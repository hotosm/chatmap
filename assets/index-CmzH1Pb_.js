const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/telegram-naMZCWTL.js","assets/chatmap--UvUJPGO.js","assets/signal-BZi8xF_p.js","assets/whatsapp-C86084Ia.js"])))=>i.map(i=>d[i]);
(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const I of document.querySelectorAll('link[rel="modulepreload"]'))C(I);new MutationObserver(I=>{for(const z of I)if(z.type==="childList")for(const E of z.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&C(E)}).observe(document,{childList:!0,subtree:!0});function v(I){const z={};return I.integrity&&(z.integrity=I.integrity),I.referrerPolicy&&(z.referrerPolicy=I.referrerPolicy),I.crossOrigin==="use-credentials"?z.credentials="include":I.crossOrigin==="anonymous"?z.credentials="omit":z.credentials="same-origin",z}function C(I){if(I.ep)return;I.ep=!0;const z=v(I);fetch(I.href,z)}})();var sc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ld(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function ev(d){if(Object.prototype.hasOwnProperty.call(d,"__esModule"))return d;var x=d.default;if(typeof x=="function"){var v=function C(){return this instanceof C?Reflect.construct(x,arguments,this.constructor):x.apply(this,arguments)};v.prototype=x.prototype}else v={};return Object.defineProperty(v,"__esModule",{value:!0}),Object.keys(d).forEach(function(C){var I=Object.getOwnPropertyDescriptor(d,C);Object.defineProperty(v,C,I.get?I:{enumerable:!0,get:function(){return d[C]}})}),v}var $p={exports:{}},Vd={},Gp={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig;function tv(){if(ig)return cn;ig=1;var d=Symbol.for("react.element"),x=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),E=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),U=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),j=Symbol.iterator;function N(oe){return oe===null||typeof oe!="object"?null:(oe=j&&oe[j]||oe["@@iterator"],typeof oe=="function"?oe:null)}var q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},se=Object.assign,J={};function ae(oe,_e,Ct){this.props=oe,this.context=_e,this.refs=J,this.updater=Ct||q}ae.prototype.isReactComponent={},ae.prototype.setState=function(oe,_e){if(typeof oe!="object"&&typeof oe!="function"&&oe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,oe,_e,"setState")},ae.prototype.forceUpdate=function(oe){this.updater.enqueueForceUpdate(this,oe,"forceUpdate")};function re(){}re.prototype=ae.prototype;function pe(oe,_e,Ct){this.props=oe,this.context=_e,this.refs=J,this.updater=Ct||q}var ge=pe.prototype=new re;ge.constructor=pe,se(ge,ae.prototype),ge.isPureReactComponent=!0;var Fe=Array.isArray,ve=Object.prototype.hasOwnProperty,qe={current:null},je={key:!0,ref:!0,__self:!0,__source:!0};function St(oe,_e,Ct){var bt,wt={},ar=null,fr=null;if(_e!=null)for(bt in _e.ref!==void 0&&(fr=_e.ref),_e.key!==void 0&&(ar=""+_e.key),_e)ve.call(_e,bt)&&!je.hasOwnProperty(bt)&&(wt[bt]=_e[bt]);var qt=arguments.length-2;if(qt===1)wt.children=Ct;else if(1<qt){for(var Kt=Array(qt),Cr=0;Cr<qt;Cr++)Kt[Cr]=arguments[Cr+2];wt.children=Kt}if(oe&&oe.defaultProps)for(bt in qt=oe.defaultProps,qt)wt[bt]===void 0&&(wt[bt]=qt[bt]);return{$$typeof:d,type:oe,key:ar,ref:fr,props:wt,_owner:qe.current}}function ot(oe,_e){return{$$typeof:d,type:oe.type,key:_e,ref:oe.ref,props:oe.props,_owner:oe._owner}}function At(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===d}function xt(oe){var _e={"=":"=0",":":"=2"};return"$"+oe.replace(/[=:]/g,function(Ct){return _e[Ct]})}var xe=/\/+/g;function Je(oe,_e){return typeof oe=="object"&&oe!==null&&oe.key!=null?xt(""+oe.key):_e.toString(36)}function G(oe,_e,Ct,bt,wt){var ar=typeof oe;(ar==="undefined"||ar==="boolean")&&(oe=null);var fr=!1;if(oe===null)fr=!0;else switch(ar){case"string":case"number":fr=!0;break;case"object":switch(oe.$$typeof){case d:case x:fr=!0}}if(fr)return fr=oe,wt=wt(fr),oe=bt===""?"."+Je(fr,0):bt,Fe(wt)?(Ct="",oe!=null&&(Ct=oe.replace(xe,"$&/")+"/"),G(wt,_e,Ct,"",function(Cr){return Cr})):wt!=null&&(At(wt)&&(wt=ot(wt,Ct+(!wt.key||fr&&fr.key===wt.key?"":(""+wt.key).replace(xe,"$&/")+"/")+oe)),_e.push(wt)),1;if(fr=0,bt=bt===""?".":bt+":",Fe(oe))for(var qt=0;qt<oe.length;qt++){ar=oe[qt];var Kt=bt+Je(ar,qt);fr+=G(ar,_e,Ct,Kt,wt)}else if(Kt=N(oe),typeof Kt=="function")for(oe=Kt.call(oe),qt=0;!(ar=oe.next()).done;)ar=ar.value,Kt=bt+Je(ar,qt++),fr+=G(ar,_e,Ct,Kt,wt);else if(ar==="object")throw _e=String(oe),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(oe).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.");return fr}function Ve(oe,_e,Ct){if(oe==null)return oe;var bt=[],wt=0;return G(oe,bt,"","",function(ar){return _e.call(Ct,ar,wt++)}),bt}function Rt(oe){if(oe._status===-1){var _e=oe._result;_e=_e(),_e.then(function(Ct){(oe._status===0||oe._status===-1)&&(oe._status=1,oe._result=Ct)},function(Ct){(oe._status===0||oe._status===-1)&&(oe._status=2,oe._result=Ct)}),oe._status===-1&&(oe._status=0,oe._result=_e)}if(oe._status===1)return oe._result.default;throw oe._result}var Ae={current:null},et={transition:null},Ze={ReactCurrentDispatcher:Ae,ReactCurrentBatchConfig:et,ReactCurrentOwner:qe};function ht(){throw Error("act(...) is not supported in production builds of React.")}return cn.Children={map:Ve,forEach:function(oe,_e,Ct){Ve(oe,function(){_e.apply(this,arguments)},Ct)},count:function(oe){var _e=0;return Ve(oe,function(){_e++}),_e},toArray:function(oe){return Ve(oe,function(_e){return _e})||[]},only:function(oe){if(!At(oe))throw Error("React.Children.only expected to receive a single React element child.");return oe}},cn.Component=ae,cn.Fragment=v,cn.Profiler=I,cn.PureComponent=pe,cn.StrictMode=C,cn.Suspense=B,cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ze,cn.act=ht,cn.cloneElement=function(oe,_e,Ct){if(oe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+oe+".");var bt=se({},oe.props),wt=oe.key,ar=oe.ref,fr=oe._owner;if(_e!=null){if(_e.ref!==void 0&&(ar=_e.ref,fr=qe.current),_e.key!==void 0&&(wt=""+_e.key),oe.type&&oe.type.defaultProps)var qt=oe.type.defaultProps;for(Kt in _e)ve.call(_e,Kt)&&!je.hasOwnProperty(Kt)&&(bt[Kt]=_e[Kt]===void 0&&qt!==void 0?qt[Kt]:_e[Kt])}var Kt=arguments.length-2;if(Kt===1)bt.children=Ct;else if(1<Kt){qt=Array(Kt);for(var Cr=0;Cr<Kt;Cr++)qt[Cr]=arguments[Cr+2];bt.children=qt}return{$$typeof:d,type:oe.type,key:wt,ref:ar,props:bt,_owner:fr}},cn.createContext=function(oe){return oe={$$typeof:E,_currentValue:oe,_currentValue2:oe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},oe.Provider={$$typeof:z,_context:oe},oe.Consumer=oe},cn.createElement=St,cn.createFactory=function(oe){var _e=St.bind(null,oe);return _e.type=oe,_e},cn.createRef=function(){return{current:null}},cn.forwardRef=function(oe){return{$$typeof:u,render:oe}},cn.isValidElement=At,cn.lazy=function(oe){return{$$typeof:K,_payload:{_status:-1,_result:oe},_init:Rt}},cn.memo=function(oe,_e){return{$$typeof:U,type:oe,compare:_e===void 0?null:_e}},cn.startTransition=function(oe){var _e=et.transition;et.transition={};try{oe()}finally{et.transition=_e}},cn.unstable_act=ht,cn.useCallback=function(oe,_e){return Ae.current.useCallback(oe,_e)},cn.useContext=function(oe){return Ae.current.useContext(oe)},cn.useDebugValue=function(){},cn.useDeferredValue=function(oe){return Ae.current.useDeferredValue(oe)},cn.useEffect=function(oe,_e){return Ae.current.useEffect(oe,_e)},cn.useId=function(){return Ae.current.useId()},cn.useImperativeHandle=function(oe,_e,Ct){return Ae.current.useImperativeHandle(oe,_e,Ct)},cn.useInsertionEffect=function(oe,_e){return Ae.current.useInsertionEffect(oe,_e)},cn.useLayoutEffect=function(oe,_e){return Ae.current.useLayoutEffect(oe,_e)},cn.useMemo=function(oe,_e){return Ae.current.useMemo(oe,_e)},cn.useReducer=function(oe,_e,Ct){return Ae.current.useReducer(oe,_e,Ct)},cn.useRef=function(oe){return Ae.current.useRef(oe)},cn.useState=function(oe){return Ae.current.useState(oe)},cn.useSyncExternalStore=function(oe,_e,Ct){return Ae.current.useSyncExternalStore(oe,_e,Ct)},cn.useTransition=function(){return Ae.current.useTransition()},cn.version="18.3.1",cn}var sg;function ch(){return sg||(sg=1,Gp.exports=tv()),Gp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function rv(){if(og)return Vd;og=1;var d=ch(),x=Symbol.for("react.element"),v=Symbol.for("react.fragment"),C=Object.prototype.hasOwnProperty,I=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,z={key:!0,ref:!0,__self:!0,__source:!0};function E(u,B,U){var K,j={},N=null,q=null;U!==void 0&&(N=""+U),B.key!==void 0&&(N=""+B.key),B.ref!==void 0&&(q=B.ref);for(K in B)C.call(B,K)&&!z.hasOwnProperty(K)&&(j[K]=B[K]);if(u&&u.defaultProps)for(K in B=u.defaultProps,B)j[K]===void 0&&(j[K]=B[K]);return{$$typeof:x,type:u,key:N,ref:q,props:j,_owner:I.current}}return Vd.Fragment=v,Vd.jsx=E,Vd.jsxs=E,Vd}var ag;function nv(){return ag||(ag=1,$p.exports=rv()),$p.exports}var yt=nv(),qr=ch();const lh=ld(qr);var Hf={},qp={exports:{}},$o={},Zp={exports:{}},Wp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg;function iv(){return lg||(lg=1,function(d){function x(et,Ze){var ht=et.length;et.push(Ze);e:for(;0<ht;){var oe=ht-1>>>1,_e=et[oe];if(0<I(_e,Ze))et[oe]=Ze,et[ht]=_e,ht=oe;else break e}}function v(et){return et.length===0?null:et[0]}function C(et){if(et.length===0)return null;var Ze=et[0],ht=et.pop();if(ht!==Ze){et[0]=ht;e:for(var oe=0,_e=et.length,Ct=_e>>>1;oe<Ct;){var bt=2*(oe+1)-1,wt=et[bt],ar=bt+1,fr=et[ar];if(0>I(wt,ht))ar<_e&&0>I(fr,wt)?(et[oe]=fr,et[ar]=ht,oe=ar):(et[oe]=wt,et[bt]=ht,oe=bt);else if(ar<_e&&0>I(fr,ht))et[oe]=fr,et[ar]=ht,oe=ar;else break e}}return Ze}function I(et,Ze){var ht=et.sortIndex-Ze.sortIndex;return ht!==0?ht:et.id-Ze.id}if(typeof performance=="object"&&typeof performance.now=="function"){var z=performance;d.unstable_now=function(){return z.now()}}else{var E=Date,u=E.now();d.unstable_now=function(){return E.now()-u}}var B=[],U=[],K=1,j=null,N=3,q=!1,se=!1,J=!1,ae=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,pe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ge(et){for(var Ze=v(U);Ze!==null;){if(Ze.callback===null)C(U);else if(Ze.startTime<=et)C(U),Ze.sortIndex=Ze.expirationTime,x(B,Ze);else break;Ze=v(U)}}function Fe(et){if(J=!1,ge(et),!se)if(v(B)!==null)se=!0,Rt(ve);else{var Ze=v(U);Ze!==null&&Ae(Fe,Ze.startTime-et)}}function ve(et,Ze){se=!1,J&&(J=!1,re(St),St=-1),q=!0;var ht=N;try{for(ge(Ze),j=v(B);j!==null&&(!(j.expirationTime>Ze)||et&&!xt());){var oe=j.callback;if(typeof oe=="function"){j.callback=null,N=j.priorityLevel;var _e=oe(j.expirationTime<=Ze);Ze=d.unstable_now(),typeof _e=="function"?j.callback=_e:j===v(B)&&C(B),ge(Ze)}else C(B);j=v(B)}if(j!==null)var Ct=!0;else{var bt=v(U);bt!==null&&Ae(Fe,bt.startTime-Ze),Ct=!1}return Ct}finally{j=null,N=ht,q=!1}}var qe=!1,je=null,St=-1,ot=5,At=-1;function xt(){return!(d.unstable_now()-At<ot)}function xe(){if(je!==null){var et=d.unstable_now();At=et;var Ze=!0;try{Ze=je(!0,et)}finally{Ze?Je():(qe=!1,je=null)}}else qe=!1}var Je;if(typeof pe=="function")Je=function(){pe(xe)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Ve=G.port2;G.port1.onmessage=xe,Je=function(){Ve.postMessage(null)}}else Je=function(){ae(xe,0)};function Rt(et){je=et,qe||(qe=!0,Je())}function Ae(et,Ze){St=ae(function(){et(d.unstable_now())},Ze)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(et){et.callback=null},d.unstable_continueExecution=function(){se||q||(se=!0,Rt(ve))},d.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<et?Math.floor(1e3/et):5},d.unstable_getCurrentPriorityLevel=function(){return N},d.unstable_getFirstCallbackNode=function(){return v(B)},d.unstable_next=function(et){switch(N){case 1:case 2:case 3:var Ze=3;break;default:Ze=N}var ht=N;N=Ze;try{return et()}finally{N=ht}},d.unstable_pauseExecution=function(){},d.unstable_requestPaint=function(){},d.unstable_runWithPriority=function(et,Ze){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var ht=N;N=et;try{return Ze()}finally{N=ht}},d.unstable_scheduleCallback=function(et,Ze,ht){var oe=d.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?oe+ht:oe):ht=oe,et){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=ht+_e,et={id:K++,callback:Ze,priorityLevel:et,startTime:ht,expirationTime:_e,sortIndex:-1},ht>oe?(et.sortIndex=ht,x(U,et),v(B)===null&&et===v(U)&&(J?(re(St),St=-1):J=!0,Ae(Fe,ht-oe))):(et.sortIndex=_e,x(B,et),se||q||(se=!0,Rt(ve))),et},d.unstable_shouldYield=xt,d.unstable_wrapCallback=function(et){var Ze=N;return function(){var ht=N;N=Ze;try{return et.apply(this,arguments)}finally{N=ht}}}}(Wp)),Wp}var ug;function sv(){return ug||(ug=1,Zp.exports=iv()),Zp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg;function ov(){if(cg)return $o;cg=1;var d=ch(),x=sv();function v(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,p=1;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C=new Set,I={};function z(i,o){E(i,o),E(i+"Capture",o)}function E(i,o){for(I[i]=o,i=0;i<o.length;i++)C.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),B=Object.prototype.hasOwnProperty,U=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,K={},j={};function N(i){return B.call(j,i)?!0:B.call(K,i)?!1:U.test(i)?j[i]=!0:(K[i]=!0,!1)}function q(i,o,p,w){if(p!==null&&p.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return w?!1:p!==null?!p.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function se(i,o,p,w){if(o===null||typeof o>"u"||q(i,o,p,w))return!0;if(w)return!1;if(p!==null)switch(p.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function J(i,o,p,w,P,L,ie){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=w,this.attributeNamespace=P,this.mustUseProperty=p,this.propertyName=i,this.type=o,this.sanitizeURL=L,this.removeEmptyString=ie}var ae={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){ae[i]=new J(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];ae[o]=new J(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){ae[i]=new J(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){ae[i]=new J(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){ae[i]=new J(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){ae[i]=new J(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){ae[i]=new J(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){ae[i]=new J(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){ae[i]=new J(i,5,!1,i.toLowerCase(),null,!1,!1)});var re=/[\-:]([a-z])/g;function pe(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(re,pe);ae[o]=new J(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(re,pe);ae[o]=new J(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(re,pe);ae[o]=new J(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){ae[i]=new J(i,1,!1,i.toLowerCase(),null,!1,!1)}),ae.xlinkHref=new J("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){ae[i]=new J(i,1,!1,i.toLowerCase(),null,!0,!0)});function ge(i,o,p,w){var P=ae.hasOwnProperty(o)?ae[o]:null;(P!==null?P.type!==0:w||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(se(o,p,P,w)&&(p=null),w||P===null?N(o)&&(p===null?i.removeAttribute(o):i.setAttribute(o,""+p)):P.mustUseProperty?i[P.propertyName]=p===null?P.type===3?!1:"":p:(o=P.attributeName,w=P.attributeNamespace,p===null?i.removeAttribute(o):(P=P.type,p=P===3||P===4&&p===!0?"":""+p,w?i.setAttributeNS(w,o,p):i.setAttribute(o,p))))}var Fe=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ve=Symbol.for("react.element"),qe=Symbol.for("react.portal"),je=Symbol.for("react.fragment"),St=Symbol.for("react.strict_mode"),ot=Symbol.for("react.profiler"),At=Symbol.for("react.provider"),xt=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),Je=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),Ve=Symbol.for("react.memo"),Rt=Symbol.for("react.lazy"),Ae=Symbol.for("react.offscreen"),et=Symbol.iterator;function Ze(i){return i===null||typeof i!="object"?null:(i=et&&i[et]||i["@@iterator"],typeof i=="function"?i:null)}var ht=Object.assign,oe;function _e(i){if(oe===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);oe=o&&o[1]||""}return`
`+oe+i}var Ct=!1;function bt(i,o){if(!i||Ct)return"";Ct=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(mt){var w=mt}Reflect.construct(i,[],o)}else{try{o.call()}catch(mt){w=mt}i.call(o.prototype)}else{try{throw Error()}catch(mt){w=mt}i()}}catch(mt){if(mt&&w&&typeof mt.stack=="string"){for(var P=mt.stack.split(`
`),L=w.stack.split(`
`),ie=P.length-1,Re=L.length-1;1<=ie&&0<=Re&&P[ie]!==L[Re];)Re--;for(;1<=ie&&0<=Re;ie--,Re--)if(P[ie]!==L[Re]){if(ie!==1||Re!==1)do if(ie--,Re--,0>Re||P[ie]!==L[Re]){var He=`
`+P[ie].replace(" at new "," at ");return i.displayName&&He.includes("<anonymous>")&&(He=He.replace("<anonymous>",i.displayName)),He}while(1<=ie&&0<=Re);break}}}finally{Ct=!1,Error.prepareStackTrace=p}return(i=i?i.displayName||i.name:"")?_e(i):""}function wt(i){switch(i.tag){case 5:return _e(i.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 2:case 15:return i=bt(i.type,!1),i;case 11:return i=bt(i.type.render,!1),i;case 1:return i=bt(i.type,!0),i;default:return""}}function ar(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case je:return"Fragment";case qe:return"Portal";case ot:return"Profiler";case St:return"StrictMode";case Je:return"Suspense";case G:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case xt:return(i.displayName||"Context")+".Consumer";case At:return(i._context.displayName||"Context")+".Provider";case xe:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ve:return o=i.displayName||null,o!==null?o:ar(i.type)||"Memo";case Rt:o=i._payload,i=i._init;try{return ar(i(o))}catch{}}return null}function fr(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ar(o);case 8:return o===St?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function qt(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Kt(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Cr(i){var o=Kt(i)?"checked":"value",p=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),w=""+i[o];if(!i.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var P=p.get,L=p.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return P.call(this)},set:function(ie){w=""+ie,L.call(this,ie)}}),Object.defineProperty(i,o,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(ie){w=""+ie},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Br(i){i._valueTracker||(i._valueTracker=Cr(i))}function Yr(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var p=o.getValue(),w="";return i&&(w=Kt(i)?i.checked?"true":"false":i.value),i=w,i!==p?(o.setValue(i),!0):!1}function Zr(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function W(i,o){var p=o.checked;return ht({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??i._wrapperState.initialChecked})}function ft(i,o){var p=o.defaultValue==null?"":o.defaultValue,w=o.checked!=null?o.checked:o.defaultChecked;p=qt(o.value!=null?o.value:p),i._wrapperState={initialChecked:w,initialValue:p,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ye(i,o){o=o.checked,o!=null&&ge(i,"checked",o,!1)}function Me(i,o){ye(i,o);var p=qt(o.value),w=o.type;if(p!=null)w==="number"?(p===0&&i.value===""||i.value!=p)&&(i.value=""+p):i.value!==""+p&&(i.value=""+p);else if(w==="submit"||w==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ne(i,o.type,p):o.hasOwnProperty("defaultValue")&&Ne(i,o.type,qt(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function we(i,o,p){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var w=o.type;if(!(w!=="submit"&&w!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,p||o===i.value||(i.value=o),i.defaultValue=o}p=i.name,p!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,p!==""&&(i.name=p)}function Ne(i,o,p){(o!=="number"||Zr(i.ownerDocument)!==i)&&(p==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+p&&(i.defaultValue=""+p))}var _t=Array.isArray;function Mt(i,o,p,w){if(i=i.options,o){o={};for(var P=0;P<p.length;P++)o["$"+p[P]]=!0;for(p=0;p<i.length;p++)P=o.hasOwnProperty("$"+i[p].value),i[p].selected!==P&&(i[p].selected=P),P&&w&&(i[p].defaultSelected=!0)}else{for(p=""+qt(p),o=null,P=0;P<i.length;P++){if(i[P].value===p){i[P].selected=!0,w&&(i[P].defaultSelected=!0);return}o!==null||i[P].disabled||(o=i[P])}o!==null&&(o.selected=!0)}}function nt(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(v(91));return ht({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function zt(i,o){var p=o.value;if(p==null){if(p=o.children,o=o.defaultValue,p!=null){if(o!=null)throw Error(v(92));if(_t(p)){if(1<p.length)throw Error(v(93));p=p[0]}o=p}o==null&&(o=""),p=o}i._wrapperState={initialValue:qt(p)}}function rr(i,o){var p=qt(o.value),w=qt(o.defaultValue);p!=null&&(p=""+p,p!==i.value&&(i.value=p),o.defaultValue==null&&i.defaultValue!==p&&(i.defaultValue=p)),w!=null&&(i.defaultValue=""+w)}function Lt(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function _r(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function en(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?_r(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var vt,xn=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,p,w,P){MSApp.execUnsafeLocalFunction(function(){return i(o,p,w,P)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(vt=vt||document.createElement("div"),vt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=vt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function yn(i,o){if(o){var p=i.firstChild;if(p&&p===i.lastChild&&p.nodeType===3){p.nodeValue=o;return}}i.textContent=o}var wn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ui=["Webkit","ms","Moz","O"];Object.keys(wn).forEach(function(i){ui.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),wn[o]=wn[i]})});function Pt(i,o,p){return o==null||typeof o=="boolean"||o===""?"":p||typeof o!="number"||o===0||wn.hasOwnProperty(i)&&wn[i]?(""+o).trim():o+"px"}function zr(i,o){i=i.style;for(var p in o)if(o.hasOwnProperty(p)){var w=p.indexOf("--")===0,P=Pt(p,o[p],w);p==="float"&&(p="cssFloat"),w?i.setProperty(p,P):i[p]=P}}var wr=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _n(i,o){if(o){if(wr[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(v(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(v(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(v(61))}if(o.style!=null&&typeof o.style!="object")throw Error(v(62))}}function ci(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ir=null;function An(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var wi=null,Xn=null,Nr=null;function Ce(i){if(i=fu(i)){if(typeof wi!="function")throw Error(v(280));var o=i.stateNode;o&&(o=pu(o),wi(i.stateNode,i.type,o))}}function ee(i){Xn?Nr?Nr.push(i):Nr=[i]:Xn=i}function Q(){if(Xn){var i=Xn,o=Nr;if(Nr=Xn=null,Ce(i),o)for(i=0;i<o.length;i++)Ce(o[i])}}function ue(i,o){return i(o)}function Se(){}var Oe=!1;function $e(i,o,p){if(Oe)return i(o,p);Oe=!0;try{return ue(i,o,p)}finally{Oe=!1,(Xn!==null||Nr!==null)&&(Se(),Q())}}function Ke(i,o){var p=i.stateNode;if(p===null)return null;var w=pu(p);if(w===null)return null;p=w[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(i=i.type,w=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!w;break e;default:i=!1}if(i)return null;if(p&&typeof p!="function")throw Error(v(231,o,typeof p));return p}var Le=!1;if(u)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){Le=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{Le=!1}function It(i,o,p,w,P,L,ie,Re,He){var mt=Array.prototype.slice.call(arguments,3);try{o.apply(p,mt)}catch(Ot){this.onError(Ot)}}var ut=!1,Nt=null,cr=!1,pr=null,Jr={onError:function(i){ut=!0,Nt=i}};function Mr(i,o,p,w,P,L,ie,Re,He){ut=!1,Nt=null,It.apply(Jr,arguments)}function Kr(i,o,p,w,P,L,ie,Re,He){if(Mr.apply(this,arguments),ut){if(ut){var mt=Nt;ut=!1,Nt=null}else throw Error(v(198));cr||(cr=!0,pr=mt)}}function Ur(i){var o=i,p=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(p=o.return),i=o.return;while(i)}return o.tag===3?p:null}function bn(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function En(i){if(Ur(i)!==i)throw Error(v(188))}function Hr(i){var o=i.alternate;if(!o){if(o=Ur(i),o===null)throw Error(v(188));return o!==i?null:i}for(var p=i,w=o;;){var P=p.return;if(P===null)break;var L=P.alternate;if(L===null){if(w=P.return,w!==null){p=w;continue}break}if(P.child===L.child){for(L=P.child;L;){if(L===p)return En(P),i;if(L===w)return En(P),o;L=L.sibling}throw Error(v(188))}if(p.return!==w.return)p=P,w=L;else{for(var ie=!1,Re=P.child;Re;){if(Re===p){ie=!0,p=P,w=L;break}if(Re===w){ie=!0,w=P,p=L;break}Re=Re.sibling}if(!ie){for(Re=L.child;Re;){if(Re===p){ie=!0,p=L,w=P;break}if(Re===w){ie=!0,w=L,p=P;break}Re=Re.sibling}if(!ie)throw Error(v(189))}}if(p.alternate!==w)throw Error(v(190))}if(p.tag!==3)throw Error(v(188));return p.stateNode.current===p?i:o}function rn(i){return i=Hr(i),i!==null?un(i):null}function un(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=un(i);if(o!==null)return o;i=i.sibling}return null}var Fn=x.unstable_scheduleCallback,Kn=x.unstable_cancelCallback,hi=x.unstable_shouldYield,ao=x.unstable_requestPaint,Pr=x.unstable_now,bi=x.unstable_getCurrentPriorityLevel,zo=x.unstable_ImmediatePriority,di=x.unstable_UserBlockingPriority,ei=x.unstable_NormalPriority,pl=x.unstable_LowPriority,ti=x.unstable_IdlePriority,Hn=null,fi=null;function Qi(i){if(fi&&typeof fi.onCommitFiberRoot=="function")try{fi.onCommitFiberRoot(Hn,i,void 0,(i.current.flags&128)===128)}catch{}}var nn=Math.clz32?Math.clz32:Mn,lo=Math.log,Di=Math.LN2;function Mn(i){return i>>>=0,i===0?32:31-(lo(i)/Di|0)|0}var ls=64,Si=4194304;function Ns(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function pi(i,o){var p=i.pendingLanes;if(p===0)return 0;var w=0,P=i.suspendedLanes,L=i.pingedLanes,ie=p&268435455;if(ie!==0){var Re=ie&~P;Re!==0?w=Ns(Re):(L&=ie,L!==0&&(w=Ns(L)))}else ie=p&~P,ie!==0?w=Ns(ie):L!==0&&(w=Ns(L));if(w===0)return 0;if(o!==0&&o!==w&&(o&P)===0&&(P=w&-w,L=o&-o,P>=L||P===16&&(L&4194240)!==0))return o;if((w&4)!==0&&(w|=p&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=w;0<o;)p=31-nn(o),P=1<<p,w|=i[p],o&=~P;return w}function R(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Y(i,o){for(var p=i.suspendedLanes,w=i.pingedLanes,P=i.expirationTimes,L=i.pendingLanes;0<L;){var ie=31-nn(L),Re=1<<ie,He=P[ie];He===-1?((Re&p)===0||(Re&w)!==0)&&(P[ie]=R(Re,o)):He<=o&&(i.expiredLanes|=Re),L&=~Re}}function he(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ee(){var i=ls;return ls<<=1,(ls&4194240)===0&&(ls=64),i}function Ye(i){for(var o=[],p=0;31>p;p++)o.push(i);return o}function st(i,o,p){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-nn(o),i[o]=p}function Et(i,o){var p=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var w=i.eventTimes;for(i=i.expirationTimes;0<p;){var P=31-nn(p),L=1<<P;o[P]=0,w[P]=-1,i[P]=-1,p&=~L}}function Ht(i,o){var p=i.entangledLanes|=o;for(i=i.entanglements;p;){var w=31-nn(p),P=1<<w;P&o|i[w]&o&&(i[w]|=o),p&=~P}}var Jt=0;function Rr(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Vr,fn,Ei,es,Vi,js=!1,us=[],mi=null,gi=null,On=null,zn=new Map,ks=new Map,Cs=[],ml="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ql(i,o){switch(i){case"focusin":case"focusout":mi=null;break;case"dragenter":case"dragleave":gi=null;break;case"mouseover":case"mouseout":On=null;break;case"pointerover":case"pointerout":zn.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ks.delete(o.pointerId)}}function Us(i,o,p,w,P,L){return i===null||i.nativeEvent!==L?(i={blockedOn:o,domEventName:p,eventSystemFlags:w,nativeEvent:L,targetContainers:[P]},o!==null&&(o=fu(o),o!==null&&fn(o)),i):(i.eventSystemFlags|=w,o=i.targetContainers,P!==null&&o.indexOf(P)===-1&&o.push(P),i)}function ac(i,o,p,w,P){switch(o){case"focusin":return mi=Us(mi,i,o,p,w,P),!0;case"dragenter":return gi=Us(gi,i,o,p,w,P),!0;case"mouseover":return On=Us(On,i,o,p,w,P),!0;case"pointerover":var L=P.pointerId;return zn.set(L,Us(zn.get(L)||null,i,o,p,w,P)),!0;case"gotpointercapture":return L=P.pointerId,ks.set(L,Us(ks.get(L)||null,i,o,p,w,P)),!0}return!1}function Is(i){var o=la(i.target);if(o!==null){var p=Ur(o);if(p!==null){if(o=p.tag,o===13){if(o=bn(p),o!==null){i.blockedOn=o,Vi(i.priority,function(){Ei(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){i.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}i.blockedOn=null}function qo(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var p=Zo(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(p===null){p=i.nativeEvent;var w=new p.constructor(p.type,p);Ir=w,p.target.dispatchEvent(w),Ir=null}else return o=fu(p),o!==null&&fn(o),i.blockedOn=p,!1;o.shift()}return!0}function $a(i,o,p){qo(i)&&p.delete(o)}function Tn(){js=!1,mi!==null&&qo(mi)&&(mi=null),gi!==null&&qo(gi)&&(gi=null),On!==null&&qo(On)&&(On=null),zn.forEach($a),ks.forEach($a)}function Vs(i,o){i.blockedOn===o&&(i.blockedOn=null,js||(js=!0,x.unstable_scheduleCallback(x.unstable_NormalPriority,Tn)))}function cs(i){function o(P){return Vs(P,i)}if(0<us.length){Vs(us[0],i);for(var p=1;p<us.length;p++){var w=us[p];w.blockedOn===i&&(w.blockedOn=null)}}for(mi!==null&&Vs(mi,i),gi!==null&&Vs(gi,i),On!==null&&Vs(On,i),zn.forEach(o),ks.forEach(o),p=0;p<Cs.length;p++)w=Cs[p],w.blockedOn===i&&(w.blockedOn=null);for(;0<Cs.length&&(p=Cs[0],p.blockedOn===null);)Is(p),p.blockedOn===null&&Cs.shift()}var hs=Fe.ReactCurrentBatchConfig,Hi=!0;function wa(i,o,p,w){var P=Jt,L=hs.transition;hs.transition=null;try{Jt=1,ts(i,o,p,w)}finally{Jt=P,hs.transition=L}}function uo(i,o,p,w){var P=Jt,L=hs.transition;hs.transition=null;try{Jt=4,ts(i,o,p,w)}finally{Jt=P,hs.transition=L}}function ts(i,o,p,w){if(Hi){var P=Zo(i,o,p,w);if(P===null)du(i,o,w,ba,p),Ql(i,w);else if(ac(P,i,o,p,w))w.stopPropagation();else if(Ql(i,w),o&4&&-1<ml.indexOf(i)){for(;P!==null;){var L=fu(P);if(L!==null&&Vr(L),L=Zo(i,o,p,w),L===null&&du(i,o,w,ba,p),L===P)break;P=L}P!==null&&w.stopPropagation()}else du(i,o,w,null,p)}}var ba=null;function Zo(i,o,p,w){if(ba=null,i=An(w),i=la(i),i!==null)if(o=Ur(i),o===null)i=null;else if(p=o.tag,p===13){if(i=bn(o),i!==null)return i;i=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return ba=i,null}function co(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bi()){case zo:return 1;case di:return 4;case ei:case pl:return 16;case ti:return 536870912;default:return 16}default:return 16}}var Ai=null,sn=null,Wo=null;function Mu(){if(Wo)return Wo;var i,o=sn,p=o.length,w,P="value"in Ai?Ai.value:Ai.textContent,L=P.length;for(i=0;i<p&&o[i]===P[i];i++);var ie=p-i;for(w=1;w<=ie&&o[p-w]===P[L-w];w++);return Wo=P.slice(i,1<w?1-w:void 0)}function ds(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Ga(){return!0}function Sa(){return!1}function Li(i){function o(p,w,P,L,ie){this._reactName=p,this._targetInst=P,this.type=w,this.nativeEvent=L,this.target=ie,this.currentTarget=null;for(var Re in i)i.hasOwnProperty(Re)&&(p=i[Re],this[Re]=p?p(L):L[Re]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Ga:Sa,this.isPropagationStopped=Sa,this}return ht(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Ga)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Ga)},persist:function(){},isPersistent:Ga}),o}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=Li(Xo),Ea=ht({},Xo,{view:0,detail:0}),gl=Li(Ea),Ko,Ro,$i,Ta=ht({},Ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ka,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==$i&&($i&&i.type==="mousemove"?(Ko=i.screenX-$i.screenX,Ro=i.screenY-$i.screenY):Ro=Ko=0,$i=i),Ko)},movementY:function(i){return"movementY"in i?i.movementY:Ro}}),eu=Li(Ta),tu=ht({},Ta,{dataTransfer:0}),Yo=Li(tu),rs=ht({},Ea,{relatedTarget:0}),Jo=Li(rs),ru=ht({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),lc=Li(ru),nu=ht({},Xo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),qa=Li(nu),iu=ht({},Xo,{data:0}),Za=Li(iu),Wa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yl(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Hs[i])?!!o[i]:!1}function ka(){return yl}var Xa=ht({},Ea,{key:function(i){if(i.key){var o=Wa[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=ds(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Qo[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ka,charCode:function(i){return i.type==="keypress"?ds(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ds(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ka=Li(Xa),D=ht({},Ta,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),X=Li(D),ce=ht({},Ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ka}),Te=Li(ce),tt=ht({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),at=Li(tt),ct=ht({},Ta,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ut=Li(ct),ir=[9,13,27,32],hr=u&&"CompositionEvent"in window,Dr=null;u&&"documentMode"in document&&(Dr=document.documentMode);var pn=u&&"TextEvent"in window&&!Dr,yi=u&&(!hr||Dr&&8<Dr&&11>=Dr),Gi=" ",_i=!1;function $s(i,o){switch(i){case"keyup":return ir.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qi(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Gs=!1;function uc(i,o){switch(i){case"compositionend":return qi(o);case"keypress":return o.which!==32?null:(_i=!0,Gi);case"textInput":return i=o.data,i===Gi&&_i?null:i;default:return null}}function cc(i,o){if(Gs)return i==="compositionend"||!hr&&$s(i,o)?(i=Mu(),Wo=sn=Ai=null,Gs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return yi&&o.locale!=="ko"?null:o.data;default:return null}}var Ya={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _l(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Ya[i.type]:o==="textarea"}function vl(i,o,p,w){ee(w),o=Tl(o,"onChange"),0<o.length&&(p=new ho("onChange","change",null,p,w),i.push({event:p,listeners:o}))}var Do=null,ea=null;function zu(i){Ou(i,0)}function ta(i){var o=go(i);if(Yr(o))return i}function xl(i,o){if(i==="change")return o}var hc=!1;if(u){var su;if(u){var on="oninput"in document;if(!on){var ou=document.createElement("div");ou.setAttribute("oninput","return;"),on=typeof ou.oninput=="function"}su=on}else su=!1;hc=su&&(!document.documentMode||9<document.documentMode)}function dh(){Do&&(Do.detachEvent("onpropertychange",dc),ea=Do=null)}function dc(i){if(i.propertyName==="value"&&ta(ea)){var o=[];vl(o,ea,i,An(i)),$e(zu,o)}}function wl(i,o,p){i==="focusin"?(dh(),Do=o,ea=p,Do.attachEvent("onpropertychange",dc)):i==="focusout"&&dh()}function fh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ta(ea)}function Ru(i,o){if(i==="click")return ta(o)}function ph(i,o){if(i==="input"||i==="change")return ta(o)}function mh(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var fs=typeof Object.is=="function"?Object.is:mh;function Ca(i,o){if(fs(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var p=Object.keys(i),w=Object.keys(o);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var P=p[w];if(!B.call(o,P)||!fs(i[P],o[P]))return!1}return!0}function Ja(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Qa(i,o){var p=Ja(i);i=0;for(var w;p;){if(p.nodeType===3){if(w=i+p.textContent.length,i<=o&&w>=o)return{node:p,offset:o-i};i=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Ja(p)}}function el(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?el(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Du(){for(var i=window,o=Zr();o instanceof i.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)i=o.contentWindow;else break;o=Zr(i.document)}return o}function Ia(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function au(i){var o=Du(),p=i.focusedElem,w=i.selectionRange;if(o!==p&&p&&p.ownerDocument&&el(p.ownerDocument.documentElement,p)){if(w!==null&&Ia(p)){if(o=w.start,i=w.end,i===void 0&&(i=o),"selectionStart"in p)p.selectionStart=o,p.selectionEnd=Math.min(i,p.value.length);else if(i=(o=p.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var P=p.textContent.length,L=Math.min(w.start,P);w=w.end===void 0?L:Math.min(w.end,P),!i.extend&&L>w&&(P=w,w=L,L=P),P=Qa(p,L);var ie=Qa(p,w);P&&ie&&(i.rangeCount!==1||i.anchorNode!==P.node||i.anchorOffset!==P.offset||i.focusNode!==ie.node||i.focusOffset!==ie.offset)&&(o=o.createRange(),o.setStart(P.node,P.offset),i.removeAllRanges(),L>w?(i.addRange(o),i.extend(ie.node,ie.offset)):(o.setEnd(ie.node,ie.offset),i.addRange(o)))}}for(o=[],i=p;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<o.length;p++)i=o[p],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Lu=u&&"documentMode"in document&&11>=document.documentMode,ra=null,lu=null,uu=null,Fu=!1;function cu(i,o,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Fu||ra==null||ra!==Zr(w)||(w=ra,"selectionStart"in w&&Ia(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),uu&&Ca(uu,w)||(uu=w,w=Tl(lu,"onSelect"),0<w.length&&(o=new ho("onSelect","select",null,o,p),i.push({event:o,listeners:w}),o.target=ra)))}function bl(i,o){var p={};return p[i.toLowerCase()]=o.toLowerCase(),p["Webkit"+i]="webkit"+o,p["Moz"+i]="moz"+o,p}var Lo={animationend:bl("Animation","AnimationEnd"),animationiteration:bl("Animation","AnimationIteration"),animationstart:bl("Animation","AnimationStart"),transitionend:bl("Transition","TransitionEnd")},tl={},Fi={};u&&(Fi=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function Fo(i){if(tl[i])return tl[i];if(!Lo[i])return i;var o=Lo[i],p;for(p in o)if(o.hasOwnProperty(p)&&p in Fi)return tl[i]=o[p];return i}var fc=Fo("animationend"),pc=Fo("animationiteration"),Yn=Fo("animationstart"),qs=Fo("transitionend"),ps=new Map,Sl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oo(i,o){ps.set(i,o),z(o,[i])}for(var El=0;El<Sl.length;El++){var Pa=Sl[El],na=Pa.toLowerCase(),mc=Pa[0].toUpperCase()+Pa.slice(1);Oo(na,"on"+mc)}Oo(fc,"onAnimationEnd"),Oo(pc,"onAnimationIteration"),Oo(Yn,"onAnimationStart"),Oo("dblclick","onDoubleClick"),Oo("focusin","onFocus"),Oo("focusout","onBlur"),Oo(qs,"onTransitionEnd"),E("onMouseEnter",["mouseout","mouseover"]),E("onMouseLeave",["mouseout","mouseover"]),E("onPointerEnter",["pointerout","pointerover"]),E("onPointerLeave",["pointerout","pointerover"]),z("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),z("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),z("onBeforeInput",["compositionend","keypress","textInput","paste"]),z("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),z("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),z("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Aa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Aa));function hu(i,o,p){var w=i.type||"unknown-event";i.currentTarget=p,Kr(w,o,void 0,i),i.currentTarget=null}function Ou(i,o){o=(o&4)!==0;for(var p=0;p<i.length;p++){var w=i[p],P=w.event;w=w.listeners;e:{var L=void 0;if(o)for(var ie=w.length-1;0<=ie;ie--){var Re=w[ie],He=Re.instance,mt=Re.currentTarget;if(Re=Re.listener,He!==L&&P.isPropagationStopped())break e;hu(P,Re,mt),L=He}else for(ie=0;ie<w.length;ie++){if(Re=w[ie],He=Re.instance,mt=Re.currentTarget,Re=Re.listener,He!==L&&P.isPropagationStopped())break e;hu(P,Re,mt),L=He}}}if(cr)throw i=pr,cr=!1,pr=null,i}function Rn(i,o){var p=o[Qr];p===void 0&&(p=o[Qr]=new Set);var w=i+"__bubble";p.has(w)||(Bu(o,i,2,!1),p.add(w))}function ia(i,o,p){var w=0;o&&(w|=4),Bu(p,i,w,o)}var rl="_reactListening"+Math.random().toString(36).slice(2);function sa(i){if(!i[rl]){i[rl]=!0,C.forEach(function(p){p!=="selectionchange"&&(gc.has(p)||ia(p,!1,i),ia(p,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[rl]||(o[rl]=!0,ia("selectionchange",!1,o))}}function Bu(i,o,p,w){switch(co(o)){case 1:var P=wa;break;case 4:P=uo;break;default:P=ts}p=P.bind(null,o,p,i),P=void 0,!Le||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(P=!0),w?P!==void 0?i.addEventListener(o,p,{capture:!0,passive:P}):i.addEventListener(o,p,!0):P!==void 0?i.addEventListener(o,p,{passive:P}):i.addEventListener(o,p,!1)}function du(i,o,p,w,P){var L=w;if((o&1)===0&&(o&2)===0&&w!==null)e:for(;;){if(w===null)return;var ie=w.tag;if(ie===3||ie===4){var Re=w.stateNode.containerInfo;if(Re===P||Re.nodeType===8&&Re.parentNode===P)break;if(ie===4)for(ie=w.return;ie!==null;){var He=ie.tag;if((He===3||He===4)&&(He=ie.stateNode.containerInfo,He===P||He.nodeType===8&&He.parentNode===P))return;ie=ie.return}for(;Re!==null;){if(ie=la(Re),ie===null)return;if(He=ie.tag,He===5||He===6){w=L=ie;continue e}Re=Re.parentNode}}w=w.return}$e(function(){var mt=L,Ot=An(p),jt=[];e:{var Ft=ps.get(i);if(Ft!==void 0){var er=ho,mr=i;switch(i){case"keypress":if(ds(p)===0)break e;case"keydown":case"keyup":er=Ka;break;case"focusin":mr="focus",er=Jo;break;case"focusout":mr="blur",er=Jo;break;case"beforeblur":case"afterblur":er=Jo;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":er=eu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":er=Yo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":er=Te;break;case fc:case pc:case Yn:er=lc;break;case qs:er=at;break;case"scroll":er=gl;break;case"wheel":er=Ut;break;case"copy":case"cut":case"paste":er=qa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":er=X}var br=(o&4)!==0,vi=!br&&i==="scroll",lt=br?Ft!==null?Ft+"Capture":null:Ft;br=[];for(var We=mt,dt;We!==null;){dt=We;var Wt=dt.stateNode;if(dt.tag===5&&Wt!==null&&(dt=Wt,lt!==null&&(Wt=Ke(We,lt),Wt!=null&&br.push(nl(We,Wt,dt)))),vi)break;We=We.return}0<br.length&&(Ft=new er(Ft,mr,null,p,Ot),jt.push({event:Ft,listeners:br}))}}if((o&7)===0){e:{if(Ft=i==="mouseover"||i==="pointerover",er=i==="mouseout"||i==="pointerout",Ft&&p!==Ir&&(mr=p.relatedTarget||p.fromElement)&&(la(mr)||mr[mo]))break e;if((er||Ft)&&(Ft=Ot.window===Ot?Ot:(Ft=Ot.ownerDocument)?Ft.defaultView||Ft.parentWindow:window,er?(mr=p.relatedTarget||p.toElement,er=mt,mr=mr?la(mr):null,mr!==null&&(vi=Ur(mr),mr!==vi||mr.tag!==5&&mr.tag!==6)&&(mr=null)):(er=null,mr=mt),er!==mr)){if(br=eu,Wt="onMouseLeave",lt="onMouseEnter",We="mouse",(i==="pointerout"||i==="pointerover")&&(br=X,Wt="onPointerLeave",lt="onPointerEnter",We="pointer"),vi=er==null?Ft:go(er),dt=mr==null?Ft:go(mr),Ft=new br(Wt,We+"leave",er,p,Ot),Ft.target=vi,Ft.relatedTarget=dt,Wt=null,la(Ot)===mt&&(br=new br(lt,We+"enter",mr,p,Ot),br.target=dt,br.relatedTarget=vi,Wt=br),vi=Wt,er&&mr)t:{for(br=er,lt=mr,We=0,dt=br;dt;dt=oa(dt))We++;for(dt=0,Wt=lt;Wt;Wt=oa(Wt))dt++;for(;0<We-dt;)br=oa(br),We--;for(;0<dt-We;)lt=oa(lt),dt--;for(;We--;){if(br===lt||lt!==null&&br===lt.alternate)break t;br=oa(br),lt=oa(lt)}br=null}else br=null;er!==null&&kl(jt,Ft,er,br,!1),mr!==null&&vi!==null&&kl(jt,vi,mr,br,!0)}}e:{if(Ft=mt?go(mt):window,er=Ft.nodeName&&Ft.nodeName.toLowerCase(),er==="select"||er==="input"&&Ft.type==="file")var Er=xl;else if(_l(Ft))if(hc)Er=ph;else{Er=fh;var Or=wl}else(er=Ft.nodeName)&&er.toLowerCase()==="input"&&(Ft.type==="checkbox"||Ft.type==="radio")&&(Er=Ru);if(Er&&(Er=Er(i,mt))){vl(jt,Er,p,Ot);break e}Or&&Or(i,Ft,mt),i==="focusout"&&(Or=Ft._wrapperState)&&Or.controlled&&Ft.type==="number"&&Ne(Ft,"number",Ft.value)}switch(Or=mt?go(mt):window,i){case"focusin":(_l(Or)||Or.contentEditable==="true")&&(ra=Or,lu=mt,uu=null);break;case"focusout":uu=lu=ra=null;break;case"mousedown":Fu=!0;break;case"contextmenu":case"mouseup":case"dragend":Fu=!1,cu(jt,p,Ot);break;case"selectionchange":if(Lu)break;case"keydown":case"keyup":cu(jt,p,Ot)}var Tr;if(hr)e:{switch(i){case"compositionstart":var Gr="onCompositionStart";break e;case"compositionend":Gr="onCompositionEnd";break e;case"compositionupdate":Gr="onCompositionUpdate";break e}Gr=void 0}else Gs?$s(i,p)&&(Gr="onCompositionEnd"):i==="keydown"&&p.keyCode===229&&(Gr="onCompositionStart");Gr&&(yi&&p.locale!=="ko"&&(Gs||Gr!=="onCompositionStart"?Gr==="onCompositionEnd"&&Gs&&(Tr=Mu()):(Ai=Ot,sn="value"in Ai?Ai.value:Ai.textContent,Gs=!0)),Or=Tl(mt,Gr),0<Or.length&&(Gr=new Za(Gr,i,null,p,Ot),jt.push({event:Gr,listeners:Or}),Tr?Gr.data=Tr:(Tr=qi(p),Tr!==null&&(Gr.data=Tr)))),(Tr=pn?uc(i,p):cc(i,p))&&(mt=Tl(mt,"onBeforeInput"),0<mt.length&&(Ot=new Za("onBeforeInput","beforeinput",null,p,Ot),jt.push({event:Ot,listeners:mt}),Ot.data=Tr))}Ou(jt,o)})}function nl(i,o,p){return{instance:i,listener:o,currentTarget:p}}function Tl(i,o){for(var p=o+"Capture",w=[];i!==null;){var P=i,L=P.stateNode;P.tag===5&&L!==null&&(P=L,L=Ke(i,p),L!=null&&w.unshift(nl(i,L,P)),L=Ke(i,o),L!=null&&w.push(nl(i,L,P))),i=i.return}return w}function oa(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function kl(i,o,p,w,P){for(var L=o._reactName,ie=[];p!==null&&p!==w;){var Re=p,He=Re.alternate,mt=Re.stateNode;if(He!==null&&He===w)break;Re.tag===5&&mt!==null&&(Re=mt,P?(He=Ke(p,L),He!=null&&ie.unshift(nl(p,He,Re))):P||(He=Ke(p,L),He!=null&&ie.push(nl(p,He,Re)))),p=p.return}ie.length!==0&&i.push({event:o,listeners:ie})}var gh=/\r\n?/g,Zs=/\u0000|\uFFFD/g;function fo(i){return(typeof i=="string"?i:""+i).replace(gh,`
`).replace(Zs,"")}function Cl(i,o,p){if(o=fo(o),fo(i)!==o&&p)throw Error(v(425))}function ms(){}var aa=null,yc=null;function _c(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Nu=typeof setTimeout=="function"?setTimeout:void 0,yh=typeof clearTimeout=="function"?clearTimeout:void 0,ju=typeof Promise=="function"?Promise:void 0,Il=typeof queueMicrotask=="function"?queueMicrotask:typeof ju<"u"?function(i){return ju.resolve(null).then(i).catch(Ws)}:Nu;function Ws(i){setTimeout(function(){throw i})}function sr(i,o){var p=o,w=0;do{var P=p.nextSibling;if(i.removeChild(p),P&&P.nodeType===8)if(p=P.data,p==="/$"){if(w===0){i.removeChild(P),cs(o);return}w--}else p!=="$"&&p!=="$?"&&p!=="$!"||w++;p=P}while(p);cs(o)}function po(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Uu(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var p=i.data;if(p==="$"||p==="$!"||p==="$?"){if(o===0)return i;o--}else p==="/$"&&o++}i=i.previousSibling}return null}var il=Math.random().toString(36).slice(2),ns="__reactFiber$"+il,Bo="__reactProps$"+il,mo="__reactContainer$"+il,Qr="__reactEvents$"+il,vc="__reactListeners$"+il,cd="__reactHandles$"+il;function la(i){var o=i[ns];if(o)return o;for(var p=i.parentNode;p;){if(o=p[mo]||p[ns]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(i=Uu(i);i!==null;){if(p=i[ns])return p;i=Uu(i)}return o}i=p,p=i.parentNode}return null}function fu(i){return i=i[ns]||i[mo],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function go(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(v(33))}function pu(i){return i[Bo]||null}var mu=[],sl=-1;function Ma(i){return{current:i}}function Dn(i){0>sl||(i.current=mu[sl],mu[sl]=null,sl--)}function Bn(i,o){sl++,mu[sl]=i.current,i.current=o}var za={},kn=Ma(za),tn=Ma(!1),Xs=za;function ua(i,o){var p=i.type.contextTypes;if(!p)return za;var w=i.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===o)return w.__reactInternalMemoizedMaskedChildContext;var P={},L;for(L in p)P[L]=o[L];return w&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=P),P}function Oi(i){return i=i.childContextTypes,i!=null}function gu(){Dn(tn),Dn(kn)}function Pl(i,o,p){if(kn.current!==za)throw Error(v(168));Bn(kn,o),Bn(tn,p)}function Al(i,o,p){var w=i.stateNode;if(o=o.childContextTypes,typeof w.getChildContext!="function")return p;w=w.getChildContext();for(var P in w)if(!(P in o))throw Error(v(108,fr(i)||"Unknown",P));return ht({},p,w)}function Ps(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||za,Xs=kn.current,Bn(kn,i),Bn(tn,tn.current),!0}function Ml(i,o,p){var w=i.stateNode;if(!w)throw Error(v(169));p?(i=Al(i,o,Xs),w.__reactInternalMemoizedMergedChildContext=i,Dn(tn),Dn(kn),Bn(kn,i)):Dn(tn),Bn(tn,p)}var or=null,Sr=!1,zl=!1;function yu(i){or===null?or=[i]:or.push(i)}function xc(i){Sr=!0,yu(i)}function g(){if(!zl&&or!==null){zl=!0;var i=0,o=Jt;try{var p=or;for(Jt=1;i<p.length;i++){var w=p[i];do w=w(!0);while(w!==null)}or=null,Sr=!1}catch(P){throw or!==null&&(or=or.slice(i+1)),Fn(zo,g),P}finally{Jt=o,zl=!1}}return null}var e=[],s=0,c=null,h=0,m=[],S=0,k=null,A=1,F="";function H(i,o){e[s++]=h,e[s++]=c,c=i,h=o}function $(i,o,p){m[S++]=A,m[S++]=F,m[S++]=k,k=i;var w=A;i=F;var P=32-nn(w)-1;w&=~(1<<P),p+=1;var L=32-nn(o)+P;if(30<L){var ie=P-P%5;L=(w&(1<<ie)-1).toString(32),w>>=ie,P-=ie,A=1<<32-nn(o)+P|p<<P|w,F=L+i}else A=1<<L|p<<P|w,F=i}function ne(i){i.return!==null&&(H(i,1),$(i,1,0))}function de(i){for(;i===c;)c=e[--s],e[s]=null,h=e[--s],e[s]=null;for(;i===k;)k=m[--S],m[S]=null,F=m[--S],m[S]=null,A=m[--S],m[S]=null}var me=null,be=null,Ie=!1,ze=null;function Be(i,o){var p=ro(5,null,null,0);p.elementType="DELETED",p.stateNode=o,p.return=i,o=i.deletions,o===null?(i.deletions=[p],i.flags|=16):o.push(p)}function ke(i,o){switch(i.tag){case 5:var p=i.type;return o=o.nodeType!==1||p.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,me=i,be=po(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,me=i,be=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(p=k!==null?{id:A,overflow:F}:null,i.memoizedState={dehydrated:o,treeContext:p,retryLane:1073741824},p=ro(18,null,null,0),p.stateNode=o,p.return=i,i.child=p,me=i,be=null,!0):!1;default:return!1}}function Ge(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Xe(i){if(Ie){var o=be;if(o){var p=o;if(!ke(i,o)){if(Ge(i))throw Error(v(418));o=po(p.nextSibling);var w=me;o&&ke(i,o)?Be(w,p):(i.flags=i.flags&-4097|2,Ie=!1,me=i)}}else{if(Ge(i))throw Error(v(418));i.flags=i.flags&-4097|2,Ie=!1,me=i}}}function it(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;me=i}function kt(i){if(i!==me)return!1;if(!Ie)return it(i),Ie=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!_c(i.type,i.memoizedProps)),o&&(o=be)){if(Ge(i))throw Bt(),Error(v(418));for(;o;)Be(i,o),o=po(o.nextSibling)}if(it(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(v(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var p=i.data;if(p==="/$"){if(o===0){be=po(i.nextSibling);break e}o--}else p!=="$"&&p!=="$!"&&p!=="$?"||o++}i=i.nextSibling}be=null}}else be=me?po(i.stateNode.nextSibling):null;return!0}function Bt(){for(var i=be;i;)i=po(i.nextSibling)}function $t(){be=me=null,Ie=!1}function Qt(i){ze===null?ze=[i]:ze.push(i)}var Gt=Fe.ReactCurrentBatchConfig;function Vt(i,o,p){if(i=p.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(v(309));var w=p.stateNode}if(!w)throw Error(v(147,i));var P=w,L=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===L?o.ref:(o=function(ie){var Re=P.refs;ie===null?delete Re[L]:Re[L]=ie},o._stringRef=L,o)}if(typeof i!="string")throw Error(v(284));if(!p._owner)throw Error(v(290,i))}return i}function ur(i,o){throw i=Object.prototype.toString.call(o),Error(v(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Fr(i){var o=i._init;return o(i._payload)}function Zt(i){function o(lt,We){if(i){var dt=lt.deletions;dt===null?(lt.deletions=[We],lt.flags|=16):dt.push(We)}}function p(lt,We){if(!i)return null;for(;We!==null;)o(lt,We),We=We.sibling;return null}function w(lt,We){for(lt=new Map;We!==null;)We.key!==null?lt.set(We.key,We):lt.set(We.index,We),We=We.sibling;return lt}function P(lt,We){return lt=$l(lt,We),lt.index=0,lt.sibling=null,lt}function L(lt,We,dt){return lt.index=dt,i?(dt=lt.alternate,dt!==null?(dt=dt.index,dt<We?(lt.flags|=2,We):dt):(lt.flags|=2,We)):(lt.flags|=1048576,We)}function ie(lt){return i&&lt.alternate===null&&(lt.flags|=2),lt}function Re(lt,We,dt,Wt){return We===null||We.tag!==6?(We=Vo(dt,lt.mode,Wt),We.return=lt,We):(We=P(We,dt),We.return=lt,We)}function He(lt,We,dt,Wt){var Er=dt.type;return Er===je?Ot(lt,We,dt.props.children,Wt,dt.key):We!==null&&(We.elementType===Er||typeof Er=="object"&&Er!==null&&Er.$$typeof===Rt&&Fr(Er)===We.type)?(Wt=P(We,dt.props),Wt.ref=Vt(lt,We,dt),Wt.return=lt,Wt):(Wt=Wc(dt.type,dt.key,dt.props,null,lt.mode,Wt),Wt.ref=Vt(lt,We,dt),Wt.return=lt,Wt)}function mt(lt,We,dt,Wt){return We===null||We.tag!==4||We.stateNode.containerInfo!==dt.containerInfo||We.stateNode.implementation!==dt.implementation?(We=Oa(dt,lt.mode,Wt),We.return=lt,We):(We=P(We,dt.children||[]),We.return=lt,We)}function Ot(lt,We,dt,Wt,Er){return We===null||We.tag!==7?(We=Gl(dt,lt.mode,Wt,Er),We.return=lt,We):(We=P(We,dt),We.return=lt,We)}function jt(lt,We,dt){if(typeof We=="string"&&We!==""||typeof We=="number")return We=Vo(""+We,lt.mode,dt),We.return=lt,We;if(typeof We=="object"&&We!==null){switch(We.$$typeof){case ve:return dt=Wc(We.type,We.key,We.props,null,lt.mode,dt),dt.ref=Vt(lt,null,We),dt.return=lt,dt;case qe:return We=Oa(We,lt.mode,dt),We.return=lt,We;case Rt:var Wt=We._init;return jt(lt,Wt(We._payload),dt)}if(_t(We)||Ze(We))return We=Gl(We,lt.mode,dt,null),We.return=lt,We;ur(lt,We)}return null}function Ft(lt,We,dt,Wt){var Er=We!==null?We.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number")return Er!==null?null:Re(lt,We,""+dt,Wt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case ve:return dt.key===Er?He(lt,We,dt,Wt):null;case qe:return dt.key===Er?mt(lt,We,dt,Wt):null;case Rt:return Er=dt._init,Ft(lt,We,Er(dt._payload),Wt)}if(_t(dt)||Ze(dt))return Er!==null?null:Ot(lt,We,dt,Wt,null);ur(lt,dt)}return null}function er(lt,We,dt,Wt,Er){if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number")return lt=lt.get(dt)||null,Re(We,lt,""+Wt,Er);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case ve:return lt=lt.get(Wt.key===null?dt:Wt.key)||null,He(We,lt,Wt,Er);case qe:return lt=lt.get(Wt.key===null?dt:Wt.key)||null,mt(We,lt,Wt,Er);case Rt:var Or=Wt._init;return er(lt,We,dt,Or(Wt._payload),Er)}if(_t(Wt)||Ze(Wt))return lt=lt.get(dt)||null,Ot(We,lt,Wt,Er,null);ur(We,Wt)}return null}function mr(lt,We,dt,Wt){for(var Er=null,Or=null,Tr=We,Gr=We=0,Ui=null;Tr!==null&&Gr<dt.length;Gr++){Tr.index>Gr?(Ui=Tr,Tr=null):Ui=Tr.sibling;var mn=Ft(lt,Tr,dt[Gr],Wt);if(mn===null){Tr===null&&(Tr=Ui);break}i&&Tr&&mn.alternate===null&&o(lt,Tr),We=L(mn,We,Gr),Or===null?Er=mn:Or.sibling=mn,Or=mn,Tr=Ui}if(Gr===dt.length)return p(lt,Tr),Ie&&H(lt,Gr),Er;if(Tr===null){for(;Gr<dt.length;Gr++)Tr=jt(lt,dt[Gr],Wt),Tr!==null&&(We=L(Tr,We,Gr),Or===null?Er=Tr:Or.sibling=Tr,Or=Tr);return Ie&&H(lt,Gr),Er}for(Tr=w(lt,Tr);Gr<dt.length;Gr++)Ui=er(Tr,lt,Gr,dt[Gr],Wt),Ui!==null&&(i&&Ui.alternate!==null&&Tr.delete(Ui.key===null?Gr:Ui.key),We=L(Ui,We,Gr),Or===null?Er=Ui:Or.sibling=Ui,Or=Ui);return i&&Tr.forEach(function(ul){return o(lt,ul)}),Ie&&H(lt,Gr),Er}function br(lt,We,dt,Wt){var Er=Ze(dt);if(typeof Er!="function")throw Error(v(150));if(dt=Er.call(dt),dt==null)throw Error(v(151));for(var Or=Er=null,Tr=We,Gr=We=0,Ui=null,mn=dt.next();Tr!==null&&!mn.done;Gr++,mn=dt.next()){Tr.index>Gr?(Ui=Tr,Tr=null):Ui=Tr.sibling;var ul=Ft(lt,Tr,mn.value,Wt);if(ul===null){Tr===null&&(Tr=Ui);break}i&&Tr&&ul.alternate===null&&o(lt,Tr),We=L(ul,We,Gr),Or===null?Er=ul:Or.sibling=ul,Or=ul,Tr=Ui}if(mn.done)return p(lt,Tr),Ie&&H(lt,Gr),Er;if(Tr===null){for(;!mn.done;Gr++,mn=dt.next())mn=jt(lt,mn.value,Wt),mn!==null&&(We=L(mn,We,Gr),Or===null?Er=mn:Or.sibling=mn,Or=mn);return Ie&&H(lt,Gr),Er}for(Tr=w(lt,Tr);!mn.done;Gr++,mn=dt.next())mn=er(Tr,lt,Gr,mn.value,Wt),mn!==null&&(i&&mn.alternate!==null&&Tr.delete(mn.key===null?Gr:mn.key),We=L(mn,We,Gr),Or===null?Er=mn:Or.sibling=mn,Or=mn);return i&&Tr.forEach(function(zp){return o(lt,zp)}),Ie&&H(lt,Gr),Er}function vi(lt,We,dt,Wt){if(typeof dt=="object"&&dt!==null&&dt.type===je&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case ve:e:{for(var Er=dt.key,Or=We;Or!==null;){if(Or.key===Er){if(Er=dt.type,Er===je){if(Or.tag===7){p(lt,Or.sibling),We=P(Or,dt.props.children),We.return=lt,lt=We;break e}}else if(Or.elementType===Er||typeof Er=="object"&&Er!==null&&Er.$$typeof===Rt&&Fr(Er)===Or.type){p(lt,Or.sibling),We=P(Or,dt.props),We.ref=Vt(lt,Or,dt),We.return=lt,lt=We;break e}p(lt,Or);break}else o(lt,Or);Or=Or.sibling}dt.type===je?(We=Gl(dt.props.children,lt.mode,Wt,dt.key),We.return=lt,lt=We):(Wt=Wc(dt.type,dt.key,dt.props,null,lt.mode,Wt),Wt.ref=Vt(lt,We,dt),Wt.return=lt,lt=Wt)}return ie(lt);case qe:e:{for(Or=dt.key;We!==null;){if(We.key===Or)if(We.tag===4&&We.stateNode.containerInfo===dt.containerInfo&&We.stateNode.implementation===dt.implementation){p(lt,We.sibling),We=P(We,dt.children||[]),We.return=lt,lt=We;break e}else{p(lt,We);break}else o(lt,We);We=We.sibling}We=Oa(dt,lt.mode,Wt),We.return=lt,lt=We}return ie(lt);case Rt:return Or=dt._init,vi(lt,We,Or(dt._payload),Wt)}if(_t(dt))return mr(lt,We,dt,Wt);if(Ze(dt))return br(lt,We,dt,Wt);ur(lt,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"?(dt=""+dt,We!==null&&We.tag===6?(p(lt,We.sibling),We=P(We,dt),We.return=lt,lt=We):(p(lt,We),We=Vo(dt,lt.mode,Wt),We.return=lt,lt=We),ie(lt)):p(lt,We)}return vi}var Xt=Zt(!0),Lr=Zt(!1),Sn=Ma(null),$r=null,Wr=null,Cn=null;function Mi(){Cn=Wr=$r=null}function As(i){var o=Sn.current;Dn(Sn),i._currentValue=o}function In(i,o,p){for(;i!==null;){var w=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,w!==null&&(w.childLanes|=o)):w!==null&&(w.childLanes&o)!==o&&(w.childLanes|=o),i===p)break;i=i.return}}function Ti(i,o){$r=i,Cn=Wr=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Ds=!0),i.firstContext=null)}function Nn(i){var o=i._currentValue;if(Cn!==i)if(i={context:i,memoizedValue:o,next:null},Wr===null){if($r===null)throw Error(v(308));Wr=i,$r.dependencies={lanes:0,firstContext:i}}else Wr=Wr.next=i;return o}var ri=null;function Bi(i){ri===null?ri=[i]:ri.push(i)}function yo(i,o,p,w){var P=o.interleaved;return P===null?(p.next=p,Bi(o)):(p.next=P.next,P.next=p),o.interleaved=p,gs(i,w)}function gs(i,o){i.lanes|=o;var p=i.alternate;for(p!==null&&(p.lanes|=o),p=i,i=i.return;i!==null;)i.childLanes|=o,p=i.alternate,p!==null&&(p.childLanes|=o),p=i,i=i.return;return p.tag===3?p.stateNode:null}var _o=!1;function Ra(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ms(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ks(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function No(i,o,p){var w=i.updateQueue;if(w===null)return null;if(w=w.shared,(hn&2)!==0){var P=w.pending;return P===null?o.next=o:(o.next=P.next,P.next=o),w.pending=o,gs(i,p)}return P=w.interleaved,P===null?(o.next=o,Bi(w)):(o.next=P.next,P.next=o),w.interleaved=o,gs(i,p)}function is(i,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194240)!==0)){var w=o.lanes;w&=i.pendingLanes,p|=w,o.lanes=p,Ht(i,p)}}function zs(i,o){var p=i.updateQueue,w=i.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var P=null,L=null;if(p=p.firstBaseUpdate,p!==null){do{var ie={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};L===null?P=L=ie:L=L.next=ie,p=p.next}while(p!==null);L===null?P=L=o:L=L.next=o}else P=L=o;p={baseState:w.baseState,firstBaseUpdate:P,lastBaseUpdate:L,shared:w.shared,effects:w.effects},i.updateQueue=p;return}i=p.lastBaseUpdate,i===null?p.firstBaseUpdate=o:i.next=o,p.lastBaseUpdate=o}function vo(i,o,p,w){var P=i.updateQueue;_o=!1;var L=P.firstBaseUpdate,ie=P.lastBaseUpdate,Re=P.shared.pending;if(Re!==null){P.shared.pending=null;var He=Re,mt=He.next;He.next=null,ie===null?L=mt:ie.next=mt,ie=He;var Ot=i.alternate;Ot!==null&&(Ot=Ot.updateQueue,Re=Ot.lastBaseUpdate,Re!==ie&&(Re===null?Ot.firstBaseUpdate=mt:Re.next=mt,Ot.lastBaseUpdate=He))}if(L!==null){var jt=P.baseState;ie=0,Ot=mt=He=null,Re=L;do{var Ft=Re.lane,er=Re.eventTime;if((w&Ft)===Ft){Ot!==null&&(Ot=Ot.next={eventTime:er,lane:0,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null});e:{var mr=i,br=Re;switch(Ft=o,er=p,br.tag){case 1:if(mr=br.payload,typeof mr=="function"){jt=mr.call(er,jt,Ft);break e}jt=mr;break e;case 3:mr.flags=mr.flags&-65537|128;case 0:if(mr=br.payload,Ft=typeof mr=="function"?mr.call(er,jt,Ft):mr,Ft==null)break e;jt=ht({},jt,Ft);break e;case 2:_o=!0}}Re.callback!==null&&Re.lane!==0&&(i.flags|=64,Ft=P.effects,Ft===null?P.effects=[Re]:Ft.push(Re))}else er={eventTime:er,lane:Ft,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},Ot===null?(mt=Ot=er,He=jt):Ot=Ot.next=er,ie|=Ft;if(Re=Re.next,Re===null){if(Re=P.shared.pending,Re===null)break;Ft=Re,Re=Ft.next,Ft.next=null,P.lastBaseUpdate=Ft,P.shared.pending=null}}while(!0);if(Ot===null&&(He=jt),P.baseState=He,P.firstBaseUpdate=mt,P.lastBaseUpdate=Ot,o=P.shared.interleaved,o!==null){P=o;do ie|=P.lane,P=P.next;while(P!==o)}else L===null&&(P.shared.lanes=0);Su|=ie,i.lanes=ie,i.memoizedState=jt}}function Ys(i,o,p){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var w=i[o],P=w.callback;if(P!==null){if(w.callback=null,w=p,typeof P!="function")throw Error(v(191,P));P.call(w)}}}var ii={},$n=Ma(ii),Ni=Ma(ii),Xr=Ma(ii);function Rs(i){if(i===ii)throw Error(v(174));return i}function Da(i,o){switch(Bn(Xr,o),Bn(Ni,i),Bn($n,ii),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:en(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=en(o,i)}Dn($n),Bn($n,o)}function xo(){Dn($n),Dn(Ni),Dn(Xr)}function wc(i){Rs(Xr.current);var o=Rs($n.current),p=en(o,i.type);o!==p&&(Bn(Ni,i),Bn($n,p))}function bc(i){Ni.current===i&&(Dn($n),Dn(Ni))}var qn=Ma(0);function wo(i){for(var o=i;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Vu=[];function Rl(){for(var i=0;i<Vu.length;i++)Vu[i]._workInProgressVersionPrimary=null;Vu.length=0}var La=Fe.ReactCurrentDispatcher,Dl=Fe.ReactCurrentBatchConfig,jo=0,Pn=null,Jn=null,ki=null,Sc=!1,Hu=!1,Ec=0,hd=0;function zi(){throw Error(v(321))}function Ll(i,o){if(o===null)return!1;for(var p=0;p<o.length&&p<i.length;p++)if(!fs(i[p],o[p]))return!1;return!0}function ca(i,o,p,w,P,L){if(jo=L,Pn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,La.current=i===null||i.memoizedState===null?Eh:xp,i=p(w,P),Hu){L=0;do{if(Hu=!1,Ec=0,25<=L)throw Error(v(301));L+=1,ki=Jn=null,o.updateQueue=null,La.current=rf,i=p(w,P)}while(Hu)}if(La.current=Sh,o=Jn!==null&&Jn.next!==null,jo=0,ki=Jn=Pn=null,Sc=!1,o)throw Error(v(300));return i}function bo(){var i=Ec!==0;return Ec=0,i}function ss(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?Pn.memoizedState=ki=i:ki=ki.next=i,ki}function So(){if(Jn===null){var i=Pn.alternate;i=i!==null?i.memoizedState:null}else i=Jn.next;var o=ki===null?Pn.memoizedState:ki.next;if(o!==null)ki=o,Jn=i;else{if(i===null)throw Error(v(310));Jn=i,i={memoizedState:Jn.memoizedState,baseState:Jn.baseState,baseQueue:Jn.baseQueue,queue:Jn.queue,next:null},ki===null?Pn.memoizedState=ki=i:ki=ki.next=i}return ki}function ha(i,o){return typeof o=="function"?o(i):o}function dd(i){var o=So(),p=o.queue;if(p===null)throw Error(v(311));p.lastRenderedReducer=i;var w=Jn,P=w.baseQueue,L=p.pending;if(L!==null){if(P!==null){var ie=P.next;P.next=L.next,L.next=ie}w.baseQueue=P=L,p.pending=null}if(P!==null){L=P.next,w=w.baseState;var Re=ie=null,He=null,mt=L;do{var Ot=mt.lane;if((jo&Ot)===Ot)He!==null&&(He=He.next={lane:0,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null}),w=mt.hasEagerState?mt.eagerState:i(w,mt.action);else{var jt={lane:Ot,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null};He===null?(Re=He=jt,ie=w):He=He.next=jt,Pn.lanes|=Ot,Su|=Ot}mt=mt.next}while(mt!==null&&mt!==L);He===null?ie=w:He.next=Re,fs(w,o.memoizedState)||(Ds=!0),o.memoizedState=w,o.baseState=ie,o.baseQueue=He,p.lastRenderedState=w}if(i=p.interleaved,i!==null){P=i;do L=P.lane,Pn.lanes|=L,Su|=L,P=P.next;while(P!==i)}else P===null&&(p.lanes=0);return[o.memoizedState,p.dispatch]}function _h(i){var o=So(),p=o.queue;if(p===null)throw Error(v(311));p.lastRenderedReducer=i;var w=p.dispatch,P=p.pending,L=o.memoizedState;if(P!==null){p.pending=null;var ie=P=P.next;do L=i(L,ie.action),ie=ie.next;while(ie!==P);fs(L,o.memoizedState)||(Ds=!0),o.memoizedState=L,o.baseQueue===null&&(o.baseState=L),p.lastRenderedState=L}return[L,w]}function si(){}function vh(i,o){var p=Pn,w=So(),P=o(),L=!fs(w.memoizedState,P);if(L&&(w.memoizedState=P,Ds=!0),w=w.queue,Cc(Ol.bind(null,p,w,i),[i]),w.getSnapshot!==o||L||ki!==null&&ki.memoizedState.tag&1){if(p.flags|=2048,kc(9,Fl.bind(null,p,w,P,o),void 0,null),ji===null)throw Error(v(349));(jo&30)!==0||fd(p,o,P)}return P}function fd(i,o,p){i.flags|=16384,i={getSnapshot:o,value:p},o=Pn.updateQueue,o===null?(o={lastEffect:null,stores:null},Pn.updateQueue=o,o.stores=[i]):(p=o.stores,p===null?o.stores=[i]:p.push(i))}function Fl(i,o,p,w){o.value=p,o.getSnapshot=w,Tc(o)&&xh(i)}function Ol(i,o,p){return p(function(){Tc(o)&&xh(i)})}function Tc(i){var o=i.getSnapshot;i=i.value;try{var p=o();return!fs(i,p)}catch{return!0}}function xh(i){var o=gs(i,1);o!==null&&fa(o,i,1,-1)}function pd(i){var o=ss();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ha,lastRenderedState:i},o.queue=i,i=i.dispatch=Gu.bind(null,Pn,i),[o.memoizedState,i]}function kc(i,o,p,w){return i={tag:i,create:o,destroy:p,deps:w,next:null},o=Pn.updateQueue,o===null?(o={lastEffect:null,stores:null},Pn.updateQueue=o,o.lastEffect=i.next=i):(p=o.lastEffect,p===null?o.lastEffect=i.next=i:(w=p.next,p.next=i,i.next=w,o.lastEffect=i)),i}function md(){return So().memoizedState}function wh(i,o,p,w){var P=ss();Pn.flags|=i,P.memoizedState=kc(1|o,p,void 0,w===void 0?null:w)}function $u(i,o,p,w){var P=So();w=w===void 0?null:w;var L=void 0;if(Jn!==null){var ie=Jn.memoizedState;if(L=ie.destroy,w!==null&&Ll(w,ie.deps)){P.memoizedState=kc(o,p,L,w);return}}Pn.flags|=i,P.memoizedState=kc(1|o,p,L,w)}function Jd(i,o){return wh(8390656,8,i,o)}function Cc(i,o){return $u(2048,8,i,o)}function gd(i,o){return $u(4,2,i,o)}function yd(i,o){return $u(4,4,i,o)}function _u(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Qd(i,o,p){return p=p!=null?p.concat([i]):null,$u(4,4,_u.bind(null,o,i),p)}function vu(){}function Ic(i,o){var p=So();o=o===void 0?null:o;var w=p.memoizedState;return w!==null&&o!==null&&Ll(o,w[1])?w[0]:(p.memoizedState=[i,o],i)}function Pc(i,o){var p=So();o=o===void 0?null:o;var w=p.memoizedState;return w!==null&&o!==null&&Ll(o,w[1])?w[0]:(i=i(),p.memoizedState=[i,o],i)}function _d(i,o,p){return(jo&21)===0?(i.baseState&&(i.baseState=!1,Ds=!0),i.memoizedState=p):(fs(p,o)||(p=Ee(),Pn.lanes|=p,Su|=p,i.baseState=!0),o)}function ef(i,o){var p=Jt;Jt=p!==0&&4>p?p:4,i(!0);var w=Dl.transition;Dl.transition={};try{i(!1),o()}finally{Jt=p,Dl.transition=w}}function tf(){return So().memoizedState}function ys(i,o,p){var w=Hl(i);if(p={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null},bh(i))vd(o,p);else if(p=yo(i,o,p,w),p!==null){var P=Ls();fa(p,i,w,P),qu(p,o,w)}}function Gu(i,o,p){var w=Hl(i),P={lane:w,action:p,hasEagerState:!1,eagerState:null,next:null};if(bh(i))vd(o,P);else{var L=i.alternate;if(i.lanes===0&&(L===null||L.lanes===0)&&(L=o.lastRenderedReducer,L!==null))try{var ie=o.lastRenderedState,Re=L(ie,p);if(P.hasEagerState=!0,P.eagerState=Re,fs(Re,ie)){var He=o.interleaved;He===null?(P.next=P,Bi(o)):(P.next=He.next,He.next=P),o.interleaved=P;return}}catch{}finally{}p=yo(i,o,P,w),p!==null&&(P=Ls(),fa(p,i,w,P),qu(p,o,w))}}function bh(i){var o=i.alternate;return i===Pn||o!==null&&o===Pn}function vd(i,o){Hu=Sc=!0;var p=i.pending;p===null?o.next=o:(o.next=p.next,p.next=o),i.pending=o}function qu(i,o,p){if((p&4194240)!==0){var w=o.lanes;w&=i.pendingLanes,p|=w,o.lanes=p,Ht(i,p)}}var Sh={readContext:Nn,useCallback:zi,useContext:zi,useEffect:zi,useImperativeHandle:zi,useInsertionEffect:zi,useLayoutEffect:zi,useMemo:zi,useReducer:zi,useRef:zi,useState:zi,useDebugValue:zi,useDeferredValue:zi,useTransition:zi,useMutableSource:zi,useSyncExternalStore:zi,useId:zi,unstable_isNewReconciler:!1},Eh={readContext:Nn,useCallback:function(i,o){return ss().memoizedState=[i,o===void 0?null:o],i},useContext:Nn,useEffect:Jd,useImperativeHandle:function(i,o,p){return p=p!=null?p.concat([i]):null,wh(4194308,4,_u.bind(null,o,i),p)},useLayoutEffect:function(i,o){return wh(4194308,4,i,o)},useInsertionEffect:function(i,o){return wh(4,2,i,o)},useMemo:function(i,o){var p=ss();return o=o===void 0?null:o,i=i(),p.memoizedState=[i,o],i},useReducer:function(i,o,p){var w=ss();return o=p!==void 0?p(o):o,w.memoizedState=w.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},w.queue=i,i=i.dispatch=ys.bind(null,Pn,i),[w.memoizedState,i]},useRef:function(i){var o=ss();return i={current:i},o.memoizedState=i},useState:pd,useDebugValue:vu,useDeferredValue:function(i){return ss().memoizedState=i},useTransition:function(){var i=pd(!1),o=i[0];return i=ef.bind(null,i[1]),ss().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,p){var w=Pn,P=ss();if(Ie){if(p===void 0)throw Error(v(407));p=p()}else{if(p=o(),ji===null)throw Error(v(349));(jo&30)!==0||fd(w,o,p)}P.memoizedState=p;var L={value:p,getSnapshot:o};return P.queue=L,Jd(Ol.bind(null,w,L,i),[i]),w.flags|=2048,kc(9,Fl.bind(null,w,L,p,o),void 0,null),p},useId:function(){var i=ss(),o=ji.identifierPrefix;if(Ie){var p=F,w=A;p=(w&~(1<<32-nn(w)-1)).toString(32)+p,o=":"+o+"R"+p,p=Ec++,0<p&&(o+="H"+p.toString(32)),o+=":"}else p=hd++,o=":"+o+"r"+p.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},xp={readContext:Nn,useCallback:Ic,useContext:Nn,useEffect:Cc,useImperativeHandle:Qd,useInsertionEffect:gd,useLayoutEffect:yd,useMemo:Pc,useReducer:dd,useRef:md,useState:function(){return dd(ha)},useDebugValue:vu,useDeferredValue:function(i){var o=So();return _d(o,Jn.memoizedState,i)},useTransition:function(){var i=dd(ha)[0],o=So().memoizedState;return[i,o]},useMutableSource:si,useSyncExternalStore:vh,useId:tf,unstable_isNewReconciler:!1},rf={readContext:Nn,useCallback:Ic,useContext:Nn,useEffect:Cc,useImperativeHandle:Qd,useInsertionEffect:gd,useLayoutEffect:yd,useMemo:Pc,useReducer:_h,useRef:md,useState:function(){return _h(ha)},useDebugValue:vu,useDeferredValue:function(i){var o=So();return Jn===null?o.memoizedState=i:_d(o,Jn.memoizedState,i)},useTransition:function(){var i=_h(ha)[0],o=So().memoizedState;return[i,o]},useMutableSource:si,useSyncExternalStore:vh,useId:tf,unstable_isNewReconciler:!1};function Uo(i,o){if(i&&i.defaultProps){o=ht({},o),i=i.defaultProps;for(var p in i)o[p]===void 0&&(o[p]=i[p]);return o}return o}function Th(i,o,p,w){o=i.memoizedState,p=p(w,o),p=p==null?o:ht({},o,p),i.memoizedState=p,i.lanes===0&&(i.updateQueue.baseState=p)}var kh={isMounted:function(i){return(i=i._reactInternals)?Ur(i)===i:!1},enqueueSetState:function(i,o,p){i=i._reactInternals;var w=Ls(),P=Hl(i),L=Ks(w,P);L.payload=o,p!=null&&(L.callback=p),o=No(i,L,P),o!==null&&(fa(o,i,P,w),is(o,i,P))},enqueueReplaceState:function(i,o,p){i=i._reactInternals;var w=Ls(),P=Hl(i),L=Ks(w,P);L.tag=1,L.payload=o,p!=null&&(L.callback=p),o=No(i,L,P),o!==null&&(fa(o,i,P,w),is(o,i,P))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var p=Ls(),w=Hl(i),P=Ks(p,w);P.tag=2,o!=null&&(P.callback=o),o=No(i,P,w),o!==null&&(fa(o,i,w,p),is(o,i,w))}};function Ch(i,o,p,w,P,L,ie){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(w,L,ie):o.prototype&&o.prototype.isPureReactComponent?!Ca(p,w)||!Ca(P,L):!0}function xd(i,o,p){var w=!1,P=za,L=o.contextType;return typeof L=="object"&&L!==null?L=Nn(L):(P=Oi(o)?Xs:kn.current,w=o.contextTypes,L=(w=w!=null)?ua(i,P):za),o=new o(p,L),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=kh,i.stateNode=o,o._reactInternals=i,w&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=P,i.__reactInternalMemoizedMaskedChildContext=L),o}function Ih(i,o,p,w){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,w),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,w),o.state!==i&&kh.enqueueReplaceState(o,o.state,null)}function xu(i,o,p,w){var P=i.stateNode;P.props=p,P.state=i.memoizedState,P.refs={},Ra(i);var L=o.contextType;typeof L=="object"&&L!==null?P.context=Nn(L):(L=Oi(o)?Xs:kn.current,P.context=ua(i,L)),P.state=i.memoizedState,L=o.getDerivedStateFromProps,typeof L=="function"&&(Th(i,o,L,p),P.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(o=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),o!==P.state&&kh.enqueueReplaceState(P,P.state,null),vo(i,p,P,w),P.state=i.memoizedState),typeof P.componentDidMount=="function"&&(i.flags|=4194308)}function Zi(i,o){try{var p="",w=o;do p+=wt(w),w=w.return;while(w);var P=p}catch(L){P=`
Error generating stack: `+L.message+`
`+L.stack}return{value:i,source:o,stack:P,digest:null}}function Ph(i,o,p){return{value:i,source:null,stack:p??null,digest:o??null}}function Ac(i,o){try{console.error(o.value)}catch(p){setTimeout(function(){throw p})}}var wp=typeof WeakMap=="function"?WeakMap:Map;function wd(i,o,p){p=Ks(-1,p),p.tag=3,p.payload={element:null};var w=o.value;return p.callback=function(){jc||(jc=!0,jh=w),Ac(i,o)},p}function nf(i,o,p){p=Ks(-1,p),p.tag=3;var w=i.type.getDerivedStateFromError;if(typeof w=="function"){var P=o.value;p.payload=function(){return w(P)},p.callback=function(){Ac(i,o)}}var L=i.stateNode;return L!==null&&typeof L.componentDidCatch=="function"&&(p.callback=function(){Ac(i,o),typeof w!="function"&&(an===null?an=new Set([this]):an.add(this));var ie=o.stack;this.componentDidCatch(o.value,{componentStack:ie!==null?ie:""})}),p}function sf(i,o,p){var w=i.pingCache;if(w===null){w=i.pingCache=new wp;var P=new Set;w.set(o,P)}else P=w.get(o),P===void 0&&(P=new Set,w.set(o,P));P.has(p)||(P.add(p),i=Cp.bind(null,i,o,p),o.then(i,i))}function of(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function af(i,o,p,w,P){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(o=Ks(-1,1),o.tag=2,No(p,o,1))),p.lanes|=1),i):(i.flags|=65536,i.lanes=P,i)}var lf=Fe.ReactCurrentOwner,Ds=!1;function Ci(i,o,p,w){o.child=i===null?Lr(o,null,p,w):Xt(o,i.child,p,w)}function Zu(i,o,p,w,P){p=p.render;var L=o.ref;return Ti(o,P),w=ca(i,o,p,w,L,P),p=bo(),i!==null&&!Ds?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~P,Eo(i,o,P)):(Ie&&p&&ne(o),o.flags|=1,Ci(i,o,w,P),o.child)}function uf(i,o,p,w,P){if(i===null){var L=p.type;return typeof L=="function"&&!Zc(L)&&L.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(o.tag=15,o.type=L,cf(i,o,L,w,P)):(i=Wc(p.type,null,w,o,o.mode,P),i.ref=o.ref,i.return=o,o.child=i)}if(L=i.child,(i.lanes&P)===0){var ie=L.memoizedProps;if(p=p.compare,p=p!==null?p:Ca,p(ie,w)&&i.ref===o.ref)return Eo(i,o,P)}return o.flags|=1,i=$l(L,w),i.ref=o.ref,i.return=o,o.child=i}function cf(i,o,p,w,P){if(i!==null){var L=i.memoizedProps;if(Ca(L,w)&&i.ref===o.ref)if(Ds=!1,o.pendingProps=w=L,(i.lanes&P)!==0)(i.flags&131072)!==0&&(Ds=!0);else return o.lanes=i.lanes,Eo(i,o,P)}return bd(i,o,p,w,P)}function hf(i,o,p){var w=o.pendingProps,P=w.children,L=i!==null?i.memoizedState:null;if(w.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bn(Ku,xs),xs|=p;else{if((p&1073741824)===0)return i=L!==null?L.baseLanes|p:p,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Bn(Ku,xs),xs|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=L!==null?L.baseLanes:p,Bn(Ku,xs),xs|=w}else L!==null?(w=L.baseLanes|p,o.memoizedState=null):w=p,Bn(Ku,xs),xs|=w;return Ci(i,o,P,p),o.child}function df(i,o){var p=o.ref;(i===null&&p!==null||i!==null&&i.ref!==p)&&(o.flags|=512,o.flags|=2097152)}function bd(i,o,p,w,P){var L=Oi(p)?Xs:kn.current;return L=ua(o,L),Ti(o,P),p=ca(i,o,p,w,L,P),w=bo(),i!==null&&!Ds?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~P,Eo(i,o,P)):(Ie&&w&&ne(o),o.flags|=1,Ci(i,o,p,P),o.child)}function ff(i,o,p,w,P){if(Oi(p)){var L=!0;Ps(o)}else L=!1;if(Ti(o,P),o.stateNode===null)Rc(i,o),xd(o,p,w),xu(o,p,w,P),w=!0;else if(i===null){var ie=o.stateNode,Re=o.memoizedProps;ie.props=Re;var He=ie.context,mt=p.contextType;typeof mt=="object"&&mt!==null?mt=Nn(mt):(mt=Oi(p)?Xs:kn.current,mt=ua(o,mt));var Ot=p.getDerivedStateFromProps,jt=typeof Ot=="function"||typeof ie.getSnapshotBeforeUpdate=="function";jt||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Re!==w||He!==mt)&&Ih(o,ie,w,mt),_o=!1;var Ft=o.memoizedState;ie.state=Ft,vo(o,w,ie,P),He=o.memoizedState,Re!==w||Ft!==He||tn.current||_o?(typeof Ot=="function"&&(Th(o,p,Ot,w),He=o.memoizedState),(Re=_o||Ch(o,p,Re,w,Ft,He,mt))?(jt||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(o.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=w,o.memoizedState=He),ie.props=w,ie.state=He,ie.context=mt,w=Re):(typeof ie.componentDidMount=="function"&&(o.flags|=4194308),w=!1)}else{ie=o.stateNode,Ms(i,o),Re=o.memoizedProps,mt=o.type===o.elementType?Re:Uo(o.type,Re),ie.props=mt,jt=o.pendingProps,Ft=ie.context,He=p.contextType,typeof He=="object"&&He!==null?He=Nn(He):(He=Oi(p)?Xs:kn.current,He=ua(o,He));var er=p.getDerivedStateFromProps;(Ot=typeof er=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Re!==jt||Ft!==He)&&Ih(o,ie,w,He),_o=!1,Ft=o.memoizedState,ie.state=Ft,vo(o,w,ie,P);var mr=o.memoizedState;Re!==jt||Ft!==mr||tn.current||_o?(typeof er=="function"&&(Th(o,p,er,w),mr=o.memoizedState),(mt=_o||Ch(o,p,mt,w,Ft,mr,He)||!1)?(Ot||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(w,mr,He),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(w,mr,He)),typeof ie.componentDidUpdate=="function"&&(o.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof ie.componentDidUpdate!="function"||Re===i.memoizedProps&&Ft===i.memoizedState||(o.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Re===i.memoizedProps&&Ft===i.memoizedState||(o.flags|=1024),o.memoizedProps=w,o.memoizedState=mr),ie.props=w,ie.state=mr,ie.context=He,w=mt):(typeof ie.componentDidUpdate!="function"||Re===i.memoizedProps&&Ft===i.memoizedState||(o.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||Re===i.memoizedProps&&Ft===i.memoizedState||(o.flags|=1024),w=!1)}return Sd(i,o,p,w,L,P)}function Sd(i,o,p,w,P,L){df(i,o);var ie=(o.flags&128)!==0;if(!w&&!ie)return P&&Ml(o,p,!1),Eo(i,o,L);w=o.stateNode,lf.current=o;var Re=ie&&typeof p.getDerivedStateFromError!="function"?null:w.render();return o.flags|=1,i!==null&&ie?(o.child=Xt(o,i.child,null,L),o.child=Xt(o,null,Re,L)):Ci(i,o,Re,L),o.memoizedState=w.state,P&&Ml(o,p,!0),o.child}function Ah(i){var o=i.stateNode;o.pendingContext?Pl(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Pl(i,o.context,!1),Da(i,o.containerInfo)}function pf(i,o,p,w,P){return $t(),Qt(P),o.flags|=256,Ci(i,o,p,w),o.child}var Bl={dehydrated:null,treeContext:null,retryLane:0};function Ed(i){return{baseLanes:i,cachePool:null,transitions:null}}function ni(i,o,p){var w=o.pendingProps,P=qn.current,L=!1,ie=(o.flags&128)!==0,Re;if((Re=ie)||(Re=i!==null&&i.memoizedState===null?!1:(P&2)!==0),Re?(L=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(P|=1),Bn(qn,P&1),i===null)return Xe(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(ie=w.children,i=w.fallback,L?(w=o.mode,L=o.child,ie={mode:"hidden",children:ie},(w&1)===0&&L!==null?(L.childLanes=0,L.pendingProps=ie):L=ql(ie,w,0,null),i=Gl(i,w,p,null),L.return=o,i.return=o,L.sibling=i,o.child=L,o.child.memoizedState=Ed(p),o.memoizedState=Bl,i):Wu(o,ie));if(P=i.memoizedState,P!==null&&(Re=P.dehydrated,Re!==null))return Mh(i,o,ie,w,Re,P,p);if(L){L=w.fallback,ie=o.mode,P=i.child,Re=P.sibling;var He={mode:"hidden",children:w.children};return(ie&1)===0&&o.child!==P?(w=o.child,w.childLanes=0,w.pendingProps=He,o.deletions=null):(w=$l(P,He),w.subtreeFlags=P.subtreeFlags&14680064),Re!==null?L=$l(Re,L):(L=Gl(L,ie,p,null),L.flags|=2),L.return=o,w.return=o,w.sibling=L,o.child=w,w=L,L=o.child,ie=i.child.memoizedState,ie=ie===null?Ed(p):{baseLanes:ie.baseLanes|p,cachePool:null,transitions:ie.transitions},L.memoizedState=ie,L.childLanes=i.childLanes&~p,o.memoizedState=Bl,w}return L=i.child,i=L.sibling,w=$l(L,{mode:"visible",children:w.children}),(o.mode&1)===0&&(w.lanes=p),w.return=o,w.sibling=null,i!==null&&(p=o.deletions,p===null?(o.deletions=[i],o.flags|=16):p.push(i)),o.child=w,o.memoizedState=null,w}function Wu(i,o){return o=ql({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Mc(i,o,p,w){return w!==null&&Qt(w),Xt(o,i.child,null,p),i=Wu(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Mh(i,o,p,w,P,L,ie){if(p)return o.flags&256?(o.flags&=-257,w=Ph(Error(v(422))),Mc(i,o,ie,w)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(L=w.fallback,P=o.mode,w=ql({mode:"visible",children:w.children},P,0,null),L=Gl(L,P,ie,null),L.flags|=2,w.return=o,L.return=o,w.sibling=L,o.child=w,(o.mode&1)!==0&&Xt(o,i.child,null,ie),o.child.memoizedState=Ed(ie),o.memoizedState=Bl,L);if((o.mode&1)===0)return Mc(i,o,ie,null);if(P.data==="$!"){if(w=P.nextSibling&&P.nextSibling.dataset,w)var Re=w.dgst;return w=Re,L=Error(v(419)),w=Ph(L,w,void 0),Mc(i,o,ie,w)}if(Re=(ie&i.childLanes)!==0,Ds||Re){if(w=ji,w!==null){switch(ie&-ie){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(w.suspendedLanes|ie))!==0?0:P,P!==0&&P!==L.retryLane&&(L.retryLane=P,gs(i,P),fa(w,i,P,-1))}return zd(),w=Ph(Error(v(421))),Mc(i,o,ie,w)}return P.data==="$?"?(o.flags|=128,o.child=i.child,o=Af.bind(null,i),P._reactRetry=o,null):(i=L.treeContext,be=po(P.nextSibling),me=o,Ie=!0,ze=null,i!==null&&(m[S++]=A,m[S++]=F,m[S++]=k,A=i.id,F=i.overflow,k=o),o=Wu(o,w.children),o.flags|=4096,o)}function zc(i,o,p){i.lanes|=o;var w=i.alternate;w!==null&&(w.lanes|=o),In(i.return,o,p)}function wu(i,o,p,w,P){var L=i.memoizedState;L===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:P}:(L.isBackwards=o,L.rendering=null,L.renderingStartTime=0,L.last=w,L.tail=p,L.tailMode=P)}function Td(i,o,p){var w=o.pendingProps,P=w.revealOrder,L=w.tail;if(Ci(i,o,w.children,p),w=qn.current,(w&2)!==0)w=w&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&zc(i,p,o);else if(i.tag===19)zc(i,p,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}w&=1}if(Bn(qn,w),(o.mode&1)===0)o.memoizedState=null;else switch(P){case"forwards":for(p=o.child,P=null;p!==null;)i=p.alternate,i!==null&&wo(i)===null&&(P=p),p=p.sibling;p=P,p===null?(P=o.child,o.child=null):(P=p.sibling,p.sibling=null),wu(o,!1,P,p,L);break;case"backwards":for(p=null,P=o.child,o.child=null;P!==null;){if(i=P.alternate,i!==null&&wo(i)===null){o.child=P;break}i=P.sibling,P.sibling=p,p=P,P=i}wu(o,!0,p,null,L);break;case"together":wu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Rc(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Eo(i,o,p){if(i!==null&&(o.dependencies=i.dependencies),Su|=o.lanes,(p&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(v(153));if(o.child!==null){for(i=o.child,p=$l(i,i.pendingProps),o.child=p,p.return=o;i.sibling!==null;)i=i.sibling,p=p.sibling=$l(i,i.pendingProps),p.return=o;p.sibling=null}return o.child}function kd(i,o,p){switch(o.tag){case 3:Ah(o),$t();break;case 5:wc(o);break;case 1:Oi(o.type)&&Ps(o);break;case 4:Da(o,o.stateNode.containerInfo);break;case 10:var w=o.type._context,P=o.memoizedProps.value;Bn(Sn,w._currentValue),w._currentValue=P;break;case 13:if(w=o.memoizedState,w!==null)return w.dehydrated!==null?(Bn(qn,qn.current&1),o.flags|=128,null):(p&o.child.childLanes)!==0?ni(i,o,p):(Bn(qn,qn.current&1),i=Eo(i,o,p),i!==null?i.sibling:null);Bn(qn,qn.current&1);break;case 19:if(w=(p&o.childLanes)!==0,(i.flags&128)!==0){if(w)return Td(i,o,p);o.flags|=128}if(P=o.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Bn(qn,qn.current),w)break;return null;case 22:case 23:return o.lanes=0,hf(i,o,p)}return Eo(i,o,p)}var zh,Dc,Rh,Cd;zh=function(i,o){for(var p=o.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break;for(;p.sibling===null;){if(p.return===null||p.return===o)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Dc=function(){},Rh=function(i,o,p,w){var P=i.memoizedProps;if(P!==w){i=o.stateNode,Rs($n.current);var L=null;switch(p){case"input":P=W(i,P),w=W(i,w),L=[];break;case"select":P=ht({},P,{value:void 0}),w=ht({},w,{value:void 0}),L=[];break;case"textarea":P=nt(i,P),w=nt(i,w),L=[];break;default:typeof P.onClick!="function"&&typeof w.onClick=="function"&&(i.onclick=ms)}_n(p,w);var ie;p=null;for(mt in P)if(!w.hasOwnProperty(mt)&&P.hasOwnProperty(mt)&&P[mt]!=null)if(mt==="style"){var Re=P[mt];for(ie in Re)Re.hasOwnProperty(ie)&&(p||(p={}),p[ie]="")}else mt!=="dangerouslySetInnerHTML"&&mt!=="children"&&mt!=="suppressContentEditableWarning"&&mt!=="suppressHydrationWarning"&&mt!=="autoFocus"&&(I.hasOwnProperty(mt)?L||(L=[]):(L=L||[]).push(mt,null));for(mt in w){var He=w[mt];if(Re=P!=null?P[mt]:void 0,w.hasOwnProperty(mt)&&He!==Re&&(He!=null||Re!=null))if(mt==="style")if(Re){for(ie in Re)!Re.hasOwnProperty(ie)||He&&He.hasOwnProperty(ie)||(p||(p={}),p[ie]="");for(ie in He)He.hasOwnProperty(ie)&&Re[ie]!==He[ie]&&(p||(p={}),p[ie]=He[ie])}else p||(L||(L=[]),L.push(mt,p)),p=He;else mt==="dangerouslySetInnerHTML"?(He=He?He.__html:void 0,Re=Re?Re.__html:void 0,He!=null&&Re!==He&&(L=L||[]).push(mt,He)):mt==="children"?typeof He!="string"&&typeof He!="number"||(L=L||[]).push(mt,""+He):mt!=="suppressContentEditableWarning"&&mt!=="suppressHydrationWarning"&&(I.hasOwnProperty(mt)?(He!=null&&mt==="onScroll"&&Rn("scroll",i),L||Re===He||(L=[])):(L=L||[]).push(mt,He))}p&&(L=L||[]).push("style",p);var mt=L;(o.updateQueue=mt)&&(o.flags|=4)}},Cd=function(i,o,p,w){p!==w&&(o.flags|=4)};function Xu(i,o){if(!Ie)switch(i.tailMode){case"hidden":o=i.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?i.tail=null:p.sibling=null;break;case"collapsed":p=i.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:w.sibling=null}}function _s(i){var o=i.alternate!==null&&i.alternate.child===i.child,p=0,w=0;if(o)for(var P=i.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags&14680064,w|=P.flags&14680064,P.return=i,P=P.sibling;else for(P=i.child;P!==null;)p|=P.lanes|P.childLanes,w|=P.subtreeFlags,w|=P.flags,P.return=i,P=P.sibling;return i.subtreeFlags|=w,i.childLanes=p,o}function bp(i,o,p){var w=o.pendingProps;switch(de(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _s(o),null;case 1:return Oi(o.type)&&gu(),_s(o),null;case 3:return w=o.stateNode,xo(),Dn(tn),Dn(kn),Rl(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(i===null||i.child===null)&&(kt(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ze!==null&&(Md(ze),ze=null))),Dc(i,o),_s(o),null;case 5:bc(o);var P=Rs(Xr.current);if(p=o.type,i!==null&&o.stateNode!=null)Rh(i,o,p,w,P),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!w){if(o.stateNode===null)throw Error(v(166));return _s(o),null}if(i=Rs($n.current),kt(o)){w=o.stateNode,p=o.type;var L=o.memoizedProps;switch(w[ns]=o,w[Bo]=L,i=(o.mode&1)!==0,p){case"dialog":Rn("cancel",w),Rn("close",w);break;case"iframe":case"object":case"embed":Rn("load",w);break;case"video":case"audio":for(P=0;P<Aa.length;P++)Rn(Aa[P],w);break;case"source":Rn("error",w);break;case"img":case"image":case"link":Rn("error",w),Rn("load",w);break;case"details":Rn("toggle",w);break;case"input":ft(w,L),Rn("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!L.multiple},Rn("invalid",w);break;case"textarea":zt(w,L),Rn("invalid",w)}_n(p,L),P=null;for(var ie in L)if(L.hasOwnProperty(ie)){var Re=L[ie];ie==="children"?typeof Re=="string"?w.textContent!==Re&&(L.suppressHydrationWarning!==!0&&Cl(w.textContent,Re,i),P=["children",Re]):typeof Re=="number"&&w.textContent!==""+Re&&(L.suppressHydrationWarning!==!0&&Cl(w.textContent,Re,i),P=["children",""+Re]):I.hasOwnProperty(ie)&&Re!=null&&ie==="onScroll"&&Rn("scroll",w)}switch(p){case"input":Br(w),we(w,L,!0);break;case"textarea":Br(w),Lt(w);break;case"select":case"option":break;default:typeof L.onClick=="function"&&(w.onclick=ms)}w=P,o.updateQueue=w,w!==null&&(o.flags|=4)}else{ie=P.nodeType===9?P:P.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=_r(p)),i==="http://www.w3.org/1999/xhtml"?p==="script"?(i=ie.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof w.is=="string"?i=ie.createElement(p,{is:w.is}):(i=ie.createElement(p),p==="select"&&(ie=i,w.multiple?ie.multiple=!0:w.size&&(ie.size=w.size))):i=ie.createElementNS(i,p),i[ns]=o,i[Bo]=w,zh(i,o,!1,!1),o.stateNode=i;e:{switch(ie=ci(p,w),p){case"dialog":Rn("cancel",i),Rn("close",i),P=w;break;case"iframe":case"object":case"embed":Rn("load",i),P=w;break;case"video":case"audio":for(P=0;P<Aa.length;P++)Rn(Aa[P],i);P=w;break;case"source":Rn("error",i),P=w;break;case"img":case"image":case"link":Rn("error",i),Rn("load",i),P=w;break;case"details":Rn("toggle",i),P=w;break;case"input":ft(i,w),P=W(i,w),Rn("invalid",i);break;case"option":P=w;break;case"select":i._wrapperState={wasMultiple:!!w.multiple},P=ht({},w,{value:void 0}),Rn("invalid",i);break;case"textarea":zt(i,w),P=nt(i,w),Rn("invalid",i);break;default:P=w}_n(p,P),Re=P;for(L in Re)if(Re.hasOwnProperty(L)){var He=Re[L];L==="style"?zr(i,He):L==="dangerouslySetInnerHTML"?(He=He?He.__html:void 0,He!=null&&xn(i,He)):L==="children"?typeof He=="string"?(p!=="textarea"||He!=="")&&yn(i,He):typeof He=="number"&&yn(i,""+He):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(I.hasOwnProperty(L)?He!=null&&L==="onScroll"&&Rn("scroll",i):He!=null&&ge(i,L,He,ie))}switch(p){case"input":Br(i),we(i,w,!1);break;case"textarea":Br(i),Lt(i);break;case"option":w.value!=null&&i.setAttribute("value",""+qt(w.value));break;case"select":i.multiple=!!w.multiple,L=w.value,L!=null?Mt(i,!!w.multiple,L,!1):w.defaultValue!=null&&Mt(i,!!w.multiple,w.defaultValue,!0);break;default:typeof P.onClick=="function"&&(i.onclick=ms)}switch(p){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return _s(o),null;case 6:if(i&&o.stateNode!=null)Cd(i,o,i.memoizedProps,w);else{if(typeof w!="string"&&o.stateNode===null)throw Error(v(166));if(p=Rs(Xr.current),Rs($n.current),kt(o)){if(w=o.stateNode,p=o.memoizedProps,w[ns]=o,(L=w.nodeValue!==p)&&(i=me,i!==null))switch(i.tag){case 3:Cl(w.nodeValue,p,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Cl(w.nodeValue,p,(i.mode&1)!==0)}L&&(o.flags|=4)}else w=(p.nodeType===9?p:p.ownerDocument).createTextNode(w),w[ns]=o,o.stateNode=w}return _s(o),null;case 13:if(Dn(qn),w=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Ie&&be!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Bt(),$t(),o.flags|=98560,L=!1;else if(L=kt(o),w!==null&&w.dehydrated!==null){if(i===null){if(!L)throw Error(v(318));if(L=o.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(v(317));L[ns]=o}else $t(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;_s(o),L=!1}else ze!==null&&(Md(ze),ze=null),L=!0;if(!L)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=p,o):(w=w!==null,w!==(i!==null&&i.memoizedState!==null)&&w&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(qn.current&1)!==0?Ri===0&&(Ri=3):zd())),o.updateQueue!==null&&(o.flags|=4),_s(o),null);case 4:return xo(),Dc(i,o),i===null&&sa(o.stateNode.containerInfo),_s(o),null;case 10:return As(o.type._context),_s(o),null;case 17:return Oi(o.type)&&gu(),_s(o),null;case 19:if(Dn(qn),L=o.memoizedState,L===null)return _s(o),null;if(w=(o.flags&128)!==0,ie=L.rendering,ie===null)if(w)Xu(L,!1);else{if(Ri!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(ie=wo(i),ie!==null){for(o.flags|=128,Xu(L,!1),w=ie.updateQueue,w!==null&&(o.updateQueue=w,o.flags|=4),o.subtreeFlags=0,w=p,p=o.child;p!==null;)L=p,i=w,L.flags&=14680066,ie=L.alternate,ie===null?(L.childLanes=0,L.lanes=i,L.child=null,L.subtreeFlags=0,L.memoizedProps=null,L.memoizedState=null,L.updateQueue=null,L.dependencies=null,L.stateNode=null):(L.childLanes=ie.childLanes,L.lanes=ie.lanes,L.child=ie.child,L.subtreeFlags=0,L.deletions=null,L.memoizedProps=ie.memoizedProps,L.memoizedState=ie.memoizedState,L.updateQueue=ie.updateQueue,L.type=ie.type,i=ie.dependencies,L.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),p=p.sibling;return Bn(qn,qn.current&1|2),o.child}i=i.sibling}L.tail!==null&&Pr()>Zn&&(o.flags|=128,w=!0,Xu(L,!1),o.lanes=4194304)}else{if(!w)if(i=wo(ie),i!==null){if(o.flags|=128,w=!0,p=i.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),Xu(L,!0),L.tail===null&&L.tailMode==="hidden"&&!ie.alternate&&!Ie)return _s(o),null}else 2*Pr()-L.renderingStartTime>Zn&&p!==1073741824&&(o.flags|=128,w=!0,Xu(L,!1),o.lanes=4194304);L.isBackwards?(ie.sibling=o.child,o.child=ie):(p=L.last,p!==null?p.sibling=ie:o.child=ie,L.last=ie)}return L.tail!==null?(o=L.tail,L.rendering=o,L.tail=o.sibling,L.renderingStartTime=Pr(),o.sibling=null,p=qn.current,Bn(qn,w?p&1|2:p&1),o):(_s(o),null);case 22:case 23:return Hc(),w=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==w&&(o.flags|=8192),w&&(o.mode&1)!==0?(xs&1073741824)!==0&&(_s(o),o.subtreeFlags&6&&(o.flags|=8192)):_s(o),null;case 24:return null;case 25:return null}throw Error(v(156,o.tag))}function Sp(i,o){switch(de(o),o.tag){case 1:return Oi(o.type)&&gu(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return xo(),Dn(tn),Dn(kn),Rl(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return bc(o),null;case 13:if(Dn(qn),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(v(340));$t()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Dn(qn),null;case 4:return xo(),null;case 10:return As(o.type._context),null;case 22:case 23:return Hc(),null;case 24:return null;default:return null}}var Dh=!1,vs=!1,Nl=typeof WeakSet=="function"?WeakSet:Set,vr=null;function bu(i,o){var p=i.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(w){Qn(i,o,w)}else p.current=null}function jl(i,o,p){try{p()}catch(w){Qn(i,o,w)}}var mf=!1;function Ep(i,o){if(aa=Hi,i=Du(),Ia(i)){if("selectionStart"in i)var p={start:i.selectionStart,end:i.selectionEnd};else e:{p=(p=i.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var P=w.anchorOffset,L=w.focusNode;w=w.focusOffset;try{p.nodeType,L.nodeType}catch{p=null;break e}var ie=0,Re=-1,He=-1,mt=0,Ot=0,jt=i,Ft=null;t:for(;;){for(var er;jt!==p||P!==0&&jt.nodeType!==3||(Re=ie+P),jt!==L||w!==0&&jt.nodeType!==3||(He=ie+w),jt.nodeType===3&&(ie+=jt.nodeValue.length),(er=jt.firstChild)!==null;)Ft=jt,jt=er;for(;;){if(jt===i)break t;if(Ft===p&&++mt===P&&(Re=ie),Ft===L&&++Ot===w&&(He=ie),(er=jt.nextSibling)!==null)break;jt=Ft,Ft=jt.parentNode}jt=er}p=Re===-1||He===-1?null:{start:Re,end:He}}else p=null}p=p||{start:0,end:0}}else p=null;for(yc={focusedElem:i,selectionRange:p},Hi=!1,vr=o;vr!==null;)if(o=vr,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,vr=i;else for(;vr!==null;){o=vr;try{var mr=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(mr!==null){var br=mr.memoizedProps,vi=mr.memoizedState,lt=o.stateNode,We=lt.getSnapshotBeforeUpdate(o.elementType===o.type?br:Uo(o.type,br),vi);lt.__reactInternalSnapshotBeforeUpdate=We}break;case 3:var dt=o.stateNode.containerInfo;dt.nodeType===1?dt.textContent="":dt.nodeType===9&&dt.documentElement&&dt.removeChild(dt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(v(163))}}catch(Wt){Qn(o,o.return,Wt)}if(i=o.sibling,i!==null){i.return=o.return,vr=i;break}vr=o.return}return mr=mf,mf=!1,mr}function Lc(i,o,p){var w=o.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var P=w=w.next;do{if((P.tag&i)===i){var L=P.destroy;P.destroy=void 0,L!==void 0&&jl(o,p,L)}P=P.next}while(P!==w)}}function Fc(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var p=o=o.next;do{if((p.tag&i)===i){var w=p.create;p.destroy=w()}p=p.next}while(p!==o)}}function Lh(i){var o=i.ref;if(o!==null){var p=i.stateNode;switch(i.tag){case 5:i=p;break;default:i=p}typeof o=="function"?o(i):o.current=i}}function gf(i){var o=i.alternate;o!==null&&(i.alternate=null,gf(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[ns],delete o[Bo],delete o[Qr],delete o[vc],delete o[cd])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function yf(i){return i.tag===5||i.tag===3||i.tag===4}function _f(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||yf(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Id(i,o,p){var w=i.tag;if(w===5||w===6)i=i.stateNode,o?p.nodeType===8?p.parentNode.insertBefore(i,o):p.insertBefore(i,o):(p.nodeType===8?(o=p.parentNode,o.insertBefore(i,p)):(o=p,o.appendChild(i)),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=ms));else if(w!==4&&(i=i.child,i!==null))for(Id(i,o,p),i=i.sibling;i!==null;)Id(i,o,p),i=i.sibling}function Oc(i,o,p){var w=i.tag;if(w===5||w===6)i=i.stateNode,o?p.insertBefore(i,o):p.appendChild(i);else if(w!==4&&(i=i.child,i!==null))for(Oc(i,o,p),i=i.sibling;i!==null;)Oc(i,o,p),i=i.sibling}var Ii=null,To=!1;function Ul(i,o,p){for(p=p.child;p!==null;)vf(i,o,p),p=p.sibling}function vf(i,o,p){if(fi&&typeof fi.onCommitFiberUnmount=="function")try{fi.onCommitFiberUnmount(Hn,p)}catch{}switch(p.tag){case 5:vs||bu(p,o);case 6:var w=Ii,P=To;Ii=null,Ul(i,o,p),Ii=w,To=P,Ii!==null&&(To?(i=Ii,p=p.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)):Ii.removeChild(p.stateNode));break;case 18:Ii!==null&&(To?(i=Ii,p=p.stateNode,i.nodeType===8?sr(i.parentNode,p):i.nodeType===1&&sr(i,p),cs(i)):sr(Ii,p.stateNode));break;case 4:w=Ii,P=To,Ii=p.stateNode.containerInfo,To=!0,Ul(i,o,p),Ii=w,To=P;break;case 0:case 11:case 14:case 15:if(!vs&&(w=p.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){P=w=w.next;do{var L=P,ie=L.destroy;L=L.tag,ie!==void 0&&((L&2)!==0||(L&4)!==0)&&jl(p,o,ie),P=P.next}while(P!==w)}Ul(i,o,p);break;case 1:if(!vs&&(bu(p,o),w=p.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=p.memoizedProps,w.state=p.memoizedState,w.componentWillUnmount()}catch(Re){Qn(p,o,Re)}Ul(i,o,p);break;case 21:Ul(i,o,p);break;case 22:p.mode&1?(vs=(w=vs)||p.memoizedState!==null,Ul(i,o,p),vs=w):Ul(i,o,p);break;default:Ul(i,o,p)}}function Pd(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var p=i.stateNode;p===null&&(p=i.stateNode=new Nl),o.forEach(function(w){var P=Mf.bind(null,i,w);p.has(w)||(p.add(w),w.then(P,P))})}}function da(i,o){var p=o.deletions;if(p!==null)for(var w=0;w<p.length;w++){var P=p[w];try{var L=i,ie=o,Re=ie;e:for(;Re!==null;){switch(Re.tag){case 5:Ii=Re.stateNode,To=!1;break e;case 3:Ii=Re.stateNode.containerInfo,To=!0;break e;case 4:Ii=Re.stateNode.containerInfo,To=!0;break e}Re=Re.return}if(Ii===null)throw Error(v(160));vf(L,ie,P),Ii=null,To=!1;var He=P.alternate;He!==null&&(He.return=null),P.return=null}catch(mt){Qn(P,o,mt)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)xf(o,i),o=o.sibling}function xf(i,o){var p=i.alternate,w=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(da(o,i),Js(i),w&4){try{Lc(3,i,i.return),Fc(3,i)}catch(br){Qn(i,i.return,br)}try{Lc(5,i,i.return)}catch(br){Qn(i,i.return,br)}}break;case 1:da(o,i),Js(i),w&512&&p!==null&&bu(p,p.return);break;case 5:if(da(o,i),Js(i),w&512&&p!==null&&bu(p,p.return),i.flags&32){var P=i.stateNode;try{yn(P,"")}catch(br){Qn(i,i.return,br)}}if(w&4&&(P=i.stateNode,P!=null)){var L=i.memoizedProps,ie=p!==null?p.memoizedProps:L,Re=i.type,He=i.updateQueue;if(i.updateQueue=null,He!==null)try{Re==="input"&&L.type==="radio"&&L.name!=null&&ye(P,L),ci(Re,ie);var mt=ci(Re,L);for(ie=0;ie<He.length;ie+=2){var Ot=He[ie],jt=He[ie+1];Ot==="style"?zr(P,jt):Ot==="dangerouslySetInnerHTML"?xn(P,jt):Ot==="children"?yn(P,jt):ge(P,Ot,jt,mt)}switch(Re){case"input":Me(P,L);break;case"textarea":rr(P,L);break;case"select":var Ft=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!L.multiple;var er=L.value;er!=null?Mt(P,!!L.multiple,er,!1):Ft!==!!L.multiple&&(L.defaultValue!=null?Mt(P,!!L.multiple,L.defaultValue,!0):Mt(P,!!L.multiple,L.multiple?[]:"",!1))}P[Bo]=L}catch(br){Qn(i,i.return,br)}}break;case 6:if(da(o,i),Js(i),w&4){if(i.stateNode===null)throw Error(v(162));P=i.stateNode,L=i.memoizedProps;try{P.nodeValue=L}catch(br){Qn(i,i.return,br)}}break;case 3:if(da(o,i),Js(i),w&4&&p!==null&&p.memoizedState.isDehydrated)try{cs(o.containerInfo)}catch(br){Qn(i,i.return,br)}break;case 4:da(o,i),Js(i);break;case 13:da(o,i),Js(i),P=i.child,P.flags&8192&&(L=P.memoizedState!==null,P.stateNode.isHidden=L,!L||P.alternate!==null&&P.alternate.memoizedState!==null||(Eu=Pr())),w&4&&Pd(i);break;case 22:if(Ot=p!==null&&p.memoizedState!==null,i.mode&1?(vs=(mt=vs)||Ot,da(o,i),vs=mt):da(o,i),Js(i),w&8192){if(mt=i.memoizedState!==null,(i.stateNode.isHidden=mt)&&!Ot&&(i.mode&1)!==0)for(vr=i,Ot=i.child;Ot!==null;){for(jt=vr=Ot;vr!==null;){switch(Ft=vr,er=Ft.child,Ft.tag){case 0:case 11:case 14:case 15:Lc(4,Ft,Ft.return);break;case 1:bu(Ft,Ft.return);var mr=Ft.stateNode;if(typeof mr.componentWillUnmount=="function"){w=Ft,p=Ft.return;try{o=w,mr.props=o.memoizedProps,mr.state=o.memoizedState,mr.componentWillUnmount()}catch(br){Qn(w,p,br)}}break;case 5:bu(Ft,Ft.return);break;case 22:if(Ft.memoizedState!==null){Ef(jt);continue}}er!==null?(er.return=Ft,vr=er):Ef(jt)}Ot=Ot.sibling}e:for(Ot=null,jt=i;;){if(jt.tag===5){if(Ot===null){Ot=jt;try{P=jt.stateNode,mt?(L=P.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none"):(Re=jt.stateNode,He=jt.memoizedProps.style,ie=He!=null&&He.hasOwnProperty("display")?He.display:null,Re.style.display=Pt("display",ie))}catch(br){Qn(i,i.return,br)}}}else if(jt.tag===6){if(Ot===null)try{jt.stateNode.nodeValue=mt?"":jt.memoizedProps}catch(br){Qn(i,i.return,br)}}else if((jt.tag!==22&&jt.tag!==23||jt.memoizedState===null||jt===i)&&jt.child!==null){jt.child.return=jt,jt=jt.child;continue}if(jt===i)break e;for(;jt.sibling===null;){if(jt.return===null||jt.return===i)break e;Ot===jt&&(Ot=null),jt=jt.return}Ot===jt&&(Ot=null),jt.sibling.return=jt.return,jt=jt.sibling}}break;case 19:da(o,i),Js(i),w&4&&Pd(i);break;case 21:break;default:da(o,i),Js(i)}}function Js(i){var o=i.flags;if(o&2){try{e:{for(var p=i.return;p!==null;){if(yf(p)){var w=p;break e}p=p.return}throw Error(v(160))}switch(w.tag){case 5:var P=w.stateNode;w.flags&32&&(yn(P,""),w.flags&=-33);var L=_f(i);Oc(i,L,P);break;case 3:case 4:var ie=w.stateNode.containerInfo,Re=_f(i);Id(i,Re,ie);break;default:throw Error(v(161))}}catch(He){Qn(i,i.return,He)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function wf(i,o,p){vr=i,bf(i)}function bf(i,o,p){for(var w=(i.mode&1)!==0;vr!==null;){var P=vr,L=P.child;if(P.tag===22&&w){var ie=P.memoizedState!==null||Dh;if(!ie){var Re=P.alternate,He=Re!==null&&Re.memoizedState!==null||vs;Re=Dh;var mt=vs;if(Dh=ie,(vs=He)&&!mt)for(vr=P;vr!==null;)ie=vr,He=ie.child,ie.tag===22&&ie.memoizedState!==null?Tf(P):He!==null?(He.return=ie,vr=He):Tf(P);for(;L!==null;)vr=L,bf(L),L=L.sibling;vr=P,Dh=Re,vs=mt}Sf(i)}else(P.subtreeFlags&8772)!==0&&L!==null?(L.return=P,vr=L):Sf(i)}}function Sf(i){for(;vr!==null;){var o=vr;if((o.flags&8772)!==0){var p=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:vs||Fc(5,o);break;case 1:var w=o.stateNode;if(o.flags&4&&!vs)if(p===null)w.componentDidMount();else{var P=o.elementType===o.type?p.memoizedProps:Uo(o.type,p.memoizedProps);w.componentDidUpdate(P,p.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var L=o.updateQueue;L!==null&&Ys(o,L,w);break;case 3:var ie=o.updateQueue;if(ie!==null){if(p=null,o.child!==null)switch(o.child.tag){case 5:p=o.child.stateNode;break;case 1:p=o.child.stateNode}Ys(o,ie,p)}break;case 5:var Re=o.stateNode;if(p===null&&o.flags&4){p=Re;var He=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":He.autoFocus&&p.focus();break;case"img":He.src&&(p.src=He.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var mt=o.alternate;if(mt!==null){var Ot=mt.memoizedState;if(Ot!==null){var jt=Ot.dehydrated;jt!==null&&cs(jt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(v(163))}vs||o.flags&512&&Lh(o)}catch(Ft){Qn(o,o.return,Ft)}}if(o===i){vr=null;break}if(p=o.sibling,p!==null){p.return=o.return,vr=p;break}vr=o.return}}function Ef(i){for(;vr!==null;){var o=vr;if(o===i){vr=null;break}var p=o.sibling;if(p!==null){p.return=o.return,vr=p;break}vr=o.return}}function Tf(i){for(;vr!==null;){var o=vr;try{switch(o.tag){case 0:case 11:case 15:var p=o.return;try{Fc(4,o)}catch(He){Qn(o,p,He)}break;case 1:var w=o.stateNode;if(typeof w.componentDidMount=="function"){var P=o.return;try{w.componentDidMount()}catch(He){Qn(o,P,He)}}var L=o.return;try{Lh(o)}catch(He){Qn(o,L,He)}break;case 5:var ie=o.return;try{Lh(o)}catch(He){Qn(o,ie,He)}}}catch(He){Qn(o,o.return,He)}if(o===i){vr=null;break}var Re=o.sibling;if(Re!==null){Re.return=o.return,vr=Re;break}vr=o.return}}var Tp=Math.ceil,Fh=Fe.ReactCurrentDispatcher,Oh=Fe.ReactCurrentOwner,Qs=Fe.ReactCurrentBatchConfig,hn=0,ji=null,Pi=null,os=0,xs=0,Ku=Ma(0),Ri=0,Bc=null,Su=0,Bh=0,Nh=0,Nc=null,eo=null,Eu=0,Zn=1/0,Fa=null,jc=!1,jh=null,an=null,Yu=!1,ol=null,Uc=0,ko=0,Vl=null,Vc=-1,Uh=0;function Ls(){return(hn&6)!==0?Pr():Vc!==-1?Vc:Vc=Pr()}function Hl(i){return(i.mode&1)===0?1:(hn&2)!==0&&os!==0?os&-os:Gt.transition!==null?(Uh===0&&(Uh=Ee()),Uh):(i=Jt,i!==0||(i=window.event,i=i===void 0?16:co(i.type)),i)}function fa(i,o,p,w){if(50<ko)throw ko=0,Vl=null,Error(v(185));st(i,p,w),((hn&2)===0||i!==ji)&&(i===ji&&((hn&2)===0&&(Bh|=p),Ri===4&&pa(i,os)),to(i,w),p===1&&hn===0&&(o.mode&1)===0&&(Zn=Pr()+500,Sr&&g()))}function to(i,o){var p=i.callbackNode;Y(i,o);var w=pi(i,i===ji?os:0);if(w===0)p!==null&&Kn(p),i.callbackNode=null,i.callbackPriority=0;else if(o=w&-w,i.callbackPriority!==o){if(p!=null&&Kn(p),o===1)i.tag===0?xc(Tu.bind(null,i)):yu(Tu.bind(null,i)),Il(function(){(hn&6)===0&&g()}),p=null;else{switch(Rr(w)){case 1:p=zo;break;case 4:p=di;break;case 16:p=ei;break;case 536870912:p=ti;break;default:p=ei}p=Ld(p,kf.bind(null,i))}i.callbackPriority=o,i.callbackNode=p}}function kf(i,o){if(Vc=-1,Uh=0,(hn&6)!==0)throw Error(v(327));var p=i.callbackNode;if(ga()&&i.callbackNode!==p)return null;var w=pi(i,i===ji?os:0);if(w===0)return null;if((w&30)!==0||(w&i.expiredLanes)!==0||o)o=$c(i,w);else{o=w;var P=hn;hn|=2;var L=If();(ji!==i||os!==o)&&(Fa=null,Zn=Pr()+500,ku(i,o));do try{Rd();break}catch(Re){Cf(i,Re)}while(!0);Mi(),Fh.current=L,hn=P,Pi!==null?o=0:(ji=null,os=0,o=Ri)}if(o!==0){if(o===2&&(P=he(i),P!==0&&(w=P,o=Ad(i,P))),o===1)throw p=Bc,ku(i,0),pa(i,w),to(i,Pr()),p;if(o===6)pa(i,w);else{if(P=i.current.alternate,(w&30)===0&&!kp(P)&&(o=$c(i,w),o===2&&(L=he(i),L!==0&&(w=L,o=Ad(i,L))),o===1))throw p=Bc,ku(i,0),pa(i,w),to(i,Pr()),p;switch(i.finishedWork=P,i.finishedLanes=w,o){case 0:case 1:throw Error(v(345));case 2:ma(i,eo,Fa);break;case 3:if(pa(i,w),(w&130023424)===w&&(o=Eu+500-Pr(),10<o)){if(pi(i,0)!==0)break;if(P=i.suspendedLanes,(P&w)!==w){Ls(),i.pingedLanes|=i.suspendedLanes&P;break}i.timeoutHandle=Nu(ma.bind(null,i,eo,Fa),o);break}ma(i,eo,Fa);break;case 4:if(pa(i,w),(w&4194240)===w)break;for(o=i.eventTimes,P=-1;0<w;){var ie=31-nn(w);L=1<<ie,ie=o[ie],ie>P&&(P=ie),w&=~L}if(w=P,w=Pr()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*Tp(w/1960))-w,10<w){i.timeoutHandle=Nu(ma.bind(null,i,eo,Fa),w);break}ma(i,eo,Fa);break;case 5:ma(i,eo,Fa);break;default:throw Error(v(329))}}}return to(i,Pr()),i.callbackNode===p?kf.bind(null,i):null}function Ad(i,o){var p=Nc;return i.current.memoizedState.isDehydrated&&(ku(i,o).flags|=256),i=$c(i,o),i!==2&&(o=eo,eo=p,o!==null&&Md(o)),i}function Md(i){eo===null?eo=i:eo.push.apply(eo,i)}function kp(i){for(var o=i;;){if(o.flags&16384){var p=o.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var w=0;w<p.length;w++){var P=p[w],L=P.getSnapshot;P=P.value;try{if(!fs(L(),P))return!1}catch{return!1}}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function pa(i,o){for(o&=~Nh,o&=~Bh,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var p=31-nn(o),w=1<<p;i[p]=-1,o&=~w}}function Tu(i){if((hn&6)!==0)throw Error(v(327));ga();var o=pi(i,0);if((o&1)===0)return to(i,Pr()),null;var p=$c(i,o);if(i.tag!==0&&p===2){var w=he(i);w!==0&&(o=w,p=Ad(i,w))}if(p===1)throw p=Bc,ku(i,0),pa(i,o),to(i,Pr()),p;if(p===6)throw Error(v(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,ma(i,eo,Fa),to(i,Pr()),null}function Vh(i,o){var p=hn;hn|=1;try{return i(o)}finally{hn=p,hn===0&&(Zn=Pr()+500,Sr&&g())}}function al(i){ol!==null&&ol.tag===0&&(hn&6)===0&&ga();var o=hn;hn|=1;var p=Qs.transition,w=Jt;try{if(Qs.transition=null,Jt=1,i)return i()}finally{Jt=w,Qs.transition=p,hn=o,(hn&6)===0&&g()}}function Hc(){xs=Ku.current,Dn(Ku)}function ku(i,o){i.finishedWork=null,i.finishedLanes=0;var p=i.timeoutHandle;if(p!==-1&&(i.timeoutHandle=-1,yh(p)),Pi!==null)for(p=Pi.return;p!==null;){var w=p;switch(de(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&gu();break;case 3:xo(),Dn(tn),Dn(kn),Rl();break;case 5:bc(w);break;case 4:xo();break;case 13:Dn(qn);break;case 19:Dn(qn);break;case 10:As(w.type._context);break;case 22:case 23:Hc()}p=p.return}if(ji=i,Pi=i=$l(i.current,null),os=xs=o,Ri=0,Bc=null,Nh=Bh=Su=0,eo=Nc=null,ri!==null){for(o=0;o<ri.length;o++)if(p=ri[o],w=p.interleaved,w!==null){p.interleaved=null;var P=w.next,L=p.pending;if(L!==null){var ie=L.next;L.next=P,w.next=ie}p.pending=w}ri=null}return i}function Cf(i,o){do{var p=Pi;try{if(Mi(),La.current=Sh,Sc){for(var w=Pn.memoizedState;w!==null;){var P=w.queue;P!==null&&(P.pending=null),w=w.next}Sc=!1}if(jo=0,ki=Jn=Pn=null,Hu=!1,Ec=0,Oh.current=null,p===null||p.return===null){Ri=1,Bc=o,Pi=null;break}e:{var L=i,ie=p.return,Re=p,He=o;if(o=os,Re.flags|=32768,He!==null&&typeof He=="object"&&typeof He.then=="function"){var mt=He,Ot=Re,jt=Ot.tag;if((Ot.mode&1)===0&&(jt===0||jt===11||jt===15)){var Ft=Ot.alternate;Ft?(Ot.updateQueue=Ft.updateQueue,Ot.memoizedState=Ft.memoizedState,Ot.lanes=Ft.lanes):(Ot.updateQueue=null,Ot.memoizedState=null)}var er=of(ie);if(er!==null){er.flags&=-257,af(er,ie,Re,L,o),er.mode&1&&sf(L,mt,o),o=er,He=mt;var mr=o.updateQueue;if(mr===null){var br=new Set;br.add(He),o.updateQueue=br}else mr.add(He);break e}else{if((o&1)===0){sf(L,mt,o),zd();break e}He=Error(v(426))}}else if(Ie&&Re.mode&1){var vi=of(ie);if(vi!==null){(vi.flags&65536)===0&&(vi.flags|=256),af(vi,ie,Re,L,o),Qt(Zi(He,Re));break e}}L=He=Zi(He,Re),Ri!==4&&(Ri=2),Nc===null?Nc=[L]:Nc.push(L),L=ie;do{switch(L.tag){case 3:L.flags|=65536,o&=-o,L.lanes|=o;var lt=wd(L,He,o);zs(L,lt);break e;case 1:Re=He;var We=L.type,dt=L.stateNode;if((L.flags&128)===0&&(typeof We.getDerivedStateFromError=="function"||dt!==null&&typeof dt.componentDidCatch=="function"&&(an===null||!an.has(dt)))){L.flags|=65536,o&=-o,L.lanes|=o;var Wt=nf(L,Re,o);zs(L,Wt);break e}}L=L.return}while(L!==null)}ll(p)}catch(Er){o=Er,Pi===p&&p!==null&&(Pi=p=p.return);continue}break}while(!0)}function If(){var i=Fh.current;return Fh.current=Sh,i===null?Sh:i}function zd(){(Ri===0||Ri===3||Ri===2)&&(Ri=4),ji===null||(Su&268435455)===0&&(Bh&268435455)===0||pa(ji,os)}function $c(i,o){var p=hn;hn|=2;var w=If();(ji!==i||os!==o)&&(Fa=null,ku(i,o));do try{Fs();break}catch(P){Cf(i,P)}while(!0);if(Mi(),hn=p,Fh.current=w,Pi!==null)throw Error(v(261));return ji=null,os=0,Ri}function Fs(){for(;Pi!==null;)Dd(Pi)}function Rd(){for(;Pi!==null&&!hi();)Dd(Pi)}function Dd(i){var o=zf(i.alternate,i,xs);i.memoizedProps=i.pendingProps,o===null?ll(i):Pi=o,Oh.current=null}function ll(i){var o=i;do{var p=o.alternate;if(i=o.return,(o.flags&32768)===0){if(p=bp(p,o,xs),p!==null){Pi=p;return}}else{if(p=Sp(p,o),p!==null){p.flags&=32767,Pi=p;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ri=6,Pi=null;return}}if(o=o.sibling,o!==null){Pi=o;return}Pi=o=i}while(o!==null);Ri===0&&(Ri=5)}function ma(i,o,p){var w=Jt,P=Qs.transition;try{Qs.transition=null,Jt=1,Gc(i,o,p,w)}finally{Qs.transition=P,Jt=w}return null}function Gc(i,o,p,w){do ga();while(ol!==null);if((hn&6)!==0)throw Error(v(327));p=i.finishedWork;var P=i.finishedLanes;if(p===null)return null;if(i.finishedWork=null,i.finishedLanes=0,p===i.current)throw Error(v(177));i.callbackNode=null,i.callbackPriority=0;var L=p.lanes|p.childLanes;if(Et(i,L),i===ji&&(Pi=ji=null,os=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Yu||(Yu=!0,Ld(ei,function(){return ga(),null})),L=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||L){L=Qs.transition,Qs.transition=null;var ie=Jt;Jt=1;var Re=hn;hn|=4,Oh.current=null,Ep(i,p),xf(p,i),au(yc),Hi=!!aa,yc=aa=null,i.current=p,wf(p),ao(),hn=Re,Jt=ie,Qs.transition=L}else i.current=p;if(Yu&&(Yu=!1,ol=i,Uc=P),L=i.pendingLanes,L===0&&(an=null),Qi(p.stateNode),to(i,Pr()),o!==null)for(w=i.onRecoverableError,p=0;p<o.length;p++)P=o[p],w(P.value,{componentStack:P.stack,digest:P.digest});if(jc)throw jc=!1,i=jh,jh=null,i;return(Uc&1)!==0&&i.tag!==0&&ga(),L=i.pendingLanes,(L&1)!==0?i===Vl?ko++:(ko=0,Vl=i):ko=0,g(),null}function ga(){if(ol!==null){var i=Rr(Uc),o=Qs.transition,p=Jt;try{if(Qs.transition=null,Jt=16>i?16:i,ol===null)var w=!1;else{if(i=ol,ol=null,Uc=0,(hn&6)!==0)throw Error(v(331));var P=hn;for(hn|=4,vr=i.current;vr!==null;){var L=vr,ie=L.child;if((vr.flags&16)!==0){var Re=L.deletions;if(Re!==null){for(var He=0;He<Re.length;He++){var mt=Re[He];for(vr=mt;vr!==null;){var Ot=vr;switch(Ot.tag){case 0:case 11:case 15:Lc(8,Ot,L)}var jt=Ot.child;if(jt!==null)jt.return=Ot,vr=jt;else for(;vr!==null;){Ot=vr;var Ft=Ot.sibling,er=Ot.return;if(gf(Ot),Ot===mt){vr=null;break}if(Ft!==null){Ft.return=er,vr=Ft;break}vr=er}}}var mr=L.alternate;if(mr!==null){var br=mr.child;if(br!==null){mr.child=null;do{var vi=br.sibling;br.sibling=null,br=vi}while(br!==null)}}vr=L}}if((L.subtreeFlags&2064)!==0&&ie!==null)ie.return=L,vr=ie;else e:for(;vr!==null;){if(L=vr,(L.flags&2048)!==0)switch(L.tag){case 0:case 11:case 15:Lc(9,L,L.return)}var lt=L.sibling;if(lt!==null){lt.return=L.return,vr=lt;break e}vr=L.return}}var We=i.current;for(vr=We;vr!==null;){ie=vr;var dt=ie.child;if((ie.subtreeFlags&2064)!==0&&dt!==null)dt.return=ie,vr=dt;else e:for(ie=We;vr!==null;){if(Re=vr,(Re.flags&2048)!==0)try{switch(Re.tag){case 0:case 11:case 15:Fc(9,Re)}}catch(Er){Qn(Re,Re.return,Er)}if(Re===ie){vr=null;break e}var Wt=Re.sibling;if(Wt!==null){Wt.return=Re.return,vr=Wt;break e}vr=Re.return}}if(hn=P,g(),fi&&typeof fi.onPostCommitFiberRoot=="function")try{fi.onPostCommitFiberRoot(Hn,i)}catch{}w=!0}return w}finally{Jt=p,Qs.transition=o}}return!1}function qc(i,o,p){o=Zi(p,o),o=wd(i,o,1),i=No(i,o,1),o=Ls(),i!==null&&(st(i,1,o),to(i,o))}function Qn(i,o,p){if(i.tag===3)qc(i,i,p);else for(;o!==null;){if(o.tag===3){qc(o,i,p);break}else if(o.tag===1){var w=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(an===null||!an.has(w))){i=Zi(p,i),i=nf(o,i,1),o=No(o,i,1),i=Ls(),o!==null&&(st(o,1,i),to(o,i));break}}o=o.return}}function Cp(i,o,p){var w=i.pingCache;w!==null&&w.delete(o),o=Ls(),i.pingedLanes|=i.suspendedLanes&p,ji===i&&(os&p)===p&&(Ri===4||Ri===3&&(os&130023424)===os&&500>Pr()-Eu?ku(i,0):Nh|=p),to(i,o)}function Pf(i,o){o===0&&((i.mode&1)===0?o=1:(o=Si,Si<<=1,(Si&130023424)===0&&(Si=4194304)));var p=Ls();i=gs(i,o),i!==null&&(st(i,o,p),to(i,p))}function Af(i){var o=i.memoizedState,p=0;o!==null&&(p=o.retryLane),Pf(i,p)}function Mf(i,o){var p=0;switch(i.tag){case 13:var w=i.stateNode,P=i.memoizedState;P!==null&&(p=P.retryLane);break;case 19:w=i.stateNode;break;default:throw Error(v(314))}w!==null&&w.delete(o),Pf(i,p)}var zf;zf=function(i,o,p){if(i!==null)if(i.memoizedProps!==o.pendingProps||tn.current)Ds=!0;else{if((i.lanes&p)===0&&(o.flags&128)===0)return Ds=!1,kd(i,o,p);Ds=(i.flags&131072)!==0}else Ds=!1,Ie&&(o.flags&1048576)!==0&&$(o,h,o.index);switch(o.lanes=0,o.tag){case 2:var w=o.type;Rc(i,o),i=o.pendingProps;var P=ua(o,kn.current);Ti(o,p),P=ca(null,o,w,i,P,p);var L=bo();return o.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Oi(w)?(L=!0,Ps(o)):L=!1,o.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,Ra(o),P.updater=kh,o.stateNode=P,P._reactInternals=o,xu(o,w,i,p),o=Sd(null,o,w,!0,L,p)):(o.tag=0,Ie&&L&&ne(o),Ci(null,o,P,p),o=o.child),o;case 16:w=o.elementType;e:{switch(Rc(i,o),i=o.pendingProps,P=w._init,w=P(w._payload),o.type=w,P=o.tag=Ip(w),i=Uo(w,i),P){case 0:o=bd(null,o,w,i,p);break e;case 1:o=ff(null,o,w,i,p);break e;case 11:o=Zu(null,o,w,i,p);break e;case 14:o=uf(null,o,w,Uo(w.type,i),p);break e}throw Error(v(306,w,""))}return o;case 0:return w=o.type,P=o.pendingProps,P=o.elementType===w?P:Uo(w,P),bd(i,o,w,P,p);case 1:return w=o.type,P=o.pendingProps,P=o.elementType===w?P:Uo(w,P),ff(i,o,w,P,p);case 3:e:{if(Ah(o),i===null)throw Error(v(387));w=o.pendingProps,L=o.memoizedState,P=L.element,Ms(i,o),vo(o,w,null,p);var ie=o.memoizedState;if(w=ie.element,L.isDehydrated)if(L={element:w,isDehydrated:!1,cache:ie.cache,pendingSuspenseBoundaries:ie.pendingSuspenseBoundaries,transitions:ie.transitions},o.updateQueue.baseState=L,o.memoizedState=L,o.flags&256){P=Zi(Error(v(423)),o),o=pf(i,o,w,p,P);break e}else if(w!==P){P=Zi(Error(v(424)),o),o=pf(i,o,w,p,P);break e}else for(be=po(o.stateNode.containerInfo.firstChild),me=o,Ie=!0,ze=null,p=Lr(o,null,w,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if($t(),w===P){o=Eo(i,o,p);break e}Ci(i,o,w,p)}o=o.child}return o;case 5:return wc(o),i===null&&Xe(o),w=o.type,P=o.pendingProps,L=i!==null?i.memoizedProps:null,ie=P.children,_c(w,P)?ie=null:L!==null&&_c(w,L)&&(o.flags|=32),df(i,o),Ci(i,o,ie,p),o.child;case 6:return i===null&&Xe(o),null;case 13:return ni(i,o,p);case 4:return Da(o,o.stateNode.containerInfo),w=o.pendingProps,i===null?o.child=Xt(o,null,w,p):Ci(i,o,w,p),o.child;case 11:return w=o.type,P=o.pendingProps,P=o.elementType===w?P:Uo(w,P),Zu(i,o,w,P,p);case 7:return Ci(i,o,o.pendingProps,p),o.child;case 8:return Ci(i,o,o.pendingProps.children,p),o.child;case 12:return Ci(i,o,o.pendingProps.children,p),o.child;case 10:e:{if(w=o.type._context,P=o.pendingProps,L=o.memoizedProps,ie=P.value,Bn(Sn,w._currentValue),w._currentValue=ie,L!==null)if(fs(L.value,ie)){if(L.children===P.children&&!tn.current){o=Eo(i,o,p);break e}}else for(L=o.child,L!==null&&(L.return=o);L!==null;){var Re=L.dependencies;if(Re!==null){ie=L.child;for(var He=Re.firstContext;He!==null;){if(He.context===w){if(L.tag===1){He=Ks(-1,p&-p),He.tag=2;var mt=L.updateQueue;if(mt!==null){mt=mt.shared;var Ot=mt.pending;Ot===null?He.next=He:(He.next=Ot.next,Ot.next=He),mt.pending=He}}L.lanes|=p,He=L.alternate,He!==null&&(He.lanes|=p),In(L.return,p,o),Re.lanes|=p;break}He=He.next}}else if(L.tag===10)ie=L.type===o.type?null:L.child;else if(L.tag===18){if(ie=L.return,ie===null)throw Error(v(341));ie.lanes|=p,Re=ie.alternate,Re!==null&&(Re.lanes|=p),In(ie,p,o),ie=L.sibling}else ie=L.child;if(ie!==null)ie.return=L;else for(ie=L;ie!==null;){if(ie===o){ie=null;break}if(L=ie.sibling,L!==null){L.return=ie.return,ie=L;break}ie=ie.return}L=ie}Ci(i,o,P.children,p),o=o.child}return o;case 9:return P=o.type,w=o.pendingProps.children,Ti(o,p),P=Nn(P),w=w(P),o.flags|=1,Ci(i,o,w,p),o.child;case 14:return w=o.type,P=Uo(w,o.pendingProps),P=Uo(w.type,P),uf(i,o,w,P,p);case 15:return cf(i,o,o.type,o.pendingProps,p);case 17:return w=o.type,P=o.pendingProps,P=o.elementType===w?P:Uo(w,P),Rc(i,o),o.tag=1,Oi(w)?(i=!0,Ps(o)):i=!1,Ti(o,p),xd(o,w,P),xu(o,w,P,p),Sd(null,o,w,!0,i,p);case 19:return Td(i,o,p);case 22:return hf(i,o,p)}throw Error(v(156,o.tag))};function Ld(i,o){return Fn(i,o)}function Rf(i,o,p,w){this.tag=i,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ro(i,o,p,w){return new Rf(i,o,p,w)}function Zc(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ip(i){if(typeof i=="function")return Zc(i)?1:0;if(i!=null){if(i=i.$$typeof,i===xe)return 11;if(i===Ve)return 14}return 2}function $l(i,o){var p=i.alternate;return p===null?(p=ro(i.tag,o,i.key,i.mode),p.elementType=i.elementType,p.type=i.type,p.stateNode=i.stateNode,p.alternate=i,i.alternate=p):(p.pendingProps=o,p.type=i.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=i.flags&14680064,p.childLanes=i.childLanes,p.lanes=i.lanes,p.child=i.child,p.memoizedProps=i.memoizedProps,p.memoizedState=i.memoizedState,p.updateQueue=i.updateQueue,o=i.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=i.sibling,p.index=i.index,p.ref=i.ref,p}function Wc(i,o,p,w,P,L){var ie=2;if(w=i,typeof i=="function")Zc(i)&&(ie=1);else if(typeof i=="string")ie=5;else e:switch(i){case je:return Gl(p.children,P,L,o);case St:ie=8,P|=8;break;case ot:return i=ro(12,p,o,P|2),i.elementType=ot,i.lanes=L,i;case Je:return i=ro(13,p,o,P),i.elementType=Je,i.lanes=L,i;case G:return i=ro(19,p,o,P),i.elementType=G,i.lanes=L,i;case Ae:return ql(p,P,L,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case At:ie=10;break e;case xt:ie=9;break e;case xe:ie=11;break e;case Ve:ie=14;break e;case Rt:ie=16,w=null;break e}throw Error(v(130,i==null?i:typeof i,""))}return o=ro(ie,p,o,P),o.elementType=i,o.type=w,o.lanes=L,o}function Gl(i,o,p,w){return i=ro(7,i,w,o),i.lanes=p,i}function ql(i,o,p,w){return i=ro(22,i,w,o),i.elementType=Ae,i.lanes=p,i.stateNode={isHidden:!1},i}function Vo(i,o,p){return i=ro(6,i,null,o),i.lanes=p,i}function Oa(i,o,p){return o=ro(4,i.children!==null?i.children:[],i.key,o),o.lanes=p,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Df(i,o,p,w,P){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ye(0),this.expirationTimes=Ye(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ye(0),this.identifierPrefix=w,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function Xc(i,o,p,w,P,L,ie,Re,He){return i=new Df(i,o,p,Re,He),o===1?(o=1,L===!0&&(o|=8)):o=0,L=ro(3,null,null,o),i.current=L,L.stateNode=i,L.memoizedState={element:w,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ra(L),i}function Pp(i,o,p){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qe,key:w==null?null:""+w,children:i,containerInfo:o,implementation:p}}function Lf(i){if(!i)return za;i=i._reactInternals;e:{if(Ur(i)!==i||i.tag!==1)throw Error(v(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Oi(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(v(171))}if(i.tag===1){var p=i.type;if(Oi(p))return Al(i,p,o)}return o}function Kc(i,o,p,w,P,L,ie,Re,He){return i=Xc(p,w,!0,i,P,L,ie,Re,He),i.context=Lf(null),p=i.current,w=Ls(),P=Hl(p),L=Ks(w,P),L.callback=o??null,No(p,L,P),i.current.lanes=P,st(i,P,w),to(i,w),i}function Ju(i,o,p,w){var P=o.current,L=Ls(),ie=Hl(P);return p=Lf(p),o.context===null?o.context=p:o.pendingContext=p,o=Ks(L,ie),o.payload={element:i},w=w===void 0?null:w,w!==null&&(o.callback=w),i=No(P,o,ie),i!==null&&(fa(i,P,ie,L),is(i,P,ie)),ie}function Hh(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function $h(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var p=i.retryLane;i.retryLane=p!==0&&p<o?p:o}}function Yc(i,o){$h(i,o),(i=i.alternate)&&$h(i,o)}function Qu(){return null}var Fd=typeof reportError=="function"?reportError:function(i){console.error(i)};function Gh(i){this._internalRoot=i}ec.prototype.render=Gh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(v(409));Ju(i,o,null,null)},ec.prototype.unmount=Gh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;al(function(){Ju(null,i,null,null)}),o[mo]=null}};function ec(i){this._internalRoot=i}ec.prototype.unstable_scheduleHydration=function(i){if(i){var o=es();i={blockedOn:null,target:i,priority:o};for(var p=0;p<Cs.length&&o!==0&&o<Cs[p].priority;p++);Cs.splice(p,0,i),p===0&&Is(i)}};function qh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Cu(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Od(){}function Ap(i,o,p,w,P){if(P){if(typeof w=="function"){var L=w;w=function(){var mt=Hh(ie);L.call(mt)}}var ie=Kc(o,w,i,0,null,!1,!1,"",Od);return i._reactRootContainer=ie,i[mo]=ie.current,sa(i.nodeType===8?i.parentNode:i),al(),ie}for(;P=i.lastChild;)i.removeChild(P);if(typeof w=="function"){var Re=w;w=function(){var mt=Hh(He);Re.call(mt)}}var He=Xc(i,0,!1,null,null,!1,!1,"",Od);return i._reactRootContainer=He,i[mo]=He.current,sa(i.nodeType===8?i.parentNode:i),al(function(){Ju(o,He,p,w)}),He}function Zh(i,o,p,w,P){var L=p._reactRootContainer;if(L){var ie=L;if(typeof P=="function"){var Re=P;P=function(){var He=Hh(ie);Re.call(He)}}Ju(o,ie,i,P)}else ie=Ap(p,o,i,P,w);return Hh(ie)}Vr=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var p=Ns(o.pendingLanes);p!==0&&(Ht(o,p|1),to(o,Pr()),(hn&6)===0&&(Zn=Pr()+500,g()))}break;case 13:al(function(){var w=gs(i,1);if(w!==null){var P=Ls();fa(w,i,1,P)}}),Yc(i,1)}},fn=function(i){if(i.tag===13){var o=gs(i,134217728);if(o!==null){var p=Ls();fa(o,i,134217728,p)}Yc(i,134217728)}},Ei=function(i){if(i.tag===13){var o=Hl(i),p=gs(i,o);if(p!==null){var w=Ls();fa(p,i,o,w)}Yc(i,o)}},es=function(){return Jt},Vi=function(i,o){var p=Jt;try{return Jt=i,o()}finally{Jt=p}},wi=function(i,o,p){switch(o){case"input":if(Me(i,p),o=p.name,p.type==="radio"&&o!=null){for(p=i;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<p.length;o++){var w=p[o];if(w!==i&&w.form===i.form){var P=pu(w);if(!P)throw Error(v(90));Yr(w),Me(w,P)}}}break;case"textarea":rr(i,p);break;case"select":o=p.value,o!=null&&Mt(i,!!p.multiple,o,!1)}},ue=Vh,Se=al;var Ff={usingClientEntryPoint:!1,Events:[fu,go,pu,ee,Q,Vh]},Jc={findFiberByHostInstance:la,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Mp={bundleType:Jc.bundleType,version:Jc.version,rendererPackageName:Jc.rendererPackageName,rendererConfig:Jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fe.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=rn(i),i===null?null:i.stateNode},findFiberByHostInstance:Jc.findFiberByHostInstance||Qu,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{Hn=Wh.inject(Mp),fi=Wh}catch{}}return $o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ff,$o.createPortal=function(i,o){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qh(o))throw Error(v(200));return Pp(i,o,null,p)},$o.createRoot=function(i,o){if(!qh(i))throw Error(v(299));var p=!1,w="",P=Fd;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(w=o.identifierPrefix),o.onRecoverableError!==void 0&&(P=o.onRecoverableError)),o=Xc(i,1,!1,null,null,p,!1,w,P),i[mo]=o.current,sa(i.nodeType===8?i.parentNode:i),new Gh(o)},$o.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(v(188)):(i=Object.keys(i).join(","),Error(v(268,i)));return i=rn(o),i=i===null?null:i.stateNode,i},$o.flushSync=function(i){return al(i)},$o.hydrate=function(i,o,p){if(!Cu(o))throw Error(v(200));return Zh(null,i,o,!0,p)},$o.hydrateRoot=function(i,o,p){if(!qh(i))throw Error(v(405));var w=p!=null&&p.hydratedSources||null,P=!1,L="",ie=Fd;if(p!=null&&(p.unstable_strictMode===!0&&(P=!0),p.identifierPrefix!==void 0&&(L=p.identifierPrefix),p.onRecoverableError!==void 0&&(ie=p.onRecoverableError)),o=Kc(o,null,i,1,p??null,P,!1,L,ie),i[mo]=o.current,sa(i),w)for(i=0;i<w.length;i++)p=w[i],P=p._getVersion,P=P(p._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[p,P]:o.mutableSourceEagerHydrationData.push(p,P);return new ec(o)},$o.render=function(i,o,p){if(!Cu(o))throw Error(v(200));return Zh(null,i,o,!1,p)},$o.unmountComponentAtNode=function(i){if(!Cu(i))throw Error(v(40));return i._reactRootContainer?(al(function(){Zh(null,null,i,!1,function(){i._reactRootContainer=null,i[mo]=null})}),!0):!1},$o.unstable_batchedUpdates=Vh,$o.unstable_renderSubtreeIntoContainer=function(i,o,p,w){if(!Cu(p))throw Error(v(200));if(i==null||i._reactInternals===void 0)throw Error(v(38));return Zh(i,o,p,!1,w)},$o.version="18.3.1-next-f1338f8080-20240426",$o}var hg;function Sy(){if(hg)return qp.exports;hg=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(x){console.error(x)}}return d(),qp.exports=ov(),qp.exports}var dg;function av(){if(dg)return Hf;dg=1;var d=Sy();return Hf.createRoot=d.createRoot,Hf.hydrateRoot=d.hydrateRoot,Hf}var lv=av();const uv=ld(lv);var ep={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */var cv=ep.exports,fg;function hv(){return fg||(fg=1,function(d,x){(function(v,C){d.exports=C()})(cv,function(){var v={},C={};function I(E,u,B){if(C[E]=B,E==="index"){var U="var sharedModule = {}; ("+C.shared+")(sharedModule); ("+C.worker+")(sharedModule);",K={};return C.shared(K),C.index(v,K),typeof window<"u"&&v.setWorkerUrl(window.URL.createObjectURL(new Blob([U],{type:"text/javascript"}))),v}}I("shared",["exports"],function(E){function u(r,t,n,a){return new(n||(n=Promise))(function(f,y){function _(M){try{T(a.next(M))}catch(O){y(O)}}function b(M){try{T(a.throw(M))}catch(O){y(O)}}function T(M){var O;M.done?f(M.value):(O=M.value,O instanceof n?O:new n(function(V){V(O)})).then(_,b)}T((a=a.apply(r,t||[])).next())})}function B(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var U=K;function K(r,t){this.x=r,this.y=t}K.prototype={clone:function(){return new K(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),n=Math.sin(r),a=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=a,this},_rotateAround:function(r,t){var n=Math.cos(r),a=Math.sin(r),f=t.y+a*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-a*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},K.convert=function(r){return r instanceof K?r:Array.isArray(r)?new K(r[0],r[1]):r};var j=B(U),N=q;function q(r,t,n,a){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(a-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=n,this.p2y=a}q.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,a=0;a<8;a++){var f=this.sampleCurveX(n)-r;if(Math.abs(f)<t)return n;var y=this.sampleCurveDerivativeX(n);if(Math.abs(y)<1e-6)break;n-=f/y}var _=0,b=1;for(n=r,a=0;a<20&&(f=this.sampleCurveX(n),!(Math.abs(f-r)<t));a++)r>f?_=n:b=n,n=.5*(b-_)+_;return n},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var se=B(N);let J,ae;function re(){return J==null&&(J=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),J}function pe(){if(ae==null&&(ae=!1,re())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const f=4*a;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&n[a]!==a){ae=!0;break}}}return ae||!1}function ge(r,t,n,a){const f=new se(r,t,n,a);return y=>f.solve(y)}const Fe=ge(.25,.1,.25,1);function ve(r,t,n){return Math.min(n,Math.max(t,r))}function qe(r,t,n){const a=n-t,f=((r-t)%a+a)%a+t;return f===t?n:f}function je(r,...t){for(const n of t)for(const a in n)r[a]=n[a];return r}let St=1;function ot(r,t,n){const a={};for(const f in r)a[f]=t.call(this,r[f],f,r);return a}function At(r,t,n){const a={};for(const f in r)t.call(this,r[f],f,r)&&(a[f]=r[f]);return a}function xt(r){return Array.isArray(r)?r.map(xt):typeof r=="object"&&r?ot(r,xt):r}const xe={};function Je(r){xe[r]||(typeof console<"u"&&console.warn(r),xe[r]=!0)}function G(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function Ve(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let Rt=null;function Ae(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ze(r,t,n,a,f){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(r,{timestamp:0});try{const _=y==null?void 0:y.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const b=_.startsWith("BGR"),T=new Uint8ClampedArray(a*f*4);if(yield y.copyTo(T,function(M,O,V,Z,te){const le=4*Math.max(-O,0),fe=(Math.max(0,V)-V)*Z*4+le,Pe=4*Z,De=Math.max(0,O),rt=Math.max(0,V);return{rect:{x:De,y:rt,width:Math.min(M.width,O+Z)-De,height:Math.min(M.height,V+te)-rt},layout:[{offset:fe,stride:Pe}]}}(r,t,n,a,f)),b)for(let M=0;M<T.length;M+=4){const O=T[M];T[M]=T[M+2],T[M+2]=O}return T}finally{y.close()}})}let ht,oe;const _e="AbortError";function Ct(){return new Error(_e)}const bt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function wt(r){return bt.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const ar="global-dispatcher";class fr extends Error{constructor(t,n,a,f){super(`AJAXError: ${n} (${t}): ${a}`),this.status=t,this.statusText=n,this.url=a,this.body=f}}const qt=()=>Ve(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Kt=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const a=wt(r.url);if(a)return a(r,t);if(Ve(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:ar},t)}if(!(/^file:/.test(n=r.url)||/^file:/.test(qt())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,f){return u(this,void 0,void 0,function*(){const y=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:qt(),signal:f.signal});a.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const _=yield fetch(y);if(!_.ok){const M=yield _.blob();throw new fr(_.status,_.statusText,a.url,M)}let b;b=a.type==="arrayBuffer"||a.type==="image"?_.arrayBuffer():a.type==="json"?_.json():_.text();const T=yield b;if(f.signal.aborted)throw Ct();return{data:T,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(r,t);if(Ve(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:ar},t)}var n;return function(a,f){return new Promise((y,_)=>{var b;const T=new XMLHttpRequest;T.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(T.responseType="arraybuffer");for(const M in a.headers)T.setRequestHeader(M,a.headers[M]);a.type==="json"&&(T.responseType="text",!((b=a.headers)===null||b===void 0)&&b.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=a.credentials==="include",T.onerror=()=>{_(new Error(T.statusText))},T.onload=()=>{if(!f.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let M=T.response;if(a.type==="json")try{M=JSON.parse(T.response)}catch(O){return void _(O)}y({data:M,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const M=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});_(new fr(T.status,T.statusText,a.url,M))}},f.signal.addEventListener("abort",()=>{T.abort(),_(Ct())}),T.send(a.body)})}(r,t)};function Cr(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const t=new URL(r),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function Br(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function Yr(r,t,n){if(n&&n[r]){const a=n[r].indexOf(t);a!==-1&&n[r].splice(a,1)}}class Zr{constructor(t,n={}){je(this,n),this.type=t}}class W extends Zr{constructor(t,n={}){super("error",je({error:t},n))}}class ft{on(t,n){return this._listeners=this._listeners||{},Br(t,n,this._listeners),this}off(t,n){return Yr(t,n,this._listeners),Yr(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Br(t,n,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,n){typeof t=="string"&&(t=new Zr(t,n||{}));const a=t.type;if(this.listens(a)){t.target=this;const f=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const b of f)b.call(this,t);const y=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const b of y)Yr(a,b,this._oneTimeListeners),b.call(this,t);const _=this._eventedParent;_&&(je(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof W&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Me=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function we(r,t){const n={};for(const a in r)a!=="ref"&&(n[a]=r[a]);return Me.forEach(a=>{a in t&&(n[a]=t[a])}),n}function Ne(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!Ne(r[n],t[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(!Ne(r[n],t[n]))return!1;return!0}return r===t}function _t(r,t){r.push(t)}function Mt(r,t,n){_t(n,{command:"addSource",args:[r,t[r]]})}function nt(r,t,n){_t(t,{command:"removeSource",args:[r]}),n[r]=!0}function zt(r,t,n,a){nt(r,n,a),Mt(r,t,n)}function rr(r,t,n){let a;for(a in r[n])if(Object.prototype.hasOwnProperty.call(r[n],a)&&a!=="data"&&!Ne(r[n][a],t[n][a]))return!1;for(a in t[n])if(Object.prototype.hasOwnProperty.call(t[n],a)&&a!=="data"&&!Ne(r[n][a],t[n][a]))return!1;return!0}function Lt(r,t,n,a,f,y){r=r||{},t=t||{};for(const _ in r)Object.prototype.hasOwnProperty.call(r,_)&&(Ne(r[_],t[_])||n.push({command:y,args:[a,_,t[_],f]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(r,_)&&(Ne(r[_],t[_])||n.push({command:y,args:[a,_,t[_],f]}))}function _r(r){return r.id}function en(r,t){return r[t.id]=t,r}class vt{constructor(t,n,a,f){this.message=(t?`${t}: `:"")+a,f&&(this.identifier=f),n!=null&&n.__line__&&(this.line=n.__line__)}}function xn(r,...t){for(const n of t)for(const a in n)r[a]=n[a];return r}class yn extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class wn{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[a,f]of n)this.bindings[a]=f}concat(t){return new wn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ui={kind:"null"},Pt={kind:"number"},zr={kind:"string"},wr={kind:"boolean"},_n={kind:"color"},ci={kind:"object"},Ir={kind:"value"},An={kind:"collator"},wi={kind:"formatted"},Xn={kind:"padding"},Nr={kind:"resolvedImage"},Ce={kind:"variableAnchorOffsetCollection"};function ee(r,t){return{kind:"array",itemType:r,N:t}}function Q(r){if(r.kind==="array"){const t=Q(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const ue=[ui,Pt,zr,wr,_n,wi,ci,ee(Ir),Xn,Nr,Ce];function Se(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Se(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of ue)if(!Se(n,t))return null}}return`Expected ${Q(r)} but found ${Q(t)} instead.`}function Oe(r,t){return t.some(n=>n.kind===r.kind)}function $e(r,t){return t.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function Ke(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}const Le=.96422,pt=.82521,It=4/29,ut=6/29,Nt=3*ut*ut,cr=ut*ut*ut,pr=Math.PI/180,Jr=180/Math.PI;function Mr(r){return(r%=360)<0&&(r+=360),r}function Kr([r,t,n,a]){let f,y;const _=bn((.2225045*(r=Ur(r))+.7168786*(t=Ur(t))+.0606169*(n=Ur(n)))/1);r===t&&t===n?f=y=_:(f=bn((.4360747*r+.3850649*t+.1430804*n)/Le),y=bn((.0139322*r+.0971045*t+.7141733*n)/pt));const b=116*_-16;return[b<0?0:b,500*(f-_),200*(_-y),a]}function Ur(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function bn(r){return r>cr?Math.pow(r,1/3):r/Nt+It}function En([r,t,n,a]){let f=(r+16)/116,y=isNaN(t)?f:f+t/500,_=isNaN(n)?f:f-n/200;return f=1*rn(f),y=Le*rn(y),_=pt*rn(_),[Hr(3.1338561*y-1.6168667*f-.4906146*_),Hr(-.9787684*y+1.9161415*f+.033454*_),Hr(.0719453*y-.2289914*f+1.4052427*_),a]}function Hr(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function rn(r){return r>ut?r*r*r:Nt*(r-It)}function un(r){return parseInt(r.padEnd(2,r),16)/255}function Fn(r,t){return Kn(t?r/100:r,0,1)}function Kn(r,t,n){return Math.min(Math.max(t,r),n)}function hi(r){return!r.some(Number.isNaN)}const ao={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Pr{constructor(t,n,a,f=1,y=!0){this.r=t,this.g=n,this.b=a,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,n,a,f]))}static parse(t){if(t instanceof Pr)return t;if(typeof t!="string")return;const n=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=ao[a];if(f){const[_,b,T]=f;return[_/255,b/255,T/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const _=a.length<6?1:2;let b=1;return[un(a.slice(b,b+=_)),un(a.slice(b,b+=_)),un(a.slice(b,b+=_)),un(a.slice(b,b+_)||"ff")]}if(a.startsWith("rgb")){const _=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[b,T,M,O,V,Z,te,le,fe,Pe,De,rt]=_,Ue=[O||" ",te||" ",Pe].join("");if(Ue==="  "||Ue==="  /"||Ue===",,"||Ue===",,,"){const Qe=[M,Z,fe].join(""),gt=Qe==="%%%"?100:Qe===""?255:0;if(gt){const Dt=[Kn(+T/gt,0,1),Kn(+V/gt,0,1),Kn(+le/gt,0,1),De?Fn(+De,rt):1];if(hi(Dt))return Dt}}return}}const y=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[_,b,T,M,O,V,Z,te,le]=y,fe=[T||" ",O||" ",Z].join("");if(fe==="  "||fe==="  /"||fe===",,"||fe===",,,"){const Pe=[+b,Kn(+M,0,100),Kn(+V,0,100),te?Fn(+te,le):1];if(hi(Pe))return function([De,rt,Ue,Qe]){function gt(Dt){const nr=(Dt+De/30)%12,Ar=rt*Math.min(Ue,1-Ue);return Ue-Ar*Math.max(-1,Math.min(nr-3,9-nr,1))}return De=Mr(De),rt/=100,Ue/=100,[gt(0),gt(8),gt(4),Qe]}(Pe)}}}(t);return n?new Pr(...n,!1):void 0}get rgb(){const{r:t,g:n,b:a,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[t/y,n/y,a/y,f])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,a,f,y]=Kr(t),_=Math.sqrt(a*a+f*f);return[Math.round(1e4*_)?Mr(Math.atan2(f,a)*Jr):NaN,_,n,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Kr(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,a,f]=this.rgb;return`rgba(${[t,n,a].map(y=>Math.round(255*y)).join(",")},${f})`}}Pr.black=new Pr(0,0,0,1),Pr.white=new Pr(1,1,1,1),Pr.transparent=new Pr(0,0,0,0),Pr.red=new Pr(1,0,0,1);class bi{constructor(t,n,a){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class zo{constructor(t,n,a,f,y){this.text=t,this.image=n,this.scale=a,this.fontStack=f,this.textColor=y}}class di{constructor(t){this.sections=t}static fromString(t){return new di([new zo(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof di?t:di.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class ei{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ei)return t;if(typeof t=="number")return new ei([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ei(t)}}toString(){return JSON.stringify(this.values)}}const pl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ti{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ti)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const a=t[n],f=t[n+1];if(typeof a!="string"||!pl.has(a)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new ti(t)}}toString(){return JSON.stringify(this.values)}}class Hn{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Hn({name:t,available:!1}):null}}function fi(r,t,n,a){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[r,t,n,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[r,t,n,a]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qi(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Pr||r instanceof bi||r instanceof di||r instanceof ei||r instanceof ti||r instanceof Hn)return!0;if(Array.isArray(r)){for(const t of r)if(!Qi(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Qi(r[t]))return!1;return!0}return!1}function nn(r){if(r===null)return ui;if(typeof r=="string")return zr;if(typeof r=="boolean")return wr;if(typeof r=="number")return Pt;if(r instanceof Pr)return _n;if(r instanceof bi)return An;if(r instanceof di)return wi;if(r instanceof ei)return Xn;if(r instanceof ti)return Ce;if(r instanceof Hn)return Nr;if(Array.isArray(r)){const t=r.length;let n;for(const a of r){const f=nn(a);if(n){if(n===f)continue;n=Ir;break}n=f}return ee(n||Ir,t)}return ci}function lo(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Pr||r instanceof di||r instanceof ei||r instanceof ti||r instanceof Hn?r.toString():JSON.stringify(r)}class Di{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Qi(t[1]))return n.error("invalid value");const a=t[1];let f=nn(a);const y=n.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new Di(f,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Mn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ls={string:zr,number:Pt,boolean:wr,object:ci};class Si{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let a,f=1;const y=t[0];if(y==="array"){let b,T;if(t.length>2){const M=t[1];if(typeof M!="string"||!(M in ls)||M==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);b=ls[M],f++}else b=Ir;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=t[2],f++}a=ee(b,T)}else{if(!ls[y])throw new Error(`Types doesn't contain name = ${y}`);a=ls[y]}const _=[];for(;f<t.length;f++){const b=n.parse(t[f],f,Ir);if(!b)return null;_.push(b)}return new Si(a,_)}evaluate(t){for(let n=0;n<this.args.length;n++){const a=this.args[n].evaluate(t);if(!Se(this.type,nn(a)))return a;if(n===this.args.length-1)throw new Mn(`Expected value to be of type ${Q(this.type)}, but found ${Q(nn(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ns={"to-boolean":wr,"to-color":_n,"to-number":Pt,"to-string":zr};class pi{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const a=t[0];if(!Ns[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return n.error("Expected one argument.");const f=Ns[a],y=[];for(let _=1;_<t.length;_++){const b=n.parse(t[_],_,Ir);if(!b)return null;y.push(b)}return new pi(f,y)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,a;for(const f of this.args){if(n=f.evaluate(t),a=null,n instanceof Pr)return n;if(typeof n=="string"){const y=t.parseColor(n);if(y)return y}else if(Array.isArray(n)&&(a=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:fi(n[0],n[1],n[2],n[3]),!a))return new Pr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Mn(a||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const a of this.args){n=a.evaluate(t);const f=ei.parse(n);if(f)return f}throw new Mn(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const a of this.args){n=a.evaluate(t);const f=ti.parse(n);if(f)return f}throw new Mn(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const a of this.args){if(n=a.evaluate(t),n===null)return 0;const f=Number(n);if(!isNaN(f))return f}throw new Mn(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return di.fromString(lo(this.args[0].evaluate(t)));case"resolvedImage":return Hn.fromString(lo(this.args[0].evaluate(t)));default:return lo(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const R=["Unknown","Point","LineString","Polygon"];class Y{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?R[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=Pr.parse(t)),n}}class he{constructor(t,n,a=[],f,y=new wn,_=[]){this.registry=t,this.path=a,this.key=a.map(b=>`[${b}]`).join(""),this.scope=y,this.errors=_,this.expectedType=f,this._isConstant=n}parse(t,n,a,f,y={}){return n?this.concat(n,a,f)._parse(t,y):this._parse(t,y)}_parse(t,n){function a(f,y,_){return _==="assert"?new Si(y,[f]):_==="coerce"?new pi(y,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let _=y.parse(t,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,T=_.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||T.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(b.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(b,T))return null}else _=a(_,b,n.typeAnnotation||"coerce");else _=a(_,b,n.typeAnnotation||"coerce");else _=a(_,b,n.typeAnnotation||"coerce");else _=a(_,b,n.typeAnnotation||"assert")}if(!(_ instanceof Di)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const b=new Y;try{_=new Di(_.type,_.evaluate(b))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,a){const f=typeof t=="number"?this.path.concat(t):this.path,y=a?this.scope.concat(a):this.scope;return new he(this.registry,this._isConstant,f,n||null,y,this.errors)}error(t,...n){const a=`${this.key}${n.map(f=>`[${f}]`).join("")}`;this.errors.push(new yn(a,t))}checkSubtype(t,n){const a=Se(t,n);return a&&this.error(a),a}}class Ee{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let y=1;y<t.length-1;y+=2){const _=t[y];if(typeof _!="string")return n.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",y);const b=n.parse(t[y+1],y+1);if(!b)return null;a.push([_,b])}const f=n.parse(t[t.length-1],t.length-1,n.expectedType,a);return f?new Ee(a,f):null}outputDefined(){return this.result.outputDefined()}}class Ye{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const a=t[1];return n.scope.has(a)?new Ye(a,n.scope.get(a)):n.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class st{constructor(t,n,a){this.type=t,this.index=n,this.input=a}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Pt),f=n.parse(t[2],2,ee(n.expectedType||Ir));return a&&f?new st(f.type.itemType,a,f):null}evaluate(t){const n=this.index.evaluate(t),a=this.input.evaluate(t);if(n<0)throw new Mn(`Array index out of bounds: ${n} < 0.`);if(n>=a.length)throw new Mn(`Array index out of bounds: ${n} > ${a.length-1}.`);if(n!==Math.floor(n))throw new Mn(`Array index must be an integer, but found ${n} instead.`);return a[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Et{constructor(t,n){this.type=wr,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Ir),f=n.parse(t[2],2,Ir);return a&&f?Oe(a.type,[wr,zr,Pt,ui,Ir])?new Et(a,f):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(a.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!$e(n,["boolean","string","number","null"]))throw new Mn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(nn(n))} instead.`);if(!$e(a,["string","array"]))throw new Mn(`Expected second argument to be of type array or string, but found ${Q(nn(a))} instead.`);return a.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ht{constructor(t,n,a){this.type=Pt,this.needle=t,this.haystack=n,this.fromIndex=a}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Ir),f=n.parse(t[2],2,Ir);if(!a||!f)return null;if(!Oe(a.type,[wr,zr,Pt,ui,Ir]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(a.type)} instead`);if(t.length===4){const y=n.parse(t[3],3,Pt);return y?new Ht(a,f,y):null}return new Ht(a,f)}evaluate(t){const n=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!$e(n,["boolean","string","number","null"]))throw new Mn(`Expected first argument to be of type boolean, string, number or null, but found ${Q(nn(n))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(t)),$e(a,["string"])){const y=a.indexOf(n,f);return y===-1?-1:[...a.slice(0,y)].length}if($e(a,["array"]))return a.indexOf(n,f);throw new Mn(`Expected second argument to be of type array or string, but found ${Q(nn(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Jt{constructor(t,n,a,f,y,_){this.inputType=t,this.type=n,this.input=a,this.cases=f,this.outputs=y,this.otherwise=_}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let a,f;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);const y={},_=[];for(let M=2;M<t.length-1;M+=2){let O=t[M];const V=t[M+1];Array.isArray(O)||(O=[O]);const Z=n.concat(M);if(O.length===0)return Z.error("Expected at least one branch label.");for(const le of O){if(typeof le!="number"&&typeof le!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof le=="number"&&Math.abs(le)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof le=="number"&&Math.floor(le)!==le)return Z.error("Numeric branch labels must be integer values.");if(a){if(Z.checkSubtype(a,nn(le)))return null}else a=nn(le);if(y[String(le)]!==void 0)return Z.error("Branch labels must be unique.");y[String(le)]=_.length}const te=n.parse(V,M,f);if(!te)return null;f=f||te.type,_.push(te)}const b=n.parse(t[1],1,Ir);if(!b)return null;const T=n.parse(t[t.length-1],t.length-1,f);return T?b.type.kind!=="value"&&n.concat(1).checkSubtype(a,b.type)?null:new Jt(a,f,b,y,_,T):null}evaluate(t){const n=this.input.evaluate(t);return(nn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Rr{constructor(t,n,a){this.type=t,this.branches=n,this.otherwise=a}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let a;n.expectedType&&n.expectedType.kind!=="value"&&(a=n.expectedType);const f=[];for(let _=1;_<t.length-1;_+=2){const b=n.parse(t[_],_,wr);if(!b)return null;const T=n.parse(t[_+1],_+1,a);if(!T)return null;f.push([b,T]),a=a||T.type}const y=n.parse(t[t.length-1],t.length-1,a);if(!y)return null;if(!a)throw new Error("Can't infer output type");return new Rr(a,f,y)}evaluate(t){for(const[n,a]of this.branches)if(n.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,a]of this.branches)t(n),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Vr{constructor(t,n,a,f){this.type=t,this.input=n,this.beginIndex=a,this.endIndex=f}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=n.parse(t[1],1,Ir),f=n.parse(t[2],2,Pt);if(!a||!f)return null;if(!Oe(a.type,[ee(Ir),zr,Ir]))return n.error(`Expected first argument to be of type array or string, but found ${Q(a.type)} instead`);if(t.length===4){const y=n.parse(t[3],3,Pt);return y?new Vr(a.type,a,f,y):null}return new Vr(a.type,a,f)}evaluate(t){const n=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let f;if(this.endIndex&&(f=this.endIndex.evaluate(t)),$e(n,["string"]))return[...n].slice(a,f).join("");if($e(n,["array"]))return n.slice(a,f);throw new Mn(`Expected first argument to be of type array or string, but found ${Q(nn(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function fn(r,t){const n=r.length-1;let a,f,y=0,_=n,b=0;for(;y<=_;)if(b=Math.floor((y+_)/2),a=r[b],f=r[b+1],a<=t){if(b===n||t<f)return b;y=b+1}else{if(!(a>t))throw new Mn("Input is not a number.");_=b-1}return 0}class Ei{constructor(t,n,a){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[f,y]of a)this.labels.push(f),this.outputs.push(y)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const a=n.parse(t[1],1,Pt);if(!a)return null;const f=[];let y=null;n.expectedType&&n.expectedType.kind!=="value"&&(y=n.expectedType);for(let _=1;_<t.length;_+=2){const b=_===1?-1/0:t[_],T=t[_+1],M=_,O=_+1;if(typeof b!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(f.length&&f[f.length-1][0]>=b)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const V=n.parse(T,O,y);if(!V)return null;y=y||V.type,f.push([b,V])}return new Ei(y,a,f)}evaluate(t){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return a[0].evaluate(t);const y=n.length;return f>=n[y-1]?a[y-1].evaluate(t):a[fn(n,f)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function es(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Vi=js;function js(r,t,n,a){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(a-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=n,this.p2y=a}js.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var n=r,a=0;a<8;a++){var f=this.sampleCurveX(n)-r;if(Math.abs(f)<t)return n;var y=this.sampleCurveDerivativeX(n);if(Math.abs(y)<1e-6)break;n-=f/y}var _=0,b=1;for(n=r,a=0;a<20&&(f=this.sampleCurveX(n),!(Math.abs(f-r)<t));a++)r>f?_=n:b=n,n=.5*(b-_)+_;return n},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var us=es(Vi);function mi(r,t,n){return r+n*(t-r)}function gi(r,t,n){return r.map((a,f)=>mi(a,t[f],n))}const On={number:mi,color:function(r,t,n,a="rgb"){switch(a){case"rgb":{const[f,y,_,b]=gi(r.rgb,t.rgb,n);return new Pr(f,y,_,b,!1)}case"hcl":{const[f,y,_,b]=r.hcl,[T,M,O,V]=t.hcl;let Z,te;if(isNaN(f)||isNaN(T))isNaN(f)?isNaN(T)?Z=NaN:(Z=T,_!==1&&_!==0||(te=M)):(Z=f,O!==1&&O!==0||(te=y));else{let rt=T-f;T>f&&rt>180?rt-=360:T<f&&f-T>180&&(rt+=360),Z=f+n*rt}const[le,fe,Pe,De]=function([rt,Ue,Qe,gt]){return rt=isNaN(rt)?0:rt*pr,En([Qe,Math.cos(rt)*Ue,Math.sin(rt)*Ue,gt])}([Z,te??mi(y,M,n),mi(_,O,n),mi(b,V,n)]);return new Pr(le,fe,Pe,De,!1)}case"lab":{const[f,y,_,b]=En(gi(r.lab,t.lab,n));return new Pr(f,y,_,b,!1)}}},array:gi,padding:function(r,t,n){return new ei(gi(r.values,t.values,n))},variableAnchorOffsetCollection:function(r,t,n){const a=r.values,f=t.values;if(a.length!==f.length)throw new Mn(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);const y=[];for(let _=0;_<a.length;_+=2){if(a[_]!==f[_])throw new Mn(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${a[_]}, to[${_}]: ${f[_]}`);y.push(a[_]);const[b,T]=a[_+1],[M,O]=f[_+1];y.push([mi(b,M,n),mi(T,O,n)])}return new ti(y)}};class zn{constructor(t,n,a,f,y){this.type=t,this.operator=n,this.interpolation=a,this.input=f,this.labels=[],this.outputs=[];for(const[_,b]of y)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(t,n,a,f){let y=0;if(t.name==="exponential")y=ks(n,t.base,a,f);else if(t.name==="linear")y=ks(n,1,a,f);else if(t.name==="cubic-bezier"){const _=t.controlPoints;y=new us(_[0],_[1],_[2],_[3]).solve(ks(n,1,a,f))}return y}static parse(t,n){let[a,f,y,..._]=t;if(!Array.isArray(f)||f.length===0)return n.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const M=f[1];if(typeof M!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:M}}else{if(f[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const M=f.slice(1);if(M.length!==4||M.some(O=>typeof O!="number"||O<0||O>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:M}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(y=n.parse(y,2,Pt),!y)return null;const b=[];let T=null;a==="interpolate-hcl"||a==="interpolate-lab"?T=_n:n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType);for(let M=0;M<_.length;M+=2){const O=_[M],V=_[M+1],Z=M+3,te=M+4;if(typeof O!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(b.length&&b[b.length-1][0]>=O)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const le=n.parse(V,te,T);if(!le)return null;T=T||le.type,b.push([O,le])}return Ke(T,Pt)||Ke(T,_n)||Ke(T,Xn)||Ke(T,Ce)||Ke(T,ee(Pt))?new zn(T,a,f,y,b):n.error(`Type ${Q(T)} is not interpolatable.`)}evaluate(t){const n=this.labels,a=this.outputs;if(n.length===1)return a[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return a[0].evaluate(t);const y=n.length;if(f>=n[y-1])return a[y-1].evaluate(t);const _=fn(n,f),b=zn.interpolationFactor(this.interpolation,f,n[_],n[_+1]),T=a[_].evaluate(t),M=a[_+1].evaluate(t);switch(this.operator){case"interpolate":return On[this.type.kind](T,M,b);case"interpolate-hcl":return On.color(T,M,b,"hcl");case"interpolate-lab":return On.color(T,M,b,"lab")}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ks(r,t,n,a){const f=a-n,y=r-n;return f===0?0:t===1?y/f:(Math.pow(t,y)-1)/(Math.pow(t,f)-1)}class Cs{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expectected at least one argument.");let a=null;const f=n.expectedType;f&&f.kind!=="value"&&(a=f);const y=[];for(const b of t.slice(1)){const T=n.parse(b,1+y.length,a,void 0,{typeAnnotation:"omit"});if(!T)return null;a=a||T.type,y.push(T)}if(!a)throw new Error("No output type");const _=f&&y.some(b=>Se(f,b.type));return new Cs(_?Ir:a,y)}evaluate(t){let n,a=null,f=0;for(const y of this.args)if(f++,a=y.evaluate(t),a&&a instanceof Hn&&!a.available&&(n||(n=a.name),a=null,f===this.args.length&&(a=n)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ml(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ql(r,t,n,a){return a.compare(t,n)===0}function Us(r,t,n){const a=r!=="=="&&r!=="!=";return class Ey{constructor(y,_,b){this.type=wr,this.lhs=y,this.rhs=_,this.collator=b,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const b=y[0];let T=_.parse(y[1],1,Ir);if(!T)return null;if(!ml(b,T.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${Q(T.type)}'.`);let M=_.parse(y[2],2,Ir);if(!M)return null;if(!ml(b,M.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${Q(M.type)}'.`);if(T.type.kind!==M.type.kind&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error(`Cannot compare types '${Q(T.type)}' and '${Q(M.type)}'.`);a&&(T.type.kind==="value"&&M.type.kind!=="value"?T=new Si(M.type,[T]):T.type.kind!=="value"&&M.type.kind==="value"&&(M=new Si(T.type,[M])));let O=null;if(y.length===4){if(T.type.kind!=="string"&&M.type.kind!=="string"&&T.type.kind!=="value"&&M.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(O=_.parse(y[3],3,An),!O)return null}return new Ey(T,M,O)}evaluate(y){const _=this.lhs.evaluate(y),b=this.rhs.evaluate(y);if(a&&this.hasUntypedArgument){const T=nn(_),M=nn(b);if(T.kind!==M.kind||T.kind!=="string"&&T.kind!=="number")throw new Mn(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const T=nn(_),M=nn(b);if(T.kind!=="string"||M.kind!=="string")return t(y,_,b)}return this.collator?n(y,_,b,this.collator.evaluate(y)):t(y,_,b)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const ac=Us("==",function(r,t,n){return t===n},Ql),Is=Us("!=",function(r,t,n){return t!==n},function(r,t,n,a){return!Ql(0,t,n,a)}),qo=Us("<",function(r,t,n){return t<n},function(r,t,n,a){return a.compare(t,n)<0}),$a=Us(">",function(r,t,n){return t>n},function(r,t,n,a){return a.compare(t,n)>0}),Tn=Us("<=",function(r,t,n){return t<=n},function(r,t,n,a){return a.compare(t,n)<=0}),Vs=Us(">=",function(r,t,n){return t>=n},function(r,t,n,a){return a.compare(t,n)>=0});class cs{constructor(t,n,a){this.type=An,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return n.error("Collator options argument must be an object.");const f=n.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,wr);if(!f)return null;const y=n.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,wr);if(!y)return null;let _=null;return a.locale&&(_=n.parse(a.locale,1,zr),!_)?null:new cs(f,y,_)}evaluate(t){return new bi(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class hs{constructor(t,n,a,f,y){this.type=zr,this.number=t,this.locale=n,this.currency=a,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const a=n.parse(t[1],1,Pt);if(!a)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return n.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=n.parse(f.locale,1,zr),!y))return null;let _=null;if(f.currency&&(_=n.parse(f.currency,1,zr),!_))return null;let b=null;if(f["min-fraction-digits"]&&(b=n.parse(f["min-fraction-digits"],1,Pt),!b))return null;let T=null;return f["max-fraction-digits"]&&(T=n.parse(f["max-fraction-digits"],1,Pt),!T)?null:new hs(a,y,_,b,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Hi{constructor(t){this.type=wi,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return n.error("First argument must be an image or text section.");const f=[];let y=!1;for(let _=1;_<=t.length-1;++_){const b=t[_];if(y&&typeof b=="object"&&!Array.isArray(b)){y=!1;let T=null;if(b["font-scale"]&&(T=n.parse(b["font-scale"],1,Pt),!T))return null;let M=null;if(b["text-font"]&&(M=n.parse(b["text-font"],1,ee(zr)),!M))return null;let O=null;if(b["text-color"]&&(O=n.parse(b["text-color"],1,_n),!O))return null;const V=f[f.length-1];V.scale=T,V.font=M,V.textColor=O}else{const T=n.parse(t[_],1,Ir);if(!T)return null;const M=T.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:T,scale:null,font:null,textColor:null})}}return new Hi(f)}evaluate(t){return new di(this.sections.map(n=>{const a=n.content.evaluate(t);return nn(a)===Nr?new zo("",a,null,null,null):new zo(lo(a),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}outputDefined(){return!1}}class wa{constructor(t){this.type=Nr,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const a=n.parse(t[1],1,zr);return a?new wa(a):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),a=Hn.fromString(n);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(n)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class uo{constructor(t){this.type=Pt,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=n.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Q(a.type)} instead.`):new uo(a):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new Mn(`Expected value to be of type string or array, but found ${Q(nn(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ts=8192;function ba(r,t){const n=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(n*f*ts),Math.round(a*f*ts)]}function Zo(r,t){const n=Math.pow(2,t.z);return[(f=(r[0]/ts+t.x)/n,360*f-180),(a=(r[1]/ts+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,f}function co(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Ai(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function sn(r,t,n){const a=r[0]-t[0],f=r[1]-t[1],y=r[0]-n[0],_=r[1]-n[1];return a*_-y*f==0&&a*y<=0&&f*_<=0}function Wo(r,t,n,a){return(f=[a[0]-n[0],a[1]-n[1]])[0]*(y=[t[0]-r[0],t[1]-r[1]])[1]-f[1]*y[0]!=0&&!(!Xo(r,t,n,a)||!Xo(n,a,r,t));var f,y}function Mu(r,t,n){for(const a of n)for(let f=0;f<a.length-1;++f)if(Wo(r,t,a[f],a[f+1]))return!0;return!1}function ds(r,t,n=!1){let a=!1;for(const b of t)for(let T=0;T<b.length-1;T++){if(sn(r,b[T],b[T+1]))return n;(y=b[T])[1]>(f=r)[1]!=(_=b[T+1])[1]>f[1]&&f[0]<(_[0]-y[0])*(f[1]-y[1])/(_[1]-y[1])+y[0]&&(a=!a)}var f,y,_;return a}function Ga(r,t){for(const n of t)if(ds(r,n))return!0;return!1}function Sa(r,t){for(const n of r)if(!ds(n,t))return!1;for(let n=0;n<r.length-1;++n)if(Mu(r[n],r[n+1],t))return!1;return!0}function Li(r,t){for(const n of t)if(Sa(r,n))return!0;return!1}function Xo(r,t,n,a){const f=a[0]-n[0],y=a[1]-n[1],_=(r[0]-n[0])*y-f*(r[1]-n[1]),b=(t[0]-n[0])*y-f*(t[1]-n[1]);return _>0&&b<0||_<0&&b>0}function ho(r,t,n){const a=[];for(let f=0;f<r.length;f++){const y=[];for(let _=0;_<r[f].length;_++){const b=ba(r[f][_],n);co(t,b),y.push(b)}a.push(y)}return a}function Ea(r,t,n){const a=[];for(let f=0;f<r.length;f++){const y=ho(r[f],t,n);a.push(y)}return a}function gl(r,t,n,a){if(r[0]<n[0]||r[0]>n[2]){const f=.5*a;let y=r[0]-n[0]>f?-a:n[0]-r[0]>f?a:0;y===0&&(y=r[0]-n[2]>f?-a:n[2]-r[0]>f?a:0),r[0]+=y}co(t,r)}function Ko(r,t,n,a){const f=Math.pow(2,a.z)*ts,y=[a.x*ts,a.y*ts],_=[];for(const b of r)for(const T of b){const M=[T.x+y[0],T.y+y[1]];gl(M,t,n,f),_.push(M)}return _}function Ro(r,t,n,a){const f=Math.pow(2,a.z)*ts,y=[a.x*ts,a.y*ts],_=[];for(const T of r){const M=[];for(const O of T){const V=[O.x+y[0],O.y+y[1]];co(t,V),M.push(V)}_.push(M)}if(t[2]-t[0]<=f/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const T of _)for(const M of T)gl(M,t,n,f)}var b;return _}class $i{constructor(t,n){this.type=wr,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qi(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const f=[];for(const y of a.features){const{type:_,coordinates:b}=y.geometry;_==="Polygon"&&f.push(b),_==="MultiPolygon"&&f.push(...b)}if(f.length)return new $i(a,{type:"MultiPolygon",coordinates:f})}else if(a.type==="Feature"){const f=a.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new $i(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new $i(a,a)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,a){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(a.type==="Polygon"){const b=ho(a.coordinates,y,_),T=Ko(n.geometry(),f,y,_);if(!Ai(f,y))return!1;for(const M of T)if(!ds(M,b))return!1}if(a.type==="MultiPolygon"){const b=Ea(a.coordinates,y,_),T=Ko(n.geometry(),f,y,_);if(!Ai(f,y))return!1;for(const M of T)if(!Ga(M,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,a){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(a.type==="Polygon"){const b=ho(a.coordinates,y,_),T=Ro(n.geometry(),f,y,_);if(!Ai(f,y))return!1;for(const M of T)if(!Sa(M,b))return!1}if(a.type==="MultiPolygon"){const b=Ea(a.coordinates,y,_),T=Ro(n.geometry(),f,y,_);if(!Ai(f,y))return!1;for(const M of T)if(!Li(M,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ta=class{constructor(r=[],t=(n,a)=>n<a?-1:n>a?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:t,compare:n}=this,a=t[r];for(;r>0;){const f=r-1>>1,y=t[f];if(n(a,y)>=0)break;t[r]=y,r=f}t[r]=a}_down(r){const{data:t,compare:n}=this,a=this.length>>1,f=t[r];for(;r<a;){let y=1+(r<<1);const _=y+1;if(_<this.length&&n(t[_],t[y])<0&&(y=_),n(t[y],f)>=0)break;t[r]=t[y],r=y}t[r]=f}};function eu(r,t,n,a,f){tu(r,t,n,a||r.length-1,f||rs)}function tu(r,t,n,a,f){for(;a>n;){if(a-n>600){var y=a-n+1,_=t-n+1,b=Math.log(y),T=.5*Math.exp(2*b/3),M=.5*Math.sqrt(b*T*(y-T)/y)*(_-y/2<0?-1:1);tu(r,t,Math.max(n,Math.floor(t-_*T/y+M)),Math.min(a,Math.floor(t+(y-_)*T/y+M)),f)}var O=r[t],V=n,Z=a;for(Yo(r,n,t),f(r[a],O)>0&&Yo(r,n,a);V<Z;){for(Yo(r,V,Z),V++,Z--;f(r[V],O)<0;)V++;for(;f(r[Z],O)>0;)Z--}f(r[n],O)===0?Yo(r,n,Z):Yo(r,++Z,a),Z<=t&&(n=Z+1),t<=Z&&(a=Z-1)}}function Yo(r,t,n){var a=r[t];r[t]=r[n],r[n]=a}function rs(r,t){return r<t?-1:r>t?1:0}function Jo(r,t){if(r.length<=1)return[r];const n=[];let a,f;for(const y of r){const _=lc(y);_!==0&&(y.area=Math.abs(_),f===void 0&&(f=_<0),f===_<0?(a&&n.push(a),a=[y]):a.push(y))}if(a&&n.push(a),t>1)for(let y=0;y<n.length;y++)n[y].length<=t||(eu(n[y],t,1,n[y].length-1,ru),n[y]=n[y].slice(0,t));return n}function ru(r,t){return t.area-r.area}function lc(r){let t=0;for(let n,a,f=0,y=r.length,_=y-1;f<y;_=f++)n=r[f],a=r[_],t+=(a.x-n.x)*(n.y+a.y);return t}const nu=1/298.257223563,qa=nu*(2-nu),iu=Math.PI/180;class Za{constructor(t){const n=6378.137*iu*1e3,a=Math.cos(t*iu),f=1/(1-qa*(1-a*a)),y=Math.sqrt(f);this.kx=n*y*a,this.ky=n*y*f*(1-qa)}distance(t,n){const a=this.wrap(t[0]-n[0])*this.kx,f=(t[1]-n[1])*this.ky;return Math.sqrt(a*a+f*f)}pointOnLine(t,n){let a,f,y,_,b=1/0;for(let T=0;T<t.length-1;T++){let M=t[T][0],O=t[T][1],V=this.wrap(t[T+1][0]-M)*this.kx,Z=(t[T+1][1]-O)*this.ky,te=0;V===0&&Z===0||(te=(this.wrap(n[0]-M)*this.kx*V+(n[1]-O)*this.ky*Z)/(V*V+Z*Z),te>1?(M=t[T+1][0],O=t[T+1][1]):te>0&&(M+=V/this.kx*te,O+=Z/this.ky*te)),V=this.wrap(n[0]-M)*this.kx,Z=(n[1]-O)*this.ky;const le=V*V+Z*Z;le<b&&(b=le,a=M,f=O,y=T,_=te)}return{point:[a,f],index:y,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Wa(r,t){return t[0]-r[0]}function Qo(r){return r[1]-r[0]+1}function Hs(r,t){return r[1]>=r[0]&&r[1]<t}function yl(r,t){if(r[0]>r[1])return[null,null];const n=Qo(r);if(t){if(n===2)return[r,null];const f=Math.floor(n/2);return[[r[0],r[0]+f],[r[0]+f,r[1]]]}if(n===1)return[r,null];const a=Math.floor(n/2)-1;return[[r[0],r[0]+a],[r[0]+a+1,r[1]]]}function ka(r,t){if(!Hs(t,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)co(n,r[a]);return n}function Xa(r){const t=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const a of n)co(t,a);return t}function Ka(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function D(r,t,n){if(!Ka(r)||!Ka(t))return NaN;let a=0,f=0;return r[2]<t[0]&&(a=t[0]-r[2]),r[0]>t[2]&&(a=r[0]-t[2]),r[1]>t[3]&&(f=r[1]-t[3]),r[3]<t[1]&&(f=t[1]-r[3]),n.distance([0,0],[a,f])}function X(r,t,n){const a=n.pointOnLine(t,r);return n.distance(r,a.point)}function ce(r,t,n,a,f){const y=Math.min(X(r,[n,a],f),X(t,[n,a],f)),_=Math.min(X(n,[r,t],f),X(a,[r,t],f));return Math.min(y,_)}function Te(r,t,n,a,f){if(!Hs(t,r.length)||!Hs(a,n.length))return 1/0;let y=1/0;for(let _=t[0];_<t[1];++_){const b=r[_],T=r[_+1];for(let M=a[0];M<a[1];++M){const O=n[M],V=n[M+1];if(Wo(b,T,O,V))return 0;y=Math.min(y,ce(b,T,O,V,f))}}return y}function tt(r,t,n,a,f){if(!Hs(t,r.length)||!Hs(a,n.length))return NaN;let y=1/0;for(let _=t[0];_<=t[1];++_)for(let b=a[0];b<=a[1];++b)if(y=Math.min(y,f.distance(r[_],n[b])),y===0)return y;return y}function at(r,t,n){if(ds(r,t,!0))return 0;let a=1/0;for(const f of t){const y=f[0],_=f[f.length-1];if(y!==_&&(a=Math.min(a,X(r,[_,y],n)),a===0))return a;const b=n.pointOnLine(f,r);if(a=Math.min(a,n.distance(r,b.point)),a===0)return a}return a}function ct(r,t,n,a){if(!Hs(t,r.length))return NaN;for(let y=t[0];y<=t[1];++y)if(ds(r[y],n,!0))return 0;let f=1/0;for(let y=t[0];y<t[1];++y){const _=r[y],b=r[y+1];for(const T of n)for(let M=0,O=T.length,V=O-1;M<O;V=M++){const Z=T[V],te=T[M];if(Wo(_,b,Z,te))return 0;f=Math.min(f,ce(_,b,Z,te,a))}}return f}function Ut(r,t){for(const n of r)for(const a of n)if(ds(a,t,!0))return!0;return!1}function ir(r,t,n,a=1/0){const f=Xa(r),y=Xa(t);if(a!==1/0&&D(f,y,n)>=a)return a;if(Ai(f,y)){if(Ut(r,t))return 0}else if(Ut(t,r))return 0;let _=1/0;for(const b of r)for(let T=0,M=b.length,O=M-1;T<M;O=T++){const V=b[O],Z=b[T];for(const te of t)for(let le=0,fe=te.length,Pe=fe-1;le<fe;Pe=le++){const De=te[Pe],rt=te[le];if(Wo(V,Z,De,rt))return 0;_=Math.min(_,ce(V,Z,De,rt,n))}}return _}function hr(r,t,n,a,f,y){if(!y)return;const _=D(ka(a,y),f,n);_<t&&r.push([_,y,[0,0]])}function Dr(r,t,n,a,f,y,_){if(!y||!_)return;const b=D(ka(a,y),ka(f,_),n);b<t&&r.push([b,y,_])}function pn(r,t,n,a,f=1/0){let y=Math.min(a.distance(r[0],n[0][0]),f);if(y===0)return y;const _=new Ta([[0,[0,r.length-1],[0,0]]],Wa),b=Xa(n);for(;_.length>0;){const T=_.pop();if(T[0]>=y)continue;const M=T[1],O=t?50:100;if(Qo(M)<=O){if(!Hs(M,r.length))return NaN;if(t){const V=ct(r,M,n,a);if(isNaN(V)||V===0)return V;y=Math.min(y,V)}else for(let V=M[0];V<=M[1];++V){const Z=at(r[V],n,a);if(y=Math.min(y,Z),y===0)return 0}}else{const V=yl(M,t);hr(_,y,a,r,b,V[0]),hr(_,y,a,r,b,V[1])}}return y}function yi(r,t,n,a,f,y=1/0){let _=Math.min(y,f.distance(r[0],n[0]));if(_===0)return _;const b=new Ta([[0,[0,r.length-1],[0,n.length-1]]],Wa);for(;b.length>0;){const T=b.pop();if(T[0]>=_)continue;const M=T[1],O=T[2],V=t?50:100,Z=a?50:100;if(Qo(M)<=V&&Qo(O)<=Z){if(!Hs(M,r.length)&&Hs(O,n.length))return NaN;let te;if(t&&a)te=Te(r,M,n,O,f),_=Math.min(_,te);else if(t&&!a){const le=r.slice(M[0],M[1]+1);for(let fe=O[0];fe<=O[1];++fe)if(te=X(n[fe],le,f),_=Math.min(_,te),_===0)return _}else if(!t&&a){const le=n.slice(O[0],O[1]+1);for(let fe=M[0];fe<=M[1];++fe)if(te=X(r[fe],le,f),_=Math.min(_,te),_===0)return _}else te=tt(r,M,n,O,f),_=Math.min(_,te)}else{const te=yl(M,t),le=yl(O,a);Dr(b,_,f,r,n,te[0],le[0]),Dr(b,_,f,r,n,te[0],le[1]),Dr(b,_,f,r,n,te[1],le[0]),Dr(b,_,f,r,n,te[1],le[1])}}return _}function Gi(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class _i{constructor(t,n){this.type=Pt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qi(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new _i(a,a.features.map(f=>Gi(f.geometry)).flat());if(a.type==="Feature")return new _i(a,Gi(a.geometry));if("type"in a&&"coordinates"in a)return new _i(a,Gi(a))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,a){const f=n.geometry(),y=f.flat().map(T=>Zo([T.x,T.y],n.canonical));if(f.length===0)return NaN;const _=new Za(y[0][1]);let b=1/0;for(const T of a){switch(T.type){case"Point":b=Math.min(b,yi(y,!1,[T.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,yi(y,!1,T.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,pn(y,!1,T.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,a){const f=n.geometry(),y=f.flat().map(T=>Zo([T.x,T.y],n.canonical));if(f.length===0)return NaN;const _=new Za(y[0][1]);let b=1/0;for(const T of a){switch(T.type){case"Point":b=Math.min(b,yi(y,!0,[T.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,yi(y,!0,T.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,pn(y,!0,T.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,a){const f=n.geometry();if(f.length===0||f[0].length===0)return NaN;const y=Jo(f,0).map(T=>T.map(M=>M.map(O=>Zo([O.x,O.y],n.canonical)))),_=new Za(y[0][0][0][1]);let b=1/0;for(const T of a)for(const M of y){switch(T.type){case"Point":b=Math.min(b,pn([T.coordinates],!1,M,_,b));break;case"LineString":b=Math.min(b,pn(T.coordinates,!0,M,_,b));break;case"Polygon":b=Math.min(b,ir(M,T.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const $s={"==":ac,"!=":Is,">":$a,"<":qo,">=":Vs,"<=":Tn,array:Si,at:st,boolean:Si,case:Rr,coalesce:Cs,collator:cs,format:Hi,image:wa,in:Et,"index-of":Ht,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:uo,let:Ee,literal:Di,match:Jt,number:Si,"number-format":hs,object:Si,slice:Vr,step:Ei,string:Si,"to-boolean":pi,"to-color":pi,"to-number":pi,"to-string":pi,var:Ye,within:$i,distance:_i};class qi{constructor(t,n,a,f){this.name=t,this.type=n,this._evaluate=a,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const a=t[0],f=qi.definitions[a];if(!f)return n.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,_=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=_.filter(([M])=>!Array.isArray(M)||M.length===t.length-1);let T=null;for(const[M,O]of b){T=new he(n.registry,_l,n.path,null,n.scope);const V=[];let Z=!1;for(let te=1;te<t.length;te++){const le=t[te],fe=Array.isArray(M)?M[te-1]:M.type,Pe=T.parse(le,1+V.length,fe);if(!Pe){Z=!0;break}V.push(Pe)}if(!Z)if(Array.isArray(M)&&M.length!==V.length)T.error(`Expected ${M.length} arguments, but found ${V.length} instead.`);else{for(let te=0;te<V.length;te++){const le=Array.isArray(M)?M[te]:M.type,fe=V[te];T.concat(te+1).checkSubtype(le,fe.type)}if(T.errors.length===0)return new qi(a,y,O,V)}}if(b.length===1)n.errors.push(...T.errors);else{const M=(b.length?b:_).map(([V])=>{return Z=V,Array.isArray(Z)?`(${Z.map(Q).join(", ")})`:`(${Q(Z.type)}...)`;var Z}).join(" | "),O=[];for(let V=1;V<t.length;V++){const Z=n.parse(t[V],1+O.length);if(!Z)return null;O.push(Q(Z.type))}n.error(`Expected arguments of type ${M}, but found (${O.join(", ")}) instead.`)}return null}static register(t,n){qi.definitions=n;for(const a in n)t[a]=qi}}function Gs(r,[t,n,a,f]){t=t.evaluate(r),n=n.evaluate(r),a=a.evaluate(r);const y=f?f.evaluate(r):1,_=fi(t,n,a,y);if(_)throw new Mn(_);return new Pr(t/255,n/255,a/255,y,!1)}function uc(r,t){return r in t}function cc(r,t){const n=t[r];return n===void 0?null:n}function Ya(r){return{type:r}}function _l(r){if(r instanceof Ye)return _l(r.boundExpression);if(r instanceof qi&&r.name==="error"||r instanceof cs||r instanceof $i||r instanceof _i)return!1;const t=r instanceof pi||r instanceof Si;let n=!0;return r.eachChild(a=>{n=t?n&&_l(a):n&&a instanceof Di}),!!n&&vl(r)&&ea(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function vl(r){if(r instanceof qi&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof $i||r instanceof _i)return!1;let t=!0;return r.eachChild(n=>{t&&!vl(n)&&(t=!1)}),t}function Do(r){if(r instanceof qi&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(n=>{t&&!Do(n)&&(t=!1)}),t}function ea(r,t){if(r instanceof qi&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(a=>{n&&!ea(a,t)&&(n=!1)}),n}function zu(r){return{result:"success",value:r}}function ta(r){return{result:"error",value:r}}function xl(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function hc(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function su(r){return!!r.expression&&r.expression.interpolated}function on(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function ou(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function dh(r){return r}function dc(r,t){const n=t.type==="color",a=r.stops&&typeof r.stops[0][0]=="object",f=a||!(a||r.property!==void 0),y=r.type||(su(t)?"exponential":"interval");if(n||t.type==="padding"){const O=n?Pr.parse:ei.parse;(r=xn({},r)).stops&&(r.stops=r.stops.map(V=>[V[0],O(V[1])])),r.default=O(r.default?r.default:t.default)}if(r.colorSpace&&(_=r.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var _;let b,T,M;if(y==="exponential")b=ph;else if(y==="interval")b=Ru;else if(y==="categorical"){b=fh,T=Object.create(null);for(const O of r.stops)T[O[0]]=O[1];M=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=mh}if(a){const O={},V=[];for(let le=0;le<r.stops.length;le++){const fe=r.stops[le],Pe=fe[0].zoom;O[Pe]===void 0&&(O[Pe]={zoom:Pe,type:r.type,property:r.property,default:r.default,stops:[]},V.push(Pe)),O[Pe].stops.push([fe[0].value,fe[1]])}const Z=[];for(const le of V)Z.push([O[le].zoom,dc(O[le],t)]);const te={name:"linear"};return{kind:"composite",interpolationType:te,interpolationFactor:zn.interpolationFactor.bind(void 0,te),zoomStops:Z.map(le=>le[0]),evaluate:({zoom:le},fe)=>ph({stops:Z,base:r.base},t,le).evaluate(le,fe)}}if(f){const O=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:zn.interpolationFactor.bind(void 0,O),zoomStops:r.stops.map(V=>V[0]),evaluate:({zoom:V})=>b(r,t,V,T,M)}}return{kind:"source",evaluate(O,V){const Z=V&&V.properties?V.properties[r.property]:void 0;return Z===void 0?wl(r.default,t.default):b(r,t,Z,T,M)}}}function wl(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function fh(r,t,n,a,f){return wl(typeof n===f?a[n]:void 0,r.default,t.default)}function Ru(r,t,n){if(on(n)!=="number")return wl(r.default,t.default);const a=r.stops.length;if(a===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[a-1][0])return r.stops[a-1][1];const f=fn(r.stops.map(y=>y[0]),n);return r.stops[f][1]}function ph(r,t,n){const a=r.base!==void 0?r.base:1;if(on(n)!=="number")return wl(r.default,t.default);const f=r.stops.length;if(f===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[f-1][0])return r.stops[f-1][1];const y=fn(r.stops.map(O=>O[0]),n),_=function(O,V,Z,te){const le=te-Z,fe=O-Z;return le===0?0:V===1?fe/le:(Math.pow(V,fe)-1)/(Math.pow(V,le)-1)}(n,a,r.stops[y][0],r.stops[y+1][0]),b=r.stops[y][1],T=r.stops[y+1][1],M=On[t.type]||dh;return typeof b.evaluate=="function"?{evaluate(...O){const V=b.evaluate.apply(void 0,O),Z=T.evaluate.apply(void 0,O);if(V!==void 0&&Z!==void 0)return M(V,Z,_,r.colorSpace)}}:M(b,T,_,r.colorSpace)}function mh(r,t,n){switch(t.type){case"color":n=Pr.parse(n);break;case"formatted":n=di.fromString(n.toString());break;case"resolvedImage":n=Hn.fromString(n.toString());break;case"padding":n=ei.parse(n);break;default:on(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return wl(n,r.default,t.default)}qi.register($s,{error:[{kind:"error"},[zr],(r,[t])=>{throw new Mn(t.evaluate(r))}],typeof:[zr,[Ir],(r,[t])=>Q(nn(t.evaluate(r)))],"to-rgba":[ee(Pt,4),[_n],(r,[t])=>{const[n,a,f,y]=t.evaluate(r).rgb;return[255*n,255*a,255*f,y]}],rgb:[_n,[Pt,Pt,Pt],Gs],rgba:[_n,[Pt,Pt,Pt,Pt],Gs],has:{type:wr,overloads:[[[zr],(r,[t])=>uc(t.evaluate(r),r.properties())],[[zr,ci],(r,[t,n])=>uc(t.evaluate(r),n.evaluate(r))]]},get:{type:Ir,overloads:[[[zr],(r,[t])=>cc(t.evaluate(r),r.properties())],[[zr,ci],(r,[t,n])=>cc(t.evaluate(r),n.evaluate(r))]]},"feature-state":[Ir,[zr],(r,[t])=>cc(t.evaluate(r),r.featureState||{})],properties:[ci,[],r=>r.properties()],"geometry-type":[zr,[],r=>r.geometryType()],id:[Ir,[],r=>r.id()],zoom:[Pt,[],r=>r.globals.zoom],"heatmap-density":[Pt,[],r=>r.globals.heatmapDensity||0],"line-progress":[Pt,[],r=>r.globals.lineProgress||0],accumulated:[Ir,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Pt,Ya(Pt),(r,t)=>{let n=0;for(const a of t)n+=a.evaluate(r);return n}],"*":[Pt,Ya(Pt),(r,t)=>{let n=1;for(const a of t)n*=a.evaluate(r);return n}],"-":{type:Pt,overloads:[[[Pt,Pt],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[Pt],(r,[t])=>-t.evaluate(r)]]},"/":[Pt,[Pt,Pt],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[Pt,[Pt,Pt],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[Pt,[],()=>Math.LN2],pi:[Pt,[],()=>Math.PI],e:[Pt,[],()=>Math.E],"^":[Pt,[Pt,Pt],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[Pt,[Pt],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Pt,[Pt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Pt,[Pt],(r,[t])=>Math.log(t.evaluate(r))],log2:[Pt,[Pt],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Pt,[Pt],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Pt,[Pt],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Pt,[Pt],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Pt,[Pt],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Pt,[Pt],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Pt,[Pt],(r,[t])=>Math.atan(t.evaluate(r))],min:[Pt,Ya(Pt),(r,t)=>Math.min(...t.map(n=>n.evaluate(r)))],max:[Pt,Ya(Pt),(r,t)=>Math.max(...t.map(n=>n.evaluate(r)))],abs:[Pt,[Pt],(r,[t])=>Math.abs(t.evaluate(r))],round:[Pt,[Pt],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Pt,[Pt],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Pt,[Pt],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[wr,[zr,Ir],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[wr,[Ir],(r,[t])=>r.id()===t.value],"filter-type-==":[wr,[zr],(r,[t])=>r.geometryType()===t.value],"filter-<":[wr,[zr,Ir],(r,[t,n])=>{const a=r.properties()[t.value],f=n.value;return typeof a==typeof f&&a<f}],"filter-id-<":[wr,[Ir],(r,[t])=>{const n=r.id(),a=t.value;return typeof n==typeof a&&n<a}],"filter->":[wr,[zr,Ir],(r,[t,n])=>{const a=r.properties()[t.value],f=n.value;return typeof a==typeof f&&a>f}],"filter-id->":[wr,[Ir],(r,[t])=>{const n=r.id(),a=t.value;return typeof n==typeof a&&n>a}],"filter-<=":[wr,[zr,Ir],(r,[t,n])=>{const a=r.properties()[t.value],f=n.value;return typeof a==typeof f&&a<=f}],"filter-id-<=":[wr,[Ir],(r,[t])=>{const n=r.id(),a=t.value;return typeof n==typeof a&&n<=a}],"filter->=":[wr,[zr,Ir],(r,[t,n])=>{const a=r.properties()[t.value],f=n.value;return typeof a==typeof f&&a>=f}],"filter-id->=":[wr,[Ir],(r,[t])=>{const n=r.id(),a=t.value;return typeof n==typeof a&&n>=a}],"filter-has":[wr,[Ir],(r,[t])=>t.value in r.properties()],"filter-has-id":[wr,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[wr,[ee(zr)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[wr,[ee(Ir)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[wr,[zr,ee(Ir)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[wr,[zr,ee(Ir)],(r,[t,n])=>function(a,f,y,_){for(;y<=_;){const b=y+_>>1;if(f[b]===a)return!0;f[b]>a?_=b-1:y=b+1}return!1}(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:wr,overloads:[[[wr,wr],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[Ya(wr),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:wr,overloads:[[[wr,wr],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[Ya(wr),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[wr,[wr],(r,[t])=>!t.evaluate(r)],"is-supported-script":[wr,[zr],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[zr,[zr],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[zr,[zr],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[zr,Ya(Ir),(r,t)=>t.map(n=>lo(n.evaluate(r))).join("")],"resolved-locale":[zr,[An],(r,[t])=>t.evaluate(r).resolvedLocale()]});class fs{constructor(t,n){var a;this.expression=t,this._warningHistory={},this._evaluator=new Y,this._defaultValue=n?(a=n).type==="color"&&ou(a.default)?new Pr(0,0,0,0):a.type==="color"?Pr.parse(a.default)||null:a.type==="padding"?ei.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?ti.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,a,f,y,_){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=a,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,n,a,f,y,_){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=a||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Mn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Ca(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in $s}function Ja(r,t){const n=new he($s,_l,[],t?function(f){const y={color:_n,string:zr,number:Pt,enum:zr,boolean:wr,formatted:wi,padding:Xn,resolvedImage:Nr,variableAnchorOffsetCollection:Ce};return f.type==="array"?ee(y[f.value]||Ir,f.length):y[f.type]}(t):void 0),a=n.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?zu(new fs(a,t)):ta(n.errors)}class Qa{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!Do(n.expression)}evaluateWithoutErrorHandling(t,n,a,f,y,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,a,f,y,_)}evaluate(t,n,a,f,y,_){return this._styleExpression.evaluate(t,n,a,f,y,_)}}class el{constructor(t,n,a,f){this.kind=t,this.zoomStops=a,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!Do(n.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,n,a,f,y,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,a,f,y,_)}evaluate(t,n,a,f,y,_){return this._styleExpression.evaluate(t,n,a,f,y,_)}interpolationFactor(t,n,a){return this.interpolationType?zn.interpolationFactor(this.interpolationType,t,n,a):0}}function Du(r,t){const n=Ja(r,t);if(n.result==="error")return n;const a=n.value.expression,f=vl(a);if(!f&&!xl(t))return ta([new yn("","data expressions not supported")]);const y=ea(a,["zoom"]);if(!y&&!hc(t))return ta([new yn("","zoom expressions not supported")]);const _=au(a);return _||y?_ instanceof yn?ta([_]):_ instanceof zn&&!su(t)?ta([new yn("",'"interpolate" expressions cannot be used with this property')]):zu(_?new el(f?"camera":"composite",n.value,_.labels,_ instanceof zn?_.interpolation:void 0):new Qa(f?"constant":"source",n.value)):ta([new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ia{constructor(t,n){this._parameters=t,this._specification=n,xn(this,dc(this._parameters,this._specification))}static deserialize(t){return new Ia(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function au(r){let t=null;if(r instanceof Ee)t=au(r.result);else if(r instanceof Cs){for(const n of r.args)if(t=au(n),t)break}else(r instanceof Ei||r instanceof zn)&&r.input instanceof qi&&r.input.name==="zoom"&&(t=r);return t instanceof yn||r.eachChild(n=>{const a=au(n);a instanceof yn?t=a:!t&&a?t=new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new yn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Lu(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Lu(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const ra={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function lu(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Lu(r)||(r=cu(r));const t=Ja(r,ra);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,a,f)=>t.value.evaluate(n,a,{},f),needGeometry:Fu(r)}}function uu(r,t){return r<t?-1:r>t?1:0}function Fu(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Fu(r[t]))return!0;return!1}function cu(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?bl(r[1],r[2],"=="):t==="!="?Fi(bl(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?bl(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map(cu))):t==="all"?["all"].concat(r.slice(1).map(cu)):t==="none"?["all"].concat(r.slice(1).map(cu).map(Fi)):t==="in"?Lo(r[1],r.slice(2)):t==="!in"?Fi(Lo(r[1],r.slice(2))):t==="has"?tl(r[1]):t!=="!has"||Fi(tl(r[1]));var n}function bl(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function Lo(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",r,["literal",t.sort(uu)]]:["filter-in-small",r,["literal",t]]}}function tl(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Fi(r){return["!",r]}function Fo(r){const t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let f="[";for(const y of r)f+=`${Fo(y)},`;return`${f}]`}const n=Object.keys(r).sort();let a="{";for(let f=0;f<n.length;f++)a+=`${JSON.stringify(n[f])}:${Fo(r[n[f]])},`;return`${a}}`}function fc(r){let t="";for(const n of Me)t+=`/${Fo(r[n])}`;return t}function pc(r){const t=r.value;return t?[new vt(r.key,t,"constants have been deprecated as of v8")]:[]}function Yn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function qs(r){if(Array.isArray(r))return r.map(qs);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=qs(r[n]);return t}return Yn(r)}function ps(r){const t=r.key,n=r.value,a=r.valueSpec||{},f=r.objectElementValidators||{},y=r.style,_=r.styleSpec,b=r.validateSpec;let T=[];const M=on(n);if(M!=="object")return[new vt(t,n,`object expected, ${M} found`)];for(const O in n){const V=O.split(".")[0],Z=a[V]||a["*"];let te;if(f[V])te=f[V];else if(a[V])te=b;else if(f["*"])te=f["*"];else{if(!a["*"]){T.push(new vt(t,n[O],`unknown property "${O}"`));continue}te=b}T=T.concat(te({key:(t&&`${t}.`)+O,value:n[O],valueSpec:Z,style:y,styleSpec:_,object:n,objectKey:O,validateSpec:b},n))}for(const O in a)f[O]||a[O].required&&a[O].default===void 0&&n[O]===void 0&&T.push(new vt(t,n,`missing required property "${O}"`));return T}function Sl(r){const t=r.value,n=r.valueSpec,a=r.style,f=r.styleSpec,y=r.key,_=r.arrayElementValidator||r.validateSpec;if(on(t)!=="array")return[new vt(y,t,`array expected, ${on(t)} found`)];if(n.length&&t.length!==n.length)return[new vt(y,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new vt(y,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let b={type:n.value,values:n.values};f.$version<7&&(b.function=n.function),on(n.value)==="object"&&(b=n.value);let T=[];for(let M=0;M<t.length;M++)T=T.concat(_({array:t,arrayIndex:M,value:t[M],valueSpec:b,validateSpec:r.validateSpec,style:a,styleSpec:f,key:`${y}[${M}]`}));return T}function Oo(r){const t=r.key,n=r.value,a=r.valueSpec;let f=on(n);return f==="number"&&n!=n&&(f="NaN"),f!=="number"?[new vt(t,n,`number expected, ${f} found`)]:"minimum"in a&&n<a.minimum?[new vt(t,n,`${n} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&n>a.maximum?[new vt(t,n,`${n} is greater than the maximum value ${a.maximum}`)]:[]}function El(r){const t=r.valueSpec,n=Yn(r.value.type);let a,f,y,_={};const b=n!=="categorical"&&r.value.property===void 0,T=!b,M=on(r.value.stops)==="array"&&on(r.value.stops[0])==="array"&&on(r.value.stops[0][0])==="object",O=ps({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(te){if(n==="identity")return[new vt(te.key,te.value,'identity function may not have a "stops" property')];let le=[];const fe=te.value;return le=le.concat(Sl({key:te.key,value:fe,valueSpec:te.valueSpec,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:V})),on(fe)==="array"&&fe.length===0&&le.push(new vt(te.key,fe,"array must have at least one stop")),le},default:function(te){return te.validateSpec({key:te.key,value:te.value,valueSpec:t,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec})}}});return n==="identity"&&b&&O.push(new vt(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||O.push(new vt(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!su(r.valueSpec)&&O.push(new vt(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!xl(r.valueSpec)?O.push(new vt(r.key,r.value,"property functions not supported")):b&&!hc(r.valueSpec)&&O.push(new vt(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!M||r.value.property!==void 0||O.push(new vt(r.key,r.value,'"property" property is required')),O;function V(te){let le=[];const fe=te.value,Pe=te.key;if(on(fe)!=="array")return[new vt(Pe,fe,`array expected, ${on(fe)} found`)];if(fe.length!==2)return[new vt(Pe,fe,`array length 2 expected, length ${fe.length} found`)];if(M){if(on(fe[0])!=="object")return[new vt(Pe,fe,`object expected, ${on(fe[0])} found`)];if(fe[0].zoom===void 0)return[new vt(Pe,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new vt(Pe,fe,"object stop key must have value")];if(y&&y>Yn(fe[0].zoom))return[new vt(Pe,fe[0].zoom,"stop zoom values must appear in ascending order")];Yn(fe[0].zoom)!==y&&(y=Yn(fe[0].zoom),f=void 0,_={}),le=le.concat(ps({key:`${Pe}[0]`,value:fe[0],valueSpec:{zoom:{}},validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Oo,value:Z}}))}else le=le.concat(Z({key:`${Pe}[0]`,value:fe[0],validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec},fe));return Ca(qs(fe[1]))?le.concat([new vt(`${Pe}[1]`,fe[1],"expressions are not allowed in function stops.")]):le.concat(te.validateSpec({key:`${Pe}[1]`,value:fe[1],valueSpec:t,validateSpec:te.validateSpec,style:te.style,styleSpec:te.styleSpec}))}function Z(te,le){const fe=on(te.value),Pe=Yn(te.value),De=te.value!==null?te.value:le;if(a){if(fe!==a)return[new vt(te.key,De,`${fe} stop domain type must match previous stop domain type ${a}`)]}else a=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean")return[new vt(te.key,De,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&n!=="categorical"){let rt=`number expected, ${fe} found`;return xl(t)&&n===void 0&&(rt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vt(te.key,De,rt)]}return n!=="categorical"||fe!=="number"||isFinite(Pe)&&Math.floor(Pe)===Pe?n!=="categorical"&&fe==="number"&&f!==void 0&&Pe<f?[new vt(te.key,De,"stop domain values must appear in ascending order")]:(f=Pe,n==="categorical"&&Pe in _?[new vt(te.key,De,"stop domain values must be unique")]:(_[Pe]=!0,[])):[new vt(te.key,De,`integer expected, found ${Pe}`)]}}function Pa(r){const t=(r.expressionContext==="property"?Du:Ja)(qs(r.value),r.valueSpec);if(t.result==="error")return t.value.map(a=>new vt(`${r.key}${a.key}`,r.value,a.message));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new vt(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Do(n))return[new vt(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Do(n))return[new vt(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!ea(n,["zoom","feature-state"]))return[new vt(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!vl(n))return[new vt(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function na(r){const t=r.key,n=r.value,a=r.valueSpec,f=[];return Array.isArray(a.values)?a.values.indexOf(Yn(n))===-1&&f.push(new vt(t,n,`expected one of [${a.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(a.values).indexOf(Yn(n))===-1&&f.push(new vt(t,n,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(n)} found`)),f}function mc(r){return Lu(qs(r.value))?Pa(xn({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Aa(r)}function Aa(r){const t=r.value,n=r.key;if(on(t)!=="array")return[new vt(n,t,`array expected, ${on(t)} found`)];const a=r.styleSpec;let f,y=[];if(t.length<1)return[new vt(n,t,"filter array must have at least 1 element")];switch(y=y.concat(na({key:`${n}[0]`,value:t[0],valueSpec:a.filter_operator,style:r.style,styleSpec:r.styleSpec})),Yn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Yn(t[1])==="$type"&&y.push(new vt(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&y.push(new vt(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=on(t[1]),f!=="string"&&y.push(new vt(`${n}[1]`,t[1],`string expected, ${f} found`)));for(let _=2;_<t.length;_++)f=on(t[_]),Yn(t[1])==="$type"?y=y.concat(na({key:`${n}[${_}]`,value:t[_],valueSpec:a.geometry_type,style:r.style,styleSpec:r.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new vt(`${n}[${_}]`,t[_],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)y=y.concat(Aa({key:`${n}[${_}]`,value:t[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":f=on(t[1]),t.length!==2?y.push(new vt(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new vt(`${n}[1]`,t[1],`string expected, ${f} found`))}return y}function gc(r,t){const n=r.key,a=r.validateSpec,f=r.style,y=r.styleSpec,_=r.value,b=r.objectKey,T=y[`${t}_${r.layerType}`];if(!T)return[];const M=b.match(/^(.*)-transition$/);if(t==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return a({key:n,value:_,valueSpec:y.transition,style:f,styleSpec:y});const O=r.valueSpec||T[b];if(!O)return[new vt(n,_,`unknown property "${b}"`)];let V;if(on(_)==="string"&&xl(O)&&!O.tokens&&(V=/^{([^}]+)}$/.exec(_)))return[new vt(n,_,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const Z=[];return r.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&Z.push(new vt(n,_,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&ou(qs(_))&&Yn(_.type)==="identity"&&Z.push(new vt(n,_,'"text-font" does not support identity functions'))),Z.concat(a({key:r.key,value:_,valueSpec:O,style:f,styleSpec:y,expressionContext:"property",propertyType:t,propertyKey:b}))}function hu(r){return gc(r,"paint")}function Ou(r){return gc(r,"layout")}function Rn(r){let t=[];const n=r.value,a=r.key,f=r.style,y=r.styleSpec;n.type||n.ref||t.push(new vt(a,n,'either "type" or "ref" is required'));let _=Yn(n.type);const b=Yn(n.ref);if(n.id){const T=Yn(n.id);for(let M=0;M<r.arrayIndex;M++){const O=f.layers[M];Yn(O.id)===T&&t.push(new vt(a,n.id,`duplicate layer id "${n.id}", previously used at line ${O.id.__line__}`))}}if("ref"in n){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in n&&t.push(new vt(a,n[M],`"${M}" is prohibited for ref layers`))}),f.layers.forEach(M=>{Yn(M.id)===b&&(T=M)}),T?T.ref?t.push(new vt(a,n.ref,"ref cannot reference another ref layer")):_=Yn(T.type):t.push(new vt(a,n.ref,`ref layer "${b}" not found`))}else if(_!=="background")if(n.source){const T=f.sources&&f.sources[n.source],M=T&&Yn(T.type);T?M==="vector"&&_==="raster"?t.push(new vt(a,n.source,`layer "${n.id}" requires a raster source`)):M!=="raster-dem"&&_==="hillshade"?t.push(new vt(a,n.source,`layer "${n.id}" requires a raster-dem source`)):M==="raster"&&_!=="raster"?t.push(new vt(a,n.source,`layer "${n.id}" requires a vector source`)):M!=="vector"||n["source-layer"]?M==="raster-dem"&&_!=="hillshade"?t.push(new vt(a,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!n.paint||!n.paint["line-gradient"]||M==="geojson"&&T.lineMetrics||t.push(new vt(a,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new vt(a,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new vt(a,n.source,`source "${n.source}" not found`))}else t.push(new vt(a,n,'missing required property "source"'));return t=t.concat(ps({key:a,value:n,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${a}.type`,value:n.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:mc,layout:T=>ps({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>Ou(xn({layerType:_},M))}}),paint:T=>ps({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":M=>hu(xn({layerType:_},M))}})}})),t}function ia(r){const t=r.value,n=r.key,a=on(t);return a!=="string"?[new vt(n,t,`string expected, ${a} found`)]:[]}const rl={promoteId:function({key:r,value:t}){if(on(t)==="string")return ia({key:r,value:t});{const n=[];for(const a in t)n.push(...ia({key:`${r}.${a}`,value:t[a]}));return n}}};function sa(r){const t=r.value,n=r.key,a=r.styleSpec,f=r.style,y=r.validateSpec;if(!t.type)return[new vt(n,t,'"type" is required')];const _=Yn(t.type);let b;switch(_){case"vector":case"raster":return b=ps({key:n,value:t,valueSpec:a[`source_${_.replace("-","_")}`],style:r.style,styleSpec:a,objectElementValidators:rl,validateSpec:y}),b;case"raster-dem":return b=function(T){var M;const O=(M=T.sourceName)!==null&&M!==void 0?M:"",V=T.value,Z=T.styleSpec,te=Z.source_raster_dem,le=T.style;let fe=[];const Pe=on(V);if(V===void 0)return fe;if(Pe!=="object")return fe.push(new vt("source_raster_dem",V,`object expected, ${Pe} found`)),fe;const De=Yn(V.encoding)==="custom",rt=["redFactor","greenFactor","blueFactor","baseShift"],Ue=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const Qe in V)!De&&rt.includes(Qe)?fe.push(new vt(Qe,V[Qe],`In "${O}": "${Qe}" is only valid when "encoding" is set to "custom". ${Ue} encoding found`)):te[Qe]?fe=fe.concat(T.validateSpec({key:Qe,value:V[Qe],valueSpec:te[Qe],validateSpec:T.validateSpec,style:le,styleSpec:Z})):fe.push(new vt(Qe,V[Qe],`unknown property "${Qe}"`));return fe}({sourceName:n,value:t,style:r.style,styleSpec:a,validateSpec:y}),b;case"geojson":if(b=ps({key:n,value:t,valueSpec:a.source_geojson,style:f,styleSpec:a,validateSpec:y,objectElementValidators:rl}),t.cluster)for(const T in t.clusterProperties){const[M,O]=t.clusterProperties[T],V=typeof M=="string"?[M,["accumulated"],["get",T]]:M;b.push(...Pa({key:`${n}.${T}.map`,value:O,expressionContext:"cluster-map"})),b.push(...Pa({key:`${n}.${T}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return b;case"video":return ps({key:n,value:t,valueSpec:a.source_video,style:f,validateSpec:y,styleSpec:a});case"image":return ps({key:n,value:t,valueSpec:a.source_image,style:f,validateSpec:y,styleSpec:a});case"canvas":return[new vt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return na({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Bu(r){const t=r.value,n=r.styleSpec,a=n.light,f=r.style;let y=[];const _=on(t);if(t===void 0)return y;if(_!=="object")return y=y.concat([new vt("light",t,`object expected, ${_} found`)]),y;for(const b in t){const T=b.match(/^(.*)-transition$/);y=y.concat(T&&a[T[1]]&&a[T[1]].transition?r.validateSpec({key:b,value:t[b],valueSpec:n.transition,validateSpec:r.validateSpec,style:f,styleSpec:n}):a[b]?r.validateSpec({key:b,value:t[b],valueSpec:a[b],validateSpec:r.validateSpec,style:f,styleSpec:n}):[new vt(b,t[b],`unknown property "${b}"`)])}return y}function du(r){const t=r.value,n=r.styleSpec,a=n.sky,f=r.style,y=on(t);if(t===void 0)return[];if(y!=="object")return[new vt("sky",t,`object expected, ${y} found`)];let _=[];for(const b in t)_=_.concat(a[b]?r.validateSpec({key:b,value:t[b],valueSpec:a[b],style:f,styleSpec:n}):[new vt(b,t[b],`unknown property "${b}"`)]);return _}function nl(r){const t=r.value,n=r.styleSpec,a=n.terrain,f=r.style;let y=[];const _=on(t);if(t===void 0)return y;if(_!=="object")return y=y.concat([new vt("terrain",t,`object expected, ${_} found`)]),y;for(const b in t)y=y.concat(a[b]?r.validateSpec({key:b,value:t[b],valueSpec:a[b],validateSpec:r.validateSpec,style:f,styleSpec:n}):[new vt(b,t[b],`unknown property "${b}"`)]);return y}function Tl(r){let t=[];const n=r.value,a=r.key;if(Array.isArray(n)){const f=[],y=[];for(const _ in n)n[_].id&&f.includes(n[_].id)&&t.push(new vt(a,n,`all the sprites' ids must be unique, but ${n[_].id} is duplicated`)),f.push(n[_].id),n[_].url&&y.includes(n[_].url)&&t.push(new vt(a,n,`all the sprites' URLs must be unique, but ${n[_].url} is duplicated`)),y.push(n[_].url),t=t.concat(ps({key:`${a}[${_}]`,value:n[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return ia({key:a,value:n})}const oa={"*":()=>[],array:Sl,boolean:function(r){const t=r.value,n=r.key,a=on(t);return a!=="boolean"?[new vt(n,t,`boolean expected, ${a} found`)]:[]},number:Oo,color:function(r){const t=r.key,n=r.value,a=on(n);return a!=="string"?[new vt(t,n,`color expected, ${a} found`)]:Pr.parse(String(n))?[]:[new vt(t,n,`color expected, "${n}" found`)]},constants:pc,enum:na,filter:mc,function:El,layer:Rn,object:ps,source:sa,light:Bu,sky:du,terrain:nl,projection:function(r){const t=r.value,n=r.styleSpec,a=n.projection,f=r.style,y=on(t);if(t===void 0)return[];if(y!=="object")return[new vt("projection",t,`object expected, ${y} found`)];let _=[];for(const b in t)_=_.concat(a[b]?r.validateSpec({key:b,value:t[b],valueSpec:a[b],style:f,styleSpec:n}):[new vt(b,t[b],`unknown property "${b}"`)]);return _},string:ia,formatted:function(r){return ia(r).length===0?[]:Pa(r)},resolvedImage:function(r){return ia(r).length===0?[]:Pa(r)},padding:function(r){const t=r.key,n=r.value;if(on(n)==="array"){if(n.length<1||n.length>4)return[new vt(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const a={type:"number"};let f=[];for(let y=0;y<n.length;y++)f=f.concat(r.validateSpec({key:`${t}[${y}]`,value:n[y],validateSpec:r.validateSpec,valueSpec:a}));return f}return Oo({key:t,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(r){const t=r.key,n=r.value,a=on(n),f=r.styleSpec;if(a!=="array"||n.length<1||n.length%2!=0)return[new vt(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<n.length;_+=2)y=y.concat(na({key:`${t}[${_}]`,value:n[_],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(Sl({key:`${t}[${_+1}]`,value:n[_+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:f}));return y},sprite:Tl};function kl(r){const t=r.value,n=r.valueSpec,a=r.styleSpec;return r.validateSpec=kl,n.expression&&ou(Yn(t))?El(r):n.expression&&Ca(qs(t))?Pa(r):n.type&&oa[n.type]?oa[n.type](r):ps(xn({},r,{valueSpec:n.type?a[n.type]:n}))}function gh(r){const t=r.value,n=r.key,a=ia(r);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new vt(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new vt(n,t,'"glyphs" url must include a "{range}" token'))),a}function Zs(r,t=ye){let n=[];return n=n.concat(kl({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:kl,objectElementValidators:{glyphs:gh,"*":()=>[]}})),r.constants&&(n=n.concat(pc({key:"constants",value:r.constants}))),Cl(n)}function fo(r){return function(t){return r({...t,validateSpec:kl})}}function Cl(r){return[].concat(r).sort((t,n)=>t.line-n.line)}function ms(r){return function(...t){return Cl(r.apply(this,t))}}Zs.source=ms(fo(sa)),Zs.sprite=ms(fo(Tl)),Zs.glyphs=ms(fo(gh)),Zs.light=ms(fo(Bu)),Zs.sky=ms(fo(du)),Zs.terrain=ms(fo(nl)),Zs.layer=ms(fo(Rn)),Zs.filter=ms(fo(mc)),Zs.paintProperty=ms(fo(hu)),Zs.layoutProperty=ms(fo(Ou));const aa=Zs,yc=aa.light,_c=aa.sky,Nu=aa.paintProperty,yh=aa.layoutProperty;function ju(r,t){let n=!1;if(t&&t.length)for(const a of t)r.fire(new W(new Error(a.message))),n=!0;return n}class Il{constructor(t,n,a){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(n=_[1])+2*(a=_[2]);for(let T=0;T<this.d*this.d;T++){const M=_[3+T],O=_[3+T+1];f.push(M===O?null:_.subarray(M,O))}const b=_[3+f.length+1];this.keys=_.subarray(_[3+f.length],b),this.bboxes=_.subarray(b),this.insert=this._insertReadonly}else{this.d=n+2*a;for(let _=0;_<this.d*this.d;_++)f.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=a,this.scale=n/t,this.uid=0;const y=a/n*t;this.min=-y,this.max=t+y}insert(t,n,a,f,y){this._forEachCell(n,a,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(a),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,a,f,y,_){this.cells[y].push(_)}query(t,n,a,f,y){const _=this.min,b=this.max;if(t<=_&&n<=_&&b<=a&&b<=f&&!y)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,n,a,f,this._queryCell,T,{},y),T}}_queryCell(t,n,a,f,y,_,b,T){const M=this.cells[y];if(M!==null){const O=this.keys,V=this.bboxes;for(let Z=0;Z<M.length;Z++){const te=M[Z];if(b[te]===void 0){const le=4*te;(T?T(V[le+0],V[le+1],V[le+2],V[le+3]):t<=V[le+2]&&n<=V[le+3]&&a>=V[le+0]&&f>=V[le+1])?(b[te]=!0,_.push(O[te])):b[te]=!1}}}}_forEachCell(t,n,a,f,y,_,b,T){const M=this._convertToCellCoord(t),O=this._convertToCellCoord(n),V=this._convertToCellCoord(a),Z=this._convertToCellCoord(f);for(let te=M;te<=V;te++)for(let le=O;le<=Z;le++){const fe=this.d*le+te;if((!T||T(this._convertFromCellCoord(te),this._convertFromCellCoord(le),this._convertFromCellCoord(te+1),this._convertFromCellCoord(le+1)))&&y.call(this,t,n,a,f,fe,_,b,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let a=0;for(let _=0;_<this.cells.length;_++)a+=this.cells[_].length;const f=new Int32Array(n+a+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=n;for(let _=0;_<t.length;_++){const b=t[_];f[3+_]=y,f.set(b,y),y+=b.length}return f[3+t.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+t.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(t,n){const a=t.toArrayBuffer();return n&&n.push(a),{buffer:a}}static deserialize(t){return new Il(t.buffer)}}const Ws={};function sr(r,t,n={}){if(Ws[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Ws[r]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}sr("Object",Object),sr("TransferableGridIndex",Il),sr("Color",Pr),sr("Error",Error),sr("AJAXError",fr),sr("ResolvedImage",Hn),sr("StylePropertyFunction",Ia),sr("StyleExpression",fs,{omit:["_evaluator"]}),sr("ZoomDependentExpression",el),sr("ZoomConstantExpression",Qa),sr("CompoundExpression",qi,{omit:["_evaluate"]});for(const r in $s)$s[r]._classRegistryKey||sr(`Expression_${r}`,$s[r]);function po(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Uu(r){return r.$name||r.constructor._classRegistryKey}function il(r){return!function(t){if(t===null||typeof t!="object")return!1;const n=Uu(t);return!(!n||n==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||po(r)||Ae(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function ns(r,t){if(il(r))return(po(r)||Ae(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const y=[];for(const _ of r)y.push(ns(_,t));return y}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=Uu(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Ws[n])throw new Error(`${n} is not registered.`);const{klass:a}=Ws[n],f=a.serialize?a.serialize(r,t):{};if(a.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in r){if(!r.hasOwnProperty(y)||Ws[n].omit.indexOf(y)>=0)continue;const _=r[y];f[y]=Ws[n].shallow.indexOf(y)>=0?_:ns(_,t)}r instanceof Error&&(f.message=r.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(f.$name=n),f}function Bo(r){if(il(r))return r;if(Array.isArray(r))return r.map(Bo);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const t=Uu(r)||"Object";if(!Ws[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Ws[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const a=Object.create(n.prototype);for(const f of Object.keys(r)){if(f==="$name")continue;const y=r[f];a[f]=Ws[t].shallow.indexOf(f)>=0?y:Bo(y)}return a}class mo{constructor(){this.first=!0}update(t,n){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const Qr={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function vc(r){for(const t of r)if(mu(t.charCodeAt(0)))return!0;return!1}function cd(r){for(const t of r)if(!go(t.charCodeAt(0)))return!1;return!0}function la(r){const t=r.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const fu=la(["Arab","Dupl","Mong","Ougr","Syrc"]);function go(r){return!fu.test(String.fromCodePoint(r))}const pu=la(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function mu(r){return!(r!==746&&r!==747&&(r<4352||!(Qr["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Qr["CJK Compatibility"](r)||Qr["CJK Strokes"](r)||!(!Qr["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Qr["Enclosed CJK Letters and Months"](r)||Qr["Ideographic Description Characters"](r)||Qr.Kanbun(r)||Qr.Katakana(r)&&r!==12540||!(!Qr["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Qr["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Qr["Vertical Forms"](r)||Qr["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||pu.test(String.fromCodePoint(r)))))}function sl(r){return!(mu(r)||function(t){return!!(Qr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Qr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Qr["Letterlike Symbols"](t)||Qr["Number Forms"](t)||Qr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Qr["Control Pictures"](t)&&t!==9251||Qr["Optical Character Recognition"](t)||Qr["Enclosed Alphanumerics"](t)||Qr["Geometric Shapes"](t)||Qr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Qr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Qr["CJK Symbols and Punctuation"](t)||Qr.Katakana(t)||Qr["Private Use Area"](t)||Qr["CJK Compatibility Forms"](t)||Qr["Small Form Variants"](t)||Qr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}const Ma=la(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Dn(r){return Ma.test(String.fromCodePoint(r))}function Bn(r,t){return!(!t&&Dn(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Qr.Khmer(r))}function za(r){for(const t of r)if(Dn(t.charCodeAt(0)))return!0;return!1}const kn=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class tn{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mo,this.transition={})}isSupportedScript(t){return function(n,a){for(const f of n)if(!Bn(f.charCodeAt(0),a))return!1;return!0}(t,kn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*n}}}class Xs{constructor(t,n){this.property=t,this.value=n,this.expression=function(a,f){if(ou(a))return new Ia(a,f);if(Ca(a)){const y=Du(a,f);if(y.result==="error")throw new Error(y.value.map(_=>`${_.key}: ${_.message}`).join(", "));return y.value}{let y=a;return f.type==="color"&&typeof a=="string"?y=Pr.parse(a):f.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(a)&&(y=ti.parse(a)):y=ei.parse(a),{kind:"constant",evaluate:()=>y}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,a){return this.property.possiblyEvaluate(this,t,n,a)}}class ua{constructor(t){this.property=t,this.value=new Xs(t,void 0)}transitioned(t,n){return new gu(this.property,this.value,n,je({},t.transition,this.transition),t.now)}untransitioned(){return new gu(this.property,this.value,null,{},0)}}class Oi{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return xt(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ua(this._values[t].property)),this._values[t].value=new Xs(this._values[t].property,n===null?void 0:xt(n))}getTransition(t){return xt(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ua(this._values[t].property)),this._values[t].transition=xt(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(t[n]=a);const f=this.getTransition(n);f!==void 0&&(t[`${n}-transition`]=f)}return t}transitioned(t,n){const a=new Pl(this._properties);for(const f of Object.keys(this._values))a._values[f]=this._values[f].transitioned(t,n._values[f]);return a}untransitioned(){const t=new Pl(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class gu{constructor(t,n,a,f,y){this.property=t,this.value=n,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=a)}possiblyEvaluate(t,n,a){const f=t.now||0,y=this.value.possiblyEvaluate(t,n,a),_=this.prior;if(_){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return _.possiblyEvaluate(t,n,a);{const b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,n,a),y,function(T){if(T<=0)return 0;if(T>=1)return 1;const M=T*T,O=M*T;return 4*(T<.5?O:3*(T-M)+O-.75)}(b))}}return y}}class Pl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,a){const f=new Ml(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,n,a);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Al{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return xt(this._values[t].value)}setValue(t,n){this._values[t]=new Xs(this._values[t].property,n===null?void 0:xt(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const a=this.getValue(n);a!==void 0&&(t[n]=a)}return t}possiblyEvaluate(t,n,a){const f=new Ml(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(t,n,a);return f}}class Ps{constructor(t,n,a){this.property=t,this.value=n,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,a,f){return this.property.evaluate(this.value,this.parameters,t,n,a,f)}}class Ml{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class or{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,a){const f=On[this.specification.type];return f?f(t,n,a):t}}class Sr{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,a,f){return new Ps(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},a,f)}:t.expression,n)}interpolate(t,n,a){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new Ps(this,{kind:"constant",value:void 0},t.parameters);const f=On[this.specification.type];if(f){const y=f(t.value.value,n.value.value,a);return new Ps(this,{kind:"constant",value:y},t.parameters)}return t}evaluate(t,n,a,f,y,_){return t.kind==="constant"?t.value:t.evaluate(n,a,f,y,_)}}class zl extends Sr{possiblyEvaluate(t,n,a,f){if(t.value===void 0)return new Ps(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const y=t.expression.evaluate(n,null,{},a,f),_=t.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,b=this._calculate(_,_,_,n);return new Ps(this,{kind:"constant",value:b},n)}if(t.expression.kind==="camera"){const y=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new Ps(this,{kind:"constant",value:y},n)}return new Ps(this,t.expression,n)}evaluate(t,n,a,f,y,_){if(t.kind==="source"){const b=t.evaluate(n,a,f,y,_);return this._calculate(b,b,b,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},a,f),t.evaluate({zoom:Math.floor(n.zoom)},a,f),t.evaluate({zoom:Math.floor(n.zoom)+1},a,f),n):t.value}_calculate(t,n,a,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:a,to:n}}interpolate(t){return t}}class yu{constructor(t){this.specification=t}possiblyEvaluate(t,n,a,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const y=t.expression.evaluate(n,null,{},a,f);return this._calculate(y,y,y,n)}return this._calculate(t.expression.evaluate(new tn(Math.floor(n.zoom-1),n)),t.expression.evaluate(new tn(Math.floor(n.zoom),n)),t.expression.evaluate(new tn(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,a,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:a,to:n}}interpolate(t){return t}}class xc{constructor(t){this.specification=t}possiblyEvaluate(t,n,a,f){return!!t.expression.evaluate(n,null,{},a,f)}interpolate(){return!1}}class g{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const a=t[n];a.specification.overridable&&this.overridableProperties.push(n);const f=this.defaultPropertyValues[n]=new Xs(a,void 0),y=this.defaultTransitionablePropertyValues[n]=new ua(a);this.defaultTransitioningPropertyValues[n]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=f.possiblyEvaluate({})}}}sr("DataDrivenProperty",Sr),sr("DataConstantProperty",or),sr("CrossFadedDataDrivenProperty",zl),sr("CrossFadedProperty",yu),sr("ColorRampProperty",xc);const e="-transition";class s extends ft{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new Al(n.layout)),n.paint)){this._transitionablePaint=new Oi(n.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ml(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,a={}){n!=null&&this._validate(yh,`layers.${this.id}.layout.${t}`,t,n,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,a={}){if(n!=null&&this._validate(Nu,`layers.${this.id}.paint.${t}`,t,n,a))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const f=this._transitionablePaint._values[t],y=f.property.specification["property-type"]==="cross-faded-data-driven",_=f.value.isDataDriven(),b=f.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(t,b,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),At(t,(n,a)=>!(n===void 0||a==="layout"&&!Object.keys(n).length||a==="paint"&&!Object.keys(n).length))}_validate(t,n,a,f,y={}){return(!y||y.validate!==!1)&&ju(this,t.call(aa,{key:n,layerType:this.type,objectKey:a,value:f,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof Ps&&xl(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class h{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function S(r,t=1){let n=0,a=0;return{members:r.map(f=>{const y=c[f.type].BYTES_PER_ELEMENT,_=n=k(n,Math.max(t,y)),b=f.components||1;return a=Math.max(a,y),n+=y*b,{name:f.name,type:f.type,components:b,offset:_}}),size:k(n,Math.max(a,t)),alignment:t}}function k(r,t){return Math.ceil(r/t)*t}class A extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const f=2*t;return this.int16[f+0]=n,this.int16[f+1]=a,t}}A.prototype.bytesPerElement=4,sr("StructArrayLayout2i4",A);class F extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,a)}emplace(t,n,a,f){const y=3*t;return this.int16[y+0]=n,this.int16[y+1]=a,this.int16[y+2]=f,t}}F.prototype.bytesPerElement=6,sr("StructArrayLayout3i6",F);class H extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,n,a,f)}emplace(t,n,a,f,y){const _=4*t;return this.int16[_+0]=n,this.int16[_+1]=a,this.int16[_+2]=f,this.int16[_+3]=y,t}}H.prototype.bytesPerElement=8,sr("StructArrayLayout4i8",H);class $ extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,n,a,f,y,_)}emplace(t,n,a,f,y,_,b){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.int16[T+2]=f,this.int16[T+3]=y,this.int16[T+4]=_,this.int16[T+5]=b,t}}$.prototype.bytesPerElement=12,sr("StructArrayLayout2i4i12",$);class ne extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,n,a,f,y,_)}emplace(t,n,a,f,y,_,b){const T=4*t,M=8*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.uint8[M+4]=f,this.uint8[M+5]=y,this.uint8[M+6]=_,this.uint8[M+7]=b,t}}ne.prototype.bytesPerElement=8,sr("StructArrayLayout2i4ub8",ne);class de extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const f=2*t;return this.float32[f+0]=n,this.float32[f+1]=a,t}}de.prototype.bytesPerElement=8,sr("StructArrayLayout2f8",de);class me extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_,b,T,M,O){const V=this.length;return this.resize(V+1),this.emplace(V,t,n,a,f,y,_,b,T,M,O)}emplace(t,n,a,f,y,_,b,T,M,O,V){const Z=10*t;return this.uint16[Z+0]=n,this.uint16[Z+1]=a,this.uint16[Z+2]=f,this.uint16[Z+3]=y,this.uint16[Z+4]=_,this.uint16[Z+5]=b,this.uint16[Z+6]=T,this.uint16[Z+7]=M,this.uint16[Z+8]=O,this.uint16[Z+9]=V,t}}me.prototype.bytesPerElement=20,sr("StructArrayLayout10ui20",me);class be extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_,b,T,M,O,V,Z){const te=this.length;return this.resize(te+1),this.emplace(te,t,n,a,f,y,_,b,T,M,O,V,Z)}emplace(t,n,a,f,y,_,b,T,M,O,V,Z,te){const le=12*t;return this.int16[le+0]=n,this.int16[le+1]=a,this.int16[le+2]=f,this.int16[le+3]=y,this.uint16[le+4]=_,this.uint16[le+5]=b,this.uint16[le+6]=T,this.uint16[le+7]=M,this.int16[le+8]=O,this.int16[le+9]=V,this.int16[le+10]=Z,this.int16[le+11]=te,t}}be.prototype.bytesPerElement=24,sr("StructArrayLayout4i4ui4i24",be);class Ie extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,a)}emplace(t,n,a,f){const y=3*t;return this.float32[y+0]=n,this.float32[y+1]=a,this.float32[y+2]=f,t}}Ie.prototype.bytesPerElement=12,sr("StructArrayLayout3f12",Ie);class ze extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}ze.prototype.bytesPerElement=4,sr("StructArrayLayout1ul4",ze);class Be extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_,b,T,M){const O=this.length;return this.resize(O+1),this.emplace(O,t,n,a,f,y,_,b,T,M)}emplace(t,n,a,f,y,_,b,T,M,O){const V=10*t,Z=5*t;return this.int16[V+0]=n,this.int16[V+1]=a,this.int16[V+2]=f,this.int16[V+3]=y,this.int16[V+4]=_,this.int16[V+5]=b,this.uint32[Z+3]=T,this.uint16[V+8]=M,this.uint16[V+9]=O,t}}Be.prototype.bytesPerElement=20,sr("StructArrayLayout6i1ul2ui20",Be);class ke extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,n,a,f,y,_)}emplace(t,n,a,f,y,_,b){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=a,this.int16[T+2]=f,this.int16[T+3]=y,this.int16[T+4]=_,this.int16[T+5]=b,t}}ke.prototype.bytesPerElement=12,sr("StructArrayLayout2i2i2i12",ke);class Ge extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,a,f,y)}emplace(t,n,a,f,y,_){const b=4*t,T=8*t;return this.float32[b+0]=n,this.float32[b+1]=a,this.float32[b+2]=f,this.int16[T+6]=y,this.int16[T+7]=_,t}}Ge.prototype.bytesPerElement=16,sr("StructArrayLayout2f1f2i16",Ge);class Xe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,n,a,f,y,_)}emplace(t,n,a,f,y,_,b){const T=16*t,M=4*t,O=8*t;return this.uint8[T+0]=n,this.uint8[T+1]=a,this.float32[M+1]=f,this.float32[M+2]=y,this.int16[O+6]=_,this.int16[O+7]=b,t}}Xe.prototype.bytesPerElement=16,sr("StructArrayLayout2ub2f2i16",Xe);class it extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,a)}emplace(t,n,a,f){const y=3*t;return this.uint16[y+0]=n,this.uint16[y+1]=a,this.uint16[y+2]=f,t}}it.prototype.bytesPerElement=6,sr("StructArrayLayout3ui6",it);class kt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De){const rt=this.length;return this.resize(rt+1),this.emplace(rt,t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De)}emplace(t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De,rt){const Ue=24*t,Qe=12*t,gt=48*t;return this.int16[Ue+0]=n,this.int16[Ue+1]=a,this.uint16[Ue+2]=f,this.uint16[Ue+3]=y,this.uint32[Qe+2]=_,this.uint32[Qe+3]=b,this.uint32[Qe+4]=T,this.uint16[Ue+10]=M,this.uint16[Ue+11]=O,this.uint16[Ue+12]=V,this.float32[Qe+7]=Z,this.float32[Qe+8]=te,this.uint8[gt+36]=le,this.uint8[gt+37]=fe,this.uint8[gt+38]=Pe,this.uint32[Qe+10]=De,this.int16[Ue+22]=rt,t}}kt.prototype.bytesPerElement=48,sr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",kt);class Bt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De,rt,Ue,Qe,gt,Dt,nr,Ar,tr,Yt,yr,dr){const lr=this.length;return this.resize(lr+1),this.emplace(lr,t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De,rt,Ue,Qe,gt,Dt,nr,Ar,tr,Yt,yr,dr)}emplace(t,n,a,f,y,_,b,T,M,O,V,Z,te,le,fe,Pe,De,rt,Ue,Qe,gt,Dt,nr,Ar,tr,Yt,yr,dr,lr){const Tt=32*t,xr=16*t;return this.int16[Tt+0]=n,this.int16[Tt+1]=a,this.int16[Tt+2]=f,this.int16[Tt+3]=y,this.int16[Tt+4]=_,this.int16[Tt+5]=b,this.int16[Tt+6]=T,this.int16[Tt+7]=M,this.uint16[Tt+8]=O,this.uint16[Tt+9]=V,this.uint16[Tt+10]=Z,this.uint16[Tt+11]=te,this.uint16[Tt+12]=le,this.uint16[Tt+13]=fe,this.uint16[Tt+14]=Pe,this.uint16[Tt+15]=De,this.uint16[Tt+16]=rt,this.uint16[Tt+17]=Ue,this.uint16[Tt+18]=Qe,this.uint16[Tt+19]=gt,this.uint16[Tt+20]=Dt,this.uint16[Tt+21]=nr,this.uint16[Tt+22]=Ar,this.uint32[xr+12]=tr,this.float32[xr+13]=Yt,this.float32[xr+14]=yr,this.uint16[Tt+30]=dr,this.uint16[Tt+31]=lr,t}}Bt.prototype.bytesPerElement=64,sr("StructArrayLayout8i15ui1ul2f2ui64",Bt);class $t extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}$t.prototype.bytesPerElement=4,sr("StructArrayLayout1f4",$t);class Qt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,a)}emplace(t,n,a,f){const y=3*t;return this.uint16[6*t+0]=n,this.float32[y+1]=a,this.float32[y+2]=f,t}}Qt.prototype.bytesPerElement=12,sr("StructArrayLayout1ui2f12",Qt);class Gt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,a){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,a)}emplace(t,n,a,f){const y=4*t;return this.uint32[2*t+0]=n,this.uint16[y+2]=a,this.uint16[y+3]=f,t}}Gt.prototype.bytesPerElement=8,sr("StructArrayLayout1ul2ui8",Gt);class Vt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,n)}emplace(t,n,a){const f=2*t;return this.uint16[f+0]=n,this.uint16[f+1]=a,t}}Vt.prototype.bytesPerElement=4,sr("StructArrayLayout2ui4",Vt);class ur extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}ur.prototype.bytesPerElement=2,sr("StructArrayLayout1ui2",ur);class Fr extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,a,f){const y=this.length;return this.resize(y+1),this.emplace(y,t,n,a,f)}emplace(t,n,a,f,y){const _=4*t;return this.float32[_+0]=n,this.float32[_+1]=a,this.float32[_+2]=f,this.float32[_+3]=y,t}}Fr.prototype.bytesPerElement=16,sr("StructArrayLayout4f16",Fr);class Zt extends h{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new j(this.anchorPointX,this.anchorPointY)}}Zt.prototype.size=20;class Xt extends Be{get(t){return new Zt(this,t)}}sr("CollisionBoxArray",Xt);class Lr extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Lr.prototype.size=48;class Sn extends kt{get(t){return new Lr(this,t)}}sr("PlacedSymbolArray",Sn);class $r extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}$r.prototype.size=64;class Wr extends Bt{get(t){return new $r(this,t)}}sr("SymbolInstanceArray",Wr);class Cn extends $t{getoffsetX(t){return this.float32[1*t+0]}}sr("GlyphOffsetArray",Cn);class Mi extends F{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}sr("SymbolLineVertexArray",Mi);class As extends h{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}As.prototype.size=12;class In extends Qt{get(t){return new As(this,t)}}sr("TextAnchorOffsetArray",In);class Ti extends h{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ti.prototype.size=8;class Nn extends Gt{get(t){return new Ti(this,t)}}sr("FeatureIndexArray",Nn);class ri extends A{}class Bi extends A{}class yo extends A{}class gs extends ${}class _o extends ne{}class Ra extends de{}class Ms extends me{}class Ks extends be{}class No extends Ie{}class is extends ze{}class zs extends ke{}class vo extends Xe{}class Ys extends it{}class ii extends Vt{}const $n=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ni}=$n;class Xr{constructor(t=[]){this.segments=t}prepareSegment(t,n,a,f){let y=this.segments[this.segments.length-1];return t>Xr.MAX_VERTEX_ARRAY_LENGTH&&Je(`Max vertices per segment is ${Xr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!y||y.vertexLength+t>Xr.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:n.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,a,f){return new Xr([{vertexOffset:t,primitiveOffset:n,vertexLength:a,primitiveLength:f,vaos:{},sortKey:0}])}}function Rs(r,t){return 256*(r=ve(Math.floor(r),0,255))+ve(Math.floor(t),0,255)}Xr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,sr("SegmentVector",Xr);const Da=S([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xo={exports:{}},wc={exports:{}};wc.exports=function(r,t){var n,a,f,y,_,b,T,M;for(a=r.length-(n=3&r.length),f=t,_=3432918353,b=461845907,M=0;M<a;)T=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24,++M,f=27492+(65535&(y=5*(65535&(f=(f^=T=(65535&(T=(T=(65535&T)*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,n){case 3:T^=(255&r.charCodeAt(M+2))<<16;case 2:T^=(255&r.charCodeAt(M+1))<<8;case 1:f^=T=(65535&(T=(T=(65535&(T^=255&r.charCodeAt(M)))*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*b+(((T>>>16)*b&65535)<<16)&4294967295}return f^=r.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var bc=wc.exports,qn={exports:{}};qn.exports=function(r,t){for(var n,a=r.length,f=t^a,y=0;a>=4;)n=1540483477*(65535&(n=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(n>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),a-=4,++y;switch(a){case 3:f^=(255&r.charCodeAt(y+2))<<16;case 2:f^=(255&r.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&r.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var wo=bc,Vu=qn.exports;xo.exports=wo,xo.exports.murmur3=wo,xo.exports.murmur2=Vu;var Rl=B(xo.exports);class La{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,a,f){this.ids.push(Dl(t)),this.positions.push(n,a,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Dl(t);let a=0,f=this.ids.length-1;for(;a<f;){const _=a+f>>1;this.ids[_]>=n?f=_:a=_+1}const y=[];for(;this.ids[a]===n;)y.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return y}static serialize(t,n){const a=new Float64Array(t.ids),f=new Uint32Array(t.positions);return jo(a,f,0,a.length-1),n&&n.push(a.buffer,f.buffer),{ids:a,positions:f}}static deserialize(t){const n=new La;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Dl(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Rl(String(r))}function jo(r,t,n,a){for(;n<a;){const f=r[n+a>>1];let y=n-1,_=a+1;for(;;){do y++;while(r[y]<f);do _--;while(r[_]>f);if(y>=_)break;Pn(r,y,_),Pn(t,3*y,3*_),Pn(t,3*y+1,3*_+1),Pn(t,3*y+2,3*_+2)}_-n<a-_?(jo(r,t,n,_),n=_+1):(jo(r,t,_+1,a),a=_)}}function Pn(r,t,n){const a=r[t];r[t]=r[n],r[n]=a}sr("FeaturePositionMap",La);class Jn{constructor(t,n){this.gl=t.gl,this.location=n}}class ki extends Jn{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Sc extends Jn{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Hu extends Jn{constructor(t,n){super(t,n),this.current=Pr.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Ec=new Float32Array(16);function hd(r){return[Rs(255*r.r,255*r.g),Rs(255*r.b,255*r.a)]}class zi{constructor(t,n,a){this.value=t,this.uniformNames=n.map(f=>`u_${f}`),this.type=a}setUniform(t,n,a){t.set(a.constantOr(this.value))}getBinding(t,n,a){return this.type==="color"?new Hu(t,n):new ki(t,n)}}class Ll{constructor(t,n){this.uniformNames=n.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,a,f){const y=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)}getBinding(t,n,a){return a.substr(0,9)==="u_pattern"?new Sc(t,n):new ki(t,n)}}class ca{constructor(t,n,a,f){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=n.map(y=>({name:`a_${y}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,n,a,f,y){const _=this.paintVertexArray.length,b=this.expression.evaluate(new tn(0),n,{},f,[],y);this.paintVertexArray.resize(t),this._setPaintValue(_,t,b)}updatePaintArray(t,n,a,f){const y=this.expression.evaluate({zoom:0},a,f);this._setPaintValue(t,n,y)}_setPaintValue(t,n,a){if(this.type==="color"){const f=hd(a);for(let y=t;y<n;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=t;f<n;f++)this.paintVertexArray.emplace(f,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bo{constructor(t,n,a,f,y,_){this.expression=t,this.uniformNames=n.map(b=>`u_${b}_t`),this.type=a,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=n.map(b=>({name:`a_${b}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,n,a,f,y){const _=this.expression.evaluate(new tn(this.zoom),n,{},f,[],y),b=this.expression.evaluate(new tn(this.zoom+1),n,{},f,[],y),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,_,b)}updatePaintArray(t,n,a,f){const y=this.expression.evaluate({zoom:this.zoom},a,f),_=this.expression.evaluate({zoom:this.zoom+1},a,f);this._setPaintValue(t,n,y,_)}_setPaintValue(t,n,a,f){if(this.type==="color"){const y=hd(a),_=hd(f);for(let b=t;b<n;b++)this.paintVertexArray.emplace(b,y[0],y[1],_[0],_[1])}else{for(let y=t;y<n;y++)this.paintVertexArray.emplace(y,a,f);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const a=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,f=ve(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,n,a){return new ki(t,n)}}class ss{constructor(t,n,a,f,y,_){this.expression=t,this.type=n,this.useIntegerZoom=a,this.zoom=f,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(t,n,a){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,n.patterns&&n.patterns[this.layerId],a)}updatePaintArray(t,n,a,f,y){this._setPaintValues(t,n,a.patterns&&a.patterns[this.layerId],y)}_setPaintValues(t,n,a,f){if(!f||!a)return;const{min:y,mid:_,max:b}=a,T=f[y],M=f[_],O=f[b];if(T&&M&&O)for(let V=t;V<n;V++)this.zoomInPaintVertexArray.emplace(V,M.tl[0],M.tl[1],M.br[0],M.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],M.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(V,M.tl[0],M.tl[1],M.br[0],M.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],M.pixelRatio,O.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Da.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Da.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class So{constructor(t,n,a){this.binders={},this._buffers=[];const f=[];for(const y in t.paint._values){if(!a(y))continue;const _=t.paint.get(y);if(!(_ instanceof Ps&&xl(_.property.specification)))continue;const b=dd(y,t.type),T=_.value,M=_.property.specification.type,O=_.property.useIntegerZoom,V=_.property.specification["property-type"],Z=V==="cross-faded"||V==="cross-faded-data-driven";if(T.kind==="constant")this.binders[y]=Z?new Ll(T.value,b):new zi(T.value,b,M),f.push(`/u_${y}`);else if(T.kind==="source"||Z){const te=_h(y,M,"source");this.binders[y]=Z?new ss(T,M,O,n,te,t.id):new ca(T,b,M,te),f.push(`/a_${y}`)}else{const te=_h(y,M,"composite");this.binders[y]=new bo(T,b,M,O,n,te),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof ca||n instanceof bo?n.maxValue:0}populatePaintArrays(t,n,a,f,y){for(const _ in this.binders){const b=this.binders[_];(b instanceof ca||b instanceof bo||b instanceof ss)&&b.populatePaintArray(t,n,a,f,y)}}setConstantPatternPositions(t,n){for(const a in this.binders){const f=this.binders[a];f instanceof Ll&&f.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,a,f,y){let _=!1;for(const b in t){const T=n.getPositions(b);for(const M of T){const O=a.feature(M.index);for(const V in this.binders){const Z=this.binders[V];if((Z instanceof ca||Z instanceof bo||Z instanceof ss)&&Z.expression.isStateDependent===!0){const te=f.paint.get(V);Z.expression=te.value,Z.updatePaintArray(M.start,M.end,O,t[b],y),_=!0}}}}return _}defines(){const t=[];for(const n in this.binders){const a=this.binders[n];(a instanceof zi||a instanceof Ll)&&t.push(...a.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof ca||a instanceof bo)for(let f=0;f<a.paintVertexAttributes.length;f++)t.push(a.paintVertexAttributes[f].name);else if(a instanceof ss)for(let f=0;f<Da.members.length;f++)t.push(Da.members[f].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const a=this.binders[n];if(a instanceof zi||a instanceof Ll||a instanceof bo)for(const f of a.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const a=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof zi||y instanceof Ll||y instanceof bo){for(const _ of y.uniformNames)if(n[_]){const b=y.getBinding(t,n[_],_);a.push({name:_,property:f,binding:b})}}}return a}setUniforms(t,n,a,f){for(const{name:y,property:_,binding:b}of n)this.binders[_].setUniform(b,f,a.get(_),y)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const a=this.binders[n];if(t&&a instanceof ss){const f=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(a instanceof ca||a instanceof bo)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const n in this.binders){const a=this.binders[n];(a instanceof ca||a instanceof bo||a instanceof ss)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof ca||n instanceof bo||n instanceof ss)&&n.destroy()}}}class ha{constructor(t,n,a=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new So(f,n,a);this.needsUpload=!1,this._featureMap=new La,this._bufferOffset=0}populatePaintArrays(t,n,a,f,y,_){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,n,f,y,_);n.id!==void 0&&this._featureMap.add(n.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,a,f){for(const y of a)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,n,y,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function dd(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function _h(r,t,n){const a={color:{source:de,composite:Fr},number:{source:$t,composite:de}},f=function(y){return{"line-pattern":{source:Ms,composite:Ms},"fill-pattern":{source:Ms,composite:Ms},"fill-extrusion-pattern":{source:Ms,composite:Ms}}[y]}(r);return f&&f[n]||a[t][n]}sr("ConstantBinder",zi),sr("CrossFadedConstantBinder",Ll),sr("SourceExpressionBinder",ca),sr("CrossFadedCompositeBinder",ss),sr("CompositeExpressionBinder",bo),sr("ProgramConfiguration",So,{omit:["_buffers"]}),sr("ProgramConfigurationSet",ha);const si=8192,vh=Math.pow(2,14)-1,fd=-vh-1;function Fl(r){const t=si/r.extent,n=r.loadGeometry();for(let a=0;a<n.length;a++){const f=n[a];for(let y=0;y<f.length;y++){const _=f[y],b=Math.round(_.x*t),T=Math.round(_.y*t);_.x=ve(b,fd,vh),_.y=ve(T,fd,vh),(b<_.x||b>_.x+1||T<_.y||T>_.y+1)&&Je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ol(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Fl(r):[]}}function Tc(r,t,n,a,f){r.emplaceBack(2*t+(a+1)/2,2*n+(f+1)/2)}class xh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Bi,this.indexArray=new Ys,this.segments=new Xr,this.programConfigurations=new ha(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){const f=this.layers[0],y=[];let _=null,b=!1;f.type==="circle"&&(_=f.layout.get("circle-sort-key"),b=!_.isConstant());for(const{feature:T,id:M,index:O,sourceLayerIndex:V}of t){const Z=this.layers[0]._featureFilter.needGeometry,te=Ol(T,Z);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),te,a))continue;const le=b?_.evaluate(te,{},a):void 0,fe={id:M,properties:T.properties,type:T.type,sourceLayerIndex:V,index:O,geometry:Z?te.geometry:Fl(T),patterns:{},sortKey:le};y.push(fe)}b&&y.sort((T,M)=>T.sortKey-M.sortKey);for(const T of y){const{geometry:M,index:O,sourceLayerIndex:V}=T,Z=t[O].feature;this.addFeature(T,M,O,a),n.featureIndex.insert(Z,M,O,V,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ni),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,a,f){for(const y of n)for(const _ of y){const b=_.x,T=_.y;if(b<0||b>=si||T<0||T>=si)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),O=M.vertexLength;Tc(this.layoutVertexArray,b,T,-1,-1),Tc(this.layoutVertexArray,b,T,1,-1),Tc(this.layoutVertexArray,b,T,1,1),Tc(this.layoutVertexArray,b,T,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+3,O+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},f)}}function pd(r,t){for(let n=0;n<r.length;n++)if(_u(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(_u(r,t[n]))return!0;return!!$u(r,t)}function kc(r,t,n){return!!_u(r,t)||!!Cc(t,r,n)}function md(r,t){if(r.length===1)return yd(t,r[0]);for(let n=0;n<t.length;n++){const a=t[n];for(let f=0;f<a.length;f++)if(_u(r,a[f]))return!0}for(let n=0;n<r.length;n++)if(yd(t,r[n]))return!0;for(let n=0;n<t.length;n++)if($u(r,t[n]))return!0;return!1}function wh(r,t,n){if(r.length>1){if($u(r,t))return!0;for(let a=0;a<t.length;a++)if(Cc(t[a],r,n))return!0}for(let a=0;a<r.length;a++)if(Cc(r[a],t,n))return!0;return!1}function $u(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const a=r[n],f=r[n+1];for(let y=0;y<t.length-1;y++)if(Jd(a,f,t[y],t[y+1]))return!0}return!1}function Jd(r,t,n,a){return G(r,n,a)!==G(t,n,a)&&G(r,t,n)!==G(r,t,a)}function Cc(r,t,n){const a=n*n;if(t.length===1)return r.distSqr(t[0])<a;for(let f=1;f<t.length;f++)if(gd(r,t[f-1],t[f])<a)return!0;return!1}function gd(r,t,n){const a=t.distSqr(n);if(a===0)return r.distSqr(t);const f=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/a;return r.distSqr(f<0?t:f>1?n:n.sub(t)._mult(f)._add(t))}function yd(r,t){let n,a,f,y=!1;for(let _=0;_<r.length;_++){n=r[_];for(let b=0,T=n.length-1;b<n.length;T=b++)a=n[b],f=n[T],a.y>t.y!=f.y>t.y&&t.x<(f.x-a.x)*(t.y-a.y)/(f.y-a.y)+a.x&&(y=!y)}return y}function _u(r,t){let n=!1;for(let a=0,f=r.length-1;a<r.length;f=a++){const y=r[a],_=r[f];y.y>t.y!=_.y>t.y&&t.x<(_.x-y.x)*(t.y-y.y)/(_.y-y.y)+y.x&&(n=!n)}return n}function Qd(r,t,n){const a=n[0],f=n[2];if(r.x<a.x&&t.x<a.x||r.x>f.x&&t.x>f.x||r.y<a.y&&t.y<a.y||r.y>f.y&&t.y>f.y)return!1;const y=G(r,t,n[0]);return y!==G(r,t,n[1])||y!==G(r,t,n[2])||y!==G(r,t,n[3])}function vu(r,t,n){const a=t.paint.get(r).value;return a.kind==="constant"?a.value:n.programConfigurations.get(t.id).getMaxValue(r)}function Ic(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Pc(r,t,n,a,f){if(!t[0]&&!t[1])return r;const y=j.convert(t)._mult(f);n==="viewport"&&y._rotate(-a);const _=[];for(let b=0;b<r.length;b++)_.push(r[b].sub(y));return _}let _d,ef;sr("CircleBucket",xh,{omit:["layers"]});var tf={get paint(){return ef=ef||new g({"circle-radius":new Sr(ye.paint_circle["circle-radius"]),"circle-color":new Sr(ye.paint_circle["circle-color"]),"circle-blur":new Sr(ye.paint_circle["circle-blur"]),"circle-opacity":new Sr(ye.paint_circle["circle-opacity"]),"circle-translate":new or(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new or(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new or(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new or(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Sr(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Sr(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Sr(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return _d=_d||new g({"circle-sort-key":new Sr(ye.layout_circle["circle-sort-key"])})}},ys=1e-6,Gu=typeof Float32Array<"u"?Float32Array:Array;function bh(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function vd(r,t,n){var a=t[0],f=t[1],y=t[2],_=t[3],b=t[4],T=t[5],M=t[6],O=t[7],V=t[8],Z=t[9],te=t[10],le=t[11],fe=t[12],Pe=t[13],De=t[14],rt=t[15],Ue=n[0],Qe=n[1],gt=n[2],Dt=n[3];return r[0]=Ue*a+Qe*b+gt*V+Dt*fe,r[1]=Ue*f+Qe*T+gt*Z+Dt*Pe,r[2]=Ue*y+Qe*M+gt*te+Dt*De,r[3]=Ue*_+Qe*O+gt*le+Dt*rt,r[4]=(Ue=n[4])*a+(Qe=n[5])*b+(gt=n[6])*V+(Dt=n[7])*fe,r[5]=Ue*f+Qe*T+gt*Z+Dt*Pe,r[6]=Ue*y+Qe*M+gt*te+Dt*De,r[7]=Ue*_+Qe*O+gt*le+Dt*rt,r[8]=(Ue=n[8])*a+(Qe=n[9])*b+(gt=n[10])*V+(Dt=n[11])*fe,r[9]=Ue*f+Qe*T+gt*Z+Dt*Pe,r[10]=Ue*y+Qe*M+gt*te+Dt*De,r[11]=Ue*_+Qe*O+gt*le+Dt*rt,r[12]=(Ue=n[12])*a+(Qe=n[13])*b+(gt=n[14])*V+(Dt=n[15])*fe,r[13]=Ue*f+Qe*T+gt*Z+Dt*Pe,r[14]=Ue*y+Qe*M+gt*te+Dt*De,r[15]=Ue*_+Qe*O+gt*le+Dt*rt,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var qu,Sh=vd;function Eh(r,t,n){var a=t[0],f=t[1],y=t[2],_=t[3];return r[0]=n[0]*a+n[4]*f+n[8]*y+n[12]*_,r[1]=n[1]*a+n[5]*f+n[9]*y+n[13]*_,r[2]=n[2]*a+n[6]*f+n[10]*y+n[14]*_,r[3]=n[3]*a+n[7]*f+n[11]*y+n[15]*_,r}qu=new Gu(4),Gu!=Float32Array&&(qu[0]=0,qu[1]=0,qu[2]=0,qu[3]=0);class xp extends s{constructor(t){super(t,tf)}createBucket(t){return new xh(t)}queryRadius(t){const n=t;return vu("circle-radius",this,n)+vu("circle-stroke-width",this,n)+Ic(this.paint.get("circle-translate"))}queryIntersectsFeature(t,n,a,f,y,_,b,T){const M=Pc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,b),O=this.paint.get("circle-radius").evaluate(n,a)+this.paint.get("circle-stroke-width").evaluate(n,a),V=this.paint.get("circle-pitch-alignment")==="map",Z=V?M:function(le,fe){return le.map(Pe=>rf(Pe,fe))}(M,T),te=V?O*b:O;for(const le of f)for(const fe of le){const Pe=V?fe:rf(fe,T);let De=te;const rt=Eh([],[fe.x,fe.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?De*=rt[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(De*=_.cameraToCenterDistance/rt[3]),kc(Z,Pe,De))return!0}return!1}}function rf(r,t){const n=Eh([],[r.x,r.y,0,1],t);return new j(n[0]/n[3],n[1]/n[3])}class Uo extends xh{}let Th;sr("HeatmapBucket",Uo,{omit:["layers"]});var kh={get paint(){return Th=Th||new g({"heatmap-radius":new Sr(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Sr(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new or(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xc(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new or(ye.paint_heatmap["heatmap-opacity"])})}};function Ch(r,{width:t,height:n},a,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*n*a)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*n*a}`)}else f=new Uint8Array(t*n*a);return r.width=t,r.height=n,r.data=f,r}function xd(r,{width:t,height:n},a){if(t===r.width&&n===r.height)return;const f=Ch({},{width:t,height:n},a);Ih(r,f,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,n)},a),r.width=t,r.height=n,r.data=f.data}function Ih(r,t,n,a,f,y){if(f.width===0||f.height===0)return t;if(f.width>r.width||f.height>r.height||n.x>r.width-f.width||n.y>r.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||a.x>t.width-f.width||a.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,b=t.data;if(_===b)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<f.height;T++){const M=((n.y+T)*r.width+n.x)*y,O=((a.y+T)*t.width+a.x)*y;for(let V=0;V<f.width*y;V++)b[O+V]=_[M+V]}return t}class xu{constructor(t,n){Ch(this,t,1,n)}resize(t){xd(this,t,1)}clone(){return new xu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,a,f,y){Ih(t,n,a,f,y,1)}}class Zi{constructor(t,n){Ch(this,t,4,n)}resize(t){xd(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Zi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,a,f,y){Ih(t,n,a,f,y,4)}}function Ph(r){const t={},n=r.resolution||256,a=r.clips?r.clips.length:1,f=r.image||new Zi({width:n,height:a});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const y=(_,b,T)=>{t[r.evaluationKey]=T;const M=r.expression.evaluate(t);f.data[_+b+0]=Math.floor(255*M.r/M.a),f.data[_+b+1]=Math.floor(255*M.g/M.a),f.data[_+b+2]=Math.floor(255*M.b/M.a),f.data[_+b+3]=Math.floor(255*M.a)};if(r.clips)for(let _=0,b=0;_<a;++_,b+=4*n)for(let T=0,M=0;T<n;T++,M+=4){const O=T/(n-1),{start:V,end:Z}=r.clips[_];y(b,M,V*(1-O)+Z*O)}else for(let _=0,b=0;_<n;_++,b+=4)y(0,b,_/(n-1));return f}sr("AlphaImage",xu),sr("RGBAImage",Zi);const Ac="big-fb";class wp extends s{createBucket(t){return new Uo(t)}constructor(t){super(t,kh),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ph({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Ac)&&this.heatmapFbos.delete(Ac)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let wd;var nf={get paint(){return wd=wd||new g({"hillshade-illumination-direction":new or(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new or(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new or(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new or(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new or(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new or(ye.paint_hillshade["hillshade-accent-color"])})}};class sf extends s{constructor(t){super(t,nf)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const of=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:af}=of;function lf(r,t,n=2){const a=t&&t.length,f=a?t[0]*n:r.length;let y=Ds(r,0,f,n,!0);const _=[];if(!y||y.next===y.prev)return _;let b,T,M;if(a&&(y=function(O,V,Z,te){const le=[];for(let fe=0,Pe=V.length;fe<Pe;fe++){const De=Ds(O,V[fe]*te,fe<Pe-1?V[fe+1]*te:O.length,te,!1);De===De.next&&(De.steiner=!0),le.push(pf(De))}le.sort(bd);for(let fe=0;fe<le.length;fe++)Z=ff(le[fe],Z);return Z}(r,t,y,n)),r.length>80*n){b=1/0,T=1/0;let O=-1/0,V=-1/0;for(let Z=n;Z<f;Z+=n){const te=r[Z],le=r[Z+1];te<b&&(b=te),le<T&&(T=le),te>O&&(O=te),le>V&&(V=le)}M=Math.max(O-b,V-T),M=M!==0?32767/M:0}return Zu(y,_,n,b,T,M,0),_}function Ds(r,t,n,a,f){let y;if(f===function(_,b,T,M){let O=0;for(let V=b,Z=T-M;V<T;V+=M)O+=(_[Z]-_[V])*(_[V+1]+_[Z+1]),Z=V;return O}(r,t,n,a)>0)for(let _=t;_<n;_+=a)y=Rc(_/a|0,r[_],r[_+1],y);else for(let _=n-a;_>=t;_-=a)y=Rc(_/a|0,r[_],r[_+1],y);return y&&Wu(y,y.next)&&(Eo(y),y=y.next),y}function Ci(r,t){if(!r)return r;t||(t=r);let n,a=r;do if(n=!1,a.steiner||!Wu(a,a.next)&&ni(a.prev,a,a.next)!==0)a=a.next;else{if(Eo(a),a=t=a.prev,a===a.next)break;n=!0}while(n||a!==t);return t}function Zu(r,t,n,a,f,y,_){if(!r)return;!_&&y&&function(T,M,O,V){let Z=T;do Z.z===0&&(Z.z=Ah(Z.x,Z.y,M,O,V)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==T);Z.prevZ.nextZ=null,Z.prevZ=null,function(te){let le,fe=1;do{let Pe,De=te;te=null;let rt=null;for(le=0;De;){le++;let Ue=De,Qe=0;for(let Dt=0;Dt<fe&&(Qe++,Ue=Ue.nextZ,Ue);Dt++);let gt=fe;for(;Qe>0||gt>0&&Ue;)Qe!==0&&(gt===0||!Ue||De.z<=Ue.z)?(Pe=De,De=De.nextZ,Qe--):(Pe=Ue,Ue=Ue.nextZ,gt--),rt?rt.nextZ=Pe:te=Pe,Pe.prevZ=rt,rt=Pe;De=Ue}rt.nextZ=null,fe*=2}while(le>1)}(Z)}(r,a,f,y);let b=r;for(;r.prev!==r.next;){const T=r.prev,M=r.next;if(y?cf(r,a,f,y):uf(r))t.push(T.i,r.i,M.i),Eo(r),r=M.next,b=M.next;else if((r=M)===b){_?_===1?Zu(r=hf(Ci(r),t),t,n,a,f,y,2):_===2&&df(r,t,n,a,f,y):Zu(Ci(r),t,n,a,f,y,1);break}}}function uf(r){const t=r.prev,n=r,a=r.next;if(ni(t,n,a)>=0)return!1;const f=t.x,y=n.x,_=a.x,b=t.y,T=n.y,M=a.y,O=f<y?f<_?f:_:y<_?y:_,V=b<T?b<M?b:M:T<M?T:M,Z=f>y?f>_?f:_:y>_?y:_,te=b>T?b>M?b:M:T>M?T:M;let le=a.next;for(;le!==t;){if(le.x>=O&&le.x<=Z&&le.y>=V&&le.y<=te&&Bl(f,b,y,T,_,M,le.x,le.y)&&ni(le.prev,le,le.next)>=0)return!1;le=le.next}return!0}function cf(r,t,n,a){const f=r.prev,y=r,_=r.next;if(ni(f,y,_)>=0)return!1;const b=f.x,T=y.x,M=_.x,O=f.y,V=y.y,Z=_.y,te=b<T?b<M?b:M:T<M?T:M,le=O<V?O<Z?O:Z:V<Z?V:Z,fe=b>T?b>M?b:M:T>M?T:M,Pe=O>V?O>Z?O:Z:V>Z?V:Z,De=Ah(te,le,t,n,a),rt=Ah(fe,Pe,t,n,a);let Ue=r.prevZ,Qe=r.nextZ;for(;Ue&&Ue.z>=De&&Qe&&Qe.z<=rt;){if(Ue.x>=te&&Ue.x<=fe&&Ue.y>=le&&Ue.y<=Pe&&Ue!==f&&Ue!==_&&Bl(b,O,T,V,M,Z,Ue.x,Ue.y)&&ni(Ue.prev,Ue,Ue.next)>=0||(Ue=Ue.prevZ,Qe.x>=te&&Qe.x<=fe&&Qe.y>=le&&Qe.y<=Pe&&Qe!==f&&Qe!==_&&Bl(b,O,T,V,M,Z,Qe.x,Qe.y)&&ni(Qe.prev,Qe,Qe.next)>=0))return!1;Qe=Qe.nextZ}for(;Ue&&Ue.z>=De;){if(Ue.x>=te&&Ue.x<=fe&&Ue.y>=le&&Ue.y<=Pe&&Ue!==f&&Ue!==_&&Bl(b,O,T,V,M,Z,Ue.x,Ue.y)&&ni(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.prevZ}for(;Qe&&Qe.z<=rt;){if(Qe.x>=te&&Qe.x<=fe&&Qe.y>=le&&Qe.y<=Pe&&Qe!==f&&Qe!==_&&Bl(b,O,T,V,M,Z,Qe.x,Qe.y)&&ni(Qe.prev,Qe,Qe.next)>=0)return!1;Qe=Qe.nextZ}return!0}function hf(r,t){let n=r;do{const a=n.prev,f=n.next.next;!Wu(a,f)&&Mc(a,n,n.next,f)&&wu(a,f)&&wu(f,a)&&(t.push(a.i,n.i,f.i),Eo(n),Eo(n.next),n=r=f),n=n.next}while(n!==r);return Ci(n)}function df(r,t,n,a,f,y){let _=r;do{let b=_.next.next;for(;b!==_.prev;){if(_.i!==b.i&&Ed(_,b)){let T=Td(_,b);return _=Ci(_,_.next),T=Ci(T,T.next),Zu(_,t,n,a,f,y,0),void Zu(T,t,n,a,f,y,0)}b=b.next}_=_.next}while(_!==r)}function bd(r,t){return r.x-t.x}function ff(r,t){const n=function(f,y){let _=y;const b=f.x,T=f.y;let M,O=-1/0;do{if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const fe=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(fe<=b&&fe>O&&(O=fe,M=_.x<_.next.x?_:_.next,fe===b))return M}_=_.next}while(_!==y);if(!M)return null;const V=M,Z=M.x,te=M.y;let le=1/0;_=M;do{if(b>=_.x&&_.x>=Z&&b!==_.x&&Bl(T<te?b:O,T,Z,te,T<te?O:b,T,_.x,_.y)){const fe=Math.abs(T-_.y)/(b-_.x);wu(_,f)&&(fe<le||fe===le&&(_.x>M.x||_.x===M.x&&Sd(M,_)))&&(M=_,le=fe)}_=_.next}while(_!==V);return M}(r,t);if(!n)return t;const a=Td(n,r);return Ci(a,a.next),Ci(n,n.next)}function Sd(r,t){return ni(r.prev,r,t.prev)<0&&ni(t.next,r,r.next)<0}function Ah(r,t,n,a,f){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function pf(r){let t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Bl(r,t,n,a,f,y,_,b){return(f-_)*(t-b)>=(r-_)*(y-b)&&(r-_)*(a-b)>=(n-_)*(t-b)&&(n-_)*(y-b)>=(f-_)*(a-b)}function Ed(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(n,a){let f=n;do{if(f.i!==n.i&&f.next.i!==n.i&&f.i!==a.i&&f.next.i!==a.i&&Mc(f,f.next,n,a))return!0;f=f.next}while(f!==n);return!1}(r,t)&&(wu(r,t)&&wu(t,r)&&function(n,a){let f=n,y=!1;const _=(n.x+a.x)/2,b=(n.y+a.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&_<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==n);return y}(r,t)&&(ni(r.prev,r,t.prev)||ni(r,t.prev,t))||Wu(r,t)&&ni(r.prev,r,r.next)>0&&ni(t.prev,t,t.next)>0)}function ni(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function Wu(r,t){return r.x===t.x&&r.y===t.y}function Mc(r,t,n,a){const f=zc(ni(r,t,n)),y=zc(ni(r,t,a)),_=zc(ni(n,a,r)),b=zc(ni(n,a,t));return f!==y&&_!==b||!(f!==0||!Mh(r,n,t))||!(y!==0||!Mh(r,a,t))||!(_!==0||!Mh(n,r,a))||!(b!==0||!Mh(n,t,a))}function Mh(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function zc(r){return r>0?1:r<0?-1:0}function wu(r,t){return ni(r.prev,r,r.next)<0?ni(r,t,r.next)>=0&&ni(r,r.prev,t)>=0:ni(r,t,r.prev)<0||ni(r,r.next,t)<0}function Td(r,t){const n=kd(r.i,r.x,r.y),a=kd(t.i,t.x,t.y),f=r.next,y=t.prev;return r.next=t,t.prev=r,n.next=f,f.prev=n,a.next=n,n.prev=a,y.next=a,a.prev=y,a}function Rc(r,t,n,a){const f=kd(r,t,n);return a?(f.next=a.next,f.prev=a,a.next.prev=f,a.next=f):(f.prev=f,f.next=f),f}function Eo(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function kd(r,t,n){return{i:r,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function zh(r,t,n){const a=n.patternDependencies;let f=!1;for(const y of t){const _=y.paint.get(`${r}-pattern`);_.isConstant()||(f=!0);const b=_.constantOr(null);b&&(f=!0,a[b.to]=!0,a[b.from]=!0)}return f}function Dc(r,t,n,a,f){const y=f.patternDependencies;for(const _ of t){const b=_.paint.get(`${r}-pattern`).value;if(b.kind!=="constant"){let T=b.evaluate({zoom:a-1},n,{},f.availableImages),M=b.evaluate({zoom:a},n,{},f.availableImages),O=b.evaluate({zoom:a+1},n,{},f.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,O=O&&O.name?O.name:O,y[T]=!0,y[M]=!0,y[O]=!0,n.patterns[_.id]={min:T,mid:M,max:O}}}return n}class Rh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new yo,this.indexArray=new Ys,this.indexArray2=new ii,this.programConfigurations=new ha(t.layers,t.zoom),this.segments=new Xr,this.segments2=new Xr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.hasPattern=zh("fill",this.layers,n);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),_=[];for(const{feature:b,id:T,index:M,sourceLayerIndex:O}of t){const V=this.layers[0]._featureFilter.needGeometry,Z=Ol(b,V);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),Z,a))continue;const te=y?f.evaluate(Z,{},a,n.availableImages):void 0,le={id:T,properties:b.properties,type:b.type,sourceLayerIndex:O,index:M,geometry:V?Z.geometry:Fl(b),patterns:{},sortKey:te};_.push(le)}y&&_.sort((b,T)=>b.sortKey-T.sortKey);for(const b of _){const{geometry:T,index:M,sourceLayerIndex:O}=b;if(this.hasPattern){const V=Dc("fill",this.layers,b,this.zoom,n);this.patternFeatures.push(V)}else this.addFeature(b,T,M,a,{});n.featureIndex.insert(t[M].feature,T,M,O,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}addFeatures(t,n,a){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,af),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,a,f,y){for(const _ of Jo(n,500)){let b=0;for(const te of _)b+=te.length;const T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),M=T.vertexLength,O=[],V=[];for(const te of _){if(te.length===0)continue;te!==_[0]&&V.push(O.length/2);const le=this.segments2.prepareSegment(te.length,this.layoutVertexArray,this.indexArray2),fe=le.vertexLength;this.layoutVertexArray.emplaceBack(te[0].x,te[0].y),this.indexArray2.emplaceBack(fe+te.length-1,fe),O.push(te[0].x),O.push(te[0].y);for(let Pe=1;Pe<te.length;Pe++)this.layoutVertexArray.emplaceBack(te[Pe].x,te[Pe].y),this.indexArray2.emplaceBack(fe+Pe-1,fe+Pe),O.push(te[Pe].x),O.push(te[Pe].y);le.vertexLength+=te.length,le.primitiveLength+=te.length}const Z=lf(O,V);for(let te=0;te<Z.length;te+=3)this.indexArray.emplaceBack(M+Z[te],M+Z[te+1],M+Z[te+2]);T.vertexLength+=b,T.primitiveLength+=Z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,y,f)}}let Cd,Xu;sr("FillBucket",Rh,{omit:["layers","patternFeatures"]});var _s={get paint(){return Xu=Xu||new g({"fill-antialias":new or(ye.paint_fill["fill-antialias"]),"fill-opacity":new Sr(ye.paint_fill["fill-opacity"]),"fill-color":new Sr(ye.paint_fill["fill-color"]),"fill-outline-color":new Sr(ye.paint_fill["fill-outline-color"]),"fill-translate":new or(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new or(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new zl(ye.paint_fill["fill-pattern"])})},get layout(){return Cd=Cd||new g({"fill-sort-key":new Sr(ye.layout_fill["fill-sort-key"])})}};class bp extends s{constructor(t){super(t,_s)}recalculate(t,n){super.recalculate(t,n);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Rh(t)}queryRadius(){return Ic(this.paint.get("fill-translate"))}queryIntersectsFeature(t,n,a,f,y,_,b){return md(Pc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,b),f)}isTileClipped(){return!0}}const Sp=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Dh=S([{name:"a_centroid",components:2,type:"Int16"}],4),{members:vs}=Sp;var Nl={},vr=U,bu=jl;function jl(r,t,n,a,f){this.properties={},this.extent=n,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=f,r.readFields(mf,this,t)}function mf(r,t,n){r==1?t.id=n.readVarint():r==2?function(a,f){for(var y=a.readVarint()+a.pos;a.pos<y;){var _=f._keys[a.readVarint()],b=f._values[a.readVarint()];f.properties[_]=b}}(n,t):r==3?t.type=n.readVarint():r==4&&(t._geometry=n.pos)}function Ep(r){for(var t,n,a=0,f=0,y=r.length,_=y-1;f<y;_=f++)a+=((n=r[_]).x-(t=r[f]).x)*(t.y+n.y);return a}jl.types=["Unknown","Point","LineString","Polygon"],jl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,n=r.readVarint()+r.pos,a=1,f=0,y=0,_=0,b=[];r.pos<n;){if(f<=0){var T=r.readVarint();a=7&T,f=T>>3}if(f--,a===1||a===2)y+=r.readSVarint(),_+=r.readSVarint(),a===1&&(t&&b.push(t),t=[]),t.push(new vr(y,_));else{if(a!==7)throw new Error("unknown command "+a);t&&t.push(t[0].clone())}}return t&&b.push(t),b},jl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,n=1,a=0,f=0,y=0,_=1/0,b=-1/0,T=1/0,M=-1/0;r.pos<t;){if(a<=0){var O=r.readVarint();n=7&O,a=O>>3}if(a--,n===1||n===2)(f+=r.readSVarint())<_&&(_=f),f>b&&(b=f),(y+=r.readSVarint())<T&&(T=y),y>M&&(M=y);else if(n!==7)throw new Error("unknown command "+n)}return[_,T,b,M]},jl.prototype.toGeoJSON=function(r,t,n){var a,f,y=this.extent*Math.pow(2,n),_=this.extent*r,b=this.extent*t,T=this.loadGeometry(),M=jl.types[this.type];function O(te){for(var le=0;le<te.length;le++){var fe=te[le];te[le]=[360*(fe.x+_)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(fe.y+b)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(a=0;a<T.length;a++)V[a]=T[a][0];O(T=V);break;case 2:for(a=0;a<T.length;a++)O(T[a]);break;case 3:for(T=function(te){var le=te.length;if(le<=1)return[te];for(var fe,Pe,De=[],rt=0;rt<le;rt++){var Ue=Ep(te[rt]);Ue!==0&&(Pe===void 0&&(Pe=Ue<0),Pe===Ue<0?(fe&&De.push(fe),fe=[te[rt]]):fe.push(te[rt]))}return fe&&De.push(fe),De}(T),a=0;a<T.length;a++)for(f=0;f<T[a].length;f++)O(T[a][f])}T.length===1?T=T[0]:M="Multi"+M;var Z={type:"Feature",geometry:{type:M,coordinates:T},properties:this.properties};return"id"in this&&(Z.id=this.id),Z};var Lc=bu,Fc=Lh;function Lh(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(gf,this,t),this.length=this._features.length}function gf(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push(function(a){for(var f=null,y=a.readVarint()+a.pos;a.pos<y;){var _=a.readVarint()>>3;f=_===1?a.readString():_===2?a.readFloat():_===3?a.readDouble():_===4?a.readVarint64():_===5?a.readVarint():_===6?a.readSVarint():_===7?a.readBoolean():null}return f}(n))}Lh.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new Lc(this._pbf,t,this.extent,this._keys,this._values)};var yf=Fc;function _f(r,t,n){if(r===3){var a=new yf(n,n.readVarint()+n.pos);a.length&&(t[a.name]=a)}}Nl.VectorTile=function(r,t){this.layers=r.readFields(_f,{},t)},Nl.VectorTileFeature=bu,Nl.VectorTileLayer=Fc;const Id=Nl.VectorTileFeature.types,Oc=Math.pow(2,13);function Ii(r,t,n,a,f,y,_,b){r.emplaceBack(t,n,2*Math.floor(a*Oc)+_,f*Oc*2,y*Oc*2,Math.round(b))}class To{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new gs,this.centroidVertexArray=new ri,this.indexArray=new Ys,this.programConfigurations=new ha(t.layers,t.zoom),this.segments=new Xr,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.features=[],this.hasPattern=zh("fill-extrusion",this.layers,n);for(const{feature:f,id:y,index:_,sourceLayerIndex:b}of t){const T=this.layers[0]._featureFilter.needGeometry,M=Ol(f,T);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),M,a))continue;const O={id:y,sourceLayerIndex:b,index:_,geometry:T?M.geometry:Fl(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Dc("fill-extrusion",this.layers,O,this.zoom,n)):this.addFeature(O,O.geometry,_,a,{}),n.featureIndex.insert(f,O.geometry,_,b,this.index,!0)}}addFeatures(t,n,a){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,n,a)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vs),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Dh.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,a,f,y){for(const _ of Jo(n,500)){const b={x:0,y:0,vertexCount:0};let T=0;for(const le of _)T+=le.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const le of _){if(le.length===0||vf(le))continue;let fe=0;for(let Pe=0;Pe<le.length;Pe++){const De=le[Pe];if(Pe>=1){const rt=le[Pe-1];if(!Ul(De,rt)){M.vertexLength+4>Xr.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ue=De.sub(rt)._perp()._unit(),Qe=rt.dist(De);fe+Qe>32768&&(fe=0),Ii(this.layoutVertexArray,De.x,De.y,Ue.x,Ue.y,0,0,fe),Ii(this.layoutVertexArray,De.x,De.y,Ue.x,Ue.y,0,1,fe),b.x+=2*De.x,b.y+=2*De.y,b.vertexCount+=2,fe+=Qe,Ii(this.layoutVertexArray,rt.x,rt.y,Ue.x,Ue.y,0,0,fe),Ii(this.layoutVertexArray,rt.x,rt.y,Ue.x,Ue.y,0,1,fe),b.x+=2*rt.x,b.y+=2*rt.y,b.vertexCount+=2;const gt=M.vertexLength;this.indexArray.emplaceBack(gt,gt+2,gt+1),this.indexArray.emplaceBack(gt+1,gt+2,gt+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+T>Xr.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),Id[t.type]!=="Polygon")continue;const O=[],V=[],Z=M.vertexLength;for(const le of _)if(le.length!==0){le!==_[0]&&V.push(O.length/2);for(let fe=0;fe<le.length;fe++){const Pe=le[fe];Ii(this.layoutVertexArray,Pe.x,Pe.y,0,0,1,1,0),b.x+=Pe.x,b.y+=Pe.y,b.vertexCount+=1,O.push(Pe.x),O.push(Pe.y)}}const te=lf(O,V);for(let le=0;le<te.length;le+=3)this.indexArray.emplaceBack(Z+te[le],Z+te[le+2],Z+te[le+1]);M.primitiveLength+=te.length/3,M.vertexLength+=T;for(let le=0;le<b.vertexCount;le++){const fe=Math.floor(b.x/b.vertexCount),Pe=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(fe,Pe)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,y,f)}}function Ul(r,t){return r.x===t.x&&(r.x<0||r.x>si)||r.y===t.y&&(r.y<0||r.y>si)}function vf(r){return r.every(t=>t.x<0)||r.every(t=>t.x>si)||r.every(t=>t.y<0)||r.every(t=>t.y>si)}let Pd;sr("FillExtrusionBucket",To,{omit:["layers","features"]});var da={get paint(){return Pd=Pd||new g({"fill-extrusion-opacity":new or(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Sr(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new or(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new or(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zl(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Sr(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Sr(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new or(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class xf extends s{constructor(t){super(t,da)}createBucket(t){return new To(t)}queryRadius(){return Ic(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,n,a,f,y,_,b,T){const M=Pc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,b),O=this.paint.get("fill-extrusion-height").evaluate(n,a),V=this.paint.get("fill-extrusion-base").evaluate(n,a),Z=function(le,fe,Pe,De){const rt=[];for(const Ue of le){const Qe=[Ue.x,Ue.y,0,1];Eh(Qe,Qe,fe),rt.push(new j(Qe[0]/Qe[3],Qe[1]/Qe[3]))}return rt}(M,T),te=function(le,fe,Pe,De){const rt=[],Ue=[],Qe=De[8]*fe,gt=De[9]*fe,Dt=De[10]*fe,nr=De[11]*fe,Ar=De[8]*Pe,tr=De[9]*Pe,Yt=De[10]*Pe,yr=De[11]*Pe;for(const dr of le){const lr=[],Tt=[];for(const xr of dr){const gr=xr.x,jr=xr.y,jn=De[0]*gr+De[4]*jr+De[12],Ln=De[1]*gr+De[5]*jr+De[13],Wi=De[2]*gr+De[6]*jr+De[14],Ba=De[3]*gr+De[7]*jr+De[15],bs=Wi+Dt,Xi=Ba+nr,no=jn+Ar,io=Ln+tr,so=Wi+Yt,xi=Ba+yr,Ki=new j((jn+Qe)/Xi,(Ln+gt)/Xi);Ki.z=bs/Xi,lr.push(Ki);const Os=new j(no/xi,io/xi);Os.z=so/xi,Tt.push(Os)}rt.push(lr),Ue.push(Tt)}return[rt,Ue]}(f,V,O,T);return function(le,fe,Pe){let De=1/0;md(Pe,fe)&&(De=wf(Pe,fe[0]));for(let rt=0;rt<fe.length;rt++){const Ue=fe[rt],Qe=le[rt];for(let gt=0;gt<Ue.length-1;gt++){const Dt=Ue[gt],nr=[Dt,Ue[gt+1],Qe[gt+1],Qe[gt],Dt];pd(Pe,nr)&&(De=Math.min(De,wf(Pe,nr)))}}return De!==1/0&&De}(te[0],te[1],Z)}}function Js(r,t){return r.x*t.x+r.y*t.y}function wf(r,t){if(r.length===1){let n=0;const a=t[n++];let f;for(;!f||a.equals(f);)if(f=t[n++],!f)return 1/0;for(;n<t.length;n++){const y=t[n],_=r[0],b=f.sub(a),T=y.sub(a),M=_.sub(a),O=Js(b,b),V=Js(b,T),Z=Js(T,T),te=Js(M,b),le=Js(M,T),fe=O*Z-V*V,Pe=(Z*te-V*le)/fe,De=(O*le-V*te)/fe,rt=a.z*(1-Pe-De)+f.z*Pe+y.z*De;if(isFinite(rt))return rt}return 1/0}{let n=1/0;for(const a of t)n=Math.min(n,a.z);return n}}const bf=S([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Sf}=bf,Ef=S([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Tf}=Ef,Tp=Nl.VectorTileFeature.types,Fh=Math.cos(Math.PI/180*37.5),Oh=Math.pow(2,14)/.5;class Qs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new _o,this.layoutVertexArray2=new Ra,this.indexArray=new Ys,this.programConfigurations=new ha(t.layers,t.zoom),this.segments=new Xr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,a){this.hasPattern=zh("line",this.layers,n);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),_=[];for(const{feature:b,id:T,index:M,sourceLayerIndex:O}of t){const V=this.layers[0]._featureFilter.needGeometry,Z=Ol(b,V);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),Z,a))continue;const te=y?f.evaluate(Z,{},a):void 0,le={id:T,properties:b.properties,type:b.type,sourceLayerIndex:O,index:M,geometry:V?Z.geometry:Fl(b),patterns:{},sortKey:te};_.push(le)}y&&_.sort((b,T)=>b.sortKey-T.sortKey);for(const b of _){const{geometry:T,index:M,sourceLayerIndex:O}=b;if(this.hasPattern){const V=Dc("line",this.layers,b,this.zoom,n);this.patternFeatures.push(V)}else this.addFeature(b,T,M,a,{});n.featureIndex.insert(t[M].feature,T,M,O,this.index)}}update(t,n,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,a)}addFeatures(t,n,a){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Tf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,a,f,y){const _=this.layers[0].layout,b=_.get("line-join").evaluate(t,{}),T=_.get("line-cap"),M=_.get("line-miter-limit"),O=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const V of n)this.addLine(V,t,b,T,M,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,y,f)}addLine(t,n,a,f,y,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let De=0;De<t.length-1;De++)this.totalDistance+=t[De].dist(t[De+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=Tp[n.type]==="Polygon";let T=t.length;for(;T>=2&&t[T-1].equals(t[T-2]);)T--;let M=0;for(;M<T-1&&t[M].equals(t[M+1]);)M++;if(T<(b?3:2))return;a==="bevel"&&(y=1.05);const O=this.overscaling<=16?15*si/(512*this.overscaling):0,V=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let Z,te,le,fe,Pe;this.e1=this.e2=-1,b&&(Z=t[T-2],Pe=t[M].sub(Z)._unit()._perp());for(let De=M;De<T;De++){if(le=De===T-1?b?t[M+1]:void 0:t[De+1],le&&t[De].equals(le))continue;Pe&&(fe=Pe),Z&&(te=Z),Z=t[De],Pe=le?le.sub(Z)._unit()._perp():fe,fe=fe||Pe;let rt=fe.add(Pe);rt.x===0&&rt.y===0||rt._unit();const Ue=fe.x*Pe.x+fe.y*Pe.y,Qe=rt.x*Pe.x+rt.y*Pe.y,gt=Qe!==0?1/Qe:1/0,Dt=2*Math.sqrt(2-2*Qe),nr=Qe<Fh&&te&&le,Ar=fe.x*Pe.y-fe.y*Pe.x>0;if(nr&&De>M){const yr=Z.dist(te);if(yr>2*O){const dr=Z.sub(Z.sub(te)._mult(O/yr)._round());this.updateDistance(te,dr),this.addCurrentVertex(dr,fe,0,0,V),te=dr}}const tr=te&&le;let Yt=tr?a:b?"butt":f;if(tr&&Yt==="round"&&(gt<_?Yt="miter":gt<=2&&(Yt="fakeround")),Yt==="miter"&&gt>y&&(Yt="bevel"),Yt==="bevel"&&(gt>2&&(Yt="flipbevel"),gt<y&&(Yt="miter")),te&&this.updateDistance(te,Z),Yt==="miter")rt._mult(gt),this.addCurrentVertex(Z,rt,0,0,V);else if(Yt==="flipbevel"){if(gt>100)rt=Pe.mult(-1);else{const yr=gt*fe.add(Pe).mag()/fe.sub(Pe).mag();rt._perp()._mult(yr*(Ar?-1:1))}this.addCurrentVertex(Z,rt,0,0,V),this.addCurrentVertex(Z,rt.mult(-1),0,0,V)}else if(Yt==="bevel"||Yt==="fakeround"){const yr=-Math.sqrt(gt*gt-1),dr=Ar?yr:0,lr=Ar?0:yr;if(te&&this.addCurrentVertex(Z,fe,dr,lr,V),Yt==="fakeround"){const Tt=Math.round(180*Dt/Math.PI/20);for(let xr=1;xr<Tt;xr++){let gr=xr/Tt;if(gr!==.5){const jn=gr-.5;gr+=gr*jn*(gr-1)*((1.0904+Ue*(Ue*(3.55645-1.43519*Ue)-3.2452))*jn*jn+(.848013+Ue*(.215638*Ue-1.06021)))}const jr=Pe.sub(fe)._mult(gr)._add(fe)._unit()._mult(Ar?-1:1);this.addHalfVertex(Z,jr.x,jr.y,!1,Ar,0,V)}}le&&this.addCurrentVertex(Z,Pe,-dr,-lr,V)}else if(Yt==="butt")this.addCurrentVertex(Z,rt,0,0,V);else if(Yt==="square"){const yr=te?1:-1;this.addCurrentVertex(Z,rt,yr,yr,V)}else Yt==="round"&&(te&&(this.addCurrentVertex(Z,fe,0,0,V),this.addCurrentVertex(Z,fe,1,1,V,!0)),le&&(this.addCurrentVertex(Z,Pe,-1,-1,V,!0),this.addCurrentVertex(Z,Pe,0,0,V)));if(nr&&De<T-1){const yr=Z.dist(le);if(yr>2*O){const dr=Z.add(le.sub(Z)._mult(O/yr)._round());this.updateDistance(Z,dr),this.addCurrentVertex(dr,Pe,0,0,V),Z=dr}}}}addCurrentVertex(t,n,a,f,y,_=!1){const b=n.y*f-n.x,T=-n.y-n.x*f;this.addHalfVertex(t,n.x+n.y*a,n.y-n.x*a,_,!1,a,y),this.addHalfVertex(t,b,T,_,!0,-f,y),this.distance>Oh/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,a,f,y,_))}addHalfVertex({x:t,y:n},a,f,y,_,b,T){const M=.5*(this.lineClips?this.scaledDistance*(Oh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(y?1:0),(n<<1)+(_?1:0),Math.round(63*a)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const O=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),T.primitiveLength++),_?this.e2=O:this.e1=O}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let hn,ji;sr("LineBucket",Qs,{omit:["layers","patternFeatures"]});var Pi={get paint(){return ji=ji||new g({"line-opacity":new Sr(ye.paint_line["line-opacity"]),"line-color":new Sr(ye.paint_line["line-color"]),"line-translate":new or(ye.paint_line["line-translate"]),"line-translate-anchor":new or(ye.paint_line["line-translate-anchor"]),"line-width":new Sr(ye.paint_line["line-width"]),"line-gap-width":new Sr(ye.paint_line["line-gap-width"]),"line-offset":new Sr(ye.paint_line["line-offset"]),"line-blur":new Sr(ye.paint_line["line-blur"]),"line-dasharray":new yu(ye.paint_line["line-dasharray"]),"line-pattern":new zl(ye.paint_line["line-pattern"]),"line-gradient":new xc(ye.paint_line["line-gradient"])})},get layout(){return hn=hn||new g({"line-cap":new or(ye.layout_line["line-cap"]),"line-join":new Sr(ye.layout_line["line-join"]),"line-miter-limit":new or(ye.layout_line["line-miter-limit"]),"line-round-limit":new or(ye.layout_line["line-round-limit"]),"line-sort-key":new Sr(ye.layout_line["line-sort-key"])})}};class os extends Sr{possiblyEvaluate(t,n){return n=new tn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,a,f){return n=je({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,a,f)}}let xs;class Ku extends s{constructor(t){super(t,Pi),this.gradientVersion=0,xs||(xs=new os(Pi.paint.properties["line-width"].specification),xs.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof Ei,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=xs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Qs(t)}queryRadius(t){const n=t,a=Ri(vu("line-width",this,n),vu("line-gap-width",this,n)),f=vu("line-offset",this,n);return a/2+Math.abs(f)+Ic(this.paint.get("line-translate"))}queryIntersectsFeature(t,n,a,f,y,_,b){const T=Pc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,b),M=b/2*Ri(this.paint.get("line-width").evaluate(n,a),this.paint.get("line-gap-width").evaluate(n,a)),O=this.paint.get("line-offset").evaluate(n,a);return O&&(f=function(V,Z){const te=[];for(let le=0;le<V.length;le++){const fe=V[le],Pe=[];for(let De=0;De<fe.length;De++){const rt=fe[De-1],Ue=fe[De],Qe=fe[De+1],gt=De===0?new j(0,0):Ue.sub(rt)._unit()._perp(),Dt=De===fe.length-1?new j(0,0):Qe.sub(Ue)._unit()._perp(),nr=gt._add(Dt)._unit(),Ar=nr.x*Dt.x+nr.y*Dt.y;Ar!==0&&nr._mult(1/Ar),Pe.push(nr._mult(Z)._add(Ue))}te.push(Pe)}return te}(f,O*b)),function(V,Z,te){for(let le=0;le<Z.length;le++){const fe=Z[le];if(V.length>=3){for(let Pe=0;Pe<fe.length;Pe++)if(_u(V,fe[Pe]))return!0}if(wh(V,fe,te))return!0}return!1}(T,f,M)}isTileClipped(){return!0}}function Ri(r,t){return t>0?t+2*r:r}const Bc=S([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Su=S([{name:"a_projected_pos",components:3,type:"Float32"}],4);S([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Bh=S([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);S([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Nh=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Nc=S([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function eo(r,t,n){return r.sections.forEach(a=>{a.text=function(f,y,_){const b=y.layout.get("text-transform").evaluate(_,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),kn.applyArabicShaping&&(f=kn.applyArabicShaping(f)),f}(a.text,t,n)}),r}S([{name:"triangle",components:3,type:"Uint16"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),S([{type:"Float32",name:"offsetX"}]),S([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),S([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Eu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Zn=24,Fa=an,jc=function(r,t,n,a,f){var y,_,b=8*f-a-1,T=(1<<b)-1,M=T>>1,O=-7,V=f-1,Z=-1,te=r[t+V];for(V+=Z,y=te&(1<<-O)-1,te>>=-O,O+=b;O>0;y=256*y+r[t+V],V+=Z,O-=8);for(_=y&(1<<-O)-1,y>>=-O,O+=a;O>0;_=256*_+r[t+V],V+=Z,O-=8);if(y===0)y=1-M;else{if(y===T)return _?NaN:1/0*(te?-1:1);_+=Math.pow(2,a),y-=M}return(te?-1:1)*_*Math.pow(2,y-a)},jh=function(r,t,n,a,f,y){var _,b,T,M=8*y-f-1,O=(1<<M)-1,V=O>>1,Z=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,te=0,le=1,fe=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,_=O):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+V>=1?Z/T:Z*Math.pow(2,1-V))*T>=2&&(_++,T/=2),_+V>=O?(b=0,_=O):_+V>=1?(b=(t*T-1)*Math.pow(2,f),_+=V):(b=t*Math.pow(2,V-1)*Math.pow(2,f),_=0));f>=8;r[n+te]=255&b,te+=le,b/=256,f-=8);for(_=_<<f|b,M+=f;M>0;r[n+te]=255&_,te+=le,_/=256,M-=8);r[n+te-le]|=128*fe};function an(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}an.Varint=0,an.Fixed64=1,an.Bytes=2,an.Fixed32=5;var Yu=4294967296,ol=1/Yu,Uc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function ko(r){return r.type===an.Bytes?r.readVarint()+r.pos:r.pos+1}function Vl(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Vc(r,t,n){var a=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(a);for(var f=n.pos-1;f>=r;f--)n.buf[f+a]=n.buf[f]}function Uh(r,t){for(var n=0;n<r.length;n++)t.writeVarint(r[n])}function Ls(r,t){for(var n=0;n<r.length;n++)t.writeSVarint(r[n])}function Hl(r,t){for(var n=0;n<r.length;n++)t.writeFloat(r[n])}function fa(r,t){for(var n=0;n<r.length;n++)t.writeDouble(r[n])}function to(r,t){for(var n=0;n<r.length;n++)t.writeBoolean(r[n])}function kf(r,t){for(var n=0;n<r.length;n++)t.writeFixed32(r[n])}function Ad(r,t){for(var n=0;n<r.length;n++)t.writeSFixed32(r[n])}function Md(r,t){for(var n=0;n<r.length;n++)t.writeFixed64(r[n])}function kp(r,t){for(var n=0;n<r.length;n++)t.writeSFixed64(r[n])}function pa(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Tu(r,t,n){r[n]=t,r[n+1]=t>>>8,r[n+2]=t>>>16,r[n+3]=t>>>24}function Vh(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}an.prototype={destroy:function(){this.buf=null},readFields:function(r,t,n){for(n=n||this.length;this.pos<n;){var a=this.readVarint(),f=a>>3,y=this.pos;this.type=7&a,r(f,t,this),this.pos===y&&this.skip(a)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=pa(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=Vh(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=pa(this.buf,this.pos)+pa(this.buf,this.pos+4)*Yu;return this.pos+=8,r},readSFixed64:function(){var r=pa(this.buf,this.pos)+Vh(this.buf,this.pos+4)*Yu;return this.pos+=8,r},readFloat:function(){var r=jc(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=jc(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,n,a=this.buf;return t=127&(n=a[this.pos++]),n<128?t:(t|=(127&(n=a[this.pos++]))<<7,n<128?t:(t|=(127&(n=a[this.pos++]))<<14,n<128?t:(t|=(127&(n=a[this.pos++]))<<21,n<128?t:function(f,y,_){var b,T,M=_.buf;if(b=(112&(T=M[_.pos++]))>>4,T<128||(b|=(127&(T=M[_.pos++]))<<3,T<128)||(b|=(127&(T=M[_.pos++]))<<10,T<128)||(b|=(127&(T=M[_.pos++]))<<17,T<128)||(b|=(127&(T=M[_.pos++]))<<24,T<128)||(b|=(1&(T=M[_.pos++]))<<31,T<128))return Vl(f,b,y);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&Uc?function(n,a,f){return Uc.decode(n.subarray(a,f))}(this.buf,t,r):function(n,a,f){for(var y="",_=a;_<f;){var b,T,M,O=n[_],V=null,Z=O>239?4:O>223?3:O>191?2:1;if(_+Z>f)break;Z===1?O<128&&(V=O):Z===2?(192&(b=n[_+1]))==128&&(V=(31&O)<<6|63&b)<=127&&(V=null):Z===3?(T=n[_+2],(192&(b=n[_+1]))==128&&(192&T)==128&&((V=(15&O)<<12|(63&b)<<6|63&T)<=2047||V>=55296&&V<=57343)&&(V=null)):Z===4&&(T=n[_+2],M=n[_+3],(192&(b=n[_+1]))==128&&(192&T)==128&&(192&M)==128&&((V=(15&O)<<18|(63&b)<<12|(63&T)<<6|63&M)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,Z=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),_+=Z}return y}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==an.Bytes)return r.push(this.readVarint(t));var n=ko(this);for(r=r||[];this.pos<n;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==an.Bytes)return r.push(this.readSVarint());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==an.Bytes)return r.push(this.readBoolean());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==an.Bytes)return r.push(this.readFloat());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==an.Bytes)return r.push(this.readDouble());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==an.Bytes)return r.push(this.readFixed32());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==an.Bytes)return r.push(this.readSFixed32());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==an.Bytes)return r.push(this.readFixed64());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==an.Bytes)return r.push(this.readSFixed64());var t=ko(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===an.Varint)for(;this.buf[this.pos++]>127;);else if(t===an.Bytes)this.pos=this.readVarint()+this.pos;else if(t===an.Fixed32)this.pos+=4;else{if(t!==an.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Tu(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Tu(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Tu(this.buf,-1&r,this.pos),Tu(this.buf,Math.floor(r*ol),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Tu(this.buf,-1&r,this.pos),Tu(this.buf,Math.floor(r*ol),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,n){var a,f;if(t>=0?(a=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(a=~(-t%4294967296))?a=a+1|0:(a=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(y,_,b){b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,b.buf[b.pos]=127&(y>>>=7)}(a,0,n),function(y,_){var b=(7&y)<<4;_.buf[_.pos++]|=b|((y>>>=3)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y)))))}(f,n)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(a,f,y){for(var _,b,T=0;T<f.length;T++){if((_=f.charCodeAt(T))>55295&&_<57344){if(!b){_>56319||T+1===f.length?(a[y++]=239,a[y++]=191,a[y++]=189):b=_;continue}if(_<56320){a[y++]=239,a[y++]=191,a[y++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(a[y++]=239,a[y++]=191,a[y++]=189,b=null);_<128?a[y++]=_:(_<2048?a[y++]=_>>6|192:(_<65536?a[y++]=_>>12|224:(a[y++]=_>>18|240,a[y++]=_>>12&63|128),a[y++]=_>>6&63|128),a[y++]=63&_|128)}return y}(this.buf,r,this.pos);var n=this.pos-t;n>=128&&Vc(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(r){this.realloc(4),jh(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),jh(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=r[n]},writeRawMessage:function(r,t){this.pos++;var n=this.pos;r(t,this);var a=this.pos-n;a>=128&&Vc(n,a,this),this.pos=n-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,t,n){this.writeTag(r,an.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,Uh,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,Ls,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,to,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Hl,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,fa,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,kf,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,Ad,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,Md,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,kp,t)},writeBytesField:function(r,t){this.writeTag(r,an.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,an.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,an.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,an.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,an.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,an.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,an.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,an.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,an.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,an.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var al=B(Fa);const Hc=3;function ku(r,t,n){r===1&&n.readMessage(Cf,t)}function Cf(r,t,n){if(r===3){const{id:a,bitmap:f,width:y,height:_,left:b,top:T,advance:M}=n.readMessage(If,{});t.push({id:a,bitmap:new xu({width:y+2*Hc,height:_+2*Hc},f),metrics:{width:y,height:_,left:b,top:T,advance:M}})}}function If(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}const zd=Hc;function $c(r){let t=0,n=0;for(const _ of r)t+=_.w*_.h,n=Math.max(n,_.w);r.sort((_,b)=>b.h-_.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let f=0,y=0;for(const _ of r)for(let b=a.length-1;b>=0;b--){const T=a[b];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,y=Math.max(y,_.y+_.h),f=Math.max(f,_.x+_.w),_.w===T.w&&_.h===T.h){const M=a.pop();b<a.length&&(a[b]=M)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(a.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:f,h:y,fill:t/(f*y)||0}}const Fs=1;class Rd{constructor(t,{pixelRatio:n,version:a,stretchX:f,stretchY:y,content:_,textFitWidth:b,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=f,this.stretchY=y,this.content=_,this.version=a,this.textFitWidth=b,this.textFitHeight=T}get tl(){return[this.paddedRect.x+Fs,this.paddedRect.y+Fs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Fs,this.paddedRect.y+this.paddedRect.h-Fs]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Fs)/this.pixelRatio,(this.paddedRect.h-2*Fs)/this.pixelRatio]}}class Dd{constructor(t,n){const a={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(t,a,y),this.addImages(n,f,y);const{w:_,h:b}=$c(y),T=new Zi({width:_||1,height:b||1});for(const M in t){const O=t[M],V=a[M].paddedRect;Zi.copy(O.data,T,{x:0,y:0},{x:V.x+Fs,y:V.y+Fs},O.data)}for(const M in n){const O=n[M],V=f[M].paddedRect,Z=V.x+Fs,te=V.y+Fs,le=O.data.width,fe=O.data.height;Zi.copy(O.data,T,{x:0,y:0},{x:Z,y:te},O.data),Zi.copy(O.data,T,{x:0,y:fe-1},{x:Z,y:te-1},{width:le,height:1}),Zi.copy(O.data,T,{x:0,y:0},{x:Z,y:te+fe},{width:le,height:1}),Zi.copy(O.data,T,{x:le-1,y:0},{x:Z-1,y:te},{width:1,height:fe}),Zi.copy(O.data,T,{x:0,y:0},{x:Z+le,y:te},{width:1,height:fe})}this.image=T,this.iconPositions=a,this.patternPositions=f}addImages(t,n,a){for(const f in t){const y=t[f],_={x:0,y:0,w:y.data.width+2*Fs,h:y.data.height+2*Fs};a.push(_),n[f]=new Rd(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),n),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),n)}patchUpdatedImage(t,n,a){if(!t||!n||t.version===n.version)return;t.version=n.version;const[f,y]=t.tl;a.update(n.data,void 0,{x:f,y})}}var ll;sr("ImagePosition",Rd),sr("ImageAtlas",Dd),E.ah=void 0,(ll=E.ah||(E.ah={}))[ll.none=0]="none",ll[ll.horizontal=1]="horizontal",ll[ll.vertical=2]="vertical",ll[ll.horizontalOnly=3]="horizontalOnly";const ma=-17;class Gc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,n){const a=new Gc;return a.scale=t||1,a.fontStack=n,a}static forImage(t){const n=new Gc;return n.imageName=t,n}}class ga{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const a=new ga;for(let f=0;f<t.sections.length;f++){const y=t.sections[f];y.image?a.addImageSection(y):a.addTextSection(y,n)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let a=0;a<t.length;a++){const f=t.charCodeAt(a+1)||null,y=t.charCodeAt(a-1)||null;n+=f&&sl(f)&&!Eu[t[a+1]]||y&&sl(y)&&!Eu[t[a-1]]||!Eu[t[a]]?t[a]:Eu[t[a]]}return n}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&Qn[this.text.charCodeAt(a)];a++)t++;let n=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&Qn[this.text.charCodeAt(a)];a--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const a=new ga;return a.text=this.text.substring(t,n),a.sectionIndex=this.sectionIndex.slice(t,n),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}addTextSection(t,n){this.text+=t.text,this.sections.push(Gc.forText(t.scale,t.fontStack||n));const a=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(a)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Je("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Gc.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qc(r,t,n,a,f,y,_,b,T,M,O,V,Z,te,le){const fe=ga.fromFeature(r,f);let Pe;V===E.ah.vertical&&fe.verticalizePunctuation();const{processBidirectionalText:De,processStyledBidirectionalText:rt}=kn;if(De&&fe.sections.length===1){Pe=[];const gt=De(fe.toString(),ro(fe,M,y,t,a,te));for(const Dt of gt){const nr=new ga;nr.text=Dt,nr.sections=fe.sections;for(let Ar=0;Ar<Dt.length;Ar++)nr.sectionIndex.push(0);Pe.push(nr)}}else if(rt){Pe=[];const gt=rt(fe.text,fe.sectionIndex,ro(fe,M,y,t,a,te));for(const Dt of gt){const nr=new ga;nr.text=Dt[0],nr.sectionIndex=Dt[1],nr.sections=fe.sections,Pe.push(nr)}}else Pe=function(gt,Dt){const nr=[],Ar=gt.text;let tr=0;for(const Yt of Dt)nr.push(gt.substring(tr,Yt)),tr=Yt;return tr<Ar.length&&nr.push(gt.substring(tr,Ar.length)),nr}(fe,ro(fe,M,y,t,a,te));const Ue=[],Qe={positionedLines:Ue,text:fe.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(gt,Dt,nr,Ar,tr,Yt,yr,dr,lr,Tt,xr,gr){let jr=0,jn=ma,Ln=0,Wi=0;const Ba=dr==="right"?1:dr==="left"?0:.5;let bs=0;for(const xi of tr){xi.trim();const Ki=xi.getMaxScale(),Os=(Ki-1)*Zn,Ss={positionedGlyphs:[],lineOffset:0};gt.positionedLines[bs]=Ss;const oo=Ss.positionedGlyphs;let Es=0;if(!xi.length()){jn+=Yt,++bs;continue}for(let Co=0;Co<xi.length();Co++){const dn=xi.getSection(Co),Gn=xi.getSectionIndex(Co),Wn=xi.getCharCode(Co);let Ho=0,oi=null,Kh=null,Zl=null,Wl=Zn;const Na=!(lr===E.ah.horizontal||!xr&&!mu(Wn)||xr&&(Qn[Wn]||(Xi=Wn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Xi)))));if(dn.imageName){const _a=Ar[dn.imageName];if(!_a)continue;Zl=dn.imageName,gt.iconsInText=gt.iconsInText||!0,Kh=_a.paddedRect;const as=_a.displaySize;dn.scale=dn.scale*Zn/gr,oi={width:as[0],height:as[1],left:Fs,top:-3,advance:Na?as[1]:as[0]},Ho=Os+(Zn-as[1]*dn.scale),Wl=oi.advance;const Iu=Na?as[0]*dn.scale-Zn*Ki:as[1]*dn.scale-Zn*Ki;Iu>0&&Iu>Es&&(Es=Iu)}else{const _a=nr[dn.fontStack],as=_a&&_a[Wn];if(as&&as.rect)Kh=as.rect,oi=as.metrics;else{const Iu=Dt[dn.fontStack],Ud=Iu&&Iu[Wn];if(!Ud)continue;oi=Ud.metrics}Ho=(Ki-dn.scale)*Zn}Na?(gt.verticalizable=!0,oo.push({glyph:Wn,imageName:Zl,x:jr,y:jn+Ho,vertical:Na,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:Gn,metrics:oi,rect:Kh}),jr+=Wl*dn.scale+Tt):(oo.push({glyph:Wn,imageName:Zl,x:jr,y:jn+Ho,vertical:Na,scale:dn.scale,fontStack:dn.fontStack,sectionIndex:Gn,metrics:oi,rect:Kh}),jr+=oi.advance*dn.scale+Tt)}oo.length!==0&&(Ln=Math.max(jr-Tt,Ln),Ip(oo,0,oo.length-1,Ba,Es)),jr=0;const ya=Yt*Ki+Es;Ss.lineOffset=Math.max(Es,Os),jn+=ya,Wi=Math.max(ya,Wi),++bs}var Xi;const no=jn-ma,{horizontalAlign:io,verticalAlign:so}=Zc(yr);(function(xi,Ki,Os,Ss,oo,Es,ya,Co,dn){const Gn=(Ki-Os)*oo;let Wn=0;Wn=Es!==ya?-Co*Ss-ma:(-Ss*dn+.5)*ya;for(const Ho of xi)for(const oi of Ho.positionedGlyphs)oi.x+=Gn,oi.y+=Wn})(gt.positionedLines,Ba,io,so,Ln,Wi,Yt,no,tr.length),gt.top+=-so*no,gt.bottom=gt.top+no,gt.left+=-io*Ln,gt.right=gt.left+Ln}(Qe,t,n,a,Pe,_,b,T,V,M,Z,le),!function(gt){for(const Dt of gt)if(Dt.positionedGlyphs.length!==0)return!1;return!0}(Ue)&&Qe}const Qn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Cp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Pf={40:!0};function Af(r,t,n,a,f,y){if(t.imageName){const _=a[t.imageName];return _?_.displaySize[0]*t.scale*Zn/y+f:0}{const _=n[t.fontStack],b=_&&_[r];return b?b.metrics.advance*t.scale+f:0}}function Mf(r,t,n,a){const f=Math.pow(r-t,2);return a?r<t?f/2:2*f:f+Math.abs(n)*n}function zf(r,t,n){let a=0;return r===10&&(a-=1e4),n&&(a+=150),r!==40&&r!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function Ld(r,t,n,a,f,y){let _=null,b=Mf(t,n,f,y);for(const T of a){const M=Mf(t-T.x,n,f,y)+T.badness;M<=b&&(_=T,b=M)}return{index:r,x:t,priorBreak:_,badness:b}}function Rf(r){return r?Rf(r.priorBreak).concat(r.index):[]}function ro(r,t,n,a,f,y){if(!r)return[];const _=[],b=function(V,Z,te,le,fe,Pe){let De=0;for(let rt=0;rt<V.length();rt++){const Ue=V.getSection(rt);De+=Af(V.getCharCode(rt),Ue,le,fe,Z,Pe)}return De/Math.max(1,Math.ceil(De/te))}(r,t,n,a,f,y),T=r.text.indexOf("​")>=0;let M=0;for(let V=0;V<r.length();V++){const Z=r.getSection(V),te=r.getCharCode(V);if(Qn[te]||(M+=Af(te,Z,a,f,t,y)),V<r.length()-1){const le=!((O=te)<11904)&&(!!Qr["CJK Compatibility Forms"](O)||!!Qr["CJK Compatibility"](O)||!!Qr["CJK Strokes"](O)||!!Qr["CJK Symbols and Punctuation"](O)||!!Qr["Enclosed CJK Letters and Months"](O)||!!Qr["Halfwidth and Fullwidth Forms"](O)||!!Qr["Ideographic Description Characters"](O)||!!Qr["Vertical Forms"](O)||pu.test(String.fromCodePoint(O)));(Cp[te]||le||Z.imageName||V!==r.length()-2&&Pf[r.getCharCode(V+1)])&&_.push(Ld(V+1,M,b,_,zf(te,r.getCharCode(V+1),le&&T),!1))}}var O;return Rf(Ld(r.length(),M,b,_,0,!0))}function Zc(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Ip(r,t,n,a,f){if(!a&&!f)return;const y=r[n],_=(r[n].x+y.metrics.advance*y.scale)*a;for(let b=t;b<=n;b++)r[b].x-=_,r[b].y+=f}function $l(r,t,n){const{horizontalAlign:a,verticalAlign:f}=Zc(n),y=t[0]-r.displaySize[0]*a,_=t[1]-r.displaySize[1]*f;return{image:r,top:_,bottom:_+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function Wc(r){var t,n;let a=r.left,f=r.top,y=r.right-a,_=r.bottom-f;const b=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",M=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(T==="proportional"){if(b==="stretchOnly"&&y/_<M||b==="proportional"){const O=Math.ceil(_*M);a*=O/y,y=O}}else if(b==="proportional"&&T==="stretchOnly"&&M!==0&&y/_>M){const O=Math.ceil(y/M);f*=O/_,_=O}return{x1:a,y1:f,x2:a+y,y2:f+_}}function Gl(r,t,n,a,f,y){const _=r.image;let b;if(_.content){const Pe=_.content,De=_.pixelRatio||1;b=[Pe[0]/De,Pe[1]/De,_.displaySize[0]-Pe[2]/De,_.displaySize[1]-Pe[3]/De]}const T=t.left*y,M=t.right*y;let O,V,Z,te;n==="width"||n==="both"?(te=f[0]+T-a[3],V=f[0]+M+a[1]):(te=f[0]+(T+M-_.displaySize[0])/2,V=te+_.displaySize[0]);const le=t.top*y,fe=t.bottom*y;return n==="height"||n==="both"?(O=f[1]+le-a[0],Z=f[1]+fe+a[2]):(O=f[1]+(le+fe-_.displaySize[1])/2,Z=O+_.displaySize[1]),{image:_,top:O,right:V,bottom:Z,left:te,collisionPadding:b}}const ql=255,Vo=128,Oa=ql*Vo;function Df(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new tn(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:f}=n;let y=0;for(;y<a.length&&a[y]<=r;)y++;y=Math.max(0,y-1);let _=y;for(;_<a.length&&a[_]<r+1;)_++;_=Math.min(a.length-1,_);const b=a[y],T=a[_];return n.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:T,interpolationType:f}:{kind:"camera",minZoom:b,maxZoom:T,minSize:n.evaluate(new tn(b)),maxSize:n.evaluate(new tn(T)),interpolationType:f}}}function Xc(r,t,n){let a="never";const f=r.get(t);return f?a=f:r.get(n)&&(a="always"),a}const Pp=Nl.VectorTileFeature.types,Lf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Kc(r,t,n,a,f,y,_,b,T,M,O,V,Z){const te=b?Math.min(Oa,Math.round(b[0])):0,le=b?Math.min(Oa,Math.round(b[1])):0;r.emplaceBack(t,n,Math.round(32*a),Math.round(32*f),y,_,(te<<1)+(T?1:0),le,16*M,16*O,256*V,256*Z)}function Ju(r,t,n){r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n),r.emplaceBack(t.x,t.y,n)}function Hh(r){for(const t of r.sections)if(za(t.text))return!0;return!1}class $h{constructor(t){this.layoutVertexArray=new Ks,this.indexArray=new Ys,this.programConfigurations=t,this.segments=new Xr,this.dynamicLayoutVertexArray=new No,this.opacityVertexArray=new is,this.hasVisibleVertices=!1,this.placedSymbolArray=new Sn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,a,f){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Su.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Lf,!0),this.opacityVertexBuffer.itemSize=1),(a||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}sr("SymbolBuffers",$h);class Yc{constructor(t,n,a){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new a,this.segments=new Xr,this.collisionVertexArray=new vo}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Bh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}sr("CollisionBuffers",Yc);class Qu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bh([]),this.placementViewportMatrix=bh([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Df(this.zoom,n["text-size"]),this.iconSizeData=Df(this.zoom,n["icon-size"]);const a=this.layers[0].layout,f=a.get("symbol-sort-key"),y=a.get("symbol-z-order");this.canOverlap=Xc(a,"text-overlap","text-allow-overlap")!=="never"||Xc(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(_=>E.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new $h(new ha(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new $h(new ha(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Cn,this.lineVertexArray=new Mi,this.symbolInstances=new Wr,this.textAnchorOffsets=new In}calculateGlyphDependencies(t,n,a,f,y){for(let _=0;_<t.length;_++)if(n[t.charCodeAt(_)]=!0,(a||f)&&y){const b=Eu[t.charAt(_)];b&&(n[b.charCodeAt(0)]=!0)}}populate(t,n,a){const f=this.layers[0],y=f.layout,_=y.get("text-font"),b=y.get("text-field"),T=y.get("icon-image"),M=(b.value.kind!=="constant"||b.value.value instanceof di&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),O=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,V=y.get("symbol-sort-key");if(this.features=[],!M&&!O)return;const Z=n.iconDependencies,te=n.glyphDependencies,le=n.availableImages,fe=new tn(this.zoom);for(const{feature:Pe,id:De,index:rt,sourceLayerIndex:Ue}of t){const Qe=f._featureFilter.needGeometry,gt=Ol(Pe,Qe);if(!f._featureFilter.filter(fe,gt,a))continue;let Dt,nr;if(Qe||(gt.geometry=Fl(Pe)),M){const tr=f.getValueAndResolveTokens("text-field",gt,a,le),Yt=di.factory(tr),yr=this.hasRTLText=this.hasRTLText||Hh(Yt);(!yr||kn.getRTLTextPluginStatus()==="unavailable"||yr&&kn.isParsed())&&(Dt=eo(Yt,f,gt))}if(O){const tr=f.getValueAndResolveTokens("icon-image",gt,a,le);nr=tr instanceof Hn?tr:Hn.fromString(tr)}if(!Dt&&!nr)continue;const Ar=this.sortFeaturesByKey?V.evaluate(gt,{},a):void 0;if(this.features.push({id:De,text:Dt,icon:nr,index:rt,sourceLayerIndex:Ue,geometry:gt.geometry,properties:Pe.properties,type:Pp[Pe.type],sortKey:Ar}),nr&&(Z[nr.name]=!0),Dt){const tr=_.evaluate(gt,{},a).join(","),Yt=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ah.vertical)>=0;for(const yr of Dt.sections)if(yr.image)Z[yr.image.name]=!0;else{const dr=vc(Dt.toString()),lr=yr.fontStack||tr,Tt=te[lr]=te[lr]||{};this.calculateGlyphDependencies(yr.text,Tt,Yt,this.allowVerticalPlacement,dr)}}}y.get("symbol-placement")==="line"&&(this.features=function(Pe){const De={},rt={},Ue=[];let Qe=0;function gt(tr){Ue.push(Pe[tr]),Qe++}function Dt(tr,Yt,yr){const dr=rt[tr];return delete rt[tr],rt[Yt]=dr,Ue[dr].geometry[0].pop(),Ue[dr].geometry[0]=Ue[dr].geometry[0].concat(yr[0]),dr}function nr(tr,Yt,yr){const dr=De[Yt];return delete De[Yt],De[tr]=dr,Ue[dr].geometry[0].shift(),Ue[dr].geometry[0]=yr[0].concat(Ue[dr].geometry[0]),dr}function Ar(tr,Yt,yr){const dr=yr?Yt[0][Yt[0].length-1]:Yt[0][0];return`${tr}:${dr.x}:${dr.y}`}for(let tr=0;tr<Pe.length;tr++){const Yt=Pe[tr],yr=Yt.geometry,dr=Yt.text?Yt.text.toString():null;if(!dr){gt(tr);continue}const lr=Ar(dr,yr),Tt=Ar(dr,yr,!0);if(lr in rt&&Tt in De&&rt[lr]!==De[Tt]){const xr=nr(lr,Tt,yr),gr=Dt(lr,Tt,Ue[xr].geometry);delete De[lr],delete rt[Tt],rt[Ar(dr,Ue[gr].geometry,!0)]=gr,Ue[xr].geometry=null}else lr in rt?Dt(lr,Tt,yr):Tt in De?nr(lr,Tt,yr):(gt(tr),De[lr]=Qe-1,rt[Tt]=Qe-1)}return Ue.filter(tr=>tr.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pe,De)=>Pe.sortKey-De.sortKey)}update(t,n,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const a=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(n[t.segment+1]),y=t.dist(n[t.segment]);const _={};for(let b=t.segment+1;b<n.length;b++)_[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:f},b<n.length-1&&(f+=n[b+1].dist(n[b]));for(let b=t.segment||0;b>=0;b--)_[b]={x:n[b].x,y:n[b].y,tileUnitDistanceFromAnchor:y},b>0&&(y+=n[b-1].dist(n[b]));for(let b=0;b<n.length;b++){const T=_[b];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,n,a,f,y,_,b,T,M,O,V,Z){const te=t.indexArray,le=t.layoutVertexArray,fe=t.segments.prepareSegment(4*n.length,le,te,this.canOverlap?_.sortKey:void 0),Pe=this.glyphOffsetArray.length,De=fe.vertexLength,rt=this.allowVerticalPlacement&&b===E.ah.vertical?Math.PI/2:0,Ue=_.text&&_.text.sections;for(let Qe=0;Qe<n.length;Qe++){const{tl:gt,tr:Dt,bl:nr,br:Ar,tex:tr,pixelOffsetTL:Yt,pixelOffsetBR:yr,minFontScaleX:dr,minFontScaleY:lr,glyphOffset:Tt,isSDF:xr,sectionIndex:gr}=n[Qe],jr=fe.vertexLength,jn=Tt[1];Kc(le,T.x,T.y,gt.x,jn+gt.y,tr.x,tr.y,a,xr,Yt.x,Yt.y,dr,lr),Kc(le,T.x,T.y,Dt.x,jn+Dt.y,tr.x+tr.w,tr.y,a,xr,yr.x,Yt.y,dr,lr),Kc(le,T.x,T.y,nr.x,jn+nr.y,tr.x,tr.y+tr.h,a,xr,Yt.x,yr.y,dr,lr),Kc(le,T.x,T.y,Ar.x,jn+Ar.y,tr.x+tr.w,tr.y+tr.h,a,xr,yr.x,yr.y,dr,lr),Ju(t.dynamicLayoutVertexArray,T,rt),te.emplaceBack(jr,jr+1,jr+2),te.emplaceBack(jr+1,jr+2,jr+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),Qe!==n.length-1&&gr===n[Qe+1].sectionIndex||t.programConfigurations.populatePaintArrays(le.length,_,_.index,{},Z,Ue&&Ue[gr])}t.placedSymbolArray.emplaceBack(T.x,T.y,Pe,this.glyphOffsetArray.length-Pe,De,M,O,T.segment,a?a[0]:0,a?a[1]:0,f[0],f[1],b,0,!1,0,V)}_addCollisionDebugVertex(t,n,a,f,y,_){return n.emplaceBack(0,0),t.emplaceBack(a.x,a.y,f,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,n,a,f,y,_,b){const T=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),M=T.vertexLength,O=y.layoutVertexArray,V=y.collisionVertexArray,Z=b.anchorX,te=b.anchorY;this._addCollisionDebugVertex(O,V,_,Z,te,new j(t,n)),this._addCollisionDebugVertex(O,V,_,Z,te,new j(a,n)),this._addCollisionDebugVertex(O,V,_,Z,te,new j(a,f)),this._addCollisionDebugVertex(O,V,_,Z,te,new j(t,f)),T.vertexLength+=4;const le=y.indexArray;le.emplaceBack(M,M+1),le.emplaceBack(M+1,M+2),le.emplaceBack(M+2,M+3),le.emplaceBack(M+3,M),T.primitiveLength+=4}addDebugCollisionBoxes(t,n,a,f){for(let y=t;y<n;y++){const _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,f?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Yc(zs,Nh.members,ii),this.iconCollisionBox=new Yc(zs,Nh.members,ii);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,a,f,y,_,b,T,M){const O={};for(let V=n;V<a;V++){const Z=t.get(V);O.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},O.textFeatureIndex=Z.featureIndex;break}for(let V=f;V<y;V++){const Z=t.get(V);O.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},O.verticalTextFeatureIndex=Z.featureIndex;break}for(let V=_;V<b;V++){const Z=t.get(V);O.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},O.iconFeatureIndex=Z.featureIndex;break}for(let V=T;V<M;V++){const Z=t.get(V);O.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},O.verticalIconFeatureIndex=Z.featureIndex;break}return O}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const a=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const a=t.placedSymbolArray.get(n),f=a.vertexStartIndex+4*a.numGlyphs;for(let y=a.vertexStartIndex;y<f;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),a=Math.cos(t),f=[],y=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const T=this.symbolInstances.get(b);f.push(0|Math.round(n*T.anchorX+a*T.anchorY)),y.push(T.featureIndex)}return _.sort((b,T)=>f[b]-f[T]||y[T]-y[b]),_}addToSortKeyRanges(t,n){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===n?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const a=this.symbolInstances.get(n);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((f,y,_)=>{f>=0&&_.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Fd,Gh;sr("SymbolBucket",Qu,{omit:["layers","collisionBoxArray","features","compareText"]}),Qu.MAX_GLYPHS=65535,Qu.addDynamicAttributes=Ju;var ec={get paint(){return Gh=Gh||new g({"icon-opacity":new Sr(ye.paint_symbol["icon-opacity"]),"icon-color":new Sr(ye.paint_symbol["icon-color"]),"icon-halo-color":new Sr(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Sr(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Sr(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new or(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new or(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Sr(ye.paint_symbol["text-opacity"]),"text-color":new Sr(ye.paint_symbol["text-color"],{runtimeType:_n,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Sr(ye.paint_symbol["text-halo-color"]),"text-halo-width":new Sr(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Sr(ye.paint_symbol["text-halo-blur"]),"text-translate":new or(ye.paint_symbol["text-translate"]),"text-translate-anchor":new or(ye.paint_symbol["text-translate-anchor"])})},get layout(){return Fd=Fd||new g({"symbol-placement":new or(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new or(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new or(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Sr(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new or(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new or(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new or(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new or(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new or(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new or(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Sr(ye.layout_symbol["icon-size"]),"icon-text-fit":new or(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new or(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Sr(ye.layout_symbol["icon-image"]),"icon-rotate":new Sr(ye.layout_symbol["icon-rotate"]),"icon-padding":new Sr(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new or(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Sr(ye.layout_symbol["icon-offset"]),"icon-anchor":new Sr(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new or(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new or(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new or(ye.layout_symbol["text-rotation-alignment"]),"text-field":new Sr(ye.layout_symbol["text-field"]),"text-font":new Sr(ye.layout_symbol["text-font"]),"text-size":new Sr(ye.layout_symbol["text-size"]),"text-max-width":new Sr(ye.layout_symbol["text-max-width"]),"text-line-height":new or(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Sr(ye.layout_symbol["text-letter-spacing"]),"text-justify":new Sr(ye.layout_symbol["text-justify"]),"text-radial-offset":new Sr(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new or(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Sr(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Sr(ye.layout_symbol["text-anchor"]),"text-max-angle":new or(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new or(ye.layout_symbol["text-writing-mode"]),"text-rotate":new Sr(ye.layout_symbol["text-rotate"]),"text-padding":new or(ye.layout_symbol["text-padding"]),"text-keep-upright":new or(ye.layout_symbol["text-keep-upright"]),"text-transform":new Sr(ye.layout_symbol["text-transform"]),"text-offset":new Sr(ye.layout_symbol["text-offset"]),"text-allow-overlap":new or(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new or(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new or(ye.layout_symbol["text-ignore-placement"]),"text-optional":new or(ye.layout_symbol["text-optional"])})}};class qh{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ui,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sr("FormatSectionOverride",qh,{omit:["defaultValue"]});class Cu extends s{constructor(t){super(t,ec)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const f=[];for(const y of a)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,a,f){const y=this.layout.get(t).evaluate(n,{},a,f),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Ca(_.value)||!y?y:function(b,T){return T.replace(/{([^{}]+)}/g,(M,O)=>b&&O in b?String(b[O]):"")}(n.properties,y)}createBucket(t){return new Qu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ec.paint.overridableProperties){if(!Cu.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),a=new qh(n),f=new fs(a,n.property.specification);let y=null;y=n.value.kind==="constant"||n.value.kind==="source"?new Qa("source",f):new el("composite",f,n.value.zoomStops),this.paint._values[t]=new Ps(n.property,y,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,a){return!(!this.layout||n.isDataDriven()||a.isDataDriven())&&Cu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const a=t.get("text-field"),f=ec.paint.properties[n];let y=!1;const _=b=>{for(const T of b)if(f.overrides&&f.overrides.hasOverride(T))return void(y=!0)};if(a.value.kind==="constant"&&a.value.value instanceof di)_(a.value.value.sections);else if(a.value.kind==="source"){const b=M=>{y||(M instanceof Di&&nn(M.value)===wi?_(M.value.sections):M instanceof Hi?_(M.sections):M.eachChild(b))},T=a.value;T._styleExpression&&b(T._styleExpression.expression)}return y}}let Od;var Ap={get paint(){return Od=Od||new g({"background-color":new or(ye.paint_background["background-color"]),"background-pattern":new yu(ye.paint_background["background-pattern"]),"background-opacity":new or(ye.paint_background["background-opacity"])})}};class Zh extends s{constructor(t){super(t,Ap)}}let Ff;var Jc={get paint(){return Ff=Ff||new g({"raster-opacity":new or(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new or(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new or(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new or(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new or(ye.paint_raster["raster-saturation"]),"raster-contrast":new or(ye.paint_raster["raster-contrast"]),"raster-resampling":new or(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new or(ye.paint_raster["raster-fade-duration"])})}};class Mp extends s{constructor(t){super(t,Jc)}}class Wh extends s{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class i{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const o=63710088e-1;class p{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new p(qe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,a=this.lat*n,f=t.lat*n,y=Math.sin(a)*Math.sin(f)+Math.cos(a)*Math.cos(f)*Math.cos((t.lng-this.lng)*n);return o*Math.acos(Math.min(y,1))}static convert(t){if(t instanceof p)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new p(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new p(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const w=2*Math.PI*o;function P(r){return w*Math.cos(r*Math.PI/180)}function L(r){return(180+r)/360}function ie(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Re(r,t){return r/P(t)}function He(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class mt{constructor(t,n,a=0){this.x=+t,this.y=+n,this.z=+a}static fromLngLat(t,n=0){const a=p.convert(t);return new mt(L(a.lng),ie(a.lat),Re(n,a.lat))}toLngLat(){return new p(360*this.x-180,He(this.y))}toAltitude(){return this.z*P(He(this.y))}meterInMercatorCoordinateUnits(){return 1/w*(t=He(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ot(r,t,n){var a=2*Math.PI*6378137/256/Math.pow(2,n);return[r*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class jt{constructor(t,n,a){if(!function(f,y,_){return!(f<0||f>25||_<0||_>=Math.pow(2,f)||y<0||y>=Math.pow(2,f))}(t,n,a))throw new Error(`x=${n}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=a,this.key=mr(0,t,t,n,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,a){const f=(_=this.y,b=this.z,T=Ot(256*(y=this.x),256*(_=Math.pow(2,b)-_-1),b),M=Ot(256*(y+1),256*(_+1),b),T[0]+","+T[1]+","+M[0]+","+M[1]);var y,_,b,T,M;const O=function(V,Z,te){let le,fe="";for(let Pe=V;Pe>0;Pe--)le=1<<Pe-1,fe+=(Z&le?1:0)+(te&le?2:0);return fe}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,O).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new j((t.x*n-this.x)*si,(t.y*n-this.y)*si)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ft{constructor(t,n){this.wrap=t,this.canonical=n,this.key=mr(t,n.z,n.z,n.x,n.y)}}class er{constructor(t,n,a,f,y){if(t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=n,this.canonical=new jt(a,+f,+y),this.key=mr(n,t,a,f,y)}clone(){return new er(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new er(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new er(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?mr(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):mr(this.wrap*+n,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new er(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,a=2*this.canonical.x,f=2*this.canonical.y;return[new er(n,this.wrap,n,a,f),new er(n,this.wrap,n,a+1,f),new er(n,this.wrap,n,a,f+1),new er(n,this.wrap,n,a+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new er(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new er(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ft(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new mt(t.x-this.wrap,t.y))}}function mr(r,t,n,a,f){(r*=2)<0&&(r=-1*r-1);const y=1<<n;return(y*y*r+y*f+a).toString(36)+n.toString(36)+t.toString(36)}sr("CanonicalTileID",jt),sr("OverscaledTileID",er,{omit:["posMatrix"]});class br{constructor(t,n,a,f=1,y=1,_=1,b=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void Je(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const T=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=_,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<T;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(T,M)]=this.data[this._idx(T-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,T)]=this.data[this._idx(M,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<T;M++)for(let O=0;O<T;O++){const V=this.get(M,O);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(t,n){const a=new Uint8Array(this.data.buffer),f=4*this._idx(t,n);return this.unpack(a[f],a[f+1],a[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,a){return t*this.redFactor+n*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new Zi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=n*this.dim,y=n*this.dim+this.dim,_=a*this.dim,b=a*this.dim+this.dim;switch(n){case-1:f=y-1;break;case 1:y=f+1}switch(a){case-1:_=b-1;break;case 1:b=_+1}const T=-n*this.dim,M=-a*this.dim;for(let O=_;O<b;O++)for(let V=f;V<y;V++)this.data[this._idx(V,O)]=t.data[this._idx(V+T,O+M)]}}sr("DEMData",br);class vi{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const a=t[n];this._stringToNumber[a]=n,this._numberToString[n]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class lt{constructor(t,n,a,f,y){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=a,t._y=f,this.properties=t.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class We{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Il(si,16,0),this.grid3D=new Il(si,16,0),this.featureIndexArray=new Nn,this.promoteId=n}insert(t,n,a,f,y,_){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,f,y);const T=_?this.grid3D:this.grid;for(let M=0;M<n.length;M++){const O=n[M],V=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<O.length;Z++){const te=O[Z];V[0]=Math.min(V[0],te.x),V[1]=Math.min(V[1],te.y),V[2]=Math.max(V[2],te.x),V[3]=Math.max(V[3],te.y)}V[0]<si&&V[1]<si&&V[2]>=0&&V[3]>=0&&T.insert(b,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Nl.VectorTile(new al(this.rawTileData)).layers,this.sourceLayerCoder=new vi(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,a,f){this.loadVTLayers();const y=t.params||{},_=si/t.tileSize/t.scale,b=lu(y.filter),T=t.queryGeometry,M=t.queryPadding*_,O=Wt(T),V=this.grid.query(O.minX-M,O.minY-M,O.maxX+M,O.maxY+M),Z=Wt(t.cameraQueryGeometry),te=this.grid3D.query(Z.minX-M,Z.minY-M,Z.maxX+M,Z.maxY+M,(Pe,De,rt,Ue)=>function(Qe,gt,Dt,nr,Ar){for(const Yt of Qe)if(gt<=Yt.x&&Dt<=Yt.y&&nr>=Yt.x&&Ar>=Yt.y)return!0;const tr=[new j(gt,Dt),new j(gt,Ar),new j(nr,Ar),new j(nr,Dt)];if(Qe.length>2){for(const Yt of tr)if(_u(Qe,Yt))return!0}for(let Yt=0;Yt<Qe.length-1;Yt++)if(Qd(Qe[Yt],Qe[Yt+1],tr))return!0;return!1}(t.cameraQueryGeometry,Pe-M,De-M,rt+M,Ue+M));for(const Pe of te)V.push(Pe);V.sort(Er);const le={};let fe;for(let Pe=0;Pe<V.length;Pe++){const De=V[Pe];if(De===fe)continue;fe=De;const rt=this.featureIndexArray.get(De);let Ue=null;this.loadMatchingFeature(le,rt.bucketIndex,rt.sourceLayerIndex,rt.featureIndex,b,y.layers,y.availableImages,n,a,f,(Qe,gt,Dt)=>(Ue||(Ue=Fl(Qe)),gt.queryIntersectsFeature(T,Qe,Dt,Ue,this.z,t.transform,_,t.pixelPosMatrix)))}return le}loadMatchingFeature(t,n,a,f,y,_,b,T,M,O,V){const Z=this.bucketLayerIDs[n];if(_&&!function(Pe,De){for(let rt=0;rt<Pe.length;rt++)if(De.indexOf(Pe[rt])>=0)return!0;return!1}(_,Z))return;const te=this.sourceLayerCoder.decode(a),le=this.vtLayers[te].feature(f);if(y.needGeometry){const Pe=Ol(le,!0);if(!y.filter(new tn(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!y.filter(new tn(this.tileID.overscaledZ),le))return;const fe=this.getId(le,te);for(let Pe=0;Pe<Z.length;Pe++){const De=Z[Pe];if(_&&_.indexOf(De)<0)continue;const rt=T[De];if(!rt)continue;let Ue={};fe&&O&&(Ue=O.getState(rt.sourceLayer||"_geojsonTileLayer",fe));const Qe=je({},M[De]);Qe.paint=dt(Qe.paint,rt.paint,le,Ue,b),Qe.layout=dt(Qe.layout,rt.layout,le,Ue,b);const gt=!V||V(le,rt,Ue);if(!gt)continue;const Dt=new lt(le,this.z,this.x,this.y,fe);Dt.layer=Qe;let nr=t[De];nr===void 0&&(nr=t[De]=[]),nr.push({featureIndex:f,feature:Dt,intersectionZ:gt})}}lookupSymbolFeatures(t,n,a,f,y,_,b,T){const M={};this.loadVTLayers();const O=lu(y);for(const V of t)this.loadMatchingFeature(M,a,f,V,O,_,b,T,n);return M}hasLayer(t){for(const n of this.bucketLayerIDs)for(const a of n)if(t===a)return!0;return!1}getId(t,n){let a=t.id;return this.promoteId&&(a=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof a=="boolean"&&(a=Number(a))),a}}function dt(r,t,n,a,f){return ot(r,(y,_)=>{const b=t instanceof Ml?t.get(_):null;return b&&b.evaluate?b.evaluate(n,a,f):b})}function Wt(r){let t=1/0,n=1/0,a=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),n=Math.min(n,y.y),a=Math.max(a,y.x),f=Math.max(f,y.y);return{minX:t,minY:n,maxX:a,maxY:f}}function Er(r,t){return t-r}function Or(r,t,n,a,f){const y=[];for(let _=0;_<r.length;_++){const b=r[_];let T;for(let M=0;M<b.length-1;M++){let O=b[M],V=b[M+1];O.x<t&&V.x<t||(O.x<t?O=new j(t,O.y+(t-O.x)/(V.x-O.x)*(V.y-O.y))._round():V.x<t&&(V=new j(t,O.y+(t-O.x)/(V.x-O.x)*(V.y-O.y))._round()),O.y<n&&V.y<n||(O.y<n?O=new j(O.x+(n-O.y)/(V.y-O.y)*(V.x-O.x),n)._round():V.y<n&&(V=new j(O.x+(n-O.y)/(V.y-O.y)*(V.x-O.x),n)._round()),O.x>=a&&V.x>=a||(O.x>=a?O=new j(a,O.y+(a-O.x)/(V.x-O.x)*(V.y-O.y))._round():V.x>=a&&(V=new j(a,O.y+(a-O.x)/(V.x-O.x)*(V.y-O.y))._round()),O.y>=f&&V.y>=f||(O.y>=f?O=new j(O.x+(f-O.y)/(V.y-O.y)*(V.x-O.x),f)._round():V.y>=f&&(V=new j(O.x+(f-O.y)/(V.y-O.y)*(V.x-O.x),f)._round()),T&&O.equals(T[T.length-1])||(T=[O],y.push(T)),T.push(V)))))}}return y}sr("FeatureIndex",We,{omit:["rawTileData","sourceLayerCoder"]});class Tr extends j{constructor(t,n,a,f){super(t,n),this.angle=a,f!==void 0&&(this.segment=f)}clone(){return new Tr(this.x,this.y,this.angle,this.segment)}}function Gr(r,t,n,a,f){if(t.segment===void 0||n===0)return!0;let y=t,_=t.segment+1,b=0;for(;b>-n/2;){if(_--,_<0)return!1;b-=r[_].dist(y),y=r[_]}b+=r[_].dist(r[_+1]),_++;const T=[];let M=0;for(;b<n/2;){const O=r[_],V=r[_+1];if(!V)return!1;let Z=r[_-1].angleTo(O)-O.angleTo(V);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:b,angleDelta:Z}),M+=Z;b-T[0].distance>a;)M-=T.shift().angleDelta;if(M>f)return!1;_++,b+=O.dist(V)}return!0}function Ui(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function mn(r,t,n){return r?.6*t*n:0}function ul(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function zp(r,t,n,a,f,y){const _=mn(n,f,y),b=ul(n,a)*y;let T=0;const M=Ui(r)/2;for(let O=0;O<r.length-1;O++){const V=r[O],Z=r[O+1],te=V.dist(Z);if(T+te>M){const le=(M-T)/te,fe=On.number(V.x,Z.x,le),Pe=On.number(V.y,Z.y,le),De=new Tr(fe,Pe,Z.angleTo(V),O);return De._round(),!_||Gr(r,De,b,_,t)?De:void 0}T+=te}}function F_(r,t,n,a,f,y,_,b,T){const M=mn(a,y,_),O=ul(a,f),V=O*_,Z=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return t-V<t/4&&(t=V+t/4),Hm(r,Z?t/2*b%t:(O/2+2*y)*_*b%t,t,M,n,V,Z,!1,T)}function Hm(r,t,n,a,f,y,_,b,T){const M=y/2,O=Ui(r);let V=0,Z=t-n,te=[];for(let le=0;le<r.length-1;le++){const fe=r[le],Pe=r[le+1],De=fe.dist(Pe),rt=Pe.angleTo(fe);for(;Z+n<V+De;){Z+=n;const Ue=(Z-V)/De,Qe=On.number(fe.x,Pe.x,Ue),gt=On.number(fe.y,Pe.y,Ue);if(Qe>=0&&Qe<T&&gt>=0&&gt<T&&Z-M>=0&&Z+M<=O){const Dt=new Tr(Qe,gt,rt,le);Dt._round(),a&&!Gr(r,Dt,y,a,f)||te.push(Dt)}}V+=De}return b||te.length||_||(te=Hm(r,V/2,n,a,f,y,_,!0,T)),te}sr("Anchor",Tr);const Bd=Fs;function $m(r,t,n,a){const f=[],y=r.image,_=y.pixelRatio,b=y.paddedRect.w-2*Bd,T=y.paddedRect.h-2*Bd;let M={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const O=y.stretchX||[[0,b]],V=y.stretchY||[[0,T]],Z=(Tt,xr)=>Tt+xr[1]-xr[0],te=O.reduce(Z,0),le=V.reduce(Z,0),fe=b-te,Pe=T-le;let De=0,rt=te,Ue=0,Qe=le,gt=0,Dt=fe,nr=0,Ar=Pe;if(y.content&&a){const Tt=y.content,xr=Tt[2]-Tt[0],gr=Tt[3]-Tt[1];(y.textFitWidth||y.textFitHeight)&&(M=Wc(r)),De=Of(O,0,Tt[0]),Ue=Of(V,0,Tt[1]),rt=Of(O,Tt[0],Tt[2]),Qe=Of(V,Tt[1],Tt[3]),gt=Tt[0]-De,nr=Tt[1]-Ue,Dt=xr-rt,Ar=gr-Qe}const tr=M.x1,Yt=M.y1,yr=M.x2-tr,dr=M.y2-Yt,lr=(Tt,xr,gr,jr)=>{const jn=Bf(Tt.stretch-De,rt,yr,tr),Ln=Nf(Tt.fixed-gt,Dt,Tt.stretch,te),Wi=Bf(xr.stretch-Ue,Qe,dr,Yt),Ba=Nf(xr.fixed-nr,Ar,xr.stretch,le),bs=Bf(gr.stretch-De,rt,yr,tr),Xi=Nf(gr.fixed-gt,Dt,gr.stretch,te),no=Bf(jr.stretch-Ue,Qe,dr,Yt),io=Nf(jr.fixed-nr,Ar,jr.stretch,le),so=new j(jn,Wi),xi=new j(bs,Wi),Ki=new j(bs,no),Os=new j(jn,no),Ss=new j(Ln/_,Ba/_),oo=new j(Xi/_,io/_),Es=t*Math.PI/180;if(Es){const dn=Math.sin(Es),Gn=Math.cos(Es),Wn=[Gn,-dn,dn,Gn];so._matMult(Wn),xi._matMult(Wn),Os._matMult(Wn),Ki._matMult(Wn)}const ya=Tt.stretch+Tt.fixed,Co=xr.stretch+xr.fixed;return{tl:so,tr:xi,bl:Os,br:Ki,tex:{x:y.paddedRect.x+Bd+ya,y:y.paddedRect.y+Bd+Co,w:gr.stretch+gr.fixed-ya,h:jr.stretch+jr.fixed-Co},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ss,pixelOffsetBR:oo,minFontScaleX:Dt/_/yr,minFontScaleY:Ar/_/dr,isSDF:n}};if(a&&(y.stretchX||y.stretchY)){const Tt=Gm(O,fe,te),xr=Gm(V,Pe,le);for(let gr=0;gr<Tt.length-1;gr++){const jr=Tt[gr],jn=Tt[gr+1];for(let Ln=0;Ln<xr.length-1;Ln++)f.push(lr(jr,xr[Ln],jn,xr[Ln+1]))}}else f.push(lr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:T+1}));return f}function Of(r,t,n){let a=0;for(const f of r)a+=Math.max(t,Math.min(n,f[1]))-Math.max(t,Math.min(n,f[0]));return a}function Gm(r,t,n){const a=[{fixed:-1,stretch:0}];for(const[f,y]of r){const _=a[a.length-1];a.push({fixed:f-_.stretch,stretch:_.stretch}),a.push({fixed:f-_.stretch,stretch:_.stretch+(y-f)})}return a.push({fixed:t+Bd,stretch:n}),a}function Bf(r,t,n,a){return r/t*n+a}function Nf(r,t,n,a){return r-t*n/a}class jf{constructor(t,n,a,f,y,_,b,T,M,O){var V;if(this.boxStartIndex=t.length,M){let Z=_.top,te=_.bottom;const le=_.collisionPadding;le&&(Z-=le[1],te+=le[3]);let fe=te-Z;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{const Z=!((V=_.image)===null||V===void 0)&&V.content&&(_.image.textFitWidth||_.image.textFitHeight)?Wc(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};Z.y1=Z.y1*b-T[0],Z.y2=Z.y2*b+T[2],Z.x1=Z.x1*b-T[3],Z.x2=Z.x2*b+T[1];const te=_.collisionPadding;if(te&&(Z.x1-=te[0]*b,Z.y1-=te[1]*b,Z.x2+=te[2]*b,Z.y2+=te[3]*b),O){const le=new j(Z.x1,Z.y1),fe=new j(Z.x2,Z.y1),Pe=new j(Z.x1,Z.y2),De=new j(Z.x2,Z.y2),rt=O*Math.PI/180;le._rotate(rt),fe._rotate(rt),Pe._rotate(rt),De._rotate(rt),Z.x1=Math.min(le.x,fe.x,Pe.x,De.x),Z.x2=Math.max(le.x,fe.x,Pe.x,De.x),Z.y1=Math.min(le.y,fe.y,Pe.y,De.y),Z.y2=Math.max(le.y,fe.y,Pe.y,De.y)}t.emplaceBack(n.x,n.y,Z.x1,Z.y1,Z.x2,Z.y2,a,f,y)}this.boxEndIndex=t.length}}class O_{constructor(t=[],n=(a,f)=>a<f?-1:a>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:a}=this,f=n[t];for(;t>0;){const y=t-1>>1,_=n[y];if(a(f,_)>=0)break;n[t]=_,t=y}n[t]=f}_down(t){const{data:n,compare:a}=this,f=this.length>>1,y=n[t];for(;t<f;){let _=1+(t<<1);const b=_+1;if(b<this.length&&a(n[b],n[_])<0&&(_=b),a(n[_],y)>=0)break;n[t]=n[_],t=_}n[t]=y}}function B_(r,t=1,n=!1){let a=1/0,f=1/0,y=-1/0,_=-1/0;const b=r[0];for(let te=0;te<b.length;te++){const le=b[te];(!te||le.x<a)&&(a=le.x),(!te||le.y<f)&&(f=le.y),(!te||le.x>y)&&(y=le.x),(!te||le.y>_)&&(_=le.y)}const T=Math.min(y-a,_-f);let M=T/2;const O=new O_([],N_);if(T===0)return new j(a,f);for(let te=a;te<y;te+=T)for(let le=f;le<_;le+=T)O.push(new Xh(te+M,le+M,M,r));let V=function(te){let le=0,fe=0,Pe=0;const De=te[0];for(let rt=0,Ue=De.length,Qe=Ue-1;rt<Ue;Qe=rt++){const gt=De[rt],Dt=De[Qe],nr=gt.x*Dt.y-Dt.x*gt.y;fe+=(gt.x+Dt.x)*nr,Pe+=(gt.y+Dt.y)*nr,le+=3*nr}return new Xh(fe/le,Pe/le,0,te)}(r),Z=O.length;for(;O.length;){const te=O.pop();(te.d>V.d||!V.d)&&(V=te,n&&console.log("found best %d after %d probes",Math.round(1e4*te.d)/1e4,Z)),te.max-V.d<=t||(M=te.h/2,O.push(new Xh(te.p.x-M,te.p.y-M,M,r)),O.push(new Xh(te.p.x+M,te.p.y-M,M,r)),O.push(new Xh(te.p.x-M,te.p.y+M,M,r)),O.push(new Xh(te.p.x+M,te.p.y+M,M,r)),Z+=4)}return n&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${V.d}`)),V.p}function N_(r,t){return t.max-r.max}function Xh(r,t,n,a){this.p=new j(r,t),this.h=n,this.d=function(f,y){let _=!1,b=1/0;for(let T=0;T<y.length;T++){const M=y[T];for(let O=0,V=M.length,Z=V-1;O<V;Z=O++){const te=M[O],le=M[Z];te.y>f.y!=le.y>f.y&&f.x<(le.x-te.x)*(f.y-te.y)/(le.y-te.y)+te.x&&(_=!_),b=Math.min(b,gd(f,te,le))}}return(_?1:-1)*Math.sqrt(b)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var ws;E.aq=void 0,(ws=E.aq||(E.aq={}))[ws.center=1]="center",ws[ws.left=2]="left",ws[ws.right=3]="right",ws[ws.top=4]="top",ws[ws.bottom=5]="bottom",ws[ws["top-left"]=6]="top-left",ws[ws["top-right"]=7]="top-right",ws[ws["bottom-left"]=8]="bottom-left",ws[ws["bottom-right"]=9]="bottom-right";const tc=7,Rp=Number.POSITIVE_INFINITY;function qm(r,t){return t[1]!==Rp?function(n,a,f){let y=0,_=0;switch(a=Math.abs(a),f=Math.abs(f),n){case"top-right":case"top-left":case"top":_=f-tc;break;case"bottom-right":case"bottom-left":case"bottom":_=-f+tc}switch(n){case"top-right":case"bottom-right":case"right":y=-a;break;case"top-left":case"bottom-left":case"left":y=a}return[y,_]}(r,t[0],t[1]):function(n,a){let f=0,y=0;a<0&&(a=0);const _=a/Math.SQRT2;switch(n){case"top-right":case"top-left":y=_-tc;break;case"bottom-right":case"bottom-left":y=-_+tc;break;case"bottom":y=-a+tc;break;case"top":y=a-tc}switch(n){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=a;break;case"right":f=-a}return[f,y]}(r,t[0])}function Zm(r,t,n){var a;const f=r.layout,y=(a=f.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},n);if(y){const b=y.values,T=[];for(let M=0;M<b.length;M+=2){const O=T[M]=b[M],V=b[M+1].map(Z=>Z*Zn);O.startsWith("top")?V[1]-=tc:O.startsWith("bottom")&&(V[1]+=tc),T[M+1]=V}return new ti(T)}const _=f.get("text-variable-anchor");if(_){let b;b=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},n)*Zn,Rp]:f.get("text-offset").evaluate(t,{},n).map(M=>M*Zn);const T=[];for(const M of _)T.push(M,qm(M,b));return new ti(T)}return null}function Dp(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function j_(r,t,n,a,f,y,_,b,T,M,O){let V=y.textMaxSize.evaluate(t,{});V===void 0&&(V=_);const Z=r.layers[0].layout,te=Z.get("icon-offset").evaluate(t,{},O),le=Xm(n.horizontal),fe=_/24,Pe=r.tilePixelRatio*fe,De=r.tilePixelRatio*V/24,rt=r.tilePixelRatio*b,Ue=r.tilePixelRatio*Z.get("symbol-spacing"),Qe=Z.get("text-padding")*r.tilePixelRatio,gt=function(Tt,xr,gr,jr=1){const jn=Tt.get("icon-padding").evaluate(xr,{},gr),Ln=jn&&jn.values;return[Ln[0]*jr,Ln[1]*jr,Ln[2]*jr,Ln[3]*jr]}(Z,t,O,r.tilePixelRatio),Dt=Z.get("text-max-angle")/180*Math.PI,nr=Z.get("text-rotation-alignment")!=="viewport"&&Z.get("symbol-placement")!=="point",Ar=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",tr=Z.get("symbol-placement"),Yt=Ue/2,yr=Z.get("icon-text-fit");let dr;a&&yr!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(dr=Gl(a,n.vertical,yr,Z.get("icon-text-fit-padding"),te,fe)),le&&(a=Gl(a,le,yr,Z.get("icon-text-fit-padding"),te,fe)));const lr=(Tt,xr)=>{xr.x<0||xr.x>=si||xr.y<0||xr.y>=si||function(gr,jr,jn,Ln,Wi,Ba,bs,Xi,no,io,so,xi,Ki,Os,Ss,oo,Es,ya,Co,dn,Gn,Wn,Ho,oi,Kh){const Zl=gr.addToLineVertexArray(jr,jn);let Wl,Na,_a,as,Iu=0,Ud=0,Qm=0,eg=0,Vp=-1,Hp=-1;const Pu={};let tg=Rl("");if(gr.allowVerticalPlacement&&Ln.vertical){const Bs=Xi.layout.get("text-rotate").evaluate(Gn,{},oi)+90;_a=new jf(no,jr,io,so,xi,Ln.vertical,Ki,Os,Ss,Bs),bs&&(as=new jf(no,jr,io,so,xi,bs,Es,ya,Ss,Bs))}if(Wi){const Bs=Xi.layout.get("icon-rotate").evaluate(Gn,{}),va=Xi.layout.get("icon-text-fit")!=="none",Qc=$m(Wi,Bs,Ho,va),hl=bs?$m(bs,Bs,Ho,va):void 0;Na=new jf(no,jr,io,so,xi,Wi,Es,ya,!1,Bs),Iu=4*Qc.length;const eh=gr.iconSizeData;let Xl=null;eh.kind==="source"?(Xl=[Vo*Xi.layout.get("icon-size").evaluate(Gn,{})],Xl[0]>Oa&&Je(`${gr.layerIds[0]}: Value for "icon-size" is >= ${ql}. Reduce your "icon-size".`)):eh.kind==="composite"&&(Xl=[Vo*Wn.compositeIconSizes[0].evaluate(Gn,{},oi),Vo*Wn.compositeIconSizes[1].evaluate(Gn,{},oi)],(Xl[0]>Oa||Xl[1]>Oa)&&Je(`${gr.layerIds[0]}: Value for "icon-size" is >= ${ql}. Reduce your "icon-size".`)),gr.addSymbols(gr.icon,Qc,Xl,dn,Co,Gn,E.ah.none,jr,Zl.lineStartIndex,Zl.lineLength,-1,oi),Vp=gr.icon.placedSymbolArray.length-1,hl&&(Ud=4*hl.length,gr.addSymbols(gr.icon,hl,Xl,dn,Co,Gn,E.ah.vertical,jr,Zl.lineStartIndex,Zl.lineLength,-1,oi),Hp=gr.icon.placedSymbolArray.length-1)}const rg=Object.keys(Ln.horizontal);for(const Bs of rg){const va=Ln.horizontal[Bs];if(!Wl){tg=Rl(va.text);const hl=Xi.layout.get("text-rotate").evaluate(Gn,{},oi);Wl=new jf(no,jr,io,so,xi,va,Ki,Os,Ss,hl)}const Qc=va.positionedLines.length===1;if(Qm+=Wm(gr,jr,va,Ba,Xi,Ss,Gn,oo,Zl,Ln.vertical?E.ah.horizontal:E.ah.horizontalOnly,Qc?rg:[Bs],Pu,Vp,Wn,oi),Qc)break}Ln.vertical&&(eg+=Wm(gr,jr,Ln.vertical,Ba,Xi,Ss,Gn,oo,Zl,E.ah.vertical,["vertical"],Pu,Hp,Wn,oi));const H_=Wl?Wl.boxStartIndex:gr.collisionBoxArray.length,$_=Wl?Wl.boxEndIndex:gr.collisionBoxArray.length,G_=_a?_a.boxStartIndex:gr.collisionBoxArray.length,q_=_a?_a.boxEndIndex:gr.collisionBoxArray.length,Z_=Na?Na.boxStartIndex:gr.collisionBoxArray.length,W_=Na?Na.boxEndIndex:gr.collisionBoxArray.length,X_=as?as.boxStartIndex:gr.collisionBoxArray.length,K_=as?as.boxEndIndex:gr.collisionBoxArray.length;let cl=-1;const Vf=(Bs,va)=>Bs&&Bs.circleDiameter?Math.max(Bs.circleDiameter,va):va;cl=Vf(Wl,cl),cl=Vf(_a,cl),cl=Vf(Na,cl),cl=Vf(as,cl);const ng=cl>-1?1:0;ng&&(cl*=Kh/Zn),gr.glyphOffsetArray.length>=Qu.MAX_GLYPHS&&Je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gn.sortKey!==void 0&&gr.addToSortKeyRanges(gr.symbolInstances.length,Gn.sortKey);const Y_=Zm(Xi,Gn,oi),[J_,Q_]=function(Bs,va){const Qc=Bs.length,hl=va==null?void 0:va.values;if((hl==null?void 0:hl.length)>0)for(let eh=0;eh<hl.length;eh+=2){const Xl=hl[eh+1];Bs.emplaceBack(E.aq[hl[eh]],Xl[0],Xl[1])}return[Qc,Bs.length]}(gr.textAnchorOffsets,Y_);gr.symbolInstances.emplaceBack(jr.x,jr.y,Pu.right>=0?Pu.right:-1,Pu.center>=0?Pu.center:-1,Pu.left>=0?Pu.left:-1,Pu.vertical||-1,Vp,Hp,tg,H_,$_,G_,q_,Z_,W_,X_,K_,io,Qm,eg,Iu,Ud,ng,0,Ki,cl,J_,Q_)}(r,xr,Tt,n,a,f,dr,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,Pe,[Qe,Qe,Qe,Qe],nr,T,rt,gt,Ar,te,t,y,M,O,_)};if(tr==="line")for(const Tt of Or(t.geometry,0,0,si,si)){const xr=F_(Tt,Ue,Dt,n.vertical||le,a,24,De,r.overscaling,si);for(const gr of xr)le&&U_(r,le.text,Yt,gr)||lr(Tt,gr)}else if(tr==="line-center"){for(const Tt of t.geometry)if(Tt.length>1){const xr=zp(Tt,Dt,n.vertical||le,a,24,De);xr&&lr(Tt,xr)}}else if(t.type==="Polygon")for(const Tt of Jo(t.geometry,0)){const xr=B_(Tt,16);lr(Tt[0],new Tr(xr.x,xr.y,0))}else if(t.type==="LineString")for(const Tt of t.geometry)lr(Tt,new Tr(Tt[0].x,Tt[0].y,0));else if(t.type==="Point")for(const Tt of t.geometry)for(const xr of Tt)lr([xr],new Tr(xr.x,xr.y,0))}function Wm(r,t,n,a,f,y,_,b,T,M,O,V,Z,te,le){const fe=function(rt,Ue,Qe,gt,Dt,nr,Ar,tr){const Yt=gt.layout.get("text-rotate").evaluate(nr,{})*Math.PI/180,yr=[];for(const dr of Ue.positionedLines)for(const lr of dr.positionedGlyphs){if(!lr.rect)continue;const Tt=lr.rect||{};let xr=zd+1,gr=!0,jr=1,jn=0;const Ln=(Dt||tr)&&lr.vertical,Wi=lr.metrics.advance*lr.scale/2;if(tr&&Ue.verticalizable&&(jn=dr.lineOffset/2-(lr.imageName?-(Zn-lr.metrics.width*lr.scale)/2:(lr.scale-1)*Zn)),lr.imageName){const dn=Ar[lr.imageName];gr=dn.sdf,jr=dn.pixelRatio,xr=Fs/jr}const Ba=Dt?[lr.x+Wi,lr.y]:[0,0];let bs=Dt?[0,0]:[lr.x+Wi+Qe[0],lr.y+Qe[1]-jn],Xi=[0,0];Ln&&(Xi=bs,bs=[0,0]);const no=lr.metrics.isDoubleResolution?2:1,io=(lr.metrics.left-xr)*lr.scale-Wi+bs[0],so=(-lr.metrics.top-xr)*lr.scale+bs[1],xi=io+Tt.w/no*lr.scale/jr,Ki=so+Tt.h/no*lr.scale/jr,Os=new j(io,so),Ss=new j(xi,so),oo=new j(io,Ki),Es=new j(xi,Ki);if(Ln){const dn=new j(-Wi,Wi-ma),Gn=-Math.PI/2,Wn=Zn/2-Wi,Ho=new j(5-ma-Wn,-(lr.imageName?Wn:0)),oi=new j(...Xi);Os._rotateAround(Gn,dn)._add(Ho)._add(oi),Ss._rotateAround(Gn,dn)._add(Ho)._add(oi),oo._rotateAround(Gn,dn)._add(Ho)._add(oi),Es._rotateAround(Gn,dn)._add(Ho)._add(oi)}if(Yt){const dn=Math.sin(Yt),Gn=Math.cos(Yt),Wn=[Gn,-dn,dn,Gn];Os._matMult(Wn),Ss._matMult(Wn),oo._matMult(Wn),Es._matMult(Wn)}const ya=new j(0,0),Co=new j(0,0);yr.push({tl:Os,tr:Ss,bl:oo,br:Es,tex:Tt,writingMode:Ue.writingMode,glyphOffset:Ba,sectionIndex:lr.sectionIndex,isSDF:gr,pixelOffsetTL:ya,pixelOffsetBR:Co,minFontScaleX:0,minFontScaleY:0})}return yr}(0,n,b,f,y,_,a,r.allowVerticalPlacement),Pe=r.textSizeData;let De=null;Pe.kind==="source"?(De=[Vo*f.layout.get("text-size").evaluate(_,{})],De[0]>Oa&&Je(`${r.layerIds[0]}: Value for "text-size" is >= ${ql}. Reduce your "text-size".`)):Pe.kind==="composite"&&(De=[Vo*te.compositeTextSizes[0].evaluate(_,{},le),Vo*te.compositeTextSizes[1].evaluate(_,{},le)],(De[0]>Oa||De[1]>Oa)&&Je(`${r.layerIds[0]}: Value for "text-size" is >= ${ql}. Reduce your "text-size".`)),r.addSymbols(r.text,fe,De,b,y,_,M,t,T.lineStartIndex,T.lineLength,Z,le);for(const rt of O)V[rt]=r.text.placedSymbolArray.length-1;return 4*fe.length}function Xm(r){for(const t in r)return r[t];return null}function U_(r,t,n,a){const f=r.compareText;if(t in f){const y=f[t];for(let _=y.length-1;_>=0;_--)if(a.dist(y[_])<n)return!0}else f[t]=[];return f[t].push(a),!1}const Km=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,a]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=a>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=Km[15&a];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new Lp(b,_,y,t)}constructor(t,n=64,a=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const y=Km.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-b%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${a}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+b+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=n,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Fp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,a,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:b}=this,T=[0,y.length-1,0],M=[];for(;T.length;){const O=T.pop()||0,V=T.pop()||0,Z=T.pop()||0;if(V-Z<=b){for(let Pe=Z;Pe<=V;Pe++){const De=_[2*Pe],rt=_[2*Pe+1];De>=t&&De<=a&&rt>=n&&rt<=f&&M.push(y[Pe])}continue}const te=Z+V>>1,le=_[2*te],fe=_[2*te+1];le>=t&&le<=a&&fe>=n&&fe<=f&&M.push(y[te]),(O===0?t<=le:n<=fe)&&(T.push(Z),T.push(te-1),T.push(1-O)),(O===0?a>=le:f>=fe)&&(T.push(te+1),T.push(V),T.push(1-O))}return M}within(t,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:_}=this,b=[0,f.length-1,0],T=[],M=a*a;for(;b.length;){const O=b.pop()||0,V=b.pop()||0,Z=b.pop()||0;if(V-Z<=_){for(let Pe=Z;Pe<=V;Pe++)Jm(y[2*Pe],y[2*Pe+1],t,n)<=M&&T.push(f[Pe]);continue}const te=Z+V>>1,le=y[2*te],fe=y[2*te+1];Jm(le,fe,t,n)<=M&&T.push(f[te]),(O===0?t-a<=le:n-a<=fe)&&(b.push(Z),b.push(te-1),b.push(1-O)),(O===0?t+a>=le:n+a>=fe)&&(b.push(te+1),b.push(V),b.push(1-O))}return T}}function Fp(r,t,n,a,f,y){if(f-a<=n)return;const _=a+f>>1;Ym(r,t,_,a,f,y),Fp(r,t,n,a,_-1,1-y),Fp(r,t,n,_+1,f,1-y)}function Ym(r,t,n,a,f,y){for(;f>a;){if(f-a>600){const M=f-a+1,O=n-a+1,V=Math.log(M),Z=.5*Math.exp(2*V/3),te=.5*Math.sqrt(V*Z*(M-Z)/M)*(O-M/2<0?-1:1);Ym(r,t,n,Math.max(a,Math.floor(n-O*Z/M+te)),Math.min(f,Math.floor(n+(M-O)*Z/M+te)),y)}const _=t[2*n+y];let b=a,T=f;for(Nd(r,t,a,n),t[2*f+y]>_&&Nd(r,t,a,f);b<T;){for(Nd(r,t,b,T),b++,T--;t[2*b+y]<_;)b++;for(;t[2*T+y]>_;)T--}t[2*a+y]===_?Nd(r,t,a,T):(T++,Nd(r,t,T,f)),T<=n&&(a=T+1),n<=T&&(f=T-1)}}function Nd(r,t,n,a){Op(r,n,a),Op(t,2*n,2*a),Op(t,2*n+1,2*a+1)}function Op(r,t,n){const a=r[t];r[t]=r[n],r[n]=a}function Jm(r,t,n,a){const f=r-n,y=t-a;return f*f+y*y}var Bp;E.bg=void 0,(Bp=E.bg||(E.bg={})).create="create",Bp.load="load",Bp.fullLoad="fullLoad";let Uf=null,jd=[];const Np=1e3/60,jp="loadTime",Up="fullLoadTime",V_={mark(r){performance.mark(r)},frame(r){const t=r;Uf!=null&&jd.push(t-Uf),Uf=t},clearMetrics(){Uf=null,jd=[],performance.clearMeasures(jp),performance.clearMeasures(Up);for(const r in E.bg)performance.clearMarks(E.bg[r])},getPerformanceMetrics(){performance.measure(jp,E.bg.create,E.bg.load),performance.measure(Up,E.bg.create,E.bg.fullLoad);const r=performance.getEntriesByName(jp)[0].duration,t=performance.getEntriesByName(Up)[0].duration,n=jd.length,a=1/(jd.reduce((y,_)=>y+_,0)/n/1e3),f=jd.filter(y=>y>Np).reduce((y,_)=>y+(_-Np)/Np,0);return{loadTime:r,fullLoadTime:t,fps:a,percentDroppedFrames:f/(n+f)*100,totalFrames:n}}};E.$=class extends H{},E.A=Gu,E.B=_c,E.C=function(r){if(Rt==null){const t=r.navigator?r.navigator.userAgent:null;Rt=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Rt},E.D=or,E.E=ft,E.F=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new i(()=>this.process()),this.subscription=function(n,a,f,y){return n.addEventListener(a,f,!1),{unsubscribe:()=>{n.removeEventListener(a,f,!1)}}}(this.target,"message",n=>this.receive(n)),this.globalScope=Ve(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((n,a)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:n,reject:a},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[f];const b={id:f,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const y=[],_=Object.assign(Object.assign({},r),{id:f,sourceMapId:this.mapId,origin:location.origin,data:ns(r.data,y)});this.target.postMessage(_,{transfer:y})})}receive(r){const t=r.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const a=this.abortControllers[n];return delete this.abortControllers[n],void(a&&a.abort())}if(Ve(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return u(this,void 0,void 0,function*(){if(t.type==="<response>"){const f=this.resolveRejects[r];return delete this.resolveRejects[r],f?void(t.error?f.reject(Bo(t.error)):f.resolve(Bo(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Bo(t.data),a=new AbortController;this.abortControllers[r]=a;try{const f=yield this.messageHandlers[t.type](t.sourceMapId,n,a);this.completeTask(r,null,f)}catch(f){this.completeTask(r,f)}})}completeTask(r,t,n){const a=[];delete this.abortControllers[r];const f={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ns(t):null,data:ns(n,a)};this.target.postMessage(f,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.G=ar,E.H=function(){var r=new Gu(16);return Gu!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},E.I=Rd,E.J=function(r,t,n){var a,f,y,_,b,T,M,O,V,Z,te,le,fe=n[0],Pe=n[1],De=n[2];return t===r?(r[12]=t[0]*fe+t[4]*Pe+t[8]*De+t[12],r[13]=t[1]*fe+t[5]*Pe+t[9]*De+t[13],r[14]=t[2]*fe+t[6]*Pe+t[10]*De+t[14],r[15]=t[3]*fe+t[7]*Pe+t[11]*De+t[15]):(f=t[1],y=t[2],_=t[3],b=t[4],T=t[5],M=t[6],O=t[7],V=t[8],Z=t[9],te=t[10],le=t[11],r[0]=a=t[0],r[1]=f,r[2]=y,r[3]=_,r[4]=b,r[5]=T,r[6]=M,r[7]=O,r[8]=V,r[9]=Z,r[10]=te,r[11]=le,r[12]=a*fe+b*Pe+V*De+t[12],r[13]=f*fe+T*Pe+Z*De+t[13],r[14]=y*fe+M*Pe+te*De+t[14],r[15]=_*fe+O*Pe+le*De+t[15]),r},E.K=function(r,t,n){var a=n[0],f=n[1],y=n[2];return r[0]=t[0]*a,r[1]=t[1]*a,r[2]=t[2]*a,r[3]=t[3]*a,r[4]=t[4]*f,r[5]=t[5]*f,r[6]=t[6]*f,r[7]=t[7]*f,r[8]=t[8]*y,r[9]=t[9]*y,r[10]=t[10]*y,r[11]=t[11]*y,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},E.L=vd,E.M=function(r,t){const n={};for(let a=0;a<t.length;a++){const f=t[a];f in r&&(n[f]=r[f])}return n},E.N=p,E.O=L,E.P=j,E.Q=ie,E.R=Zi,E.S=er,E.T=Oi,E.U=re,E.V=pe,E.W=Ze,E.X=si,E.Y=S,E.Z=mt,E._=u,E.a=bt,E.a$=function(r,t){var n=r[0],a=r[1],f=r[2],y=r[3],_=r[4],b=r[5],T=r[6],M=r[7],O=r[8],V=r[9],Z=r[10],te=r[11],le=r[12],fe=r[13],Pe=r[14],De=r[15],rt=t[0],Ue=t[1],Qe=t[2],gt=t[3],Dt=t[4],nr=t[5],Ar=t[6],tr=t[7],Yt=t[8],yr=t[9],dr=t[10],lr=t[11],Tt=t[12],xr=t[13],gr=t[14],jr=t[15];return Math.abs(n-rt)<=ys*Math.max(1,Math.abs(n),Math.abs(rt))&&Math.abs(a-Ue)<=ys*Math.max(1,Math.abs(a),Math.abs(Ue))&&Math.abs(f-Qe)<=ys*Math.max(1,Math.abs(f),Math.abs(Qe))&&Math.abs(y-gt)<=ys*Math.max(1,Math.abs(y),Math.abs(gt))&&Math.abs(_-Dt)<=ys*Math.max(1,Math.abs(_),Math.abs(Dt))&&Math.abs(b-nr)<=ys*Math.max(1,Math.abs(b),Math.abs(nr))&&Math.abs(T-Ar)<=ys*Math.max(1,Math.abs(T),Math.abs(Ar))&&Math.abs(M-tr)<=ys*Math.max(1,Math.abs(M),Math.abs(tr))&&Math.abs(O-Yt)<=ys*Math.max(1,Math.abs(O),Math.abs(Yt))&&Math.abs(V-yr)<=ys*Math.max(1,Math.abs(V),Math.abs(yr))&&Math.abs(Z-dr)<=ys*Math.max(1,Math.abs(Z),Math.abs(dr))&&Math.abs(te-lr)<=ys*Math.max(1,Math.abs(te),Math.abs(lr))&&Math.abs(le-Tt)<=ys*Math.max(1,Math.abs(le),Math.abs(Tt))&&Math.abs(fe-xr)<=ys*Math.max(1,Math.abs(fe),Math.abs(xr))&&Math.abs(Pe-gr)<=ys*Math.max(1,Math.abs(Pe),Math.abs(gr))&&Math.abs(De-jr)<=ys*Math.max(1,Math.abs(De),Math.abs(jr))},E.a0=Xr,E.a1=jt,E.a2=vt,E.a3=r=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const a of r){const f=window.document.createElement("source");Cr(a)||(t.crossOrigin="Anonymous"),f.src=a,t.appendChild(f)}})},E.a4=function(){return St++},E.a5=Xt,E.a6=Qu,E.a7=lu,E.a8=Ol,E.a9=lt,E.aA=function(r){if(r.type==="custom")return new Wh(r);switch(r.type){case"background":return new Zh(r);case"circle":return new xp(r);case"fill":return new bp(r);case"fill-extrusion":return new xf(r);case"heatmap":return new wp(r);case"hillshade":return new sf(r);case"line":return new Ku(r);case"raster":return new Mp(r);case"symbol":return new Cu(r)}},E.aB=xt,E.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let n=[];try{if(!Ne(r.version,t.version))return[{command:"setStyle",args:[t]}];Ne(r.center,t.center)||n.push({command:"setCenter",args:[t.center]}),Ne(r.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),Ne(r.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),Ne(r.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),Ne(r.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),Ne(r.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),Ne(r.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),Ne(r.light,t.light)||n.push({command:"setLight",args:[t.light]}),Ne(r.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),Ne(r.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),Ne(r.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const a={},f=[];(function(_,b,T,M){let O;for(O in b=b||{},_=_||{})Object.prototype.hasOwnProperty.call(_,O)&&(Object.prototype.hasOwnProperty.call(b,O)||nt(O,T,M));for(O in b)Object.prototype.hasOwnProperty.call(b,O)&&(Object.prototype.hasOwnProperty.call(_,O)?Ne(_[O],b[O])||(_[O].type==="geojson"&&b[O].type==="geojson"&&rr(_,b,O)?_t(T,{command:"setGeoJSONSourceData",args:[O,b[O].data]}):zt(O,b,T,M)):Mt(O,b,T))})(r.sources,t.sources,f,a);const y=[];r.layers&&r.layers.forEach(_=>{"source"in _&&a[_.source]?n.push({command:"removeLayer",args:[_.id]}):y.push(_)}),n=n.concat(f),function(_,b,T){b=b||[];const M=(_=_||[]).map(_r),O=b.map(_r),V=_.reduce(en,{}),Z=b.reduce(en,{}),te=M.slice(),le=Object.create(null);let fe,Pe,De,rt,Ue;for(let Qe=0,gt=0;Qe<M.length;Qe++)fe=M[Qe],Object.prototype.hasOwnProperty.call(Z,fe)?gt++:(_t(T,{command:"removeLayer",args:[fe]}),te.splice(te.indexOf(fe,gt),1));for(let Qe=0,gt=0;Qe<O.length;Qe++)fe=O[O.length-1-Qe],te[te.length-1-Qe]!==fe&&(Object.prototype.hasOwnProperty.call(V,fe)?(_t(T,{command:"removeLayer",args:[fe]}),te.splice(te.lastIndexOf(fe,te.length-gt),1)):gt++,rt=te[te.length-Qe],_t(T,{command:"addLayer",args:[Z[fe],rt]}),te.splice(te.length-Qe,0,fe),le[fe]=!0);for(let Qe=0;Qe<O.length;Qe++)if(fe=O[Qe],Pe=V[fe],De=Z[fe],!le[fe]&&!Ne(Pe,De))if(Ne(Pe.source,De.source)&&Ne(Pe["source-layer"],De["source-layer"])&&Ne(Pe.type,De.type)){for(Ue in Lt(Pe.layout,De.layout,T,fe,null,"setLayoutProperty"),Lt(Pe.paint,De.paint,T,fe,null,"setPaintProperty"),Ne(Pe.filter,De.filter)||_t(T,{command:"setFilter",args:[fe,De.filter]}),Ne(Pe.minzoom,De.minzoom)&&Ne(Pe.maxzoom,De.maxzoom)||_t(T,{command:"setLayerZoomRange",args:[fe,De.minzoom,De.maxzoom]}),Pe)Object.prototype.hasOwnProperty.call(Pe,Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?Lt(Pe[Ue],De[Ue],T,fe,Ue.slice(6),"setPaintProperty"):Ne(Pe[Ue],De[Ue])||_t(T,{command:"setLayerProperty",args:[fe,Ue,De[Ue]]}));for(Ue in De)Object.prototype.hasOwnProperty.call(De,Ue)&&!Object.prototype.hasOwnProperty.call(Pe,Ue)&&Ue!=="layout"&&Ue!=="paint"&&Ue!=="filter"&&Ue!=="metadata"&&Ue!=="minzoom"&&Ue!=="maxzoom"&&(Ue.indexOf("paint.")===0?Lt(Pe[Ue],De[Ue],T,fe,Ue.slice(6),"setPaintProperty"):Ne(Pe[Ue],De[Ue])||_t(T,{command:"setLayerProperty",args:[fe,Ue,De[Ue]]}))}else _t(T,{command:"removeLayer",args:[fe]}),rt=te[te.lastIndexOf(fe)+1],_t(T,{command:"addLayer",args:[De,rt]})}(y,t.layers,n)}catch(a){console.warn("Unable to compute style diff:",a),n=[{command:"setStyle",args:[t]}]}return n},E.aD=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},E.aE=function r(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(!r(t[a],n[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(!r(t[a],n[a]))return!1;return!0}return t===n},E.aF=ot,E.aG=At,E.aH=class extends Jn{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},E.aI=ki,E.aJ=class extends Jn{constructor(r,t){super(r,t),this.current=Ec}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},E.aK=Sc,E.aL=Hu,E.aM=Pr,E.aN=class extends Jn{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},E.aO=class extends Jn{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},E.aP=function(r,t,n,a,f,y,_){var b=1/(t-n),T=1/(a-f),M=1/(y-_);return r[0]=-2*b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*M,r[11]=0,r[12]=(t+n)*b,r[13]=(f+a)*T,r[14]=(_+y)*M,r[15]=1,r},E.aQ=Sh,E.aR=class extends Ge{},E.aS=Nc,E.aT=class extends it{},E.aU=Ac,E.aV=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},E.aW=Ph,E.aX=ri,E.aY=Ys,E.aZ=class extends ur{},E.a_=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},E.aa=function(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,a,f,y)=>{const _=f||y;return t[a]=!_||_.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},E.ab=function(r,t){const n=[];for(const a in r)a in t||n.push(a);return n},E.ac=ve,E.ad=function(r,t,n){var a=Math.sin(n),f=Math.cos(n),y=t[0],_=t[1],b=t[2],T=t[3],M=t[4],O=t[5],V=t[6],Z=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=y*f+M*a,r[1]=_*f+O*a,r[2]=b*f+V*a,r[3]=T*f+Z*a,r[4]=M*f-y*a,r[5]=O*f-_*a,r[6]=V*f-b*a,r[7]=Z*f-T*a,r},E.ae=function(r){var t=new Gu(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},E.af=Eh,E.ag=function(r,t){let n=0,a=0;if(r.kind==="constant")a=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:_}=r,b=f?ve(zn.interpolationFactor(f,t,y,_),0,1):0;r.kind==="camera"?a=On.number(r.minSize,r.maxSize,b):n=b}return{uSizeT:n,uSize:a}},E.ai=function(r,{uSize:t,uSizeT:n},{lowerSize:a,upperSize:f}){return r.kind==="source"?a/Vo:r.kind==="composite"?On.number(a/Vo,f/Vo,n):t},E.aj=Ju,E.ak=function(r,t,n,a){const f=t.y-r.y,y=t.x-r.x,_=a.y-n.y,b=a.x-n.x,T=_*y-b*f;if(T===0)return null;const M=(b*(r.y-n.y)-_*(r.x-n.x))/T;return new j(r.x+M*y,r.y+M*f)},E.al=Or,E.am=pd,E.an=bh,E.ao=function(r){let t=1/0,n=1/0,a=-1/0,f=-1/0;for(const y of r)t=Math.min(t,y.x),n=Math.min(n,y.y),a=Math.max(a,y.x),f=Math.max(f,y.y);return[t,n,a,f]},E.ap=Zn,E.ar=Xc,E.as=function(r,t){var n=t[0],a=t[1],f=t[2],y=t[3],_=t[4],b=t[5],T=t[6],M=t[7],O=t[8],V=t[9],Z=t[10],te=t[11],le=t[12],fe=t[13],Pe=t[14],De=t[15],rt=n*b-a*_,Ue=n*T-f*_,Qe=n*M-y*_,gt=a*T-f*b,Dt=a*M-y*b,nr=f*M-y*T,Ar=O*fe-V*le,tr=O*Pe-Z*le,Yt=O*De-te*le,yr=V*Pe-Z*fe,dr=V*De-te*fe,lr=Z*De-te*Pe,Tt=rt*lr-Ue*dr+Qe*yr+gt*Yt-Dt*tr+nr*Ar;return Tt?(r[0]=(b*lr-T*dr+M*yr)*(Tt=1/Tt),r[1]=(f*dr-a*lr-y*yr)*Tt,r[2]=(fe*nr-Pe*Dt+De*gt)*Tt,r[3]=(Z*Dt-V*nr-te*gt)*Tt,r[4]=(T*Yt-_*lr-M*tr)*Tt,r[5]=(n*lr-f*Yt+y*tr)*Tt,r[6]=(Pe*Qe-le*nr-De*Ue)*Tt,r[7]=(O*nr-Z*Qe+te*Ue)*Tt,r[8]=(_*dr-b*Yt+M*Ar)*Tt,r[9]=(a*Yt-n*dr-y*Ar)*Tt,r[10]=(le*Dt-fe*Qe+De*rt)*Tt,r[11]=(V*Qe-O*Dt-te*rt)*Tt,r[12]=(b*tr-_*yr-T*Ar)*Tt,r[13]=(n*yr-a*tr+f*Ar)*Tt,r[14]=(fe*Ue-le*gt-Pe*rt)*Tt,r[15]=(O*gt-V*Ue+Z*rt)*Tt,r):null},E.at=Dp,E.au=Zc,E.av=Lp,E.aw=function(){const r={},t=ye.$version;for(const n in ye.$root){const a=ye.$root[n];if(a.required){let f=null;f=n==="version"?t:a.type==="array"?[]:{},f!=null&&(r[n]=f)}}return r},E.ax=mo,E.ay=qt,E.az=function(r){r=r.slice();const t=Object.create(null);for(let n=0;n<r.length;n++)t[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=we(r[n],t[r[n].ref]));return r},E.b=Ae,E.b0=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},E.b1=function(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r[3]=t[3]*n[3],r},E.b2=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},E.b3=qe,E.b4=Ft,E.b5=Re,E.b6=function(r,t,n,a,f){var y,_=1/Math.tan(t/2);return r[0]=_/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,f!=null&&f!==1/0?(r[10]=(f+a)*(y=1/(a-f)),r[14]=2*f*a*y):(r[10]=-1,r[14]=-2*a),r},E.b7=function(r,t,n){var a=Math.sin(n),f=Math.cos(n),y=t[4],_=t[5],b=t[6],T=t[7],M=t[8],O=t[9],V=t[10],Z=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=y*f+M*a,r[5]=_*f+O*a,r[6]=b*f+V*a,r[7]=T*f+Z*a,r[8]=M*f-y*a,r[9]=O*f-_*a,r[10]=V*f-b*a,r[11]=Z*f-T*a,r},E.b8=ge,E.b9=Fe,E.bA=Fa,E.bB=function(r){return r.message===_e},E.bC=Ja,E.bD=kn,E.ba=function(r){return r*Math.PI/180},E.bb=function(r,t){const{x:n,y:a}=mt.fromLngLat(t);return!(r<0||r>25||a<0||a>=1||n<0||n>=1)},E.bc=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},E.bd=class extends F{},E.be=o,E.bf=V_,E.bh=fr,E.bi=function(r,t){bt.REGISTERED_PROTOCOLS[r]=t},E.bj=function(r){delete bt.REGISTERED_PROTOCOLS[r]},E.bk=function(r,t){const n={};for(let f=0;f<r.length;f++){const y=t&&t[r[f].id]||fc(r[f]);t&&(t[r[f].id]=y);let _=n[y];_||(_=n[y]=[]),_.push(r[f])}const a=[];for(const f in n)a.push(n[f]);return a},E.bl=sr,E.bm=vi,E.bn=We,E.bo=Dd,E.bp=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=si/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0],n=t.layout,a=t._unevaluatedLayout._values,f={layoutIconSize:a["icon-size"].possiblyEvaluate(new tn(r.bucket.zoom+1),r.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new tn(r.bucket.zoom+1),r.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new tn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:O}=r.bucket.textSizeData;f.compositeTextSizes=[a["text-size"].possiblyEvaluate(new tn(M),r.canonical),a["text-size"].possiblyEvaluate(new tn(O),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:O}=r.bucket.iconSizeData;f.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new tn(M),r.canonical),a["icon-size"].possiblyEvaluate(new tn(O),r.canonical)]}const y=n.get("text-line-height")*Zn,_=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",b=n.get("text-keep-upright"),T=n.get("text-size");for(const M of r.bucket.features){const O=n.get("text-font").evaluate(M,{},r.canonical).join(","),V=T.evaluate(M,{},r.canonical),Z=f.layoutTextSize.evaluate(M,{},r.canonical),te=f.layoutIconSize.evaluate(M,{},r.canonical),le={horizontal:{},vertical:void 0},fe=M.text;let Pe,De=[0,0];if(fe){const Qe=fe.toString(),gt=n.get("text-letter-spacing").evaluate(M,{},r.canonical)*Zn,Dt=cd(Qe)?gt:0,nr=n.get("text-anchor").evaluate(M,{},r.canonical),Ar=Zm(t,M,r.canonical);if(!Ar){const dr=n.get("text-radial-offset").evaluate(M,{},r.canonical);De=dr?qm(nr,[dr*Zn,Rp]):n.get("text-offset").evaluate(M,{},r.canonical).map(lr=>lr*Zn)}let tr=_?"center":n.get("text-justify").evaluate(M,{},r.canonical);const Yt=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(M,{},r.canonical)*Zn:1/0,yr=()=>{r.bucket.allowVerticalPlacement&&vc(Qe)&&(le.vertical=qc(fe,r.glyphMap,r.glyphPositions,r.imagePositions,O,Yt,y,nr,"left",Dt,De,E.ah.vertical,!0,Z,V))};if(!_&&Ar){const dr=new Set;if(tr==="auto")for(let Tt=0;Tt<Ar.values.length;Tt+=2)dr.add(Dp(Ar.values[Tt]));else dr.add(tr);let lr=!1;for(const Tt of dr)if(!le.horizontal[Tt])if(lr)le.horizontal[Tt]=le.horizontal[0];else{const xr=qc(fe,r.glyphMap,r.glyphPositions,r.imagePositions,O,Yt,y,"center",Tt,Dt,De,E.ah.horizontal,!1,Z,V);xr&&(le.horizontal[Tt]=xr,lr=xr.positionedLines.length===1)}yr()}else{tr==="auto"&&(tr=Dp(nr));const dr=qc(fe,r.glyphMap,r.glyphPositions,r.imagePositions,O,Yt,y,nr,tr,Dt,De,E.ah.horizontal,!1,Z,V);dr&&(le.horizontal[tr]=dr),yr(),vc(Qe)&&_&&b&&(le.vertical=qc(fe,r.glyphMap,r.glyphPositions,r.imagePositions,O,Yt,y,nr,tr,Dt,De,E.ah.vertical,!1,Z,V))}}let rt=!1;if(M.icon&&M.icon.name){const Qe=r.imageMap[M.icon.name];Qe&&(Pe=$l(r.imagePositions[M.icon.name],n.get("icon-offset").evaluate(M,{},r.canonical),n.get("icon-anchor").evaluate(M,{},r.canonical)),rt=!!Qe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=rt:r.bucket.sdfIcons!==rt&&Je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const Ue=Xm(le.horizontal)||le.vertical;r.bucket.iconsInText=!!Ue&&Ue.iconsInText,(Ue||Pe)&&j_(r.bucket,M,le,Pe,r.imageMap,f,Z,te,De,rt,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},E.bq=Qs,E.br=Rh,E.bs=To,E.bt=Nl,E.bu=al,E.bv=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},E.bw=function(r,t,n,a,f){return u(this,void 0,void 0,function*(){if(pe())try{return yield Ze(r,t,n,a,f)}catch{}return function(y,_,b,T,M){const O=y.width,V=y.height;ht&&oe||(ht=new OffscreenCanvas(O,V),oe=ht.getContext("2d",{willReadFrequently:!0})),ht.width=O,ht.height=V,oe.drawImage(y,0,0,O,V);const Z=oe.getImageData(_,b,T,M);return oe.clearRect(0,0,O,V),Z.data}(r,t,n,a,f)})},E.bx=br,E.by=B,E.bz=U,E.c=Ct,E.d=r=>u(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=je,E.f=r=>new Promise((t,n)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=et})},a.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(r)],{type:"image/png"});a.src=r.byteLength?URL.createObjectURL(f):et}),E.g=wt,E.h=(r,t)=>Kt(je(r,{type:"json"}),t),E.i=Ve,E.j=W,E.k=Zr,E.l=(r,t)=>Kt(je(r,{type:"arrayBuffer"}),t),E.m=Kt,E.n=function(r){return new al(r).readFields(ku,[])},E.o=xu,E.p=$c,E.q=g,E.r=yc,E.s=Cr,E.t=ju,E.u=aa,E.v=ye,E.w=Je,E.x=function([r,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(n),y:r*Math.sin(t)*Math.sin(n),z:r*Math.cos(n)}},E.y=On,E.z=tn}),I("worker",["./shared"],function(E){class u{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,Q){for(const Se of ee){this._layerConfigs[Se.id]=Se;const Oe=this._layers[Se.id]=E.aA(Se);Oe._featureFilter=E.a7(Oe.filter),this.keyCache[Se.id]&&delete this.keyCache[Se.id]}for(const Se of Q)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ue=E.bk(Object.values(this._layerConfigs),this.keyCache);for(const Se of ue){const Oe=Se.map(ut=>this._layers[ut.id]),$e=Oe[0];if($e.visibility==="none")continue;const Ke=$e.source||"";let Le=this.familiesBySource[Ke];Le||(Le=this.familiesBySource[Ke]={});const pt=$e.sourceLayer||"_geojsonTileLayer";let It=Le[pt];It||(It=Le[pt]=[]),It.push(Oe)}}}class B{constructor(ee){const Q={},ue=[];for(const Ke in ee){const Le=ee[Ke],pt=Q[Ke]={};for(const It in Le){const ut=Le[+It];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Nt={x:0,y:0,w:ut.bitmap.width+2,h:ut.bitmap.height+2};ue.push(Nt),pt[It]={rect:Nt,metrics:ut.metrics}}}const{w:Se,h:Oe}=E.p(ue),$e=new E.o({width:Se||1,height:Oe||1});for(const Ke in ee){const Le=ee[Ke];for(const pt in Le){const It=Le[+pt];if(!It||It.bitmap.width===0||It.bitmap.height===0)continue;const ut=Q[Ke][pt].rect;E.o.copy(It.bitmap,$e,{x:0,y:0},{x:ut.x+1,y:ut.y+1},It.bitmap)}}this.image=$e,this.positions=Q}}E.bl("GlyphAtlas",B);class U{constructor(ee){this.tileID=new E.S(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,Q,ue,Se){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new E.a5;const Oe=new E.bm(Object.keys(ee.layers).sort()),$e=new E.bn(this.tileID,this.promoteId);$e.bucketLayerIDs=[];const Ke={},Le={featureIndex:$e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue},pt=Q.familiesBySource[this.source];for(const Hr in pt){const rn=ee.layers[Hr];if(!rn)continue;rn.version===1&&E.w(`Vector tile source "${this.source}" layer "${Hr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const un=Oe.encode(Hr),Fn=[];for(let Kn=0;Kn<rn.length;Kn++){const hi=rn.feature(Kn),ao=$e.getId(hi,Hr);Fn.push({feature:hi,id:ao,index:Kn,sourceLayerIndex:un})}for(const Kn of pt[Hr]){const hi=Kn[0];hi.source!==this.source&&E.w(`layer.source = ${hi.source} does not equal this.source = ${this.source}`),hi.minzoom&&this.zoom<Math.floor(hi.minzoom)||hi.maxzoom&&this.zoom>=hi.maxzoom||hi.visibility!=="none"&&(K(Kn,this.zoom,ue),(Ke[hi.id]=hi.createBucket({index:$e.bucketLayerIDs.length,layers:Kn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:un,sourceID:this.source})).populate(Fn,Le,this.tileID.canonical),$e.bucketLayerIDs.push(Kn.map(ao=>ao.id)))}}const It=E.aF(Le.glyphDependencies,Hr=>Object.keys(Hr).map(Number));this.inFlightDependencies.forEach(Hr=>Hr==null?void 0:Hr.abort()),this.inFlightDependencies=[];let ut=Promise.resolve({});if(Object.keys(It).length){const Hr=new AbortController;this.inFlightDependencies.push(Hr),ut=Se.sendAsync({type:"GG",data:{stacks:It,source:this.source,tileID:this.tileID,type:"glyphs"}},Hr)}const Nt=Object.keys(Le.iconDependencies);let cr=Promise.resolve({});if(Nt.length){const Hr=new AbortController;this.inFlightDependencies.push(Hr),cr=Se.sendAsync({type:"GI",data:{icons:Nt,source:this.source,tileID:this.tileID,type:"icons"}},Hr)}const pr=Object.keys(Le.patternDependencies);let Jr=Promise.resolve({});if(pr.length){const Hr=new AbortController;this.inFlightDependencies.push(Hr),Jr=Se.sendAsync({type:"GI",data:{icons:pr,source:this.source,tileID:this.tileID,type:"patterns"}},Hr)}const[Mr,Kr,Ur]=yield Promise.all([ut,cr,Jr]),bn=new B(Mr),En=new E.bo(Kr,Ur);for(const Hr in Ke){const rn=Ke[Hr];rn instanceof E.a6?(K(rn.layers,this.zoom,ue),E.bp({bucket:rn,glyphMap:Mr,glyphPositions:bn.positions,imageMap:Kr,imagePositions:En.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):rn.hasPattern&&(rn instanceof E.bq||rn instanceof E.br||rn instanceof E.bs)&&(K(rn.layers,this.zoom,ue),rn.addFeatures(Le,this.tileID.canonical,En.patternPositions))}return this.status="done",{buckets:Object.values(Ke).filter(Hr=>!Hr.isEmpty()),featureIndex:$e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:bn.image,imageAtlas:En,glyphMap:this.returnDependencies?Mr:null,iconMap:this.returnDependencies?Kr:null,glyphPositions:this.returnDependencies?bn.positions:null}})}}function K(Ce,ee,Q){const ue=new E.z(ee);for(const Se of Ce)Se.recalculate(ue,Q)}class j{constructor(ee,Q,ue){this.actor=ee,this.layerIndex=Q,this.availableImages=ue,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,Q){return E._(this,void 0,void 0,function*(){const ue=yield E.l(ee.request,Q);try{return{vectorTile:new E.bt.VectorTile(new E.bu(ue.data)),rawData:ue.data,cacheControl:ue.cacheControl,expires:ue.expires}}catch(Se){const Oe=new Uint8Array(ue.data);let $e=`Unable to parse the tile at ${ee.request.url}, `;throw $e+=Oe[0]===31&&Oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Se.message}`,new Error($e)}})}loadTile(ee){return E._(this,void 0,void 0,function*(){const Q=ee.uid,ue=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new E.bv(ee.request),Se=new U(ee);this.loading[Q]=Se;const Oe=new AbortController;Se.abort=Oe;try{const $e=yield this.loadVectorTile(ee,Oe);if(delete this.loading[Q],!$e)return null;const Ke=$e.rawData,Le={};$e.expires&&(Le.expires=$e.expires),$e.cacheControl&&(Le.cacheControl=$e.cacheControl);const pt={};if(ue){const ut=ue.finish();ut&&(pt.resourceTiming=JSON.parse(JSON.stringify(ut)))}Se.vectorTile=$e.vectorTile;const It=Se.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[Q]=Se,this.fetching[Q]={rawTileData:Ke,cacheControl:Le,resourceTiming:pt};try{const ut=yield It;return E.e({rawTileData:Ke.slice(0)},ut,Le,pt)}finally{delete this.fetching[Q]}}catch($e){throw delete this.loading[Q],Se.status="done",this.loaded[Q]=Se,$e}})}reloadTile(ee){return E._(this,void 0,void 0,function*(){const Q=ee.uid;if(!this.loaded||!this.loaded[Q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ue=this.loaded[Q];if(ue.showCollisionBoxes=ee.showCollisionBoxes,ue.status==="parsing"){const Se=yield ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor);let Oe;if(this.fetching[Q]){const{rawTileData:$e,cacheControl:Ke,resourceTiming:Le}=this.fetching[Q];delete this.fetching[Q],Oe=E.e({rawTileData:$e.slice(0)},Se,Ke,Le)}else Oe=Se;return Oe}if(ue.status==="done"&&ue.vectorTile)return ue.parse(ue.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(ee){return E._(this,void 0,void 0,function*(){const Q=this.loading,ue=ee.uid;Q&&Q[ue]&&Q[ue].abort&&(Q[ue].abort.abort(),delete Q[ue])})}removeTile(ee){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class N{constructor(){this.loaded={}}loadTile(ee){return E._(this,void 0,void 0,function*(){const{uid:Q,encoding:ue,rawImageData:Se,redFactor:Oe,greenFactor:$e,blueFactor:Ke,baseShift:Le}=ee,pt=Se.width+2,It=Se.height+2,ut=E.b(Se)?new E.R({width:pt,height:It},yield E.bw(Se,-1,-1,pt,It)):Se,Nt=new E.bx(Q,ut,ue,Oe,$e,Ke,Le);return this.loaded=this.loaded||{},this.loaded[Q]=Nt,Nt})}removeTile(ee){const Q=this.loaded,ue=ee.uid;Q&&Q[ue]&&delete Q[ue]}}function q(Ce,ee){if(Ce.length!==0){se(Ce[0],ee);for(var Q=1;Q<Ce.length;Q++)se(Ce[Q],!ee)}}function se(Ce,ee){for(var Q=0,ue=0,Se=0,Oe=Ce.length,$e=Oe-1;Se<Oe;$e=Se++){var Ke=(Ce[Se][0]-Ce[$e][0])*(Ce[$e][1]+Ce[Se][1]),Le=Q+Ke;ue+=Math.abs(Q)>=Math.abs(Ke)?Q-Le+Ke:Ke-Le+Q,Q=Le}Q+ue>=0!=!!ee&&Ce.reverse()}var J=E.by(function Ce(ee,Q){var ue,Se=ee&&ee.type;if(Se==="FeatureCollection")for(ue=0;ue<ee.features.length;ue++)Ce(ee.features[ue],Q);else if(Se==="GeometryCollection")for(ue=0;ue<ee.geometries.length;ue++)Ce(ee.geometries[ue],Q);else if(Se==="Feature")Ce(ee.geometry,Q);else if(Se==="Polygon")q(ee.coordinates,Q);else if(Se==="MultiPolygon")for(ue=0;ue<ee.coordinates.length;ue++)q(ee.coordinates[ue],Q);return ee});const ae=E.bt.VectorTileFeature.prototype.toGeoJSON;var re={exports:{}},pe=E.bz,ge=E.bt.VectorTileFeature,Fe=ve;function ve(Ce,ee){this.options=ee||{},this.features=Ce,this.length=Ce.length}function qe(Ce,ee){this.id=typeof Ce.id=="number"?Ce.id:void 0,this.type=Ce.type,this.rawGeometry=Ce.type===1?[Ce.geometry]:Ce.geometry,this.properties=Ce.tags,this.extent=ee||4096}ve.prototype.feature=function(Ce){return new qe(this.features[Ce],this.options.extent)},qe.prototype.loadGeometry=function(){var Ce=this.rawGeometry;this.geometry=[];for(var ee=0;ee<Ce.length;ee++){for(var Q=Ce[ee],ue=[],Se=0;Se<Q.length;Se++)ue.push(new pe(Q[Se][0],Q[Se][1]));this.geometry.push(ue)}return this.geometry},qe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ce=this.geometry,ee=1/0,Q=-1/0,ue=1/0,Se=-1/0,Oe=0;Oe<Ce.length;Oe++)for(var $e=Ce[Oe],Ke=0;Ke<$e.length;Ke++){var Le=$e[Ke];ee=Math.min(ee,Le.x),Q=Math.max(Q,Le.x),ue=Math.min(ue,Le.y),Se=Math.max(Se,Le.y)}return[ee,ue,Q,Se]},qe.prototype.toGeoJSON=ge.prototype.toGeoJSON;var je=E.bA,St=Fe;function ot(Ce){var ee=new je;return function(Q,ue){for(var Se in Q.layers)ue.writeMessage(3,At,Q.layers[Se])}(Ce,ee),ee.finish()}function At(Ce,ee){var Q;ee.writeVarintField(15,Ce.version||1),ee.writeStringField(1,Ce.name||""),ee.writeVarintField(5,Ce.extent||4096);var ue={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<Ce.length;Q++)ue.feature=Ce.feature(Q),ee.writeMessage(2,xt,ue);var Se=ue.keys;for(Q=0;Q<Se.length;Q++)ee.writeStringField(3,Se[Q]);var Oe=ue.values;for(Q=0;Q<Oe.length;Q++)ee.writeMessage(4,Rt,Oe[Q])}function xt(Ce,ee){var Q=Ce.feature;Q.id!==void 0&&ee.writeVarintField(1,Q.id),ee.writeMessage(2,xe,Ce),ee.writeVarintField(3,Q.type),ee.writeMessage(4,Ve,Q)}function xe(Ce,ee){var Q=Ce.feature,ue=Ce.keys,Se=Ce.values,Oe=Ce.keycache,$e=Ce.valuecache;for(var Ke in Q.properties){var Le=Q.properties[Ke],pt=Oe[Ke];if(Le!==null){pt===void 0&&(ue.push(Ke),Oe[Ke]=pt=ue.length-1),ee.writeVarint(pt);var It=typeof Le;It!=="string"&&It!=="boolean"&&It!=="number"&&(Le=JSON.stringify(Le));var ut=It+":"+Le,Nt=$e[ut];Nt===void 0&&(Se.push(Le),$e[ut]=Nt=Se.length-1),ee.writeVarint(Nt)}}}function Je(Ce,ee){return(ee<<3)+(7&Ce)}function G(Ce){return Ce<<1^Ce>>31}function Ve(Ce,ee){for(var Q=Ce.loadGeometry(),ue=Ce.type,Se=0,Oe=0,$e=Q.length,Ke=0;Ke<$e;Ke++){var Le=Q[Ke],pt=1;ue===1&&(pt=Le.length),ee.writeVarint(Je(1,pt));for(var It=ue===3?Le.length-1:Le.length,ut=0;ut<It;ut++){ut===1&&ue!==1&&ee.writeVarint(Je(2,It-1));var Nt=Le[ut].x-Se,cr=Le[ut].y-Oe;ee.writeVarint(G(Nt)),ee.writeVarint(G(cr)),Se+=Nt,Oe+=cr}ue===3&&ee.writeVarint(Je(7,1))}}function Rt(Ce,ee){var Q=typeof Ce;Q==="string"?ee.writeStringField(1,Ce):Q==="boolean"?ee.writeBooleanField(7,Ce):Q==="number"&&(Ce%1!=0?ee.writeDoubleField(3,Ce):Ce<0?ee.writeSVarintField(6,Ce):ee.writeVarintField(5,Ce))}re.exports=ot,re.exports.fromVectorTileJs=ot,re.exports.fromGeojsonVt=function(Ce,ee){ee=ee||{};var Q={};for(var ue in Ce)Q[ue]=new St(Ce[ue].features,ee),Q[ue].name=ue,Q[ue].version=ee.version,Q[ue].extent=ee.extent;return ot({layers:Q})},re.exports.GeoJSONWrapper=St;var Ae=E.by(re.exports);const et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ce=>Ce},Ze=Math.fround||(ht=new Float32Array(1),Ce=>(ht[0]=+Ce,ht[0]));var ht;const oe=3,_e=5,Ct=6;class bt{constructor(ee){this.options=Object.assign(Object.create(et),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:Q,minZoom:ue,maxZoom:Se}=this.options;Q&&console.time("total time");const Oe=`prepare ${ee.length} points`;Q&&console.time(Oe),this.points=ee;const $e=[];for(let Le=0;Le<ee.length;Le++){const pt=ee[Le];if(!pt.geometry)continue;const[It,ut]=pt.geometry.coordinates,Nt=Ze(fr(It)),cr=Ze(qt(ut));$e.push(Nt,cr,1/0,Le,-1,1),this.options.reduce&&$e.push(0)}let Ke=this.trees[Se+1]=this._createTree($e);Q&&console.timeEnd(Oe);for(let Le=Se;Le>=ue;Le--){const pt=+Date.now();Ke=this.trees[Le]=this._createTree(this._cluster(Ke,Le)),Q&&console.log("z%d: %d clusters in %dms",Le,Ke.numItems,+Date.now()-pt)}return Q&&console.timeEnd("total time"),this}getClusters(ee,Q){let ue=((ee[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,ee[1]));let Oe=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)ue=-180,Oe=180;else if(ue>Oe){const ut=this.getClusters([ue,Se,180,$e],Q),Nt=this.getClusters([-180,Se,Oe,$e],Q);return ut.concat(Nt)}const Ke=this.trees[this._limitZoom(Q)],Le=Ke.range(fr(ue),qt($e),fr(Oe),qt(Se)),pt=Ke.data,It=[];for(const ut of Le){const Nt=this.stride*ut;It.push(pt[Nt+_e]>1?wt(pt,Nt,this.clusterProps):this.points[pt[Nt+oe]])}return It}getChildren(ee){const Q=this._getOriginId(ee),ue=this._getOriginZoom(ee),Se="No cluster with the specified id.",Oe=this.trees[ue];if(!Oe)throw new Error(Se);const $e=Oe.data;if(Q*this.stride>=$e.length)throw new Error(Se);const Ke=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),Le=Oe.within($e[Q*this.stride],$e[Q*this.stride+1],Ke),pt=[];for(const It of Le){const ut=It*this.stride;$e[ut+4]===ee&&pt.push($e[ut+_e]>1?wt($e,ut,this.clusterProps):this.points[$e[ut+oe]])}if(pt.length===0)throw new Error(Se);return pt}getLeaves(ee,Q,ue){const Se=[];return this._appendLeaves(Se,ee,Q=Q||10,ue=ue||0,0),Se}getTile(ee,Q,ue){const Se=this.trees[this._limitZoom(ee)],Oe=Math.pow(2,ee),{extent:$e,radius:Ke}=this.options,Le=Ke/$e,pt=(ue-Le)/Oe,It=(ue+1+Le)/Oe,ut={features:[]};return this._addTileFeatures(Se.range((Q-Le)/Oe,pt,(Q+1+Le)/Oe,It),Se.data,Q,ue,Oe,ut),Q===0&&this._addTileFeatures(Se.range(1-Le/Oe,pt,1,It),Se.data,Oe,ue,Oe,ut),Q===Oe-1&&this._addTileFeatures(Se.range(0,pt,Le/Oe,It),Se.data,-1,ue,Oe,ut),ut.features.length?ut:null}getClusterExpansionZoom(ee){let Q=this._getOriginZoom(ee)-1;for(;Q<=this.options.maxZoom;){const ue=this.getChildren(ee);if(Q++,ue.length!==1)break;ee=ue[0].properties.cluster_id}return Q}_appendLeaves(ee,Q,ue,Se,Oe){const $e=this.getChildren(Q);for(const Ke of $e){const Le=Ke.properties;if(Le&&Le.cluster?Oe+Le.point_count<=Se?Oe+=Le.point_count:Oe=this._appendLeaves(ee,Le.cluster_id,ue,Se,Oe):Oe<Se?Oe++:ee.push(Ke),ee.length===ue)break}return Oe}_createTree(ee){const Q=new E.av(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ee.length;ue+=this.stride)Q.add(ee[ue],ee[ue+1]);return Q.finish(),Q.data=ee,Q}_addTileFeatures(ee,Q,ue,Se,Oe,$e){for(const Ke of ee){const Le=Ke*this.stride,pt=Q[Le+_e]>1;let It,ut,Nt;if(pt)It=ar(Q,Le,this.clusterProps),ut=Q[Le],Nt=Q[Le+1];else{const Jr=this.points[Q[Le+oe]];It=Jr.properties;const[Mr,Kr]=Jr.geometry.coordinates;ut=fr(Mr),Nt=qt(Kr)}const cr={type:1,geometry:[[Math.round(this.options.extent*(ut*Oe-ue)),Math.round(this.options.extent*(Nt*Oe-Se))]],tags:It};let pr;pr=pt||this.options.generateId?Q[Le+oe]:this.points[Q[Le+oe]].id,pr!==void 0&&(cr.id=pr),$e.features.push(cr)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,Q){const{radius:ue,extent:Se,reduce:Oe,minPoints:$e}=this.options,Ke=ue/(Se*Math.pow(2,Q)),Le=ee.data,pt=[],It=this.stride;for(let ut=0;ut<Le.length;ut+=It){if(Le[ut+2]<=Q)continue;Le[ut+2]=Q;const Nt=Le[ut],cr=Le[ut+1],pr=ee.within(Le[ut],Le[ut+1],Ke),Jr=Le[ut+_e];let Mr=Jr;for(const Kr of pr){const Ur=Kr*It;Le[Ur+2]>Q&&(Mr+=Le[Ur+_e])}if(Mr>Jr&&Mr>=$e){let Kr,Ur=Nt*Jr,bn=cr*Jr,En=-1;const Hr=((ut/It|0)<<5)+(Q+1)+this.points.length;for(const rn of pr){const un=rn*It;if(Le[un+2]<=Q)continue;Le[un+2]=Q;const Fn=Le[un+_e];Ur+=Le[un]*Fn,bn+=Le[un+1]*Fn,Le[un+4]=Hr,Oe&&(Kr||(Kr=this._map(Le,ut,!0),En=this.clusterProps.length,this.clusterProps.push(Kr)),Oe(Kr,this._map(Le,un)))}Le[ut+4]=Hr,pt.push(Ur/Mr,bn/Mr,1/0,Hr,-1,Mr),Oe&&pt.push(En)}else{for(let Kr=0;Kr<It;Kr++)pt.push(Le[ut+Kr]);if(Mr>1)for(const Kr of pr){const Ur=Kr*It;if(!(Le[Ur+2]<=Q)){Le[Ur+2]=Q;for(let bn=0;bn<It;bn++)pt.push(Le[Ur+bn])}}}}return pt}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,Q,ue){if(ee[Q+_e]>1){const $e=this.clusterProps[ee[Q+Ct]];return ue?Object.assign({},$e):$e}const Se=this.points[ee[Q+oe]].properties,Oe=this.options.map(Se);return ue&&Oe===Se?Object.assign({},Oe):Oe}}function wt(Ce,ee,Q){return{type:"Feature",id:Ce[ee+oe],properties:ar(Ce,ee,Q),geometry:{type:"Point",coordinates:[(ue=Ce[ee],360*(ue-.5)),Kt(Ce[ee+1])]}};var ue}function ar(Ce,ee,Q){const ue=Ce[ee+_e],Se=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,Oe=Ce[ee+Ct],$e=Oe===-1?{}:Object.assign({},Q[Oe]);return Object.assign($e,{cluster:!0,cluster_id:Ce[ee+oe],point_count:ue,point_count_abbreviated:Se})}function fr(Ce){return Ce/360+.5}function qt(Ce){const ee=Math.sin(Ce*Math.PI/180),Q=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Q<0?0:Q>1?1:Q}function Kt(Ce){const ee=(180-360*Ce)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Cr(Ce,ee,Q,ue){let Se=ue;const Oe=ee+(Q-ee>>1);let $e,Ke=Q-ee;const Le=Ce[ee],pt=Ce[ee+1],It=Ce[Q],ut=Ce[Q+1];for(let Nt=ee+3;Nt<Q;Nt+=3){const cr=Br(Ce[Nt],Ce[Nt+1],Le,pt,It,ut);if(cr>Se)$e=Nt,Se=cr;else if(cr===Se){const pr=Math.abs(Nt-Oe);pr<Ke&&($e=Nt,Ke=pr)}}Se>ue&&($e-ee>3&&Cr(Ce,ee,$e,ue),Ce[$e+2]=Se,Q-$e>3&&Cr(Ce,$e,Q,ue))}function Br(Ce,ee,Q,ue,Se,Oe){let $e=Se-Q,Ke=Oe-ue;if($e!==0||Ke!==0){const Le=((Ce-Q)*$e+(ee-ue)*Ke)/($e*$e+Ke*Ke);Le>1?(Q=Se,ue=Oe):Le>0&&(Q+=$e*Le,ue+=Ke*Le)}return $e=Ce-Q,Ke=ee-ue,$e*$e+Ke*Ke}function Yr(Ce,ee,Q,ue){const Se={id:Ce??null,type:ee,geometry:Q,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Zr(Se,Q);else if(ee==="Polygon")Zr(Se,Q[0]);else if(ee==="MultiLineString")for(const Oe of Q)Zr(Se,Oe);else if(ee==="MultiPolygon")for(const Oe of Q)Zr(Se,Oe[0]);return Se}function Zr(Ce,ee){for(let Q=0;Q<ee.length;Q+=3)Ce.minX=Math.min(Ce.minX,ee[Q]),Ce.minY=Math.min(Ce.minY,ee[Q+1]),Ce.maxX=Math.max(Ce.maxX,ee[Q]),Ce.maxY=Math.max(Ce.maxY,ee[Q+1])}function W(Ce,ee,Q,ue){if(!ee.geometry)return;const Se=ee.geometry.coordinates;if(Se&&Se.length===0)return;const Oe=ee.geometry.type,$e=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let Ke=[],Le=ee.id;if(Q.promoteId?Le=ee.properties[Q.promoteId]:Q.generateId&&(Le=ue||0),Oe==="Point")ft(Se,Ke);else if(Oe==="MultiPoint")for(const pt of Se)ft(pt,Ke);else if(Oe==="LineString")ye(Se,Ke,$e,!1);else if(Oe==="MultiLineString"){if(Q.lineMetrics){for(const pt of Se)Ke=[],ye(pt,Ke,$e,!1),Ce.push(Yr(Le,"LineString",Ke,ee.properties));return}Me(Se,Ke,$e,!1)}else if(Oe==="Polygon")Me(Se,Ke,$e,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const pt of ee.geometry.geometries)W(Ce,{id:Le,geometry:pt,properties:ee.properties},Q,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const pt of Se){const It=[];Me(pt,It,$e,!0),Ke.push(It)}}Ce.push(Yr(Le,Oe,Ke,ee.properties))}function ft(Ce,ee){ee.push(we(Ce[0]),Ne(Ce[1]),0)}function ye(Ce,ee,Q,ue){let Se,Oe,$e=0;for(let Le=0;Le<Ce.length;Le++){const pt=we(Ce[Le][0]),It=Ne(Ce[Le][1]);ee.push(pt,It,0),Le>0&&($e+=ue?(Se*It-pt*Oe)/2:Math.sqrt(Math.pow(pt-Se,2)+Math.pow(It-Oe,2))),Se=pt,Oe=It}const Ke=ee.length-3;ee[2]=1,Cr(ee,0,Ke,Q),ee[Ke+2]=1,ee.size=Math.abs($e),ee.start=0,ee.end=ee.size}function Me(Ce,ee,Q,ue){for(let Se=0;Se<Ce.length;Se++){const Oe=[];ye(Ce[Se],Oe,Q,ue),ee.push(Oe)}}function we(Ce){return Ce/360+.5}function Ne(Ce){const ee=Math.sin(Ce*Math.PI/180),Q=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return Q<0?0:Q>1?1:Q}function _t(Ce,ee,Q,ue,Se,Oe,$e,Ke){if(ue/=ee,Oe>=(Q/=ee)&&$e<ue)return Ce;if($e<Q||Oe>=ue)return null;const Le=[];for(const pt of Ce){const It=pt.geometry;let ut=pt.type;const Nt=Se===0?pt.minX:pt.minY,cr=Se===0?pt.maxX:pt.maxY;if(Nt>=Q&&cr<ue){Le.push(pt);continue}if(cr<Q||Nt>=ue)continue;let pr=[];if(ut==="Point"||ut==="MultiPoint")Mt(It,pr,Q,ue,Se);else if(ut==="LineString")nt(It,pr,Q,ue,Se,!1,Ke.lineMetrics);else if(ut==="MultiLineString")rr(It,pr,Q,ue,Se,!1);else if(ut==="Polygon")rr(It,pr,Q,ue,Se,!0);else if(ut==="MultiPolygon")for(const Jr of It){const Mr=[];rr(Jr,Mr,Q,ue,Se,!0),Mr.length&&pr.push(Mr)}if(pr.length){if(Ke.lineMetrics&&ut==="LineString"){for(const Jr of pr)Le.push(Yr(pt.id,ut,Jr,pt.tags));continue}ut!=="LineString"&&ut!=="MultiLineString"||(pr.length===1?(ut="LineString",pr=pr[0]):ut="MultiLineString"),ut!=="Point"&&ut!=="MultiPoint"||(ut=pr.length===3?"Point":"MultiPoint"),Le.push(Yr(pt.id,ut,pr,pt.tags))}}return Le.length?Le:null}function Mt(Ce,ee,Q,ue,Se){for(let Oe=0;Oe<Ce.length;Oe+=3){const $e=Ce[Oe+Se];$e>=Q&&$e<=ue&&Lt(ee,Ce[Oe],Ce[Oe+1],Ce[Oe+2])}}function nt(Ce,ee,Q,ue,Se,Oe,$e){let Ke=zt(Ce);const Le=Se===0?_r:en;let pt,It,ut=Ce.start;for(let Mr=0;Mr<Ce.length-3;Mr+=3){const Kr=Ce[Mr],Ur=Ce[Mr+1],bn=Ce[Mr+2],En=Ce[Mr+3],Hr=Ce[Mr+4],rn=Se===0?Kr:Ur,un=Se===0?En:Hr;let Fn=!1;$e&&(pt=Math.sqrt(Math.pow(Kr-En,2)+Math.pow(Ur-Hr,2))),rn<Q?un>Q&&(It=Le(Ke,Kr,Ur,En,Hr,Q),$e&&(Ke.start=ut+pt*It)):rn>ue?un<ue&&(It=Le(Ke,Kr,Ur,En,Hr,ue),$e&&(Ke.start=ut+pt*It)):Lt(Ke,Kr,Ur,bn),un<Q&&rn>=Q&&(It=Le(Ke,Kr,Ur,En,Hr,Q),Fn=!0),un>ue&&rn<=ue&&(It=Le(Ke,Kr,Ur,En,Hr,ue),Fn=!0),!Oe&&Fn&&($e&&(Ke.end=ut+pt*It),ee.push(Ke),Ke=zt(Ce)),$e&&(ut+=pt)}let Nt=Ce.length-3;const cr=Ce[Nt],pr=Ce[Nt+1],Jr=Se===0?cr:pr;Jr>=Q&&Jr<=ue&&Lt(Ke,cr,pr,Ce[Nt+2]),Nt=Ke.length-3,Oe&&Nt>=3&&(Ke[Nt]!==Ke[0]||Ke[Nt+1]!==Ke[1])&&Lt(Ke,Ke[0],Ke[1],Ke[2]),Ke.length&&ee.push(Ke)}function zt(Ce){const ee=[];return ee.size=Ce.size,ee.start=Ce.start,ee.end=Ce.end,ee}function rr(Ce,ee,Q,ue,Se,Oe){for(const $e of Ce)nt($e,ee,Q,ue,Se,Oe,!1)}function Lt(Ce,ee,Q,ue){Ce.push(ee,Q,ue)}function _r(Ce,ee,Q,ue,Se,Oe){const $e=(Oe-ee)/(ue-ee);return Lt(Ce,Oe,Q+(Se-Q)*$e,1),$e}function en(Ce,ee,Q,ue,Se,Oe){const $e=(Oe-Q)/(Se-Q);return Lt(Ce,ee+(ue-ee)*$e,Oe,1),$e}function vt(Ce,ee){const Q=[];for(let ue=0;ue<Ce.length;ue++){const Se=Ce[ue],Oe=Se.type;let $e;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")$e=xn(Se.geometry,ee);else if(Oe==="MultiLineString"||Oe==="Polygon"){$e=[];for(const Ke of Se.geometry)$e.push(xn(Ke,ee))}else if(Oe==="MultiPolygon"){$e=[];for(const Ke of Se.geometry){const Le=[];for(const pt of Ke)Le.push(xn(pt,ee));$e.push(Le)}}Q.push(Yr(Se.id,Oe,$e,Se.tags))}return Q}function xn(Ce,ee){const Q=[];Q.size=Ce.size,Ce.start!==void 0&&(Q.start=Ce.start,Q.end=Ce.end);for(let ue=0;ue<Ce.length;ue+=3)Q.push(Ce[ue]+ee,Ce[ue+1],Ce[ue+2]);return Q}function yn(Ce,ee){if(Ce.transformed)return Ce;const Q=1<<Ce.z,ue=Ce.x,Se=Ce.y;for(const Oe of Ce.features){const $e=Oe.geometry,Ke=Oe.type;if(Oe.geometry=[],Ke===1)for(let Le=0;Le<$e.length;Le+=2)Oe.geometry.push(wn($e[Le],$e[Le+1],ee,Q,ue,Se));else for(let Le=0;Le<$e.length;Le++){const pt=[];for(let It=0;It<$e[Le].length;It+=2)pt.push(wn($e[Le][It],$e[Le][It+1],ee,Q,ue,Se));Oe.geometry.push(pt)}}return Ce.transformed=!0,Ce}function wn(Ce,ee,Q,ue,Se,Oe){return[Math.round(Q*(Ce*ue-Se)),Math.round(Q*(ee*ue-Oe))]}function ui(Ce,ee,Q,ue,Se){const Oe=ee===Se.maxZoom?0:Se.tolerance/((1<<ee)*Se.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:Ce.length,source:null,x:Q,y:ue,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ke of Ce)Pt($e,Ke,Oe,Se);return $e}function Pt(Ce,ee,Q,ue){const Se=ee.geometry,Oe=ee.type,$e=[];if(Ce.minX=Math.min(Ce.minX,ee.minX),Ce.minY=Math.min(Ce.minY,ee.minY),Ce.maxX=Math.max(Ce.maxX,ee.maxX),Ce.maxY=Math.max(Ce.maxY,ee.maxY),Oe==="Point"||Oe==="MultiPoint")for(let Ke=0;Ke<Se.length;Ke+=3)$e.push(Se[Ke],Se[Ke+1]),Ce.numPoints++,Ce.numSimplified++;else if(Oe==="LineString")zr($e,Se,Ce,Q,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let Ke=0;Ke<Se.length;Ke++)zr($e,Se[Ke],Ce,Q,Oe==="Polygon",Ke===0);else if(Oe==="MultiPolygon")for(let Ke=0;Ke<Se.length;Ke++){const Le=Se[Ke];for(let pt=0;pt<Le.length;pt++)zr($e,Le[pt],Ce,Q,!0,pt===0)}if($e.length){let Ke=ee.tags||null;if(Oe==="LineString"&&ue.lineMetrics){Ke={};for(const pt in ee.tags)Ke[pt]=ee.tags[pt];Ke.mapbox_clip_start=Se.start/Se.size,Ke.mapbox_clip_end=Se.end/Se.size}const Le={geometry:$e,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:Ke};ee.id!==null&&(Le.id=ee.id),Ce.features.push(Le)}}function zr(Ce,ee,Q,ue,Se,Oe){const $e=ue*ue;if(ue>0&&ee.size<(Se?$e:ue))return void(Q.numPoints+=ee.length/3);const Ke=[];for(let Le=0;Le<ee.length;Le+=3)(ue===0||ee[Le+2]>$e)&&(Q.numSimplified++,Ke.push(ee[Le],ee[Le+1])),Q.numPoints++;Se&&function(Le,pt){let It=0;for(let ut=0,Nt=Le.length,cr=Nt-2;ut<Nt;cr=ut,ut+=2)It+=(Le[ut]-Le[cr])*(Le[ut+1]+Le[cr+1]);if(It>0===pt)for(let ut=0,Nt=Le.length;ut<Nt/2;ut+=2){const cr=Le[ut],pr=Le[ut+1];Le[ut]=Le[Nt-2-ut],Le[ut+1]=Le[Nt-1-ut],Le[Nt-2-ut]=cr,Le[Nt-1-ut]=pr}}(Ke,Oe),Ce.push(Ke)}const wr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class _n{constructor(ee,Q){const ue=(Q=this.options=function(Oe,$e){for(const Ke in $e)Oe[Ke]=$e[Ke];return Oe}(Object.create(wr),Q)).debug;if(ue&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let Se=function(Oe,$e){const Ke=[];if(Oe.type==="FeatureCollection")for(let Le=0;Le<Oe.features.length;Le++)W(Ke,Oe.features[Le],$e,Le);else W(Ke,Oe.type==="Feature"?Oe:{geometry:Oe},$e);return Ke}(ee,Q);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Se=function(Oe,$e){const Ke=$e.buffer/$e.extent;let Le=Oe;const pt=_t(Oe,1,-1-Ke,Ke,0,-1,2,$e),It=_t(Oe,1,1-Ke,2+Ke,0,-1,2,$e);return(pt||It)&&(Le=_t(Oe,1,-Ke,1+Ke,0,-1,2,$e)||[],pt&&(Le=vt(pt,1).concat(Le)),It&&(Le=Le.concat(vt(It,-1)))),Le}(Se,Q),Se.length&&this.splitTile(Se,0,0,0),ue&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,Q,ue,Se,Oe,$e,Ke){const Le=[ee,Q,ue,Se],pt=this.options,It=pt.debug;for(;Le.length;){Se=Le.pop(),ue=Le.pop(),Q=Le.pop(),ee=Le.pop();const ut=1<<Q,Nt=ci(Q,ue,Se);let cr=this.tiles[Nt];if(!cr&&(It>1&&console.time("creation"),cr=this.tiles[Nt]=ui(ee,Q,ue,Se,pt),this.tileCoords.push({z:Q,x:ue,y:Se}),It)){It>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ue,Se,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));const Fn=`z${Q}`;this.stats[Fn]=(this.stats[Fn]||0)+1,this.total++}if(cr.source=ee,Oe==null){if(Q===pt.indexMaxZoom||cr.numPoints<=pt.indexMaxPoints)continue}else{if(Q===pt.maxZoom||Q===Oe)continue;if(Oe!=null){const Fn=Oe-Q;if(ue!==$e>>Fn||Se!==Ke>>Fn)continue}}if(cr.source=null,ee.length===0)continue;It>1&&console.time("clipping");const pr=.5*pt.buffer/pt.extent,Jr=.5-pr,Mr=.5+pr,Kr=1+pr;let Ur=null,bn=null,En=null,Hr=null,rn=_t(ee,ut,ue-pr,ue+Mr,0,cr.minX,cr.maxX,pt),un=_t(ee,ut,ue+Jr,ue+Kr,0,cr.minX,cr.maxX,pt);ee=null,rn&&(Ur=_t(rn,ut,Se-pr,Se+Mr,1,cr.minY,cr.maxY,pt),bn=_t(rn,ut,Se+Jr,Se+Kr,1,cr.minY,cr.maxY,pt),rn=null),un&&(En=_t(un,ut,Se-pr,Se+Mr,1,cr.minY,cr.maxY,pt),Hr=_t(un,ut,Se+Jr,Se+Kr,1,cr.minY,cr.maxY,pt),un=null),It>1&&console.timeEnd("clipping"),Le.push(Ur||[],Q+1,2*ue,2*Se),Le.push(bn||[],Q+1,2*ue,2*Se+1),Le.push(En||[],Q+1,2*ue+1,2*Se),Le.push(Hr||[],Q+1,2*ue+1,2*Se+1)}}getTile(ee,Q,ue){ee=+ee,Q=+Q,ue=+ue;const Se=this.options,{extent:Oe,debug:$e}=Se;if(ee<0||ee>24)return null;const Ke=1<<ee,Le=ci(ee,Q=Q+Ke&Ke-1,ue);if(this.tiles[Le])return yn(this.tiles[Le],Oe);$e>1&&console.log("drilling down to z%d-%d-%d",ee,Q,ue);let pt,It=ee,ut=Q,Nt=ue;for(;!pt&&It>0;)It--,ut>>=1,Nt>>=1,pt=this.tiles[ci(It,ut,Nt)];return pt&&pt.source?($e>1&&(console.log("found parent tile z%d-%d-%d",It,ut,Nt),console.time("drilling down")),this.splitTile(pt.source,It,ut,Nt,ee,Q,ue),$e>1&&console.timeEnd("drilling down"),this.tiles[Le]?yn(this.tiles[Le],Oe):null):null}}function ci(Ce,ee,Q){return 32*((1<<Ce)*Q+ee)+Ce}function Ir(Ce,ee){return ee?Ce.properties[ee]:Ce.id}function An(Ce,ee){if(Ce==null)return!0;if(Ce.type==="Feature")return Ir(Ce,ee)!=null;if(Ce.type==="FeatureCollection"){const Q=new Set;for(const ue of Ce.features){const Se=Ir(ue,ee);if(Se==null||Q.has(Se))return!1;Q.add(Se)}return!0}return!1}function wi(Ce,ee){const Q=new Map;if(Ce!=null)if(Ce.type==="Feature")Q.set(Ir(Ce,ee),Ce);else for(const ue of Ce.features)Q.set(Ir(ue,ee),ue);return Q}class Xn extends j{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,Q){return E._(this,void 0,void 0,function*(){const ue=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Se=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!Se)return null;const Oe=new class{constructor(Ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.X,this.length=Ke.length,this._features=Ke}feature(Ke){return new class{constructor(Le){this._feature=Le,this.extent=E.X,this.type=Le.type,this.properties=Le.tags,"id"in Le&&!isNaN(Le.id)&&(this.id=parseInt(Le.id,10))}loadGeometry(){if(this._feature.type===1){const Le=[];for(const pt of this._feature.geometry)Le.push([new E.P(pt[0],pt[1])]);return Le}{const Le=[];for(const pt of this._feature.geometry){const It=[];for(const ut of pt)It.push(new E.P(ut[0],ut[1]));Le.push(It)}return Le}}toGeoJSON(Le,pt,It){return ae.call(this,Le,pt,It)}}(this._features[Ke])}}(Se.features);let $e=Ae(Oe);return $e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),{vectorTile:Oe,rawData:$e.buffer}})}loadData(ee){return E._(this,void 0,void 0,function*(){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.abort();const ue=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new E.bv(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new bt(function({superclusterOptions:$e,clusterProperties:Ke}){if(!Ke||!$e)return $e;const Le={},pt={},It={accumulated:null,zoom:0},ut={properties:null},Nt=Object.keys(Ke);for(const cr of Nt){const[pr,Jr]=Ke[cr],Mr=E.bC(Jr),Kr=E.bC(typeof pr=="string"?[pr,["accumulated"],["get",cr]]:pr);Le[cr]=Mr.value,pt[cr]=Kr.value}return $e.map=cr=>{ut.properties=cr;const pr={};for(const Jr of Nt)pr[Jr]=Le[Jr].evaluate(It,ut);return pr},$e.reduce=(cr,pr)=>{ut.properties=pr;for(const Jr of Nt)It.accumulated=cr[Jr],cr[Jr]=pt[Jr].evaluate(It,ut)},$e}(ee)).load((yield this._pendingData).features):(Se=yield this._pendingData,new _n(Se,ee.geojsonVtOptions)),this.loaded={};const Oe={};if(ue){const $e=ue.finish();$e&&(Oe.resourceTiming={},Oe.resourceTiming[ee.source]=JSON.parse(JSON.stringify($e)))}return Oe}catch(Oe){if(delete this._pendingRequest,E.bB(Oe))return{abandoned:!0};throw Oe}var Se})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const Q=this.loaded;return Q&&Q[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,Q){return E._(this,void 0,void 0,function*(){let ue=yield this.loadGeoJSON(ee,Q);if(delete this._pendingRequest,typeof ue!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(J(ue,!0),ee.filter){const Se=E.bC(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Se.result==="error")throw new Error(Se.value.map($e=>`${$e.key}: ${$e.message}`).join(", "));ue={type:"FeatureCollection",features:ue.features.filter($e=>Se.value.evaluate({zoom:0},$e))}}return ue})}loadGeoJSON(ee,Q){return E._(this,void 0,void 0,function*(){const{promoteId:ue}=ee;if(ee.request){const Se=yield E.h(ee.request,Q);return this._dataUpdateable=An(Se.data,ue)?wi(Se.data,ue):void 0,Se.data}if(typeof ee.data=="string")try{const Se=JSON.parse(ee.data);return this._dataUpdateable=An(Se,ue)?wi(Se,ue):void 0,Se}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(Se,Oe,$e){var Ke,Le,pt,It;if(Oe.removeAll&&Se.clear(),Oe.remove)for(const ut of Oe.remove)Se.delete(ut);if(Oe.add)for(const ut of Oe.add){const Nt=Ir(ut,$e);Nt!=null&&Se.set(Nt,ut)}if(Oe.update)for(const ut of Oe.update){let Nt=Se.get(ut.id);if(Nt==null)continue;const cr=!ut.removeAllProperties&&(((Ke=ut.removeProperties)===null||Ke===void 0?void 0:Ke.length)>0||((Le=ut.addOrUpdateProperties)===null||Le===void 0?void 0:Le.length)>0);if((ut.newGeometry||ut.removeAllProperties||cr)&&(Nt=Object.assign({},Nt),Se.set(ut.id,Nt),cr&&(Nt.properties=Object.assign({},Nt.properties))),ut.newGeometry&&(Nt.geometry=ut.newGeometry),ut.removeAllProperties)Nt.properties={};else if(((pt=ut.removeProperties)===null||pt===void 0?void 0:pt.length)>0)for(const pr of ut.removeProperties)Object.prototype.hasOwnProperty.call(Nt.properties,pr)&&delete Nt.properties[pr];if(((It=ut.addOrUpdateProperties)===null||It===void 0?void 0:It.length)>0)for(const{key:pr,value:Jr}of ut.addOrUpdateProperties)Nt.properties[pr]=Jr}}(this._dataUpdateable,ee.dataDiff,ue),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class Nr{constructor(ee){this.self=ee,this.actor=new E.F(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Q,ue)=>{if(this.externalWorkerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.externalWorkerSourceTypes[Q]=ue},this.self.addProtocol=E.bi,this.self.removeProtocol=E.bj,this.self.registerRTLTextPlugin=Q=>{if(E.bD.isParsed())throw new Error("RTL text plugin already registered.");E.bD.setMethods(Q)},this.actor.registerMessageHandler("LDT",(Q,ue)=>this._getDEMWorkerSource(Q,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RDT",(Q,ue)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Q,ue.source).removeTile(ue)})),this.actor.registerMessageHandler("GCEZ",(Q,ue)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterExpansionZoom(ue)})),this.actor.registerMessageHandler("GCC",(Q,ue)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterChildren(ue)})),this.actor.registerMessageHandler("GCL",(Q,ue)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,ue.type,ue.source).getClusterLeaves(ue)})),this.actor.registerMessageHandler("LD",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).loadData(ue)),this.actor.registerMessageHandler("GD",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).getData()),this.actor.registerMessageHandler("LT",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).loadTile(ue)),this.actor.registerMessageHandler("RT",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).reloadTile(ue)),this.actor.registerMessageHandler("AT",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).abortTile(ue)),this.actor.registerMessageHandler("RMT",(Q,ue)=>this._getWorkerSource(Q,ue.type,ue.source).removeTile(ue)),this.actor.registerMessageHandler("RS",(Q,ue)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[Q]||!this.workerSources[Q][ue.type]||!this.workerSources[Q][ue.type][ue.source])return;const Se=this.workerSources[Q][ue.type][ue.source];delete this.workerSources[Q][ue.type][ue.source],Se.removeSource!==void 0&&Se.removeSource(ue)})),this.actor.registerMessageHandler("RM",Q=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q]})),this.actor.registerMessageHandler("SR",(Q,ue)=>E._(this,void 0,void 0,function*(){this.referrer=ue})),this.actor.registerMessageHandler("SRPS",(Q,ue)=>this._syncRTLPluginState(Q,ue)),this.actor.registerMessageHandler("IS",(Q,ue)=>E._(this,void 0,void 0,function*(){this.self.importScripts(ue)})),this.actor.registerMessageHandler("SI",(Q,ue)=>this._setImages(Q,ue)),this.actor.registerMessageHandler("UL",(Q,ue)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(Q).update(ue.layers,ue.removedIds)})),this.actor.registerMessageHandler("SL",(Q,ue)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(Q).replace(ue)}))}_setImages(ee,Q){return E._(this,void 0,void 0,function*(){this.availableImages[ee]=Q;for(const ue in this.workerSources[ee]){const Se=this.workerSources[ee][ue];for(const Oe in Se)Se[Oe].availableImages=Q}})}_syncRTLPluginState(ee,Q){return E._(this,void 0,void 0,function*(){if(E.bD.isParsed())return E.bD.getState();if(Q.pluginStatus!=="loading")return E.bD.setState(Q),Q;const ue=Q.pluginURL;if(this.self.importScripts(ue),E.bD.isParsed()){const Se={pluginStatus:"loaded",pluginURL:ue};return E.bD.setState(Se),Se}throw E.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ue}`)})}_getAvailableImages(ee){let Q=this.availableImages[ee];return Q||(Q=[]),Q}_getLayerIndex(ee){let Q=this.layerIndexes[ee];return Q||(Q=this.layerIndexes[ee]=new u),Q}_getWorkerSource(ee,Q,ue){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][Q]||(this.workerSources[ee][Q]={}),!this.workerSources[ee][Q][ue]){const Se={sendAsync:(Oe,$e)=>(Oe.targetMapId=ee,this.actor.sendAsync(Oe,$e))};switch(Q){case"vector":this.workerSources[ee][Q][ue]=new j(Se,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][Q][ue]=new Xn(Se,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][Q][ue]=new this.externalWorkerSourceTypes[Q](Se,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][Q][ue]}_getDEMWorkerSource(ee,Q){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][Q]||(this.demWorkerSources[ee][Q]=new N),this.demWorkerSources[ee][Q]}}return E.i(self)&&(self.worker=new Nr(self)),Nr}),I("index",["exports","./shared"],function(E,u){var B="4.7.1";let U,K;const j={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((e,s)=>{const c=requestAnimationFrame(e);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),s(u.c())})}),getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,s.drawImage(g,0,0,g.width,g.height),s},resolveURL:g=>(U||(U=document.createElement("a")),U.href=g,U.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(K==null&&(K=matchMedia("(prefers-reduced-motion: reduce)")),K.matches)}};class N{static testProp(e){if(!N.docStyle)return e[0];for(let s=0;s<e.length;s++)if(e[s]in N.docStyle)return e[s];return e[0]}static create(e,s,c){const h=window.document.createElement(e);return s!==void 0&&(h.className=s),c&&c.appendChild(h),h}static createNS(e,s){return window.document.createElementNS(e,s)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(e,s){e.style[N.transformProp]=s}static addEventListener(e,s,c,h={}){e.addEventListener(s,c,"passive"in h?h:h.capture)}static removeEventListener(e,s,c,h={}){e.removeEventListener(s,c,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",N.suppressClickInternal,!0)},0)}static getScale(e){const s=e.getBoundingClientRect();return{x:s.width/e.offsetWidth||1,y:s.height/e.offsetHeight||1,boundingClientRect:s}}static getPoint(e,s,c){const h=s.boundingClientRect;return new u.P((c.clientX-h.left)/s.x-e.clientLeft,(c.clientY-h.top)/s.y-e.clientTop)}static mousePos(e,s){const c=N.getScale(e);return N.getPoint(e,c,s)}static touchPos(e,s){const c=[],h=N.getScale(e);for(let m=0;m<s.length;m++)c.push(N.getPoint(e,h,s[m]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const q={supported:!1,testSupport:function(g){!ae&&J&&(re?pe(g):se=g)}};let se,J,ae=!1,re=!1;function pe(g){const e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,J),g.isContextLost())return;q.supported=!0}catch{}g.deleteTexture(e),ae=!0}var ge;typeof document<"u"&&(J=document.createElement("img"),J.onload=()=>{se&&pe(se),se=null,re=!0},J.onerror=()=>{ae=!0,se=null},J.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,s,c,h;g.resetRequestQueue=()=>{e=[],s=0,c=0,h={}},g.addThrottleControl=A=>{const F=c++;return h[F]=A,F},g.removeThrottleControl=A=>{delete h[A],S()},g.getImage=(A,F,H=!0)=>new Promise(($,ne)=>{q.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),u.e(A,{type:"image"}),e.push({abortController:F,requestParameters:A,supportImageRefresh:H,state:"queued",onError:de=>{ne(de)},onSuccess:de=>{$(de)}}),S()});const m=A=>u._(this,void 0,void 0,function*(){A.state="running";const{requestParameters:F,supportImageRefresh:H,onError:$,onSuccess:ne,abortController:de}=A,me=H===!1&&!u.i(self)&&!u.g(F.url)&&(!F.headers||Object.keys(F.headers).reduce((ze,Be)=>ze&&Be==="accept",!0));s++;const be=me?k(F,de):u.m(F,de);try{const ze=yield be;delete A.abortController,A.state="completed",ze.data instanceof HTMLImageElement||u.b(ze.data)?ne(ze):ze.data&&ne({data:yield(Ie=ze.data,typeof createImageBitmap=="function"?u.d(Ie):u.f(Ie)),cacheControl:ze.cacheControl,expires:ze.expires})}catch(ze){delete A.abortController,$(ze)}finally{s--,S()}var Ie}),S=()=>{const A=(()=>{for(const F of Object.keys(h))if(h[F]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let F=s;F<A&&e.length>0;F++){const H=e.shift();H.abortController.signal.aborted?F--:m(H)}},k=(A,F)=>new Promise((H,$)=>{const ne=new Image,de=A.url,me=A.credentials;me&&me==="include"?ne.crossOrigin="use-credentials":(me&&me==="same-origin"||!u.s(de))&&(ne.crossOrigin="anonymous"),F.signal.addEventListener("abort",()=>{ne.src="",$(u.c())}),ne.fetchPriority="high",ne.onload=()=>{ne.onerror=ne.onload=null,H({data:ne})},ne.onerror=()=>{ne.onerror=ne.onload=null,F.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ne.src=de})}(ge||(ge={})),ge.resetRequestQueue();class Fe{constructor(e){this._transformRequestFn=e}transformRequest(e,s){return this._transformRequestFn&&this._transformRequestFn(e,s)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ve(g){var e=new u.A(3);return e[0]=g[0],e[1]=g[1],e[2]=g[2],e}var qe,je=function(g,e,s){return g[0]=e[0]-s[0],g[1]=e[1]-s[1],g[2]=e[2]-s[2],g};qe=new u.A(3),u.A!=Float32Array&&(qe[0]=0,qe[1]=0,qe[2]=0);var St=function(g){var e=g[0],s=g[1];return e*e+s*s};function ot(g){const e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:c,url:h}of g){const m=`${c}${h}`;s.indexOf(m)===-1&&(s.push(m),e.push({id:c,url:h}))}}return e}function At(g,e,s){const c=g.split("?");return c[0]+=`${e}${s}`,c.join("?")}(function(){var g=new u.A(2);u.A!=Float32Array&&(g[0]=0,g[1]=0)})();class xt{constructor(e,s,c,h){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(s,h)}update(e,s,c){const{width:h,height:m}=e,S=!(this.size&&this.size[0]===h&&this.size[1]===m||c),{context:k}=this,{gl:A}=k;if(this.useMipmap=!!(s&&s.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!s||s.premultiply!==!1)),S)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,e):A.texImage2D(A.TEXTURE_2D,0,this.format,h,m,0,this.format,A.UNSIGNED_BYTE,e.data);else{const{x:F,y:H}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?A.texSubImage2D(A.TEXTURE_2D,0,F,H,A.RGBA,A.UNSIGNED_BYTE,e):A.texSubImage2D(A.TEXTURE_2D,0,F,H,h,m,A.RGBA,A.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)}bind(e,s,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||e),this.filter=e),s!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function xe(g){const{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class Je extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:s,promiseResolve:c}of this.requestors)c(this._getImagesForIds(s));this.requestors=[]}}getImage(e){const s=this.images[e];if(s&&!s.data&&s.spriteData){const c=s.spriteData;s.data=new u.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),s.spriteData=null}return s}addImage(e,s){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,s)&&(this.images[e]=s)}_validate(e,s){let c=!0;const h=s.data||s.spriteData;return this._validateStretch(s.stretchX,h&&h.width)||(this.fire(new u.j(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,h&&h.height)||(this.fire(new u.j(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new u.j(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,s){if(!e)return!0;let c=0;for(const h of e){if(h[0]<c||h[1]<h[0]||s<h[1])return!1;c=h[1]}return!0}_validateContent(e,s){if(!e)return!0;if(e.length!==4)return!1;const c=s.spriteData,h=c&&c.width||s.data.width,m=c&&c.height||s.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,s,c=!0){const h=this.getImage(e);if(c&&(h.data.width!==s.data.width||h.data.height!==s.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=h.version+1,this.images[e]=s,this.updatedImages[e]=!0}removeImage(e){const s=this.images[e];delete this.images[e],delete this.patterns[e],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((s,c)=>{let h=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(h=!1);this.isLoaded()||h?s(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:s})})}_getImagesForIds(e){const s={};for(const c of e){let h=this.getImage(c);h||(this.fire(new u.k("styleimagemissing",{id:c})),h=this.getImage(c)),h?s[c]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:u.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:e,height:s}=this.atlasImage;return{width:e,height:s}}getPattern(e){const s=this.patterns[e],c=this.getImage(e);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const h={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new u.I(h,c);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const s=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new xt(e,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:s,h:c}=u.p(e),h=this.atlasImage;h.resize({width:s||1,height:c||1});for(const m in this.patterns){const{bin:S}=this.patterns[m],k=S.x+1,A=S.y+1,F=this.getImage(m).data,H=F.width,$=F.height;u.R.copy(F,h,{x:0,y:0},{x:k,y:A},{width:H,height:$}),u.R.copy(F,h,{x:0,y:$-1},{x:k,y:A-1},{width:H,height:1}),u.R.copy(F,h,{x:0,y:0},{x:k,y:A+$},{width:H,height:1}),u.R.copy(F,h,{x:H-1,y:0},{x:k-1,y:A},{width:1,height:$}),u.R.copy(F,h,{x:0,y:0},{x:k+H,y:A},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const s of e){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.getImage(s);c||u.w(`Image with ID: "${s}" was not found`),xe(c)&&this.updateImage(s,c)}}}const G=1e20;function Ve(g,e,s,c,h,m,S,k,A){for(let F=e;F<e+c;F++)Rt(g,s*m+F,m,h,S,k,A);for(let F=s;F<s+h;F++)Rt(g,F*m+e,1,c,S,k,A)}function Rt(g,e,s,c,h,m,S){m[0]=0,S[0]=-1e20,S[1]=G,h[0]=g[e];for(let k=1,A=0,F=0;k<c;k++){h[k]=g[e+k*s];const H=k*k;do{const $=m[A];F=(h[k]-h[$]+H-$*$)/(k-$)/2}while(F<=S[A]&&--A>-1);A++,m[A]=k,S[A]=F,S[A+1]=G}for(let k=0,A=0;k<c;k++){for(;S[A+1]<k;)A++;const F=m[A],H=k-F;g[e+k*s]=h[F]+H*H}}class Ae{constructor(e,s){this.requestManager=e,this.localIdeographFontFamily=s,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return u._(this,void 0,void 0,function*(){const s=[];for(const m in e)for(const S of e[m])s.push(this._getAndCacheGlyphsPromise(m,S));const c=yield Promise.all(s),h={};for(const{stack:m,id:S,glyph:k}of c)h[m]||(h[m]={}),h[m][S]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return h})}_getAndCacheGlyphsPromise(e,s){return u._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=c.glyphs[s];if(h!==void 0)return{stack:e,id:s,glyph:h};if(h=this._tinySDF(c,e,s),h)return c.glyphs[s]=h,{stack:e,id:s,glyph:h};const m=Math.floor(s/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[m])return{stack:e,id:s,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[m]){const k=Ae.loadGlyphRange(e,m,this.url,this.requestManager);c.requests[m]=k}const S=yield c.requests[m];for(const k in S)this._doesCharSupportLocalGlyph(+k)||(c.glyphs[+k]=S[+k]);return c.ranges[m]=!0,{stack:e,id:s,glyph:S[s]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,s,c){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let m=e.tinySDF;if(!m){let k="400";/bold/i.test(s)?k="900":/medium/i.test(s)?k="500":/light/i.test(s)&&(k="200"),m=e.tinySDF=new Ae.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:k})}const S=m.draw(String.fromCharCode(c));return{id:c,bitmap:new u.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ae.loadGlyphRange=function(g,e,s,c){return u._(this,void 0,void 0,function*(){const h=256*e,m=h+255,S=c.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${h}-${m}`),"Glyphs"),k=yield u.l(S,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);const A={};for(const F of u.n(k.data))A[F.id]=F;return A})},Ae.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:s=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=s;const k=this.size=g+4*e,A=this._createCanvas(k),F=this.ctx=A.getContext("2d",{willReadFrequently:!0});F.font=`${S} ${m} ${g}px ${h}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(g){const e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(g),S=Math.ceil(s),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),A=Math.min(this.size-this.buffer,S+Math.ceil(c)),F=k+2*this.buffer,H=A+2*this.buffer,$=Math.max(F*H,0),ne=new Uint8ClampedArray($),de={data:ne,width:F,height:H,glyphWidth:k,glyphHeight:A,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(k===0||A===0)return de;const{ctx:me,buffer:be,gridInner:Ie,gridOuter:ze}=this;me.clearRect(be,be,k,A),me.fillText(g,be,be+S);const Be=me.getImageData(be,be,k,A);ze.fill(G,0,$),Ie.fill(0,0,$);for(let ke=0;ke<A;ke++)for(let Ge=0;Ge<k;Ge++){const Xe=Be.data[4*(ke*k+Ge)+3]/255;if(Xe===0)continue;const it=(ke+be)*F+Ge+be;if(Xe===1)ze[it]=0,Ie[it]=G;else{const kt=.5-Xe;ze[it]=kt>0?kt*kt:0,Ie[it]=kt<0?kt*kt:0}}Ve(ze,0,0,F,H,F,this.f,this.v,this.z),Ve(Ie,be,be,k,A,F,this.f,this.v,this.z);for(let ke=0;ke<$;ke++){const Ge=Math.sqrt(ze[ke])-Math.sqrt(Ie[ke]);ne[ke]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return de}};class et{constructor(){this.specification=u.v.light.position}possiblyEvaluate(e,s){return u.x(e.expression.evaluate(s))}interpolate(e,s,c){return{x:u.y.number(e.x,s.x,c),y:u.y.number(e.y,s.y,c),z:u.y.number(e.z,s.z,c)}}}let Ze;class ht extends u.E{constructor(e){super(),Ze=Ze||new u.q({anchor:new u.D(u.v.light.anchor),position:new et,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(Ze),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,s={}){if(!this._validate(u.r,e,s))for(const c in e){const h=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,c){return(!c||c.validate!==!1)&&u.t(this,e.call(u.u,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const oe=new u.q({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class _e extends u.E{constructor(e){super(),this._transitionable=new u.T(oe),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.z(0))}setSky(e,s={}){if(!this._validate(u.B,e,s)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const h=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,s,c={}){return(c==null?void 0:c.validate)!==!1&&u.t(this,e.call(u.u,u.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Ct{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,s){const c=e.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,s)),this.dashEntry[c]}getDashRanges(e,s,c){const h=[];let m=e.length%2==1?-e[e.length-1]*c:0,S=e[0]*c,k=!0;h.push({left:m,right:S,isDash:k,zeroLength:e[0]===0});let A=e[0];for(let F=1;F<e.length;F++){k=!k;const H=e[F];m=A*c,A+=H,S=A*c,h.push({left:m,right:S,isDash:k,zeroLength:H===0})}return h}addRoundDash(e,s,c){const h=s/2;for(let m=-c;m<=c;m++){const S=this.width*(this.nextRow+c+m);let k=0,A=e[k];for(let F=0;F<this.width;F++){F/A.right>1&&(A=e[++k]);const H=Math.abs(F-A.left),$=Math.abs(F-A.right),ne=Math.min(H,$);let de;const me=m/c*(h+1);if(A.isDash){const be=h-Math.abs(me);de=Math.sqrt(ne*ne+be*be)}else de=h-Math.sqrt(ne*ne+me*me);this.data[S+F]=Math.max(0,Math.min(255,de+128))}}}addRegularDash(e){for(let k=e.length-1;k>=0;--k){const A=e[k],F=e[k+1];A.zeroLength?e.splice(k,1):F&&F.isDash===A.isDash&&(F.left=A.left,e.splice(k,1))}const s=e[0],c=e[e.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const h=this.width*this.nextRow;let m=0,S=e[m];for(let k=0;k<this.width;k++){k/S.right>1&&(S=e[++m]);const A=Math.abs(k-S.left),F=Math.abs(k-S.right),H=Math.min(A,F);this.data[h+k]=Math.max(0,Math.min(255,(S.isDash?H:-H)+128))}}addDash(e,s){const c=s?7:0,h=2*c+1;if(this.nextRow+h>this.height)return u.w("LineAtlas out of space"),null;let m=0;for(let k=0;k<e.length;k++)m+=e[k];if(m!==0){const k=this.width/m,A=this.getDashRanges(e,this.width,k);s?this.addRoundDash(A,k,c):this.addRegularDash(A)}const S={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=h,this.dirty=!0,S}bind(e){const s=e.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const bt="maplibre_preloaded_worker_pool";class wt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<wt.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[bt]}numActive(){return Object.keys(this.active).length}}const ar=Math.floor(j.hardwareConcurrency/2);let fr,qt;function Kt(){return fr||(fr=new wt),fr}wt.workerCount=u.C(globalThis)?Math.max(Math.min(ar,3),1):1;class Cr{constructor(e,s){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=s;const c=this.workerPool.acquire(s);for(let h=0;h<c.length;h++){const m=new u.F(c[h],s);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,s){const c=[];for(const h of this.actors)c.push(h.sendAsync({type:e,data:s}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,s){for(const c of this.actors)c.registerMessageHandler(e,s)}}function Br(){return qt||(qt=new Cr(Kt(),u.G),qt.registerMessageHandler("GR",(g,e,s)=>u.m(e,s))),qt}function Yr(g,e){const s=u.H();return u.J(s,s,[1,1,0]),u.K(s,s,[.5*g.width,.5*g.height,1]),u.L(s,s,g.calculatePosMatrix(e.toUnwrapped()))}function Zr(g,e,s,c,h,m){const S=function($,ne,de){if($)for(const me of $){const be=ne[me];if(be&&be.source===de&&be.type==="fill-extrusion")return!0}else for(const me in ne){const be=ne[me];if(be.source===de&&be.type==="fill-extrusion")return!0}return!1}(h&&h.layers,e,g.id),k=m.maxPitchScaleFactor(),A=g.tilesIn(c,k,S);A.sort(W);const F=[];for(const $ of A)F.push({wrappedTileID:$.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(e,s,g._state,$.queryGeometry,$.cameraQueryGeometry,$.scale,h,m,k,Yr(g.transform,$.tileID))});const H=function($){const ne={},de={};for(const me of $){const be=me.queryResults,Ie=me.wrappedTileID,ze=de[Ie]=de[Ie]||{};for(const Be in be){const ke=be[Be],Ge=ze[Be]=ze[Be]||{},Xe=ne[Be]=ne[Be]||[];for(const it of ke)Ge[it.featureIndex]||(Ge[it.featureIndex]=!0,Xe.push(it))}}return ne}(F);for(const $ in H)H[$].forEach(ne=>{const de=ne.feature,me=g.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=me});return H}function W(g,e){const s=g.tileID,c=e.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}function ft(g,e,s){return u._(this,void 0,void 0,function*(){let c=g;if(g.url?c=(yield u.h(e.transformRequest(g.url,"Source"),s)).data:yield j.frameAsync(s),!c)return null;const h=u.M(u.e(c,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(h.vectorLayerIds=c.vector_layers.map(m=>m.id)),h})}class ye{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof u.N?new u.N(e.lng,e.lat):u.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof u.N?new u.N(e.lng,e.lat):u.N.convert(e),this}extend(e){const s=this._sw,c=this._ne;let h,m;if(e instanceof u.N)h=e,m=e;else{if(!(e instanceof ye))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ye.convert(e)):this.extend(u.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(u.N.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return s||c?(s.lng=Math.min(h.lng,s.lng),s.lat=Math.min(h.lat,s.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new u.N(h.lng,h.lat),this._ne=new u.N(m.lng,m.lat)),this}getCenter(){return new u.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.N(this.getWest(),this.getNorth())}getSouthEast(){return new u.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:c}=u.N.convert(e);let h=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(e){return e instanceof ye?e:e&&new ye(e)}static fromLngLat(e,s=0){const c=360*s/40075017,h=c/Math.cos(Math.PI/180*e.lat);return new ye(new u.N(e.lng-h,e.lat-c),new u.N(e.lng+h,e.lat+c))}adjustAntiMeridian(){const e=new u.N(this._sw.lng,this._sw.lat),s=new u.N(this._ne.lng,this._ne.lat);return new ye(e,e.lng>s.lng?new u.N(s.lng+360,s.lat):s)}}class Me{constructor(e,s,c){this.bounds=ye.convert(this.validateBounds(e)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const s=Math.pow(2,e.z),c=Math.floor(u.O(this.bounds.getWest())*s),h=Math.floor(u.Q(this.bounds.getNorth())*s),m=Math.ceil(u.O(this.bounds.getEast())*s),S=Math.ceil(u.Q(this.bounds.getSouth())*s);return e.x>=c&&e.x<m&&e.y>=h&&e.y<S}}class we extends u.E{constructor(e,s,c,h){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.M(s,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ft(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(u.e(this,e),e.bounds&&(this.tileBounds=new Me(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new u.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(e){return u._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(s,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,S)=>{e.reloadPromise={resolve:m,reject:S}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:h,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,s){if(s&&s.resourceTiming&&(e.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&e.setExpiryData(s),e.loadVectorData(s,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ne extends u.E{constructor(e,s,c,h){super(),this.id=e,this.dispatcher=c,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},s),u.e(this,u.M(s,["url","scheme","tileSize"]))}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ft(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(u.e(this,e),e.bounds&&(this.tileBounds=new Me(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new u.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return u.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return u._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield ge.getImage(this.map._requestManager.transformRequest(s,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const h=this.map.painter.context,m=h.gl,S=c.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new xt(h,S,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class _t extends Ne{constructor(e,s,c,h){super(e,s,c,h),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(e){return u._(this,void 0,void 0,function*(){const s=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(s,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield ge.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const S=u.b(m)&&u.U()?m:yield this.readImageNow(m),k={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const A=yield e.actor.sendAsync({type:"LDT",data:k});e.dem=A,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.V()){const s=e.width+2,c=e.height+2;try{return new u.R({width:s,height:c},yield u.W(e,-1,-1,s,c))}catch{}}return j.getImageData(e,1)})}_getNeighboringTiles(e){const s=e.canonical,c=Math.pow(2,s.z),h=(s.x-1+c)%c,m=s.x===0?e.wrap-1:e.wrap,S=(s.x+1+c)%c,k=s.x+1===c?e.wrap+1:e.wrap,A={};return A[new u.S(e.overscaledZ,m,s.z,h,s.y).key]={backfilled:!1},A[new u.S(e.overscaledZ,k,s.z,S,s.y).key]={backfilled:!1},s.y>0&&(A[new u.S(e.overscaledZ,m,s.z,h,s.y-1).key]={backfilled:!1},A[new u.S(e.overscaledZ,e.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},A[new u.S(e.overscaledZ,k,s.z,S,s.y-1).key]={backfilled:!1}),s.y+1<c&&(A[new u.S(e.overscaledZ,m,s.z,h,s.y+1).key]={backfilled:!1},A[new u.S(e.overscaledZ,e.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},A[new u.S(e.overscaledZ,k,s.z,S,s.y+1).key]={backfilled:!1}),A}unloadTile(e){return u._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Mt extends u.E{constructor(e,s,c,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(h),this._data=s.data,this._options=u.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const m=u.X/this.tileSize;s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*m,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*m,extent:u.X,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:u.X,radius:(s.clusterRadius||50)*m,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return u._(this,void 0,void 0,function*(){const e=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,s,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:s,offset:c}})}_updateWorkerData(e){return u._(this,void 0,void 0,function*(){const s=u.e({type:this.type},this.workerOptions);e?s.dataDiff=e:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(j.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let h=null;c.resourceTiming&&c.resourceTiming[this.id]&&(h=c.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&u.e(m,{resourceTiming:h}),this.fire(new u.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new u.k("dataabort",{dataType:"source"}));this.fire(new u.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return u._(this,void 0,void 0,function*(){const s=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:s,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,s==="RT")})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var nt=u.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class zt extends u.E{constructor(e,s,c,h){super(),this.id=e,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=s}load(e){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield ge.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,e&&(this.coordinates=e),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new u.j(s))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const s=e.map(u.Z.fromLngLat);this.tileID=function(h){let m=1/0,S=1/0,k=-1/0,A=-1/0;for(const ne of h)m=Math.min(m,ne.x),S=Math.min(S,ne.y),k=Math.max(k,ne.x),A=Math.max(A,ne.y);const F=Math.max(k-m,A-S),H=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),$=Math.pow(2,H);return new u.a1(H,Math.floor((m+k)/2*$),Math.floor((S+A)/2*$))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new u.$,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.X,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.X),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.X,u.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new xt(e,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class rr extends zt{constructor(e,s,c,h){super(e,s,c,h),this.roundZoom=!0,this.type="video",this.options=s}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const s of e.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield u.a3(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new u.j(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const s=this.video.seekable;e<s.start(0)||e>s.end(0)?this.fire(new u.j(new u.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,s=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new xt(e,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Lt extends zt{constructor(e,s,c,h){super(e,s,c,h),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(S=>typeof S!="number"))||this.fire(new u.j(new u.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.a2(`sources.${e}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new u.j(new u.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,nt.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xt(s,this.canvas,c.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const S=this.tiles[m];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,h=!0)}h&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const _r={},en=g=>{switch(g){case"geojson":return Mt;case"image":return zt;case"raster":return Ne;case"raster-dem":return _t;case"vector":return we;case"video":return rr;case"canvas":return Lt}return _r[g]},vt="RTLPluginLoaded";class xn extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Br()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return u._(this,arguments,void 0,function*(s,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.k(vt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let yn=null;function wn(){return yn||(yn=new xn),yn}class ui{constructor(e,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=u.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const S={};if(!m)return S;for(const k of h){const A=k.layerIds.map(F=>m.getLayer(F)).filter(Boolean);if(A.length!==0){k.layers=A,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(F=>A.filter(H=>H.id===F)[0]));for(const F of A)S[F.id]=k}}return S}(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a6&&m.hasRTLText){this.hasRTLText=!0,wn().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const h=this.buckets[c];h.uploadPending()&&h.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xt(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xt(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,c,h,m,S,k,A,F,H){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:S,tileSize:this.tileSize,pixelPosMatrix:H,transform:A,params:k,queryPadding:this.queryPadding*F},e,s,c):{}}querySourceFeatures(e,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),m=s&&s.sourceLayer?s.sourceLayer:"",S=h._geojsonTileLayer||h[m];if(!S)return;const k=u.a7(s&&s.filter),{z:A,x:F,y:H}=this.tileID.canonical,$={z:A,x:F,y:H};for(let ne=0;ne<S.length;ne++){const de=S.feature(ne);if(k.needGeometry){const Ie=u.a8(de,!0);if(!k.filter(new u.z(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!k.filter(new u.z(this.tileID.overscaledZ),de))continue;const me=c.getId(de,m),be=new u.a9(de,A,F,H,me);be.tile=$,e.push(be)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const c=u.aa(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(s)if(this.expirationTime<s)h=!0;else{const m=this.expirationTime-s;m?this.expirationTime=c+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!s.style.hasLayer(h))continue;const m=this.buckets[h],S=m.layers[0].sourceLayer||"_geojsonTileLayer",k=c[S],A=e[S];if(!k||!A||Object.keys(A).length===0)continue;m.update(A,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const F=s&&s.style&&s.style.getLayer(h);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=j.now()+e}setDependencies(e,s){const c={};for(const h of s)c[h]=!0;this.dependencies[e]=c}hasDependency(e,s){for(const c of e){const h=this.dependencies[c];if(h){for(const m of s)if(h[m])return!0}}return!1}}class Pt{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,c){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:s,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},c)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const c=e.wrapped().key,h=s===void 0?0:this.data[c].indexOf(s),m=this.data[c][h];return this.data[c].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const c in this.data)for(const h of this.data[c])e(h.value)||s.push(h);for(const c of s)this.remove(c.value.tileID,c)}}class zr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,c){const h=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},u.e(this.stateChanges[e][h],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])c[m]||(this.deletedStates[e][h][m]=null)}else for(const m in c)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,s,c){if(this.deletedStates[e]===null)return;const h=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&s!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][c]=null);else if(s!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(c in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][c]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,s){const c=String(s),h=u.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][s];if(m===null)return{};for(const S in m)delete h[S]}return h}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const S in this.stateChanges[h])this.state[h][S]||(this.state[h][S]={}),u.e(this.state[h][S],this.stateChanges[h][S]),m[S]=this.state[h][S];c[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const S in this.state[h])m[S]={},this.state[h][S]={};else for(const S in this.deletedStates[h]){if(this.deletedStates[h][S]===null)this.state[h][S]={};else for(const k of Object.keys(this.deletedStates[h][S]))delete this.state[h][S][k];m[S]=this.state[h][S]}c[h]=c[h]||{},u.e(c[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const h in e)e[h].setFeatureState(c,s)}}class wr extends u.E{constructor(e,s,c){super(),this.id=e,this.dispatcher=c,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,S,k)=>{const A=new(en(m.type))(h,m,S,k);if(A.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${A.id}`);return A})(e,s,c,this),this._tiles={},this._cache=new Pt(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new zr,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const s=this._tiles[e];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,s,c){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,s,c)}catch(h){e.state="errored",h.status!==404?this._source.fire(new u.j(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new u.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(_n).map(e=>e.key)}getRenderableIds(e){const s=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&s.push(this._tiles[c]);return e?s.sort((c,h)=>{const m=c.tileID,S=h.tileID,k=new u.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),A=new u.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-S.overscaledZ||A.y-k.y||A.x-k.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(_n).map(c=>c.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,s){return u._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=s),yield this._loadTile(c,e,s))})}_tileLoaded(e,s,c){e.timeAdded=j.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const s=this.getRenderableIds();for(let h=0;h<s.length;h++){const m=s[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const S=this.getTileByID(m);c(e,S),c(S,e)}}function c(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let S=m.tileID.canonical.x-h.tileID.canonical.x;const k=m.tileID.canonical.y-h.tileID.canonical.y,A=Math.pow(2,h.tileID.canonical.z),F=m.tileID.key;S===0&&k===0||Math.abs(k)>1||(Math.abs(S)>1&&(Math.abs(S+A)===1?S+=A:Math.abs(S-A)===1&&(S-=A)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,S,k),h.neighboringTiles&&h.neighboringTiles[F]&&(h.neighboringTiles[F].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,c,h){for(const m in this._tiles){let S=this._tiles[m];if(h[m]||!S.hasData()||S.tileID.overscaledZ<=s||S.tileID.overscaledZ>c)continue;let k=S.tileID;for(;S&&S.tileID.overscaledZ>s+1;){const F=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[F.key],S&&S.hasData()&&(k=F)}let A=k;for(;A.overscaledZ>s;)if(A=A.scaledTo(A.overscaledZ-1),e[A.key]){h[k.key]=k;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=e.overscaledZ-1;c>=s;c--){const h=e.scaledTo(c),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const s=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(s*c*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const s=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,s){const c={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),c[m.tileID.key]=m}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,s,c,h,m,S){const k={},A={},F=Object.keys(e),H=j.now();for(const $ of F){const ne=e[$],de=this._tiles[$];if(!de||de.fadeEndTime!==0&&de.fadeEndTime<=H)continue;const me=this.findLoadedParent(ne,s),be=this.findLoadedSibling(ne),Ie=me||be||null;Ie&&(this._addTile(Ie.tileID),k[Ie.tileID.key]=Ie.tileID),A[$]=ne}this._retainLoadedChildren(A,h,c,e);for(const $ in k)e[$]||(this._coveredTiles[$]=!0,e[$]=k[$]);if(S){const $={},ne={};for(const de of m)this._tiles[de.key].hasData()?$[de.key]=de:ne[de.key]=de;for(const de in ne){const me=ne[de].children(this._source.maxzoom);this._tiles[me[0].key]&&this._tiles[me[1].key]&&this._tiles[me[2].key]&&this._tiles[me[3].key]&&($[me[0].key]=e[me[0].key]=me[0],$[me[1].key]=e[me[1].key]=me[1],$[me[2].key]=e[me[2].key]=me[2],$[me[3].key]=e[me[3].key]=me[3],delete ne[de])}for(const de in ne){const me=ne[de],be=this.findLoadedParent(me,this._source.minzoom),Ie=this.findLoadedSibling(me),ze=be||Ie||null;if(ze){$[ze.tileID.key]=e[ze.tileID.key]=ze.tileID;for(const Be in $)$[Be].isChildOf(ze.tileID)&&delete $[Be]}}for(const de in this._tiles)$[de]||(this._coveredTiles[de]=!0)}}update(e,s){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=s,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new u.S(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y)):(c=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(H=>this._source.hasTile(H)))):c=[];const h=e.coveringZoomLevel(this._source),m=Math.max(h-wr.maxOverzooming,this._source.minzoom),S=Math.max(h+wr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const H={};for(const $ of c)if($.canonical.z>this._source.minzoom){const ne=$.scaledTo($.canonical.z-1);H[ne.key]=ne;const de=$.scaledTo(Math.max(this._source.minzoom,Math.min($.canonical.z,5)));H[de.key]=de}c=c.concat(Object.values(H))}const k=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const A=this._updateRetainedTiles(c,h);ci(this._source.type)&&this._updateCoveredAndRetainedTiles(A,m,S,h,c,s);for(const H in A)this._tiles[H].clearFadeHold();const F=u.ab(this._tiles,A);for(const H of F){const $=this._tiles[H];$.hasSymbolBuckets&&!$.holdingForFade()?$.setHoldDuration(this.map._fadeDuration):$.hasSymbolBuckets&&!$.symbolFadeFinished()||this._removeTile(H)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,s){var c;const h={},m={},S=Math.max(s-wr.maxOverzooming,this._source.minzoom),k=Math.max(s+wr.maxUnderzooming,this._source.minzoom),A={};for(const F of e){const H=this._addTile(F);h[F.key]=F,H.hasData()||s<this._source.maxzoom&&(A[F.key]=F)}this._retainLoadedChildren(A,s,k,h);for(const F of e){let H=this._tiles[F.key];if(H.hasData())continue;if(s+1>this._source.maxzoom){const ne=F.children(this._source.maxzoom)[0],de=this.getTile(ne);if(de&&de.hasData()){h[ne.key]=ne;continue}}else{const ne=F.children(this._source.maxzoom);if(h[ne[0].key]&&h[ne[1].key]&&h[ne[2].key]&&h[ne[3].key])continue}let $=H.wasRequested();for(let ne=F.overscaledZ-1;ne>=S;--ne){const de=F.scaledTo(ne);if(m[de.key])break;if(m[de.key]=!0,H=this.getTile(de),!H&&$&&(H=this._addTile(de)),H){const me=H.hasData();if((me||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||$)&&(h[de.key]=de),$=H.wasRequested(),me)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let c,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}s.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;h=m}for(const m of s)this._loadedParentTiles[m]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const s=this._tiles[e].tileID,c=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=c}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const c=s;return s||(s=new ui(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(s,e.key,s.state)),s.uses++,this._tiles[e.key]=s,c||this._source.fire(new u.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=s.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(e){const s=e.sourceDataType;e.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&s==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,s,c){const h=[],m=this.transform;if(!m)return h;const S=c?m.getCameraQueryGeometry(e):e,k=e.map(me=>m.pointCoordinate(me,this.terrain)),A=S.map(me=>m.pointCoordinate(me,this.terrain)),F=this.getIds();let H=1/0,$=1/0,ne=-1/0,de=-1/0;for(const me of A)H=Math.min(H,me.x),$=Math.min($,me.y),ne=Math.max(ne,me.x),de=Math.max(de,me.y);for(let me=0;me<F.length;me++){const be=this._tiles[F[me]];if(be.holdingForFade())continue;const Ie=be.tileID,ze=Math.pow(2,m.zoom-be.tileID.overscaledZ),Be=s*be.queryPadding*u.X/be.tileSize/ze,ke=[Ie.getTilePoint(new u.Z(H,$)),Ie.getTilePoint(new u.Z(ne,de))];if(ke[0].x-Be<u.X&&ke[0].y-Be<u.X&&ke[1].x+Be>=0&&ke[1].y+Be>=0){const Ge=k.map(it=>Ie.getTilePoint(it)),Xe=A.map(it=>Ie.getTilePoint(it));h.push({tile:be,tileID:Ie,queryGeometry:Ge,cameraQueryGeometry:Xe,scale:ze})}}return h}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(ci(this._source.type)){const e=j.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=e)return!0}return!1}setFeatureState(e,s,c){this._state.updateState(e=e||"_geojsonTileLayer",s,c)}removeFeatureState(e,s,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,c)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,c){const h=this._tiles[e];h&&h.setDependencies(s,c)}reloadTilesForDependencies(e,s){for(const c in this._tiles)this._tiles[c].hasDependency(e,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,s))}}function _n(g,e){const s=Math.abs(2*g.wrap)-+(g.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||c-s||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function ci(g){return g==="raster"||g==="image"||g==="video"}wr.maxOverzooming=10,wr.maxUnderzooming=3;class Ir{constructor(e,s){this.reset(e,s)}reset(e,s){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=u.ac(e,0,1);let s=1,c=this._distances[s];const h=e*this.paddedLength+this.padding;for(;c<h&&s<this._distances.length;)c=this._distances[++s];const m=s-1,S=this._distances[m],k=c-S,A=k>0?(h-S)/k:0;return this.points[m].mult(1-A).add(this.points[s].mult(A))}}function An(g,e){let s=!0;return g==="always"||g!=="never"&&e!=="never"||(s=!1),s}class wi{constructor(e,s,c){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(s/c);for(let S=0;S<this.xCellCount*this.yCellCount;S++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=s,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,s,c,h,m){this._forEachCell(s,c,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,s,c,h){this._forEachCell(s-h,c-h,s+h,c+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(s),this.circles.push(c),this.circles.push(h)}_insertBoxCell(e,s,c,h,m,S){this.boxCells[m].push(S)}_insertCircleCell(e,s,c,h,m,S){this.circleCells[m].push(S)}_query(e,s,c,h,m,S,k){if(c<0||e>this.width||h<0||s>this.height)return[];const A=[];if(e<=0&&s<=0&&this.width<=c&&this.height<=h){if(m)return[{key:null,x1:e,y1:s,x2:c,y2:h}];for(let F=0;F<this.boxKeys.length;F++)A.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const H=this.circles[3*F],$=this.circles[3*F+1],ne=this.circles[3*F+2];A.push({key:this.circleKeys[F],x1:H-ne,y1:$-ne,x2:H+ne,y2:$+ne})}}else this._forEachCell(e,s,c,h,this._queryCell,A,{hitTest:m,overlapMode:S,seenUids:{box:{},circle:{}}},k);return A}query(e,s,c,h){return this._query(e,s,c,h,!1,null)}hitTest(e,s,c,h,m,S){return this._query(e,s,c,h,!0,m,S).length>0}hitTestCircle(e,s,c,h,m){const S=e-c,k=e+c,A=s-c,F=s+c;if(k<0||S>this.width||F<0||A>this.height)return!1;const H=[];return this._forEachCell(S,A,k,F,this._queryCellCircle,H,{hitTest:!0,overlapMode:h,circle:{x:e,y:s,radius:c},seenUids:{box:{},circle:{}}},m),H.length>0}_queryCell(e,s,c,h,m,S,k,A){const{seenUids:F,hitTest:H,overlapMode:$}=k,ne=this.boxCells[m];if(ne!==null){const me=this.bboxes;for(const be of ne)if(!F.box[be]){F.box[be]=!0;const Ie=4*be,ze=this.boxKeys[be];if(e<=me[Ie+2]&&s<=me[Ie+3]&&c>=me[Ie+0]&&h>=me[Ie+1]&&(!A||A(ze))&&(!H||!An($,ze.overlapMode))&&(S.push({key:ze,x1:me[Ie],y1:me[Ie+1],x2:me[Ie+2],y2:me[Ie+3]}),H))return!0}}const de=this.circleCells[m];if(de!==null){const me=this.circles;for(const be of de)if(!F.circle[be]){F.circle[be]=!0;const Ie=3*be,ze=this.circleKeys[be];if(this._circleAndRectCollide(me[Ie],me[Ie+1],me[Ie+2],e,s,c,h)&&(!A||A(ze))&&(!H||!An($,ze.overlapMode))){const Be=me[Ie],ke=me[Ie+1],Ge=me[Ie+2];if(S.push({key:ze,x1:Be-Ge,y1:ke-Ge,x2:Be+Ge,y2:ke+Ge}),H)return!0}}}return!1}_queryCellCircle(e,s,c,h,m,S,k,A){const{circle:F,seenUids:H,overlapMode:$}=k,ne=this.boxCells[m];if(ne!==null){const me=this.bboxes;for(const be of ne)if(!H.box[be]){H.box[be]=!0;const Ie=4*be,ze=this.boxKeys[be];if(this._circleAndRectCollide(F.x,F.y,F.radius,me[Ie+0],me[Ie+1],me[Ie+2],me[Ie+3])&&(!A||A(ze))&&!An($,ze.overlapMode))return S.push(!0),!0}}const de=this.circleCells[m];if(de!==null){const me=this.circles;for(const be of de)if(!H.circle[be]){H.circle[be]=!0;const Ie=3*be,ze=this.circleKeys[be];if(this._circlesCollide(me[Ie],me[Ie+1],me[Ie+2],F.x,F.y,F.radius)&&(!A||A(ze))&&!An($,ze.overlapMode))return S.push(!0),!0}}}_forEachCell(e,s,c,h,m,S,k,A){const F=this._convertToXCellCoord(e),H=this._convertToYCellCoord(s),$=this._convertToXCellCoord(c),ne=this._convertToYCellCoord(h);for(let de=F;de<=$;de++)for(let me=H;me<=ne;me++)if(m.call(this,e,s,c,h,this.xCellCount*me+de,S,k,A))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,s,c,h,m,S){const k=h-e,A=m-s,F=c+S;return F*F>k*k+A*A}_circleAndRectCollide(e,s,c,h,m,S,k){const A=(S-h)/2,F=Math.abs(e-(h+A));if(F>A+c)return!1;const H=(k-m)/2,$=Math.abs(s-(m+H));if($>H+c)return!1;if(F<=A||$<=H)return!0;const ne=F-A,de=$-H;return ne*ne+de*de<=c*c}}function Xn(g,e,s,c,h){const m=u.H();return e?(u.K(m,m,[1/h,1/h,1]),s||u.ad(m,m,c.angle)):u.L(m,c.labelPlaneMatrix,g),m}function Nr(g,e,s,c,h){if(e){const m=u.ae(g);return u.K(m,m,[h,h,1]),s||u.ad(m,m,-c.angle),m}return c.glCoordMatrix}function Ce(g,e,s,c){let h;c?(h=[g,e,c(g,e),1],u.af(h,h,s)):(h=[g,e,0,1],Jr(h,h,s));const m=h[3];return{point:new u.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function ee(g,e){return .5+g/e*.5}function Q(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function ue(g,e,s,c,h,m,S,k,A,F,H,$,ne,de,me){const be=c?g.textSizeData:g.iconSizeData,Ie=u.ag(be,s.transform.zoom),ze=[256/s.width*2+1,256/s.height*2+1],Be=c?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;Be.clear();const ke=g.lineVertexArray,Ge=c?g.text.placedSymbolArray:g.icon.placedSymbolArray,Xe=s.transform.width/s.transform.height;let it=!1;for(let kt=0;kt<Ge.length;kt++){const Bt=Ge.get(kt);if(Bt.hidden||Bt.writingMode===u.ah.vertical&&!it){pr(Bt.numGlyphs,Be);continue}it=!1;const $t=Ce(Bt.anchorX,Bt.anchorY,e,me);if(!Q($t.point,ze)){pr(Bt.numGlyphs,Be);continue}const Qt=ee(s.transform.cameraToCenterDistance,$t.signedDistanceFromCamera),Gt=u.ai(be,Ie,Bt),Vt=S?Gt/Qt:Gt*Qt,ur={getElevation:me,labelPlaneMatrix:h,lineVertexArray:ke,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:F,tileAnchorPoint:new u.P(Bt.anchorX,Bt.anchorY),unwrappedTileID:H,width:$,height:ne,translation:de},Fr=$e(ur,Bt,Vt,!1,k,e,m,g.glyphOffsetArray,Be,Xe,A);it=Fr.useVertical,(Fr.notEnoughRoom||it||Fr.needsFlipping&&$e(ur,Bt,Vt,!0,k,e,m,g.glyphOffsetArray,Be,Xe,A).notEnoughRoom)&&pr(Bt.numGlyphs,Be)}c?g.text.dynamicLayoutVertexBuffer.updateData(Be):g.icon.dynamicLayoutVertexBuffer.updateData(Be)}function Se(g,e,s,c,h,m,S,k){const A=m.glyphStartIndex+m.numGlyphs,F=m.lineStartIndex,H=m.lineStartIndex+m.lineLength,$=e.getoffsetX(m.glyphStartIndex),ne=e.getoffsetX(A-1),de=Nt(g*$,s,c,h,m.segment,F,H,k,S);if(!de)return null;const me=Nt(g*ne,s,c,h,m.segment,F,H,k,S);return me?k.projectionCache.anyProjectionOccluded?null:{first:de,last:me}:null}function Oe(g,e,s,c){return g===u.ah.horizontal&&Math.abs(s.y-e.y)>Math.abs(s.x-e.x)*c?{useVertical:!0}:(g===u.ah.vertical?e.y<s.y:e.x>s.x)?{needsFlipping:!0}:null}function $e(g,e,s,c,h,m,S,k,A,F,H){const $=s/24,ne=e.lineOffsetX*$,de=e.lineOffsetY*$;let me;if(e.numGlyphs>1){const be=e.glyphStartIndex+e.numGlyphs,Ie=e.lineStartIndex,ze=e.lineStartIndex+e.lineLength,Be=Se($,k,ne,de,c,e,H,g);if(!Be)return{notEnoughRoom:!0};const ke=Ce(Be.first.point.x,Be.first.point.y,S,g.getElevation).point,Ge=Ce(Be.last.point.x,Be.last.point.y,S,g.getElevation).point;if(h&&!c){const Xe=Oe(e.writingMode,ke,Ge,F);if(Xe)return Xe}me=[Be.first];for(let Xe=e.glyphStartIndex+1;Xe<be-1;Xe++)me.push(Nt($*k.getoffsetX(Xe),ne,de,c,e.segment,Ie,ze,g,H));me.push(Be.last)}else{if(h&&!c){const Ie=Ce(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,ze=e.lineStartIndex+e.segment+1,Be=new u.P(g.lineVertexArray.getx(ze),g.lineVertexArray.gety(ze)),ke=Ce(Be.x,Be.y,m,g.getElevation),Ge=ke.signedDistanceFromCamera>0?ke.point:function(it,kt,Bt,$t,Qt,Gt){return Ke(it,kt,Bt,1,Qt,Gt)}(g.tileAnchorPoint,Be,Ie,0,m,g),Xe=Oe(e.writingMode,Ie,Ge,F);if(Xe)return Xe}const be=Nt($*k.getoffsetX(e.glyphStartIndex),ne,de,c,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,g,H);if(!be||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};me=[be]}for(const be of me)u.aj(A,be.point,be.angle);return{}}function Ke(g,e,s,c,h,m){const S=g.add(g.sub(e)._unit()),k=h!==void 0?Ce(S.x,S.y,h,m.getElevation).point:pt(S.x,S.y,m).point,A=s.sub(k);return s.add(A._mult(c/A.mag()))}function Le(g,e,s){const c=e.projectionCache;if(c.projections[g])return c.projections[g];const h=new u.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),m=pt(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return c.projections[g]=m.point,c.anyProjectionOccluded=c.anyProjectionOccluded||m.isOccluded,m.point;const S=g-s.direction;return function(k,A,F,H,$){return Ke(k,A,F,H,void 0,$)}(s.distanceFromAnchor===0?e.tileAnchorPoint:new u.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),h,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,e)}function pt(g,e,s){const c=g+s.translation[0],h=e+s.translation[1];let m;return!s.pitchWithMap&&s.projection.useSpecialProjectionForSymbols?(m=s.projection.projectTileCoordinates(c,h,s.unwrappedTileID,s.getElevation),m.point.x=(.5*m.point.x+.5)*s.width,m.point.y=(.5*-m.point.y+.5)*s.height):(m=Ce(c,h,s.labelPlaneMatrix,s.getElevation),m.isOccluded=!1),m}function It(g,e,s){return g._unit()._perp()._mult(e*s)}function ut(g,e,s,c,h,m,S,k,A){if(k.projectionCache.offsets[g])return k.projectionCache.offsets[g];const F=s.add(e);if(g+A.direction<c||g+A.direction>=h)return k.projectionCache.offsets[g]=F,F;const H=Le(g+A.direction,k,A),$=It(H.sub(s),S,A.direction),ne=s.add($),de=H.add($);return k.projectionCache.offsets[g]=u.ak(m,F,ne,de)||F,k.projectionCache.offsets[g]}function Nt(g,e,s,c,h,m,S,k,A){const F=c?g-e:g+e;let H=F>0?1:-1,$=0;c&&(H*=-1,$=Math.PI),H<0&&($+=Math.PI);let ne,de=H>0?m+h:m+h+1;k.projectionCache.cachedAnchorPoint?ne=k.projectionCache.cachedAnchorPoint:(ne=pt(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=ne);let me,be,Ie=ne,ze=ne,Be=0,ke=0;const Ge=Math.abs(F),Xe=[];let it;for(;Be+ke<=Ge;){if(de+=H,de<m||de>=S)return null;Be+=ke,ze=Ie,be=me;const $t={absOffsetX:Ge,direction:H,distanceFromAnchor:Be,previousVertex:ze};if(Ie=Le(de,k,$t),s===0)Xe.push(ze),it=Ie.sub(ze);else{let Qt;const Gt=Ie.sub(ze);Qt=Gt.mag()===0?It(Le(de+H,k,$t).sub(Ie),s,H):It(Gt,s,H),be||(be=ze.add(Qt)),me=ut(de,Qt,Ie,m,S,be,s,k,$t),Xe.push(be),it=me.sub(be)}ke=it.mag()}const kt=it._mult((Ge-Be)/ke)._add(be||ze),Bt=$+Math.atan2(Ie.y-ze.y,Ie.x-ze.x);return Xe.push(kt),{point:kt,angle:A?Bt:0,path:Xe}}const cr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pr(g,e){for(let s=0;s<g;s++){const c=e.length;e.resize(c+4),e.float32.set(cr,3*c)}}function Jr(g,e,s){const c=e[0],h=e[1];return g[0]=s[0]*c+s[4]*h+s[12],g[1]=s[1]*c+s[5]*h+s[13],g[3]=s[3]*c+s[7]*h+s[15],g}const Mr=100;class Kr{constructor(e,s,c=new wi(e.width+200,e.height+200,25),h=new wi(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=s,this.grid=c,this.ignoredGrid=h,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Mr,this.screenBottomBoundary=e.height+Mr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,s,c,h,m,S,k,A,F,H,$){const ne=e.anchorPointX+A[0],de=e.anchorPointY+A[1],me=this.projectAndGetPerspectiveRatio(h,ne,de,m,H),be=c*me.perspectiveRatio;let Ie;if(S||k)Ie=this._projectCollisionBox(e,be,h,m,S,k,A,me,H,$);else{const Xe=me.point.x+($?$.x*be:0),it=me.point.y+($?$.y*be:0);Ie={allPointsOccluded:!1,box:[Xe+e.x1*be,it+e.y1*be,Xe+e.x2*be,it+e.y2*be]}}const[ze,Be,ke,Ge]=Ie.box;return this.mapProjection.useSpecialProjectionForSymbols&&(S?Ie.allPointsOccluded:this.mapProjection.isOccluded(ne,de,m))||me.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ze,Be,ke,Ge)||s!=="always"&&this.grid.hitTest(ze,Be,ke,Ge,s,F)?{box:[ze,Be,ke,Ge],placeable:!1,offscreen:!1}:{box:[ze,Be,ke,Ge],placeable:!0,offscreen:this.isOffscreen(ze,Be,ke,Ge)}}placeCollisionCircles(e,s,c,h,m,S,k,A,F,H,$,ne,de,me,be,Ie){const ze=[],Be=new u.P(s.anchorX,s.anchorY),ke=this.getPerspectiveRatio(S,Be.x,Be.y,k,Ie),Ge=($?m/ke:m*ke)/u.ap,Xe={getElevation:Ie,labelPlaneMatrix:A,lineVertexArray:c,pitchWithMap:$,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:Be,unwrappedTileID:k,width:this.transform.width,height:this.transform.height,translation:be},it=Se(Ge,h,s.lineOffsetX*Ge,s.lineOffsetY*Ge,!1,s,!1,Xe);let kt=!1,Bt=!1,$t=!0;if(it){const Qt=.5*de*ke+me,Gt=new u.P(-100,-100),Vt=new u.P(this.screenRightBoundary,this.screenBottomBoundary),ur=new Ir,Fr=it.first,Zt=it.last;let Xt=[];for(let $r=Fr.path.length-1;$r>=1;$r--)Xt.push(Fr.path[$r]);for(let $r=1;$r<Zt.path.length;$r++)Xt.push(Zt.path[$r]);const Lr=2.5*Qt;if(F){const $r=this.projectPathToScreenSpace(Xt,Xe,F);Xt=$r.some(Wr=>Wr.signedDistanceFromCamera<=0)?[]:$r.map(Wr=>Wr.point)}let Sn=[];if(Xt.length>0){const $r=Xt[0].clone(),Wr=Xt[0].clone();for(let Cn=1;Cn<Xt.length;Cn++)$r.x=Math.min($r.x,Xt[Cn].x),$r.y=Math.min($r.y,Xt[Cn].y),Wr.x=Math.max(Wr.x,Xt[Cn].x),Wr.y=Math.max(Wr.y,Xt[Cn].y);Sn=$r.x>=Gt.x&&Wr.x<=Vt.x&&$r.y>=Gt.y&&Wr.y<=Vt.y?[Xt]:Wr.x<Gt.x||$r.x>Vt.x||Wr.y<Gt.y||$r.y>Vt.y?[]:u.al([Xt],Gt.x,Gt.y,Vt.x,Vt.y)}for(const $r of Sn){ur.reset($r,.25*Qt);let Wr=0;Wr=ur.length<=.5*Qt?1:Math.ceil(ur.paddedLength/Lr)+1;for(let Cn=0;Cn<Wr;Cn++){const Mi=Cn/Math.max(Wr-1,1),As=ur.lerp(Mi),In=As.x+Mr,Ti=As.y+Mr;ze.push(In,Ti,Qt,0);const Nn=In-Qt,ri=Ti-Qt,Bi=In+Qt,yo=Ti+Qt;if($t=$t&&this.isOffscreen(Nn,ri,Bi,yo),Bt=Bt||this.isInsideGrid(Nn,ri,Bi,yo),e!=="always"&&this.grid.hitTestCircle(In,Ti,Qt,e,ne)&&(kt=!0,!H))return{circles:[],offscreen:!1,collisionDetected:kt}}}}return{circles:!H&&kt||!Bt||ke<this.perspectiveRatioCutoff?[]:ze,offscreen:$t,collisionDetected:kt}}projectPathToScreenSpace(e,s,c){return e.map(h=>Ce(h.x,h.y,c,s.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,h=1/0,m=-1/0,S=-1/0;for(const H of e){const $=new u.P(H.x+Mr,H.y+Mr);c=Math.min(c,$.x),h=Math.min(h,$.y),m=Math.max(m,$.x),S=Math.max(S,$.y),s.push($)}const k=this.grid.query(c,h,m,S).concat(this.ignoredGrid.query(c,h,m,S)),A={},F={};for(const H of k){const $=H.key;if(A[$.bucketInstanceId]===void 0&&(A[$.bucketInstanceId]={}),A[$.bucketInstanceId][$.featureIndex])continue;const ne=[new u.P(H.x1,H.y1),new u.P(H.x2,H.y1),new u.P(H.x2,H.y2),new u.P(H.x1,H.y2)];u.am(s,ne)&&(A[$.bucketInstanceId][$.featureIndex]=!0,F[$.bucketInstanceId]===void 0&&(F[$.bucketInstanceId]=[]),F[$.bucketInstanceId].push($.featureIndex))}return F}insertCollisionBox(e,s,c,h,m,S){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:S,overlapMode:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,s,c,h,m,S){const k=c?this.ignoredGrid:this.grid,A={bucketInstanceId:h,featureIndex:m,collisionGroupID:S,overlapMode:s};for(let F=0;F<e.length;F+=4)k.insertCircle(A,e[F],e[F+1],e[F+2])}projectAndGetPerspectiveRatio(e,s,c,h,m){let S;m?(S=[s,c,m(s,c),1],u.af(S,S,e)):(S=[s,c,0,1],Jr(S,S,e));const k=S[3];return{point:new u.P((S[0]/k+1)/2*this.transform.width+Mr,(-S[1]/k+1)/2*this.transform.height+Mr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}getPerspectiveRatio(e,s,c,h,m){const S=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(s,c,h,m):Ce(s,c,e,m);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(e,s,c,h){return c<Mr||e>=this.screenRightBoundary||h<Mr||s>this.screenBottomBoundary}isInsideGrid(e,s,c,h){return c>=0&&e<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const e=u.an([]);return u.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,s,c,h,m,S,k,A,F,H){let $=new u.P(1,0),ne=new u.P(0,1);const de=new u.P(e.anchorPointX+k[0],e.anchorPointY+k[1]);if(S&&!m){const $t=this.projectAndGetPerspectiveRatio(c,de.x+1,de.y,h,F).point.sub(A.point).unit(),Qt=Math.atan($t.y/$t.x)+($t.x<0?Math.PI:0),Gt=Math.sin(Qt),Vt=Math.cos(Qt);$=new u.P(Vt,Gt),ne=new u.P(-Gt,Vt)}else if(!S&&m){const $t=-this.transform.angle,Qt=Math.sin($t),Gt=Math.cos($t);$=new u.P(Gt,Qt),ne=new u.P(-Qt,Gt)}let me=A.point,be=s;if(m){me=de;const $t=this.transform.zoom-Math.floor(this.transform.zoom);be=Math.pow(2,-$t),be*=this.mapProjection.getPitchedTextCorrection(this.transform,de,h),H||(be*=u.ac(.5+A.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}H&&(me=me.add($.mult(H.x*be)).add(ne.mult(H.y*be)));const Ie=e.x1*be,ze=e.x2*be,Be=(Ie+ze)/2,ke=e.y1*be,Ge=e.y2*be,Xe=(ke+Ge)/2,it=[{offsetX:Ie,offsetY:ke},{offsetX:Be,offsetY:ke},{offsetX:ze,offsetY:ke},{offsetX:ze,offsetY:Xe},{offsetX:ze,offsetY:Ge},{offsetX:Be,offsetY:Ge},{offsetX:Ie,offsetY:Ge},{offsetX:Ie,offsetY:Xe}];let kt=[];for(const{offsetX:$t,offsetY:Qt}of it)kt.push(new u.P(me.x+$.x*$t+ne.x*Qt,me.y+$.y*$t+ne.y*Qt));let Bt=!1;if(m){const $t=kt.map(Qt=>this.projectAndGetPerspectiveRatio(c,Qt.x,Qt.y,h,F));Bt=$t.some(Qt=>!Qt.isOccluded),kt=$t.map(Qt=>Qt.point)}else Bt=!0;return{box:u.ao(kt),allPointsOccluded:!Bt}}}function Ur(g,e,s){return e*(u.X/(g.tileSize*Math.pow(2,s-g.tileID.overscaledZ)))}class bn{constructor(e,s,c,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?s:-s))):h&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class En{constructor(e,s,c,h,m){this.text=new bn(e?e.text:null,s,c,m),this.icon=new bn(e?e.icon:null,s,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hr{constructor(e,s,c){this.text=e,this.icon=s,this.skipFade=c}}class rn{constructor(){this.invProjMatrix=u.H(),this.viewportMatrix=u.H(),this.circles=[]}}class un{constructor(e,s,c,h,m){this.bucketInstanceId=e,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=h,this.tileID=m}}class Fn{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const s=++this.maxGroupID;this.collisionGroups[e]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[e]}}function Kn(g,e,s,c,h){const{horizontalAlign:m,verticalAlign:S}=u.au(g);return new u.P(-(m-.5)*e+c[0]*h,-(S-.5)*s+c[1]*h)}class hi{constructor(e,s,c,h,m,S){this.transform=e.clone(),this.terrain=c,this.collisionIndex=new Kr(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Fn(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const s=this.terrain;return s?(c,h)=>s.getElevation(e,c,h):null}getBucketParts(e,s,c,h){const m=c.getBucket(s),S=c.latestFeatureIndex;if(!m||!S||s.id!==m.layerIds[0])return;const k=c.collisionBoxArray,A=m.layers[0].layout,F=m.layers[0].paint,H=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),$=c.tileSize/u.X,ne=c.tileID.toUnwrapped(),de=this.transform.calculatePosMatrix(ne),me=A.get("text-pitch-alignment")==="map",be=A.get("text-rotation-alignment")==="map",Ie=Ur(c,1,this.transform.zoom),ze=this.collisionIndex.mapProjection.translatePosition(this.transform,c,F.get("text-translate"),F.get("text-translate-anchor")),Be=this.collisionIndex.mapProjection.translatePosition(this.transform,c,F.get("icon-translate"),F.get("icon-translate-anchor")),ke=Xn(de,me,be,this.transform,Ie);let Ge=null;if(me){const it=Nr(de,me,be,this.transform,Ie);Ge=u.L([],this.transform.labelPlaneMatrix,it)}this.retainedQueryData[m.bucketInstanceId]=new un(m.bucketInstanceId,S,m.sourceLayerIndex,m.index,c.tileID);const Xe={bucket:m,layout:A,translationText:ze,translationIcon:Be,posMatrix:de,unwrappedTileID:ne,textLabelPlaneMatrix:ke,labelToScreenMatrix:Ge,scale:H,textPixelRatio:$,holdingForFade:c.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:u.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const it of m.sortKeyRanges){const{sortKey:kt,symbolInstanceStart:Bt,symbolInstanceEnd:$t}=it;e.push({sortKey:kt,symbolInstanceStart:Bt,symbolInstanceEnd:$t,parameters:Xe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(e,s,c,h,m,S,k,A,F,H,$,ne,de,me,be,Ie,ze,Be,ke){const Ge=u.aq[e.textAnchor],Xe=[e.textOffset0,e.textOffset1],it=Kn(Ge,c,h,Xe,m),kt=this.collisionIndex.placeCollisionBox(s,ne,A,F,H,k,S,Ie,$.predicate,ke,it);if((!Be||this.collisionIndex.placeCollisionBox(Be,ne,A,F,H,k,S,ze,$.predicate,ke,it).placeable)&&kt.placeable){let Bt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Bt=this.prevPlacement.variableOffsets[de.crossTileID].anchor),de.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[de.crossTileID]={textOffset:Xe,width:c,height:h,anchor:Ge,textBoxScale:m,prevAnchor:Bt},this.markUsedJustification(me,Ge,de,be),me.allowVerticalPlacement&&(this.markUsedOrientation(me,be,de),this.placedOrientations[de.crossTileID]=be),{shift:it,placedGlyphBoxes:kt}}}placeLayerBucketPart(e,s,c){const{bucket:h,layout:m,translationText:S,translationIcon:k,posMatrix:A,unwrappedTileID:F,textLabelPlaneMatrix:H,labelToScreenMatrix:$,textPixelRatio:ne,holdingForFade:de,collisionBoxArray:me,partiallyEvaluatedTextSize:be,collisionGroup:Ie}=e.parameters,ze=m.get("text-optional"),Be=m.get("icon-optional"),ke=u.ar(m,"text-overlap","text-allow-overlap"),Ge=ke==="always",Xe=u.ar(m,"icon-overlap","icon-allow-overlap"),it=Xe==="always",kt=m.get("text-rotation-alignment")==="map",Bt=m.get("text-pitch-alignment")==="map",$t=m.get("icon-text-fit")!=="none",Qt=m.get("symbol-z-order")==="viewport-y",Gt=Ge&&(it||!h.hasIconData()||Be),Vt=it&&(Ge||!h.hasTextData()||ze);!h.collisionArrays&&me&&h.deserializeCollisionBoxes(me);const ur=this._getTerrainElevationFunc(this.retainedQueryData[h.bucketInstanceId].tileID),Fr=(Zt,Xt,Lr)=>{var Sn,$r;if(s[Zt.crossTileID])return;if(de)return void(this.placements[Zt.crossTileID]=new Hr(!1,!1,!1));let Wr=!1,Cn=!1,Mi=!0,As=null,In={box:null,placeable:!1,offscreen:null},Ti={placeable:!1},Nn=null,ri=null,Bi=null,yo=0,gs=0,_o=0;Xt.textFeatureIndex?yo=Xt.textFeatureIndex:Zt.useRuntimeCollisionCircles&&(yo=Zt.featureIndex),Xt.verticalTextFeatureIndex&&(gs=Xt.verticalTextFeatureIndex);const Ra=Xt.textBox;if(Ra){const is=ii=>{let $n=u.ah.horizontal;if(h.allowVerticalPlacement&&!ii&&this.prevPlacement){const Ni=this.prevPlacement.placedOrientations[Zt.crossTileID];Ni&&(this.placedOrientations[Zt.crossTileID]=Ni,$n=Ni,this.markUsedOrientation(h,$n,Zt))}return $n},zs=(ii,$n)=>{if(h.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&Xt.verticalTextBox){for(const Ni of h.writingModes)if(Ni===u.ah.vertical?(In=$n(),Ti=In):In=ii(),In&&In.placeable)break}else In=ii()},vo=Zt.textAnchorOffsetStartIndex,Ys=Zt.textAnchorOffsetEndIndex;if(Ys===vo){const ii=($n,Ni)=>{const Xr=this.collisionIndex.placeCollisionBox($n,ke,ne,A,F,Bt,kt,S,Ie.predicate,ur);return Xr&&Xr.placeable&&(this.markUsedOrientation(h,Ni,Zt),this.placedOrientations[Zt.crossTileID]=Ni),Xr};zs(()=>ii(Ra,u.ah.horizontal),()=>{const $n=Xt.verticalTextBox;return h.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&$n?ii($n,u.ah.vertical):{box:null,offscreen:null}}),is(In&&In.placeable)}else{let ii=u.aq[($r=(Sn=this.prevPlacement)===null||Sn===void 0?void 0:Sn.variableOffsets[Zt.crossTileID])===null||$r===void 0?void 0:$r.anchor];const $n=(Xr,Rs,Da)=>{const xo=Xr.x2-Xr.x1,wc=Xr.y2-Xr.y1,bc=Zt.textBoxScale,qn=$t&&Xe==="never"?Rs:null;let wo=null,Vu=ke==="never"?1:2,Rl="never";ii&&Vu++;for(let La=0;La<Vu;La++){for(let Dl=vo;Dl<Ys;Dl++){const jo=h.textAnchorOffsets.get(Dl);if(ii&&jo.textAnchor!==ii)continue;const Pn=this.attemptAnchorPlacement(jo,Xr,xo,wc,bc,kt,Bt,ne,A,F,Ie,Rl,Zt,h,Da,S,k,qn,ur);if(Pn&&(wo=Pn.placedGlyphBoxes,wo&&wo.placeable))return Wr=!0,As=Pn.shift,wo}ii?ii=null:Rl=ke}return c&&!wo&&(wo={box:this.collisionIndex.placeCollisionBox(Ra,"always",ne,A,F,Bt,kt,S,Ie.predicate,ur,new u.P(0,0)).box,offscreen:!1,placeable:!1}),wo};zs(()=>$n(Ra,Xt.iconBox,u.ah.horizontal),()=>{const Xr=Xt.verticalTextBox;return h.allowVerticalPlacement&&(!In||!In.placeable)&&Zt.numVerticalGlyphVertices>0&&Xr?$n(Xr,Xt.verticalIconBox,u.ah.vertical):{box:null,occluded:!0,offscreen:null}}),In&&(Wr=In.placeable,Mi=In.offscreen);const Ni=is(In&&In.placeable);if(!Wr&&this.prevPlacement){const Xr=this.prevPlacement.variableOffsets[Zt.crossTileID];Xr&&(this.variableOffsets[Zt.crossTileID]=Xr,this.markUsedJustification(h,Xr.anchor,Zt,Ni))}}}if(Nn=In,Wr=Nn&&Nn.placeable,Mi=Nn&&Nn.offscreen,Zt.useRuntimeCollisionCircles){const is=h.text.placedSymbolArray.get(Zt.centerJustifiedTextSymbolIndex),zs=u.ai(h.textSizeData,be,is),vo=m.get("text-padding");ri=this.collisionIndex.placeCollisionCircles(ke,is,h.lineVertexArray,h.glyphOffsetArray,zs,A,F,H,$,c,Bt,Ie.predicate,Zt.collisionCircleDiameter,vo,S,ur),ri.circles.length&&ri.collisionDetected&&!c&&u.w("Collisions detected, but collision boxes are not shown"),Wr=Ge||ri.circles.length>0&&!ri.collisionDetected,Mi=Mi&&ri.offscreen}if(Xt.iconFeatureIndex&&(_o=Xt.iconFeatureIndex),Xt.iconBox){const is=zs=>this.collisionIndex.placeCollisionBox(zs,Xe,ne,A,F,Bt,kt,k,Ie.predicate,ur,$t&&As?As:void 0);Ti&&Ti.placeable&&Xt.verticalIconBox?(Bi=is(Xt.verticalIconBox),Cn=Bi.placeable):(Bi=is(Xt.iconBox),Cn=Bi.placeable),Mi=Mi&&Bi.offscreen}const Ms=ze||Zt.numHorizontalGlyphVertices===0&&Zt.numVerticalGlyphVertices===0,Ks=Be||Zt.numIconVertices===0;Ms||Ks?Ks?Ms||(Cn=Cn&&Wr):Wr=Cn&&Wr:Cn=Wr=Cn&&Wr;const No=Cn&&Bi.placeable;if(Wr&&Nn.placeable&&this.collisionIndex.insertCollisionBox(Nn.box,ke,m.get("text-ignore-placement"),h.bucketInstanceId,Ti&&Ti.placeable&&gs?gs:yo,Ie.ID),No&&this.collisionIndex.insertCollisionBox(Bi.box,Xe,m.get("icon-ignore-placement"),h.bucketInstanceId,_o,Ie.ID),ri&&Wr&&this.collisionIndex.insertCollisionCircles(ri.circles,ke,m.get("text-ignore-placement"),h.bucketInstanceId,yo,Ie.ID),c&&this.storeCollisionData(h.bucketInstanceId,Lr,Xt,Nn,Bi,ri),Zt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Zt.crossTileID]=new Hr(Wr||Gt,Cn||Vt,Mi||h.justReloaded),s[Zt.crossTileID]=!0};if(Qt){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Zt=h.getSortedSymbolIndexes(this.transform.angle);for(let Xt=Zt.length-1;Xt>=0;--Xt){const Lr=Zt[Xt];Fr(h.symbolInstances.get(Lr),h.collisionArrays[Lr],Lr)}}else for(let Zt=e.symbolInstanceStart;Zt<e.symbolInstanceEnd;Zt++)Fr(h.symbolInstances.get(Zt),h.collisionArrays[Zt],Zt);if(c&&h.bucketInstanceId in this.collisionCircleArrays){const Zt=this.collisionCircleArrays[h.bucketInstanceId];u.as(Zt.invProjMatrix,A),Zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}storeCollisionData(e,s,c,h,m,S){if(c.textBox||c.iconBox){let k,A;this.collisionBoxArrays.has(e)?k=this.collisionBoxArrays.get(e):(k=new Map,this.collisionBoxArrays.set(e,k)),k.has(s)?A=k.get(s):(A={text:null,icon:null},k.set(s,A)),c.textBox&&(A.text=h.box),c.iconBox&&(A.icon=m.box)}if(S){let k=this.collisionCircleArrays[e];k===void 0&&(k=this.collisionCircleArrays[e]=new rn);for(let A=0;A<S.circles.length;A+=4)k.circles.push(S.circles[A+0]),k.circles.push(S.circles[A+1]),k.circles.push(S.circles[A+2]),k.circles.push(S.collisionDetected?1:0)}}markUsedJustification(e,s,c,h){let m;m=h===u.ah.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.at(s)];const S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const k of S)k>=0&&(e.text.placedSymbolArray.get(k).crossTileID=m>=0&&k!==m?0:c.crossTileID)}markUsedOrientation(e,s,c){const h=s===u.ah.horizontal||s===u.ah.horizontalOnly?s:0,m=s===u.ah.vertical?s:0,S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const k of S)e.text.placedSymbolArray.get(k).placedOrientation=h;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const h=s?s.symbolFadeChange(e):1,m=s?s.opacities:{},S=s?s.variableOffsets:{},k=s?s.placedOrientations:{};for(const A in this.placements){const F=this.placements[A],H=m[A];H?(this.opacities[A]=new En(H,h,F.text,F.icon),c=c||F.text!==H.text.placed||F.icon!==H.icon.placed):(this.opacities[A]=new En(null,h,F.text,F.icon,F.skipFade),c=c||F.text||F.icon)}for(const A in m){const F=m[A];if(!this.opacities[A]){const H=new En(F,h,!1,!1);H.isHidden()||(this.opacities[A]=H,c=c||F.text.placed||F.icon.placed)}}for(const A in S)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=S[A]);for(const A in k)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=k[A]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:e)}updateLayerOpacities(e,s){const c={};for(const h of s){const m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,c,h.collisionBoxArray)}}updateBucketOpacities(e,s,c,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],S=m.layout,k=new En(null,0,!1,!1,!0),A=S.get("text-allow-overlap"),F=S.get("icon-allow-overlap"),H=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=S.get("text-rotation-alignment")==="map",ne=S.get("text-pitch-alignment")==="map",de=S.get("icon-text-fit")!=="none",me=new En(null,0,A&&(F||!e.hasIconData()||S.get("icon-optional")),F&&(A||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const be=(ze,Be,ke)=>{for(let Ge=0;Ge<Be/4;Ge++)ze.opacityVertexArray.emplaceBack(ke);ze.hasVisibleVertices=ze.hasVisibleVertices||ke!==fi},Ie=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ze=0;ze<e.symbolInstances.length;ze++){const Be=e.symbolInstances.get(ze),{numHorizontalGlyphVertices:ke,numVerticalGlyphVertices:Ge,crossTileID:Xe}=Be;let it=this.opacities[Xe];c[Xe]?it=k:it||(it=me,this.opacities[Xe]=it),c[Xe]=!0;const kt=Be.numIconVertices>0,Bt=this.placedOrientations[Be.crossTileID],$t=Bt===u.ah.vertical,Qt=Bt===u.ah.horizontal||Bt===u.ah.horizontalOnly;if(ke>0||Ge>0){const Vt=Hn(it.text);be(e.text,ke,$t?fi:Vt),be(e.text,Ge,Qt?fi:Vt);const ur=it.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Xt=>{Xt>=0&&(e.text.placedSymbolArray.get(Xt).hidden=ur||$t?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=ur||Qt?1:0);const Fr=this.variableOffsets[Be.crossTileID];Fr&&this.markUsedJustification(e,Fr.anchor,Be,Bt);const Zt=this.placedOrientations[Be.crossTileID];Zt&&(this.markUsedJustification(e,"left",Be,Zt),this.markUsedOrientation(e,Zt,Be))}if(kt){const Vt=Hn(it.icon),ur=!(de&&Be.verticalPlacedIconSymbolIndex&&$t);Be.placedIconSymbolIndex>=0&&(be(e.icon,Be.numIconVertices,ur?Vt:fi),e.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=it.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(be(e.icon,Be.numVerticalIconVertices,ur?fi:Vt),e.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=it.icon.isHidden())}const Gt=Ie&&Ie.has(ze)?Ie.get(ze):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Vt=e.collisionArrays[ze];if(Vt){let ur=new u.P(0,0);if(Vt.textBox||Vt.verticalTextBox){let Fr=!0;if(H){const Zt=this.variableOffsets[Xe];Zt?(ur=Kn(Zt.anchor,Zt.width,Zt.height,Zt.textOffset,Zt.textBoxScale),$&&ur._rotate(ne?this.transform.angle:-this.transform.angle)):Fr=!1}if(Vt.textBox||Vt.verticalTextBox){let Zt;Vt.textBox&&(Zt=$t),Vt.verticalTextBox&&(Zt=Qt),ao(e.textCollisionBox.collisionVertexArray,it.text.placed,!Fr||Zt,Gt.text,ur.x,ur.y)}}if(Vt.iconBox||Vt.verticalIconBox){const Fr=!!(!Qt&&Vt.verticalIconBox);let Zt;Vt.iconBox&&(Zt=Fr),Vt.verticalIconBox&&(Zt=!Fr),ao(e.iconCollisionBox.collisionVertexArray,it.icon.placed,Zt,Gt.icon,de?ur.x:0,de?ur.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=ze.invProjMatrix,e.placementViewportMatrix=ze.viewportMatrix,e.collisionCircleArray=ze.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function ao(g,e,s,c,h,m){c&&c.length!==0||(c=[0,0,0,0]);const S=c[0]-Mr,k=c[1]-Mr,A=c[2]-Mr,F=c[3]-Mr;g.emplaceBack(e?1:0,s?1:0,h||0,m||0,S,k),g.emplaceBack(e?1:0,s?1:0,h||0,m||0,A,k),g.emplaceBack(e?1:0,s?1:0,h||0,m||0,A,F),g.emplaceBack(e?1:0,s?1:0,h||0,m||0,S,F)}const Pr=Math.pow(2,25),bi=Math.pow(2,24),zo=Math.pow(2,17),di=Math.pow(2,16),ei=Math.pow(2,9),pl=Math.pow(2,8),ti=Math.pow(2,1);function Hn(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const e=g.placed?1:0,s=Math.floor(127*g.opacity);return s*Pr+e*bi+s*zo+e*di+s*ei+e*pl+s*ti+e}const fi=0;function Qi(){return{isOccluded:(g,e,s)=>!1,getPitchedTextCorrection:(g,e,s)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,e,s,c){throw new Error("Not implemented.")},translatePosition:(g,e,s,c)=>function(h,m,S,k,A=!1){if(!S[0]&&!S[1])return[0,0];const F=A?k==="map"?h.angle:0:k==="viewport"?-h.angle:0;if(F){const H=Math.sin(F),$=Math.cos(F);S=[S[0]*$-S[1]*H,S[0]*H+S[1]*$]}return[A?S[0]:Ur(m,S[0],h.zoom),A?S[1]:Ur(m,S[1],h.zoom)]}(g,e,s,c),getCircleRadiusCorrection:g=>1}}class nn{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,s,c,h,m){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(s.getBucketParts(S,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((k,A)=>k.sortKey-A.sortKey));this._currentPartIndex<S.length;)if(s.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class lo{constructor(e,s,c,h,m,S,k,A){this.placement=new hi(e,Qi(),s,S,k,A),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,s,c){const h=j.now(),m=()=>!this._forceFullPlacement&&j.now()-h>2;for(;this._currentPlacementIndex>=0;){const S=s[e[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=k)&&(!S.maxzoom||S.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new nn(S)),this._inProgressLayer.continuePlacement(c[S.source],this.placement,this._showCollisionBoxes,S,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Di=512/u.X/2;class Mn{constructor(e,s,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const h=new Map;for(let m=0;m<s.length;m++){const S=s.get(m),k=S.key,A=h.get(k);A?A.push(S):h.set(k,[S])}for(const[m,S]of h){const k={positions:S.map(A=>({x:Math.floor(A.anchorX*Di),y:Math.floor(A.anchorY*Di)})),crossTileIDs:S.map(A=>A.crossTileID)};if(k.positions.length>128){const A=new u.av(k.positions.length,16,Uint16Array);for(const{x:F,y:H}of k.positions)A.add(F,H);A.finish(),delete k.positions,k.index=A}this._symbolsByKey[m]=k}}getScaledCoordinates(e,s){const{x:c,y:h,z:m}=this.tileID.canonical,{x:S,y:k,z:A}=s.canonical,F=Di/Math.pow(2,A-m),H=(k*u.X+e.anchorY)*F,$=h*u.X*Di;return{x:Math.floor((S*u.X+e.anchorX)*F-c*u.X*Di),y:Math.floor(H-$)}}findMatches(e,s,c){const h=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let m=0;m<e.length;m++){const S=e.get(m);if(S.crossTileID)continue;const k=this._symbolsByKey[S.key];if(!k)continue;const A=this.getScaledCoordinates(S,s);if(k.index){const F=k.index.range(A.x-h,A.y-h,A.x+h,A.y+h).sort();for(const H of F){const $=k.crossTileIDs[H];if(!c[$]){c[$]=!0,S.crossTileID=$;break}}}else if(k.positions)for(let F=0;F<k.positions.length;F++){const H=k.positions[F],$=k.crossTileIDs[F];if(Math.abs(H.x-A.x)<=h&&Math.abs(H.y-A.y)<=h&&!c[$]){c[$]=!0,S.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class ls{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Si{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const s=Math.round((e-this.lng)/360);if(s!==0)for(const c in this.indexes){const h=this.indexes[c],m={};for(const S in h){const k=h[S];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+s),m[k.tileID.key]=k}this.indexes[c]=m}this.lng=e}addBucket(e,s,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<s.symbolInstances.length;m++)s.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const S=this.indexes[m];if(Number(m)>e.overscaledZ)for(const k in S){const A=S[k];A.tileID.isChildOf(e)&&A.findMatches(s.symbolInstances,e,h)}else{const k=S[e.scaledTo(Number(m)).key];k&&k.findMatches(s.symbolInstances,e,h)}}for(let m=0;m<s.symbolInstances.length;m++){const S=s.symbolInstances.get(m);S.crossTileID||(S.crossTileID=c.generate(),h[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Mn(e,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(e,s){for(const c of s.getCrossTileIDsLists())for(const h of c)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let s=!1;for(const c in this.indexes){const h=this.indexes[c];for(const m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,h[m]),delete h[m],s=!0)}return s}}class Ns{constructor(){this.layerIndexes={},this.crossTileIDs=new ls,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,s,c){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Si);let m=!1;const S={};h.handleWrapJump(c);for(const k of s){const A=k.getBucket(e);A&&e.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(k.tileID,A,this.crossTileIDs)&&(m=!0),S[A.bucketInstanceId]=!0)}return h.removeStaleBuckets(S)&&(m=!0),m}pruneUnusedLayers(e){const s={};e.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}const pi=(g,e)=>u.t(g,e&&e.filter(s=>s.identifier!=="source.canvas")),R=u.aw();class Y extends u.E{constructor(e,s={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const h=this.sourceCaches[c].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new Cr(Kt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,h)=>this.getGlyphs(c,h)),this.dispatcher.registerMessageHandler("GI",(c,h)=>this.getImages(c,h)),this.imageManager=new Je,this.imageManager.setEventedParent(this),this.glyphManager=new Ae(e._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Ct(256,512),this.crossTileSymbolIndex=new Ns,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.ay()),wn().on(vt,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const h=this.sourceCaches[c.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const S in this._layers){const k=this._layers[S];k.source===m.id&&this._validateLayer(k)}})}loadURL(e,s={},c){this.fire(new u.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;u.h(h,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,s,c)}).catch(S=>{this._loadStyleRequest=null,S&&!m.signal.aborted&&this.fire(new u.j(S))})}loadJSON(e,s={},c){this.fire(new u.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(e,s,c)}).catch(()=>{})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(R,{validate:!1})}_load(e,s,c){var h;const m=s.transformStyle?s.transformStyle(c,e):e;if(!s.validate||!pi(this,u.u(m))){this._loaded=!0,this.stylesheet=m;for(const S in m.sources)this.addSource(S,m.sources[S],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new ht(this.stylesheet.light),this.sky=new _e(this.stylesheet.sky),this.map.setTerrain((h=this.stylesheet.terrain)!==null&&h!==void 0?h:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const e=u.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of e){const c=u.aA(s);c.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=c}}_loadSprite(e,s=!1,c=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,S,k,A){return u._(this,void 0,void 0,function*(){const F=ot(m),H=k>1?"@2x":"",$={},ne={};for(const{id:de,url:me}of F){const be=S.transformRequest(At(me,H,".json"),"SpriteJSON");$[de]=u.h(be,A);const Ie=S.transformRequest(At(me,H,".png"),"SpriteImage");ne[de]=ge.getImage(Ie,A)}return yield Promise.all([...Object.values($),...Object.values(ne)]),function(de,me){return u._(this,void 0,void 0,function*(){const be={};for(const Ie in de){be[Ie]={};const ze=j.getImageCanvasContext((yield me[Ie]).data),Be=(yield de[Ie]).data;for(const ke in Be){const{width:Ge,height:Xe,x:it,y:kt,sdf:Bt,pixelRatio:$t,stretchX:Qt,stretchY:Gt,content:Vt,textFitWidth:ur,textFitHeight:Fr}=Be[ke];be[Ie][ke]={data:null,pixelRatio:$t,sdf:Bt,stretchX:Qt,stretchY:Gt,content:Vt,textFitWidth:ur,textFitHeight:Fr,spriteData:{width:Ge,height:Xe,x:it,y:kt,context:ze}}}}return be})}($,ne)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const S in m){this._spritesImagesIds[S]=[];const k=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(A=>!(A in m)):[];for(const A of k)this.imageManager.removeImage(A),this._changedImages[A]=!0;for(const A in m[S]){const F=S==="default"?A:`${S}:${A}`;this._spritesImagesIds[S].push(F),F in this.imageManager.images?this.imageManager.updateImage(F,m[S][A],!1):this.imageManager.addImage(F,m[S][A]),s&&(this._changedImages[F]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new u.j(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),c&&c(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(e){const s=this.sourceCaches[e.source];if(!s)return;const c=e.sourceLayer;if(!c)return;const h=s.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.j(new Error(`Source layer "${c}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,s=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(s?u.aB(c):c);const h=[];for(const m of e)if(c[m]){const S=s?u.aB(c[m]):c[m];h.push(S)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const s=Object.keys(this._layers);for(const c of s){const h=this._layers[c];h.type!=="custom"&&(e[c]=h.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const s=this._changed;if(s){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const S in this._updatedSources){const k=this._updatedSources[S];if(k==="reload")this._reloadSource(S);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];c[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in c){const m=this.sourceCaches[h];!!c[h]!=!!m.used&&m.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,s&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,s={}){var c;this._checkLoaded();const h=this.serialize();if(e=s.transformStyle?s.transformStyle(h,e):e,((c=s.validate)===null||c===void 0||c)&&pi(this,u.u(e)))return!1;(e=u.aB(e)).layers=u.az(e.layers);const m=u.aC(h,e),S=this._getOperationsToPerform(m);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const k of S.operations)k();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const s=[],c=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":s.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":s.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,h.args));break;case"setSky":s.push(()=>this.setSky.apply(this,h.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setTransition":s.push(()=>{});break;default:c.push(h.command)}return{operations:s,unimplemented:c}}addImage(e,s){if(this.getImage(e))return this.fire(new u.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,s),this._afterImageUpdated(e)}updateImage(e,s){this.imageManager.updateImage(e,s)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new u.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,s,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.u.source,`sources.${e}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const h=this.sourceCaches[e]=new wr(e,s,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new u.j(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],s.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,s){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,s,c={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new u.j(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(pi(this,u.aD(e)))return;m=u.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=u.aB(e),e=u.e(e,{source:h})),this._validate(u.u.layer,`layers.${h}`,e,{arrayIndex:-1},c))return;m=u.aA(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const S=s?this._order.indexOf(s):this._order.length;if(s&&S===-1)this.fire(new u.j(new Error(`Cannot add layer "${h}" before non-existing layer "${s}".`)));else{if(this._order.splice(S,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const k=this._removedLayers[h];delete this._removedLayers[h],k.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,s){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new u.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===s)return;const c=this._order.indexOf(e);this._order.splice(c,1);const h=s?this._order.indexOf(s):this._order.length;s&&h===-1?this.fire(new u.j(new Error(`Cannot move layer "${e}" before non-existing layer "${s}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const s=this._layers[e];if(!s)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${e}".`)));s.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=s,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],s.onRemove&&s.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,s,c){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===s&&h.maxzoom===c||(s!=null&&(h.minzoom=s),c!=null&&(h.maxzoom=c),this._updateLayer(h)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,s,c={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!u.aE(h.filter,s))return s==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(u.u.filter,`layers.${h.id}.filter`,s,null,c)||(h.filter=u.aB(s),this._updateLayer(h)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return u.aB(this.getLayer(e).filter)}setLayoutProperty(e,s,c,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.aE(m.getLayoutProperty(s),c)||(m.setLayoutProperty(s,c,h),this._updateLayer(m)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,s){const c=this.getLayer(e);if(c)return c.getLayoutProperty(s);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,s,c,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.aE(m.getPaintProperty(s),c)||(m.setPaintProperty(s,c,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new u.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,s){return this.getLayer(e).getPaintProperty(s)}setFeatureState(e,s){this._checkLoaded();const c=e.source,h=e.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new u.j(new Error(`The source '${c}' does not exist in the map's style.`)));const S=m.getSource().type;S==="geojson"&&h?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||h?(e.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,s)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,s){this._checkLoaded();const c=e.source,h=this.sourceCaches[c];if(h===void 0)return void this.fire(new u.j(new Error(`The source '${c}' does not exist in the map's style.`)));const m=h.getSource().type,S=m==="vector"?e.sourceLayer:void 0;m!=="vector"||S?s&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(S,e.id,s):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const s=e.source,c=e.sourceLayer,h=this.sourceCaches[s];if(h!==void 0)return h.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),h.getFeatureState(c,e.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=u.aF(this.sourceCaches,m=>m.serialize()),s=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,h=this.stylesheet;return u.aG({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,sources:e,layers:s,terrain:c},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const s=S=>this._layers[S].type==="fill-extrusion",c={},h=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(s(k)){c[k]=S;for(const A of e){const F=A[k];if(F)for(const H of F)h.push(H)}}}h.sort((S,k)=>k.intersectionZ-S.intersectionZ);const m=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(s(k))for(let A=h.length-1;A>=0;A--){const F=h[A].feature;if(c[F.layer.id]<S)break;m.push(F),h.pop()}else for(const A of e){const F=A[k];if(F)for(const H of F)m.push(H.feature)}}return m}queryRenderedFeatures(e,s,c){s&&s.filter&&this._validate(u.u.filter,"queryRenderedFeatures.filter",s.filter,null,s);const h={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const k of s.layers){const A=this._layers[k];if(!A)return this.fire(new u.j(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];h[A.source]=!0}}const m=[];s.availableImages=this._availableImages;const S=this._serializedAllLayers();for(const k in this.sourceCaches)s.layers&&!h[k]||m.push(Zr(this.sourceCaches[k],this._layers,S,e,s,c));return this.placement&&m.push(function(k,A,F,H,$,ne,de){const me={},be=ne.queryRenderedSymbols(H),Ie=[];for(const ze of Object.keys(be).map(Number))Ie.push(de[ze]);Ie.sort(W);for(const ze of Ie){const Be=ze.featureIndex.lookupSymbolFeatures(be[ze.bucketInstanceId],A,ze.bucketIndex,ze.sourceLayerIndex,$.filter,$.layers,$.availableImages,k);for(const ke in Be){const Ge=me[ke]=me[ke]||[],Xe=Be[ke];Xe.sort((it,kt)=>{const Bt=ze.featureSortOrder;if(Bt){const $t=Bt.indexOf(it.featureIndex);return Bt.indexOf(kt.featureIndex)-$t}return kt.featureIndex-it.featureIndex});for(const it of Xe)Ge.push(it)}}for(const ze in me)me[ze].forEach(Be=>{const ke=Be.feature,Ge=F[k[ze].source].getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=Ge});return me}(this._layers,S,this.sourceCaches,e,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,s){s&&s.filter&&this._validate(u.u.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[e];return c?function(h,m){const S=h.getRenderableIds().map(F=>h.getTileByID(F)),k=[],A={};for(let F=0;F<S.length;F++){const H=S[F],$=H.tileID.canonical.key;A[$]||(A[$]=!0,H.querySourceFeatures(k,m))}return k}(c,s):[]}getLight(){return this.light.getLight()}setLight(e,s={}){this._checkLoaded();const c=this.light.getLight();let h=!1;for(const S in e)if(!u.aE(e[S],c[S])){h=!0;break}if(!h)return;const m={now:j.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,s),this.light.updateTransitions(m)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,s={}){const c=this.getSky();let h=!1;if(!e&&!c)return;if(e&&!c)h=!0;else if(!e&&c)h=!0;else for(const S in e)if(!u.aE(e[S],c[S])){h=!0;break}if(!h)return;const m={now:j.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,s),this.sky.updateTransitions(m)}_validate(e,s,c,h,m={}){return(!m||m.validate!==!1)&&pi(this,e.call(u.u,u.e({key:s,style:this.serialize(),value:c,styleSpec:u.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),wn().off(vt,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const c=this.sourceCaches[s];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const s in this.sourceCaches)this.sourceCaches[s].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,s,c,h,m=!1){let S=!1,k=!1;const A={};for(const F of this._order){const H=this._layers[F];if(H.type!=="symbol")continue;if(!A[H.source]){const ne=this.sourceCaches[H.source];A[H.source]=ne.getRenderableIds(!0).map(de=>ne.getTileByID(de)).sort((de,me)=>me.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(me.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(H,A[H.source],e.center.lng);S=S||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(j.now(),e.zoom))&&(this.pauseablePlacement=new lo(e,this.map.terrain,this._order,m,s,c,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(j.now()),k=!0),S&&this.pauseablePlacement.placement.setStale()),k||S)for(const F of this._order){const H=this._layers[F];H.type==="symbol"&&this.placement.updateLayerOpacities(H,A[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(j.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,s){return u._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[s.source];return h&&h.setDependencies(s.tileID.key,s.type,s.icons),c})}getGlyphs(e,s){return u._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(s.stacks),h=this.sourceCaches[s.source];return h&&h.setDependencies(s.tileID.key,s.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,s={}){this._checkLoaded(),e&&this._validate(u.u.glyphs,"glyphs",e,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,s,c={},h){this._checkLoaded();const m=[{id:e,url:s}],S=[...ot(this.stylesheet.sprite),...m];this._validate(u.u.sprite,"sprite",S,null,c)||(this.stylesheet.sprite=S,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();const s=ot(this.stylesheet.sprite);if(s.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;s.splice(s.findIndex(c=>c.id===e),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ot(this.stylesheet.sprite)}setSprite(e,s={},c){this._checkLoaded(),e&&this._validate(u.u.sprite,"sprite",e,null,s)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var he=u.Y([{name:"a_pos",type:"Int16",components:2}]);const Ee={prelude:Ye(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ye(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ye(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ye(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ye("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ye(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ye(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ye("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ye("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ye("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ye(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ye(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ye(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ye(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ye(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ye(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ye(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ye(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ye(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ye(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ye(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ye(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ye(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ye(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ye(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ye(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ye("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ye("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ye("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Ye("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ye(g,e){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/attribute ([\w]+) ([\w]+)/g),h=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=m?m.concat(h):h,k={};return{fragmentSource:g=g.replace(s,(A,F,H,$,ne)=>(k[ne]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
varying ${H} ${$} ${ne};
#else
uniform ${H} ${$} u_${ne};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ne}
    ${H} ${$} ${ne} = u_${ne};
#endif
`)),vertexSource:e=e.replace(s,(A,F,H,$,ne)=>{const de=$==="float"?"vec2":"vec4",me=ne.match(/color/)?"color":de;return k[ne]?F==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
attribute ${H} ${de} a_${ne};
varying ${H} ${$} ${ne};
#else
uniform ${H} ${$} u_${ne};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = a_${ne};
#else
    ${H} ${$} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = unpack_mix_${me}(a_${ne}, u_${ne}_t);
#else
    ${H} ${$} ${ne} = u_${ne};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
attribute ${H} ${de} a_${ne};
#else
uniform ${H} ${$} u_${ne};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${H} ${$} ${ne} = a_${ne};
#else
    ${H} ${$} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${H} ${$} ${ne} = unpack_mix_${me}(a_${ne}, u_${ne}_t);
#else
    ${H} ${$} ${ne} = u_${ne};
#endif
`}),staticAttributes:c,staticUniforms:S}}class st{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,s,c,h,m,S,k,A,F){this.context=e;let H=this.boundPaintVertexBuffers.length!==h.length;for(let $=0;!H&&$<h.length;$++)this.boundPaintVertexBuffers[$]!==h[$]&&(H=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==c||H||this.boundIndexBuffer!==m||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==F?this.freshBind(s,c,h,m,S,k,A,F):(e.bindVertexArray.set(this.vao),k&&k.bind(),m&&m.dynamicDraw&&m.bind(),A&&A.bind(),F&&F.bind())}freshBind(e,s,c,h,m,S,k,A){const F=e.numAttributes,H=this.context,$=H.gl;this.vao&&this.destroy(),this.vao=H.createVertexArray(),H.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=A,s.enableAttributes($,e);for(const ne of c)ne.enableAttributes($,e);S&&S.enableAttributes($,e),k&&k.enableAttributes($,e),A&&A.enableAttributes($,e),s.bind(),s.setVertexAttribPointers($,e,m);for(const ne of c)ne.bind(),ne.setVertexAttribPointers($,e,m);S&&(S.bind(),S.setVertexAttribPointers($,e,m)),h&&h.bind(),k&&(k.bind(),k.setVertexAttribPointers($,e,m)),A&&(A.bind(),A.setVertexAttribPointers($,e,m)),H.currentNumAttributes=F}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Et=(g,e,s,c,h)=>({u_matrix:g,u_texture:0,u_ele_delta:e,u_fog_matrix:s,u_fog_color:c?c.properties.get("fog-color"):u.aM.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:c?c.calculateFogBlendOpacity(h):0,u_horizon_color:c?c.properties.get("horizon-color"):u.aM.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1});function Ht(g){const e=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const c=g[s].split(" ");e.push(c.pop())}return e}class Jt{constructor(e,s,c,h,m,S){const k=e.gl;this.program=k.createProgram();const A=Ht(s.staticAttributes),F=c?c.getBinderAttributes():[],H=A.concat(F),$=Ee.prelude.staticUniforms?Ht(Ee.prelude.staticUniforms):[],ne=s.staticUniforms?Ht(s.staticUniforms):[],de=c?c.getBinderUniforms():[],me=$.concat(ne).concat(de),be=[];for(const it of me)be.indexOf(it)<0&&be.push(it);const Ie=c?c.defines():[];m&&Ie.push("#define OVERDRAW_INSPECTOR;"),S&&Ie.push("#define TERRAIN3D;");const ze=Ie.concat(Ee.prelude.fragmentSource,s.fragmentSource).join(`
`),Be=Ie.concat(Ee.prelude.vertexSource,s.vertexSource).join(`
`),ke=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ke,ze),k.compileShader(ke),!k.getShaderParameter(ke,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(ke)}`);k.attachShader(this.program,ke);const Ge=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Ge,Be),k.compileShader(Ge),!k.getShaderParameter(Ge,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Ge)}`);k.attachShader(this.program,Ge),this.attributes={};const Xe={};this.numAttributes=H.length;for(let it=0;it<this.numAttributes;it++)H[it]&&(k.bindAttribLocation(this.program,it,H[it]),this.attributes[H[it]]=it);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Ge),k.deleteShader(ke);for(let it=0;it<be.length;it++){const kt=be[it];if(kt&&!Xe[kt]){const Bt=k.getUniformLocation(this.program,kt);Bt&&(Xe[kt]=Bt)}}this.fixedUniforms=h(e,Xe),this.terrainUniforms=((it,kt)=>({u_depth:new u.aH(it,kt.u_depth),u_terrain:new u.aH(it,kt.u_terrain),u_terrain_dim:new u.aI(it,kt.u_terrain_dim),u_terrain_matrix:new u.aJ(it,kt.u_terrain_matrix),u_terrain_unpack:new u.aK(it,kt.u_terrain_unpack),u_terrain_exaggeration:new u.aI(it,kt.u_terrain_exaggeration)}))(e,Xe),this.binderUniforms=c?c.getUniforms(e,Xe):[]}draw(e,s,c,h,m,S,k,A,F,H,$,ne,de,me,be,Ie,ze,Be){const ke=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(S),A){e.activeTexture.set(ke.TEXTURE2),ke.bindTexture(ke.TEXTURE_2D,A.depthTexture),e.activeTexture.set(ke.TEXTURE3),ke.bindTexture(ke.TEXTURE_2D,A.texture);for(const Xe in this.terrainUniforms)this.terrainUniforms[Xe].set(A[Xe])}for(const Xe in this.fixedUniforms)this.fixedUniforms[Xe].set(k[Xe]);be&&be.setUniforms(e,this.binderUniforms,de,{zoom:me});let Ge=0;switch(s){case ke.LINES:Ge=2;break;case ke.TRIANGLES:Ge=3;break;case ke.LINE_STRIP:Ge=1}for(const Xe of ne.get()){const it=Xe.vaos||(Xe.vaos={});(it[F]||(it[F]=new st)).bind(e,this,H,be?be.getPaintVertexBuffers():[],$,Xe.vertexOffset,Ie,ze,Be),ke.drawElements(s,Xe.primitiveLength*Ge,ke.UNSIGNED_SHORT,Xe.primitiveOffset*Ge*2)}}}function Rr(g,e,s){const c=1/Ur(s,1,e.transform.tileZoom),h=Math.pow(2,s.tileID.overscaledZ),m=s.tileSize*Math.pow(2,e.transform.tileZoom)/h,S=m*(s.tileID.canonical.x+s.tileID.wrap*h),k=m*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}const Vr=(g,e,s,c)=>{const h=e.style.light,m=h.properties.get("position"),S=[m.x,m.y,m.z],k=function(){var F=new u.A(9);return u.A!=Float32Array&&(F[1]=0,F[2]=0,F[3]=0,F[5]=0,F[6]=0,F[7]=0),F[0]=1,F[4]=1,F[8]=1,F}();h.properties.get("anchor")==="viewport"&&function(F,H){var $=Math.sin(H),ne=Math.cos(H);F[0]=ne,F[1]=$,F[2]=0,F[3]=-$,F[4]=ne,F[5]=0,F[6]=0,F[7]=0,F[8]=1}(k,-e.transform.angle),function(F,H,$){var ne=H[0],de=H[1],me=H[2];F[0]=ne*$[0]+de*$[3]+me*$[6],F[1]=ne*$[1]+de*$[4]+me*$[7],F[2]=ne*$[2]+de*$[5]+me*$[8]}(S,S,k);const A=h.properties.get("color");return{u_matrix:g,u_lightpos:S,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+s,u_opacity:c}},fn=(g,e,s,c,h,m,S)=>u.e(Vr(g,e,s,c),Rr(m,e,S),{u_height_factor:-Math.pow(2,h.overscaledZ)/S.tileSize/8}),Ei=g=>({u_matrix:g}),es=(g,e,s,c)=>u.e(Ei(g),Rr(s,e,c)),Vi=(g,e)=>({u_matrix:g,u_world:e}),js=(g,e,s,c,h)=>u.e(es(g,e,s,c),{u_world:h}),us=(g,e,s,c)=>{const h=g.transform;let m,S;if(c.paint.get("circle-pitch-alignment")==="map"){const k=Ur(s,1,h.zoom);m=!0,S=[k,k]}else m=!1,S=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(e.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:S}},mi=(g,e,s)=>({u_matrix:g,u_inv_matrix:e,u_camera_to_center_distance:s.cameraToCenterDistance,u_viewport_size:[s.width,s.height]}),gi=(g,e,s=1)=>({u_matrix:g,u_color:e,u_overlay:0,u_overlay_scale:s}),On=g=>({u_matrix:g}),zn=(g,e,s,c)=>({u_matrix:g,u_extrude_scale:Ur(e,1,s),u_intensity:c}),ks=(g,e,s,c)=>{const h=u.H();u.aP(h,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:s,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}};function Cs(g,e){const s=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new u.Z(0,c/s).toLngLat().lat,new u.Z(0,(c+1)/s).toLngLat().lat]}const ml=(g,e,s,c)=>{const h=g.transform;return{u_matrix:qo(g,e,s,c),u_ratio:1/Ur(e,1,h.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Ql=(g,e,s,c,h)=>u.e(ml(g,e,s,h),{u_image:0,u_image_height:c}),Us=(g,e,s,c,h)=>{const m=g.transform,S=Is(e,m);return{u_matrix:qo(g,e,s,h),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Ur(e,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[S,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},ac=(g,e,s,c,h,m)=>{const S=g.lineAtlas,k=Is(e,g.transform),A=s.layout.get("line-cap")==="round",F=S.getDash(c.from,A),H=S.getDash(c.to,A),$=F.width*h.fromScale,ne=H.width*h.toScale;return u.e(ml(g,e,s,m),{u_patternscale_a:[k/$,-F.height/2],u_patternscale_b:[k/ne,-H.height/2],u_sdfgamma:S.width/(256*Math.min($,ne)*g.pixelRatio)/2,u_image:0,u_tex_y_a:F.y,u_tex_y_b:H.y,u_mix:h.t})};function Is(g,e){return 1/Ur(g,1,e.tileZoom)}function qo(g,e,s,c){return g.translatePosMatrix(c?c.posMatrix:e.tileID.posMatrix,e,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const $a=(g,e,s,c,h)=>{return{u_matrix:g,u_tl_parent:e,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(S=h.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(m=h.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Tn(h.paint.get("raster-hue-rotate"))};var m,S};function Tn(g){g*=Math.PI/180;const e=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*e-s+1)/3,(Math.sqrt(3)*e-s+1)/3]}const Vs=(g,e,s,c,h,m,S,k,A,F,H,$,ne,de)=>{const me=S.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_pitch:me.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:me.width/me.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:A,u_coord_matrix:F,u_is_text:+$,u_pitch_with_map:+c,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:ne,u_texture:0,u_translation:H,u_pitched_scale:de}},cs=(g,e,s,c,h,m,S,k,A,F,H,$,ne,de,me)=>{const be=S.transform;return u.e(Vs(g,e,s,c,h,m,S,k,A,F,H,$,ne,me),{u_gamma_scale:c?Math.cos(be._pitch)*be.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},hs=(g,e,s,c,h,m,S,k,A,F,H,$,ne,de)=>u.e(cs(g,e,s,c,h,m,S,k,A,F,H,!0,$,!0,de),{u_texsize_icon:ne,u_texture_icon:1}),Hi=(g,e,s)=>({u_matrix:g,u_opacity:e,u_color:s}),wa=(g,e,s,c,h,m)=>u.e(function(S,k,A,F){const H=A.imageManager.getPattern(S.from.toString()),$=A.imageManager.getPattern(S.to.toString()),{width:ne,height:de}=A.imageManager.getPixelSize(),me=Math.pow(2,F.tileID.overscaledZ),be=F.tileSize*Math.pow(2,A.transform.tileZoom)/me,Ie=be*(F.tileID.canonical.x+F.tileID.wrap*me),ze=be*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:H.tl,u_pattern_br_a:H.br,u_pattern_tl_b:$.tl,u_pattern_br_b:$.br,u_texsize:[ne,de],u_mix:k.t,u_pattern_size_a:H.displaySize,u_pattern_size_b:$.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/Ur(F,1,A.transform.tileZoom),u_pixel_coord_upper:[Ie>>16,ze>>16],u_pixel_coord_lower:[65535&Ie,65535&ze]}}(c,m,s,h),{u_matrix:g,u_opacity:e}),uo={fillExtrusion:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_lightpos:new u.aN(g,e.u_lightpos),u_lightintensity:new u.aI(g,e.u_lightintensity),u_lightcolor:new u.aN(g,e.u_lightcolor),u_vertical_gradient:new u.aI(g,e.u_vertical_gradient),u_opacity:new u.aI(g,e.u_opacity)}),fillExtrusionPattern:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_lightpos:new u.aN(g,e.u_lightpos),u_lightintensity:new u.aI(g,e.u_lightintensity),u_lightcolor:new u.aN(g,e.u_lightcolor),u_vertical_gradient:new u.aI(g,e.u_vertical_gradient),u_height_factor:new u.aI(g,e.u_height_factor),u_image:new u.aH(g,e.u_image),u_texsize:new u.aO(g,e.u_texsize),u_pixel_coord_upper:new u.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,e.u_pixel_coord_lower),u_scale:new u.aN(g,e.u_scale),u_fade:new u.aI(g,e.u_fade),u_opacity:new u.aI(g,e.u_opacity)}),fill:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix)}),fillPattern:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_image:new u.aH(g,e.u_image),u_texsize:new u.aO(g,e.u_texsize),u_pixel_coord_upper:new u.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,e.u_pixel_coord_lower),u_scale:new u.aN(g,e.u_scale),u_fade:new u.aI(g,e.u_fade)}),fillOutline:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_world:new u.aO(g,e.u_world)}),fillOutlinePattern:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_world:new u.aO(g,e.u_world),u_image:new u.aH(g,e.u_image),u_texsize:new u.aO(g,e.u_texsize),u_pixel_coord_upper:new u.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,e.u_pixel_coord_lower),u_scale:new u.aN(g,e.u_scale),u_fade:new u.aI(g,e.u_fade)}),circle:(g,e)=>({u_camera_to_center_distance:new u.aI(g,e.u_camera_to_center_distance),u_scale_with_map:new u.aH(g,e.u_scale_with_map),u_pitch_with_map:new u.aH(g,e.u_pitch_with_map),u_extrude_scale:new u.aO(g,e.u_extrude_scale),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_matrix:new u.aJ(g,e.u_matrix)}),collisionBox:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_pixel_extrude_scale:new u.aO(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_inv_matrix:new u.aJ(g,e.u_inv_matrix),u_camera_to_center_distance:new u.aI(g,e.u_camera_to_center_distance),u_viewport_size:new u.aO(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new u.aL(g,e.u_color),u_matrix:new u.aJ(g,e.u_matrix),u_overlay:new u.aH(g,e.u_overlay),u_overlay_scale:new u.aI(g,e.u_overlay_scale)}),clippingMask:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix)}),heatmap:(g,e)=>({u_extrude_scale:new u.aI(g,e.u_extrude_scale),u_intensity:new u.aI(g,e.u_intensity),u_matrix:new u.aJ(g,e.u_matrix)}),heatmapTexture:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_world:new u.aO(g,e.u_world),u_image:new u.aH(g,e.u_image),u_color_ramp:new u.aH(g,e.u_color_ramp),u_opacity:new u.aI(g,e.u_opacity)}),hillshade:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_image:new u.aH(g,e.u_image),u_latrange:new u.aO(g,e.u_latrange),u_light:new u.aO(g,e.u_light),u_shadow:new u.aL(g,e.u_shadow),u_highlight:new u.aL(g,e.u_highlight),u_accent:new u.aL(g,e.u_accent)}),hillshadePrepare:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_image:new u.aH(g,e.u_image),u_dimension:new u.aO(g,e.u_dimension),u_zoom:new u.aI(g,e.u_zoom),u_unpack:new u.aK(g,e.u_unpack)}),line:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_ratio:new u.aI(g,e.u_ratio),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_ratio:new u.aI(g,e.u_ratio),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,e.u_units_to_pixels),u_image:new u.aH(g,e.u_image),u_image_height:new u.aI(g,e.u_image_height)}),linePattern:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_texsize:new u.aO(g,e.u_texsize),u_ratio:new u.aI(g,e.u_ratio),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_image:new u.aH(g,e.u_image),u_units_to_pixels:new u.aO(g,e.u_units_to_pixels),u_scale:new u.aN(g,e.u_scale),u_fade:new u.aI(g,e.u_fade)}),lineSDF:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_ratio:new u.aI(g,e.u_ratio),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,e.u_units_to_pixels),u_patternscale_a:new u.aO(g,e.u_patternscale_a),u_patternscale_b:new u.aO(g,e.u_patternscale_b),u_sdfgamma:new u.aI(g,e.u_sdfgamma),u_image:new u.aH(g,e.u_image),u_tex_y_a:new u.aI(g,e.u_tex_y_a),u_tex_y_b:new u.aI(g,e.u_tex_y_b),u_mix:new u.aI(g,e.u_mix)}),raster:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_tl_parent:new u.aO(g,e.u_tl_parent),u_scale_parent:new u.aI(g,e.u_scale_parent),u_buffer_scale:new u.aI(g,e.u_buffer_scale),u_fade_t:new u.aI(g,e.u_fade_t),u_opacity:new u.aI(g,e.u_opacity),u_image0:new u.aH(g,e.u_image0),u_image1:new u.aH(g,e.u_image1),u_brightness_low:new u.aI(g,e.u_brightness_low),u_brightness_high:new u.aI(g,e.u_brightness_high),u_saturation_factor:new u.aI(g,e.u_saturation_factor),u_contrast_factor:new u.aI(g,e.u_contrast_factor),u_spin_weights:new u.aN(g,e.u_spin_weights)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new u.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,e.u_is_size_feature_constant),u_size_t:new u.aI(g,e.u_size_t),u_size:new u.aI(g,e.u_size),u_camera_to_center_distance:new u.aI(g,e.u_camera_to_center_distance),u_pitch:new u.aI(g,e.u_pitch),u_rotate_symbol:new u.aH(g,e.u_rotate_symbol),u_aspect_ratio:new u.aI(g,e.u_aspect_ratio),u_fade_change:new u.aI(g,e.u_fade_change),u_matrix:new u.aJ(g,e.u_matrix),u_label_plane_matrix:new u.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,e.u_coord_matrix),u_is_text:new u.aH(g,e.u_is_text),u_pitch_with_map:new u.aH(g,e.u_pitch_with_map),u_is_along_line:new u.aH(g,e.u_is_along_line),u_is_variable_anchor:new u.aH(g,e.u_is_variable_anchor),u_texsize:new u.aO(g,e.u_texsize),u_texture:new u.aH(g,e.u_texture),u_translation:new u.aO(g,e.u_translation),u_pitched_scale:new u.aI(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new u.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,e.u_is_size_feature_constant),u_size_t:new u.aI(g,e.u_size_t),u_size:new u.aI(g,e.u_size),u_camera_to_center_distance:new u.aI(g,e.u_camera_to_center_distance),u_pitch:new u.aI(g,e.u_pitch),u_rotate_symbol:new u.aH(g,e.u_rotate_symbol),u_aspect_ratio:new u.aI(g,e.u_aspect_ratio),u_fade_change:new u.aI(g,e.u_fade_change),u_matrix:new u.aJ(g,e.u_matrix),u_label_plane_matrix:new u.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,e.u_coord_matrix),u_is_text:new u.aH(g,e.u_is_text),u_pitch_with_map:new u.aH(g,e.u_pitch_with_map),u_is_along_line:new u.aH(g,e.u_is_along_line),u_is_variable_anchor:new u.aH(g,e.u_is_variable_anchor),u_texsize:new u.aO(g,e.u_texsize),u_texture:new u.aH(g,e.u_texture),u_gamma_scale:new u.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_is_halo:new u.aH(g,e.u_is_halo),u_translation:new u.aO(g,e.u_translation),u_pitched_scale:new u.aI(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new u.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,e.u_is_size_feature_constant),u_size_t:new u.aI(g,e.u_size_t),u_size:new u.aI(g,e.u_size),u_camera_to_center_distance:new u.aI(g,e.u_camera_to_center_distance),u_pitch:new u.aI(g,e.u_pitch),u_rotate_symbol:new u.aH(g,e.u_rotate_symbol),u_aspect_ratio:new u.aI(g,e.u_aspect_ratio),u_fade_change:new u.aI(g,e.u_fade_change),u_matrix:new u.aJ(g,e.u_matrix),u_label_plane_matrix:new u.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,e.u_coord_matrix),u_is_text:new u.aH(g,e.u_is_text),u_pitch_with_map:new u.aH(g,e.u_pitch_with_map),u_is_along_line:new u.aH(g,e.u_is_along_line),u_is_variable_anchor:new u.aH(g,e.u_is_variable_anchor),u_texsize:new u.aO(g,e.u_texsize),u_texsize_icon:new u.aO(g,e.u_texsize_icon),u_texture:new u.aH(g,e.u_texture),u_texture_icon:new u.aH(g,e.u_texture_icon),u_gamma_scale:new u.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new u.aI(g,e.u_device_pixel_ratio),u_is_halo:new u.aH(g,e.u_is_halo),u_translation:new u.aO(g,e.u_translation),u_pitched_scale:new u.aI(g,e.u_pitched_scale)}),background:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_opacity:new u.aI(g,e.u_opacity),u_color:new u.aL(g,e.u_color)}),backgroundPattern:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_opacity:new u.aI(g,e.u_opacity),u_image:new u.aH(g,e.u_image),u_pattern_tl_a:new u.aO(g,e.u_pattern_tl_a),u_pattern_br_a:new u.aO(g,e.u_pattern_br_a),u_pattern_tl_b:new u.aO(g,e.u_pattern_tl_b),u_pattern_br_b:new u.aO(g,e.u_pattern_br_b),u_texsize:new u.aO(g,e.u_texsize),u_mix:new u.aI(g,e.u_mix),u_pattern_size_a:new u.aO(g,e.u_pattern_size_a),u_pattern_size_b:new u.aO(g,e.u_pattern_size_b),u_scale_a:new u.aI(g,e.u_scale_a),u_scale_b:new u.aI(g,e.u_scale_b),u_pixel_coord_upper:new u.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aI(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_texture:new u.aH(g,e.u_texture),u_ele_delta:new u.aI(g,e.u_ele_delta),u_fog_matrix:new u.aJ(g,e.u_fog_matrix),u_fog_color:new u.aL(g,e.u_fog_color),u_fog_ground_blend:new u.aI(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.aI(g,e.u_fog_ground_blend_opacity),u_horizon_color:new u.aL(g,e.u_horizon_color),u_horizon_fog_blend:new u.aI(g,e.u_horizon_fog_blend)}),terrainDepth:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_ele_delta:new u.aI(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_matrix:new u.aJ(g,e.u_matrix),u_texture:new u.aH(g,e.u_texture),u_terrain_coords_id:new u.aI(g,e.u_terrain_coords_id),u_ele_delta:new u.aI(g,e.u_ele_delta)}),sky:(g,e)=>({u_sky_color:new u.aL(g,e.u_sky_color),u_horizon_color:new u.aL(g,e.u_horizon_color),u_horizon:new u.aI(g,e.u_horizon),u_sky_horizon_blend:new u.aI(g,e.u_sky_horizon_blend)})};class ts{constructor(e,s,c){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ba={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zo{constructor(e,s,c,h){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,s){for(let c=0;c<this.attributes.length;c++){const h=s.attributes[this.attributes[c].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,s,c){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],S=s.attributes[m.name];S!==void 0&&e.vertexAttribPointer(S,m.components,e[ba[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const co=new WeakMap;function Ai(g){var e;if(co.has(g))return co.get(g);{const s=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return co.set(g,s),s}}class sn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wo extends sn{getDefault(){return u.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Mu extends sn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class ds extends sn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Ga extends sn{getDefault(){return[!0,!0,!0,!0]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Sa extends sn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Li extends sn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Xo extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const s=this.current;(e.func!==s.func||e.ref!==s.ref||e.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class ho extends sn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ea extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=e,this.dirty=!1}}class gl extends sn{getDefault(){return[0,1]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ko extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=e,this.dirty=!1}}class Ro extends sn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class $i extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.BLEND):s.disable(s.BLEND),this.current=e,this.dirty=!1}}class Ta extends sn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class eu extends sn{getDefault(){return u.aM.transparent}set(e){const s=this.current;(e.r!==s.r||e.g!==s.g||e.b!==s.b||e.a!==s.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tu extends sn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Yo extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;e?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=e,this.dirty=!1}}class rs extends sn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Jo extends sn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ru extends sn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class lc extends sn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class nu extends sn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const s=this.current;(e[0]!==s[0]||e[1]!==s[1]||e[2]!==s[2]||e[3]!==s[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class qa extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class iu extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Za extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Wa extends sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Qo extends sn{getDefault(){return null}set(e){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Hs extends sn{getDefault(){return null}set(e){var s;if(e===this.current&&!this.dirty)return;const c=this.gl;Ai(c)?c.bindVertexArray(e):(s=c.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class yl extends sn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ka extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Xa extends sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Ka extends sn{constructor(e,s){super(e),this.context=e,this.parent=s}getDefault(){return null}}class D extends Ka{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class X extends Ka{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ce extends Ka{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Te{constructor(e,s,c,h,m){this.context=e,this.width=s,this.height=c;const S=e.gl,k=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new D(e,k),h)this.depthAttachment=m?new ce(e,k):new X(e,k);else if(m)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,s=this.colorAttachment.get();if(s&&e.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class tt{constructor(e,s,c){this.blendFunction=e,this.blendColor=s,this.mask=c}}tt.Replace=[1,0],tt.disabled=new tt(tt.Replace,u.aM.transparent,[!1,!1,!1,!1]),tt.unblended=new tt(tt.Replace,u.aM.transparent,[!0,!0,!0,!0]),tt.alphaBlended=new tt([1,771],u.aM.transparent,[!0,!0,!0,!0]);class at{constructor(e){var s,c;if(this.gl=e,this.clearColor=new Wo(this),this.clearDepth=new Mu(this),this.clearStencil=new ds(this),this.colorMask=new Ga(this),this.depthMask=new Sa(this),this.stencilMask=new Li(this),this.stencilFunc=new Xo(this),this.stencilOp=new ho(this),this.stencilTest=new Ea(this),this.depthRange=new gl(this),this.depthTest=new Ko(this),this.depthFunc=new Ro(this),this.blend=new $i(this),this.blendFunc=new Ta(this),this.blendColor=new eu(this),this.blendEquation=new tu(this),this.cullFace=new Yo(this),this.cullFaceSide=new rs(this),this.frontFace=new Jo(this),this.program=new ru(this),this.activeTexture=new lc(this),this.viewport=new nu(this),this.bindFramebuffer=new qa(this),this.bindRenderbuffer=new iu(this),this.bindTexture=new Za(this),this.bindVertexBuffer=new Wa(this),this.bindElementBuffer=new Qo(this),this.bindVertexArray=new Hs(this),this.pixelStoreUnpack=new yl(this),this.pixelStoreUnpackPremultiplyAlpha=new ka(this),this.pixelStoreUnpackFlipY=new Xa(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Ai(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=e.RGBA16F)!==null&&s!==void 0?s:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,s){return new ts(this,e,s)}createVertexBuffer(e,s,c){return new Zo(this,e,s,c)}createRenderbuffer(e,s,c){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,s,c),this.bindRenderbuffer.set(null),m}createFramebuffer(e,s,c,h){return new Te(this,e,s,c,h)}clear({color:e,depth:s,stencil:c}){const h=this.gl;let m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){u.aE(e.blendFunction,tt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Ai(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var s;return Ai(this.gl)?this.gl.deleteVertexArray(e):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class ct{constructor(e,s,c){this.func=e,this.mask=s,this.range=c}}ct.ReadOnly=!1,ct.ReadWrite=!0,ct.disabled=new ct(519,ct.ReadOnly,[0,1]);const Ut=7680;class ir{constructor(e,s,c,h,m,S){this.test=e,this.ref=s,this.mask=c,this.fail=h,this.depthFail=m,this.pass=S}}ir.disabled=new ir({func:519,mask:0},0,0,Ut,Ut,Ut);class hr{constructor(e,s,c){this.enable=e,this.mode=s,this.frontFace=c}}let Dr;function pn(g,e,s,c,h){const m=g.context,S=m.gl,k=g.useProgram("collisionBox"),A=[];let F=0,H=0;for(let ze=0;ze<c.length;ze++){const Be=c[ze],ke=e.getTile(Be).getBucket(s);if(!ke)continue;const Ge=h?ke.textCollisionBox:ke.iconCollisionBox,Xe=ke.collisionCircleArray;if(Xe.length>0){const it=u.H();u.aQ(it,ke.placementInvProjMatrix,g.transform.glCoordMatrix),u.aQ(it,it,ke.placementViewportMatrix),A.push({circleArray:Xe,circleOffset:H,transform:Be.posMatrix,invTransform:it,coord:Be}),F+=Xe.length/4,H=F}Ge&&k.draw(m,S.LINES,ct.disabled,ir.disabled,g.colorModeForRenderPass(),hr.disabled,{u_matrix:Be.posMatrix,u_pixel_extrude_scale:[1/($=g.transform).width,1/$.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(Be),s.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,g.transform.zoom,null,null,Ge.collisionVertexBuffer)}var $;if(!h||!A.length)return;const ne=g.useProgram("collisionCircle"),de=new u.aR;de.resize(4*F),de._trim();let me=0;for(const ze of A)for(let Be=0;Be<ze.circleArray.length/4;Be++){const ke=4*Be,Ge=ze.circleArray[ke+0],Xe=ze.circleArray[ke+1],it=ze.circleArray[ke+2],kt=ze.circleArray[ke+3];de.emplace(me++,Ge,Xe,it,kt,0),de.emplace(me++,Ge,Xe,it,kt,1),de.emplace(me++,Ge,Xe,it,kt,2),de.emplace(me++,Ge,Xe,it,kt,3)}(!Dr||Dr.length<2*F)&&(Dr=function(ze){const Be=2*ze,ke=new u.aT;ke.resize(Be),ke._trim();for(let Ge=0;Ge<Be;Ge++){const Xe=6*Ge;ke.uint16[Xe+0]=4*Ge+0,ke.uint16[Xe+1]=4*Ge+1,ke.uint16[Xe+2]=4*Ge+2,ke.uint16[Xe+3]=4*Ge+2,ke.uint16[Xe+4]=4*Ge+3,ke.uint16[Xe+5]=4*Ge+0}return ke}(F));const be=m.createIndexBuffer(Dr,!0),Ie=m.createVertexBuffer(de,u.aS.members,!0);for(const ze of A){const Be=mi(ze.transform,ze.invTransform,g.transform);ne.draw(m,S.TRIANGLES,ct.disabled,ir.disabled,g.colorModeForRenderPass(),hr.disabled,Be,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ze.coord),s.id,Ie,be,u.a0.simpleSegment(0,2*ze.circleOffset,ze.circleArray.length,ze.circleArray.length/2),null,g.transform.zoom,null,null,null)}Ie.destroy(),be.destroy()}hr.disabled=new hr(!1,1029,2305),hr.backCCW=new hr(!0,1029,2305);const yi=u.an(new Float32Array(16));function Gi(g,e,s,c,h,m){const{horizontalAlign:S,verticalAlign:k}=u.au(g);return new u.P((-(S-.5)*e/h+c[0])*m,(-(k-.5)*s/h+c[1])*m)}function _i(g,e,s,c,h,m){const S=e.tileAnchorPoint.add(new u.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let k=c.mult(m);s||(k=k.rotate(-h));const A=S.add(k);return Ce(A.x,A.y,e.labelPlaneMatrix,e.getElevation).point}if(s){const k=pt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),A=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return g.add(c.rotate(A))}return g.add(c)}function $s(g,e,s,c,h,m,S,k,A,F,H,$,ne,de){const me=g.text.placedSymbolArray,be=g.text.dynamicLayoutVertexArray,Ie=g.icon.dynamicLayoutVertexArray,ze={};be.clear();for(let Be=0;Be<me.length;Be++){const ke=me.get(Be),Ge=ke.hidden||!ke.crossTileID||g.allowVerticalPlacement&&!ke.placedOrientation?null:c[ke.crossTileID];if(Ge){const Xe=new u.P(ke.anchorX,ke.anchorY),it={getElevation:de,width:h.width,height:h.height,labelPlaneMatrix:m,pitchWithMap:s,projection:H,tileAnchorPoint:Xe,translation:$,unwrappedTileID:ne},kt=s?Ce(Xe.x,Xe.y,S,de):pt(Xe.x,Xe.y,it),Bt=ee(h.cameraToCenterDistance,kt.signedDistanceFromCamera);let $t=u.ai(g.textSizeData,A,ke)*Bt/u.ap;s&&($t*=g.tilePixelRatio/k);const{width:Qt,height:Gt,anchor:Vt,textOffset:ur,textBoxScale:Fr}=Ge,Zt=Gi(Vt,Qt,Gt,ur,Fr,$t),Xt=H.getPitchedTextCorrection(h,Xe.add(new u.P($[0],$[1])),ne),Lr=_i(kt.point,it,e,Zt,h.angle,Xt),Sn=g.allowVerticalPlacement&&ke.placedOrientation===u.ah.vertical?Math.PI/2:0;for(let $r=0;$r<ke.numGlyphs;$r++)u.aj(be,Lr,Sn);F&&ke.associatedIconIndex>=0&&(ze[ke.associatedIconIndex]={shiftedAnchor:Lr,angle:Sn})}else pr(ke.numGlyphs,be)}if(F){Ie.clear();const Be=g.icon.placedSymbolArray;for(let ke=0;ke<Be.length;ke++){const Ge=Be.get(ke);if(Ge.hidden)pr(Ge.numGlyphs,Ie);else{const Xe=ze[ke];if(Xe)for(let it=0;it<Ge.numGlyphs;it++)u.aj(Ie,Xe.shiftedAnchor,Xe.angle);else pr(Ge.numGlyphs,Ie)}}g.icon.dynamicLayoutVertexBuffer.updateData(Ie)}g.text.dynamicLayoutVertexBuffer.updateData(be)}function qi(g,e,s){return s.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Gs(g,e,s,c,h,m,S,k,A,F,H,$){const ne=g.context,de=ne.gl,me=g.transform,be=Qi(),Ie=k==="map",ze=A==="map",Be=k!=="viewport"&&s.layout.get("symbol-placement")!=="point",ke=Ie&&!ze&&!Be,Ge=!ze&&Be,Xe=!s.layout.get("symbol-sort-key").isConstant();let it=!1;const kt=g.depthModeForSublayer(0,ct.ReadOnly),Bt=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$t=[],Qt=be.getCircleRadiusCorrection(me);for(const Gt of c){const Vt=e.getTile(Gt),ur=Vt.getBucket(s);if(!ur)continue;const Fr=h?ur.text:ur.icon;if(!Fr||!Fr.segments.get().length||!Fr.hasVisibleVertices)continue;const Zt=Fr.programConfigurations.get(s.id),Xt=h||ur.sdfIcons,Lr=h?ur.textSizeData:ur.iconSizeData,Sn=ze||me.pitch!==0,$r=g.useProgram(qi(Xt,h,ur),Zt),Wr=u.ag(Lr,me.zoom),Cn=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Gt);let Mi,As,In,Ti,Nn=[0,0],ri=null;if(h)As=Vt.glyphAtlasTexture,In=de.LINEAR,Mi=Vt.glyphAtlasTexture.size,ur.iconsInText&&(Nn=Vt.imageAtlasTexture.size,ri=Vt.imageAtlasTexture,Ti=Sn||g.options.rotating||g.options.zooming||Lr.kind==="composite"||Lr.kind==="camera"?de.LINEAR:de.NEAREST);else{const Xr=s.layout.get("icon-size").constantOr(0)!==1||ur.iconsNeedLinear;As=Vt.imageAtlasTexture,In=Xt||g.options.rotating||g.options.zooming||Xr||Sn?de.LINEAR:de.NEAREST,Mi=Vt.imageAtlasTexture.size}const Bi=Ur(Vt,1,g.transform.zoom),yo=Ge?Gt.posMatrix:yi,gs=Xn(yo,ze,Ie,g.transform,Bi),_o=Nr(yo,ze,Ie,g.transform,Bi),Ra=Nr(Gt.posMatrix,ze,Ie,g.transform,Bi),Ms=be.translatePosition(g.transform,Vt,m,S),Ks=Bt&&ur.hasTextData(),No=s.layout.get("icon-text-fit")!=="none"&&Ks&&ur.hasIconData();if(Be){const Xr=g.style.map.terrain?(Da,xo)=>g.style.map.terrain.getElevation(Gt,Da,xo):null,Rs=s.layout.get("text-rotation-alignment")==="map";ue(ur,Gt.posMatrix,g,h,gs,Ra,ze,F,Rs,be,Gt.toUnwrapped(),me.width,me.height,Ms,Xr)}const is=Gt.posMatrix,zs=h&&Bt||No,vo=Be||zs?yi:gs,Ys=_o,ii=Xt&&s.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $n;$n=Xt?ur.iconsInText?hs(Lr.kind,Wr,ke,ze,Be,zs,g,is,vo,Ys,Ms,Mi,Nn,Qt):cs(Lr.kind,Wr,ke,ze,Be,zs,g,is,vo,Ys,Ms,h,Mi,!0,Qt):Vs(Lr.kind,Wr,ke,ze,Be,zs,g,is,vo,Ys,Ms,h,Mi,Qt);const Ni={program:$r,buffers:Fr,uniformValues:$n,atlasTexture:As,atlasTextureIcon:ri,atlasInterpolation:In,atlasInterpolationIcon:Ti,isSDF:Xt,hasHalo:ii};if(Xe&&ur.canOverlap){it=!0;const Xr=Fr.segments.get();for(const Rs of Xr)$t.push({segments:new u.a0([Rs]),sortKey:Rs.sortKey,state:Ni,terrainData:Cn})}else $t.push({segments:Fr.segments,sortKey:0,state:Ni,terrainData:Cn})}it&&$t.sort((Gt,Vt)=>Gt.sortKey-Vt.sortKey);for(const Gt of $t){const Vt=Gt.state;if(ne.activeTexture.set(de.TEXTURE0),Vt.atlasTexture.bind(Vt.atlasInterpolation,de.CLAMP_TO_EDGE),Vt.atlasTextureIcon&&(ne.activeTexture.set(de.TEXTURE1),Vt.atlasTextureIcon&&Vt.atlasTextureIcon.bind(Vt.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),Vt.isSDF){const ur=Vt.uniformValues;Vt.hasHalo&&(ur.u_is_halo=1,uc(Vt.buffers,Gt.segments,s,g,Vt.program,kt,H,$,ur,Gt.terrainData)),ur.u_is_halo=0}uc(Vt.buffers,Gt.segments,s,g,Vt.program,kt,H,$,Vt.uniformValues,Gt.terrainData)}}function uc(g,e,s,c,h,m,S,k,A,F){const H=c.context;h.draw(H,H.gl.TRIANGLES,m,S,k,hr.disabled,A,F,s.id,g.layoutVertexBuffer,g.indexBuffer,e,s.paint,c.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function cc(g,e,s,c){const h=g.context,m=h.gl,S=ir.disabled,k=new tt([m.ONE,m.ONE],u.aM.transparent,[!0,!0,!0,!0]),A=e.getBucket(s);if(!A)return;const F=c.key;let H=s.heatmapFbos.get(F);H||(H=_l(h,e.tileSize,e.tileSize),s.heatmapFbos.set(F,H)),h.bindFramebuffer.set(H.framebuffer),h.viewport.set([0,0,e.tileSize,e.tileSize]),h.clear({color:u.aM.transparent});const $=A.programConfigurations.get(s.id),ne=g.useProgram("heatmap",$),de=g.style.map.terrain.getTerrainData(c);ne.draw(h,m.TRIANGLES,ct.disabled,S,k,hr.disabled,zn(c.posMatrix,e,g.transform.zoom,s.paint.get("heatmap-intensity")),de,s.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,s.paint,g.transform.zoom,$)}function Ya(g,e,s){const c=g.context,h=c.gl;c.setColorMode(g.colorModeForRenderPass());const m=vl(c,e),S=s.key,k=e.heatmapFbos.get(S);k&&(c.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,k.colorAttachment.get()),c.activeTexture.set(h.TEXTURE1),m.bind(h.LINEAR,h.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(c,h.TRIANGLES,ct.disabled,ir.disabled,g.colorModeForRenderPass(),hr.disabled,ks(g,e,0,1),null,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,g.transform.zoom),k.destroy(),e.heatmapFbos.delete(S))}function _l(g,e,s){var c,h;const m=g.gl,S=m.createTexture();m.bindTexture(m.TEXTURE_2D,S),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const k=(c=g.HALF_FLOAT)!==null&&c!==void 0?c:m.UNSIGNED_BYTE,A=(h=g.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,A,e,s,0,m.RGBA,k,null);const F=g.createFramebuffer(e,s,!1,!1);return F.colorAttachment.set(S),F}function vl(g,e){return e.colorRampTexture||(e.colorRampTexture=new xt(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function Do(g,e,s,c,h){if(!s||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let S=m[s.to.toString()],k=m[s.from.toString()];if(!S&&k&&(S=k),!k&&S&&(k=S),!S||!k){const A=h.getPaintProperty(e);S=m[A],k=m[A]}S&&k&&g.setConstantPatternPositions(S,k)}function ea(g,e,s,c,h,m,S){const k=g.context.gl,A="fill-pattern",F=s.paint.get(A),H=F&&F.constantOr(1),$=s.getCrossfadeParameters();let ne,de,me,be,Ie;S?(de=H&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=k.LINES):(de=H?"fillPattern":"fill",ne=k.TRIANGLES);const ze=F.constantOr(null);for(const Be of c){const ke=e.getTile(Be);if(H&&!ke.patternsLoaded())continue;const Ge=ke.getBucket(s);if(!Ge)continue;const Xe=Ge.programConfigurations.get(s.id),it=g.useProgram(de,Xe),kt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Be);H&&(g.context.activeTexture.set(k.TEXTURE0),ke.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Xe.updatePaintBuffers($)),Do(Xe,A,ze,ke,s);const Bt=kt?Be:null,$t=g.translatePosMatrix(Bt?Bt.posMatrix:Be.posMatrix,ke,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(S){be=Ge.indexBuffer2,Ie=Ge.segments2;const Qt=[k.drawingBufferWidth,k.drawingBufferHeight];me=de==="fillOutlinePattern"&&H?js($t,g,$,ke,Qt):Vi($t,Qt)}else be=Ge.indexBuffer,Ie=Ge.segments,me=H?es($t,g,$,ke):Ei($t);it.draw(g.context,ne,h,g.stencilModeForClipping(Be),m,hr.disabled,me,kt,s.id,Ge.layoutVertexBuffer,be,Ie,s.paint,g.transform.zoom,Xe)}}function zu(g,e,s,c,h,m,S){const k=g.context,A=k.gl,F="fill-extrusion-pattern",H=s.paint.get(F),$=H.constantOr(1),ne=s.getCrossfadeParameters(),de=s.paint.get("fill-extrusion-opacity"),me=H.constantOr(null);for(const be of c){const Ie=e.getTile(be),ze=Ie.getBucket(s);if(!ze)continue;const Be=g.style.map.terrain&&g.style.map.terrain.getTerrainData(be),ke=ze.programConfigurations.get(s.id),Ge=g.useProgram($?"fillExtrusionPattern":"fillExtrusion",ke);$&&(g.context.activeTexture.set(A.TEXTURE0),Ie.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),ke.updatePaintBuffers(ne)),Do(ke,F,me,Ie,s);const Xe=g.translatePosMatrix(be.posMatrix,Ie,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),it=s.paint.get("fill-extrusion-vertical-gradient"),kt=$?fn(Xe,g,it,de,be,ne,Ie):Vr(Xe,g,it,de);Ge.draw(k,k.gl.TRIANGLES,h,m,S,hr.backCCW,kt,Be,s.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,s.paint,g.transform.zoom,ke,g.style.map.terrain&&ze.centroidVertexBuffer)}}function ta(g,e,s,c,h,m,S){const k=g.context,A=k.gl,F=s.fbo;if(!F)return;const H=g.useProgram("hillshade"),$=g.style.map.terrain&&g.style.map.terrain.getTerrainData(e);k.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,F.colorAttachment.get()),H.draw(k,A.TRIANGLES,h,m,S,hr.disabled,((ne,de,me,be)=>{const Ie=me.paint.get("hillshade-shadow-color"),ze=me.paint.get("hillshade-highlight-color"),Be=me.paint.get("hillshade-accent-color");let ke=me.paint.get("hillshade-illumination-direction")*(Math.PI/180);me.paint.get("hillshade-illumination-anchor")==="viewport"&&(ke-=ne.transform.angle);const Ge=!ne.options.moving;return{u_matrix:be?be.posMatrix:ne.transform.calculatePosMatrix(de.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:Cs(0,de.tileID),u_light:[me.paint.get("hillshade-exaggeration"),ke],u_shadow:Ie,u_highlight:ze,u_accent:Be}})(g,s,c,$?e:null),$,c.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function xl(g,e,s,c,h,m){const S=g.context,k=S.gl,A=e.dem;if(A&&A.data){const F=A.dim,H=A.stride,$=A.getPixels();if(S.activeTexture.set(k.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||g.getTileTexture(H),e.demTexture){const de=e.demTexture;de.update($,{premultiply:!1}),de.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else e.demTexture=new xt(S,$,k.RGBA,{premultiply:!1}),e.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);S.activeTexture.set(k.TEXTURE0);let ne=e.fbo;if(!ne){const de=new xt(S,{width:F,height:F,data:null},k.RGBA);de.bind(k.LINEAR,k.CLAMP_TO_EDGE),ne=e.fbo=S.createFramebuffer(F,F,!0,!1),ne.colorAttachment.set(de.texture)}S.bindFramebuffer.set(ne.framebuffer),S.viewport.set([0,0,F,F]),g.useProgram("hillshadePrepare").draw(S,k.TRIANGLES,c,h,m,hr.disabled,((de,me)=>{const be=me.stride,Ie=u.H();return u.aP(Ie,0,u.X,-u.X,0,0,1),u.J(Ie,Ie,[0,-u.X,0]),{u_matrix:Ie,u_image:1,u_dimension:[be,be],u_zoom:de.overscaledZ,u_unpack:me.getUnpackVector()}})(e.tileID,A),null,s.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function hc(g,e,s,c,h,m){const S=c.paint.get("raster-fade-duration");if(!m&&S>0){const k=j.now(),A=(k-g.timeAdded)/S,F=e?(k-e.timeAdded)/S:-1,H=s.getSource(),$=h.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),ne=!e||Math.abs(e.tileID.overscaledZ-$)>Math.abs(g.tileID.overscaledZ-$),de=ne&&g.refreshedUponExpiration?1:u.ac(ne?A:1-F,0,1);return g.refreshedUponExpiration&&A>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-de}:{opacity:de,mix:0}}return{opacity:1,mix:0}}const su=new u.aM(1,0,0,1),on=new u.aM(0,1,0,1),ou=new u.aM(0,0,1,1),dh=new u.aM(1,0,1,1),dc=new u.aM(0,1,1,1);function wl(g,e,s,c){Ru(g,0,e+s/2,g.transform.width,s,c)}function fh(g,e,s,c){Ru(g,e-s/2,0,s,g.transform.height,c)}function Ru(g,e,s,c,h,m){const S=g.context,k=S.gl;k.enable(k.SCISSOR_TEST),k.scissor(e*g.pixelRatio,s*g.pixelRatio,c*g.pixelRatio,h*g.pixelRatio),S.clear({color:m}),k.disable(k.SCISSOR_TEST)}function ph(g,e,s){const c=g.context,h=c.gl,m=s.posMatrix,S=g.useProgram("debug"),k=ct.disabled,A=ir.disabled,F=g.colorModeForRenderPass(),H="$debug",$=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);c.activeTexture.set(h.TEXTURE0);const ne=e.getTileByID(s.key).latestRawTileData,de=Math.floor((ne&&ne.byteLength||0)/1024),me=e.getTile(s).tileSize,be=512/Math.min(me,512)*(s.overscaledZ/g.transform.zoom)*.5;let Ie=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(Ie+=` => ${s.overscaledZ}`),function(ze,Be){ze.initDebugOverlayCanvas();const ke=ze.debugOverlayCanvas,Ge=ze.context.gl,Xe=ze.debugOverlayCanvas.getContext("2d");Xe.clearRect(0,0,ke.width,ke.height),Xe.shadowColor="white",Xe.shadowBlur=2,Xe.lineWidth=1.5,Xe.strokeStyle="white",Xe.textBaseline="top",Xe.font="bold 36px Open Sans, sans-serif",Xe.fillText(Be,5,5),Xe.strokeText(Be,5,5),ze.debugOverlayTexture.update(ke),ze.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(g,`${Ie} ${de}kB`),S.draw(c,h.TRIANGLES,k,A,tt.alphaBlended,hr.disabled,gi(m,u.aM.transparent,be),null,H,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),S.draw(c,h.LINE_STRIP,k,A,F,hr.disabled,gi(m,u.aM.red),$,H,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function mh(g,e,s){const c=g.context,h=c.gl,m=g.colorModeForRenderPass(),S=new ct(h.LEQUAL,ct.ReadWrite,g.depthRangeFor3D),k=g.useProgram("terrain"),A=e.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,g.width,g.height]);for(const F of s){const H=g.renderToTexture.getTexture(F),$=e.getTerrainData(F.tileID);c.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,H.texture);const ne=g.transform.calculatePosMatrix(F.tileID.toUnwrapped()),de=e.getMeshFrameDelta(g.transform.zoom),me=g.transform.calculateFogMatrix(F.tileID.toUnwrapped()),be=Et(ne,de,me,g.style.sky,g.transform.pitch);k.draw(c,h.TRIANGLES,S,ir.disabled,m,hr.backCCW,be,$,"terrain",A.vertexBuffer,A.indexBuffer,A.segments)}}class fs{constructor(e,s,c){this.vertexBuffer=e,this.indexBuffer=s,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Ca{constructor(e,s){this.context=new at(e),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=wr.maxUnderzooming+wr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ns}resize(e,s,c){if(this.width=Math.floor(e*c),this.height=Math.floor(s*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,s=new u.aX;s.emplaceBack(0,0),s.emplaceBack(u.X,0),s.emplaceBack(0,u.X),s.emplaceBack(u.X,u.X),this.tileExtentBuffer=e.createVertexBuffer(s,he.members),this.tileExtentSegments=u.a0.simpleSegment(0,0,4,2);const c=new u.aX;c.emplaceBack(0,0),c.emplaceBack(u.X,0),c.emplaceBack(0,u.X),c.emplaceBack(u.X,u.X),this.debugBuffer=e.createVertexBuffer(c,he.members),this.debugSegments=u.a0.simpleSegment(0,0,4,5);const h=new u.$;h.emplaceBack(0,0,0,0),h.emplaceBack(u.X,0,u.X,0),h.emplaceBack(0,u.X,0,u.X),h.emplaceBack(u.X,u.X,u.X,u.X),this.rasterBoundsBuffer=e.createVertexBuffer(h,nt.members),this.rasterBoundsSegments=u.a0.simpleSegment(0,0,4,2);const m=new u.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(m,he.members),this.viewportSegments=u.a0.simpleSegment(0,0,4,2);const S=new u.aZ;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(S);const k=new u.aY;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(k);const A=this.context.gl;this.stencilClearMode=new ir({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO)}clearStencil(){const e=this.context,s=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.H();u.aP(c,0,this.width,this.height,0,0,1),u.K(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,s.TRIANGLES,ct.disabled,this.stencilClearMode,tt.disabled,hr.disabled,On(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,s){if(this.currentStencilSource===e.source||!e.isTileClipped()||!s||!s.length)return;this.currentStencilSource=e.source;const c=this.context,h=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(tt.disabled),c.setDepthMode(ct.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of s){const k=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S);m.draw(c,h.TRIANGLES,ct.disabled,new ir({func:h.ALWAYS,mask:0},k,255,h.KEEP,h.KEEP,h.REPLACE),tt.disabled,hr.disabled,On(S.posMatrix),A,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,s=this.context.gl;return new ir({func:s.NOTEQUAL,mask:255},e,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(e){const s=this.context.gl;return new ir({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(e){const s=this.context.gl,c=e.sort((S,k)=>k.overscaledZ-S.overscaledZ),h=c[c.length-1].overscaledZ,m=c[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const S={};for(let k=0;k<m;k++)S[k+h]=new ir({func:s.GEQUAL,mask:255},k+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=m,[S,c]}return[{[h]:ir.disabled},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new tt([e.CONSTANT_COLOR,e.ONE],new u.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?tt.unblended:tt.alphaBlended}depthModeForSublayer(e,s,c){if(!this.opaquePassEnabledForLayer())return ct.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ct(c||this.context.gl.LEQUAL,s,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,s){this.style=e,this.options=s,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(j.now()),this.imageManager.beginFrame();const c=this.style._order,h=this.style.sourceCaches,m={},S={},k={};for(const A in h){const F=h[A];F.used&&F.prepare(this.context),m[A]=F.getVisibleCoordinates(),S[A]=m[A].slice().reverse(),k[A]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let A=0;A<c.length;A++)if(this.style._layers[c[A]].is3D()){this.opaquePassCutoff=A;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const A of c){const F=this.style._layers[A];if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const H=S[F.source];(F.type==="custom"||H.length)&&this.renderLayer(this,h[F.source],F,H)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?u.aM.black:u.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(A,F){const H=A.context,$=H.gl,ne=((ze,Be,ke)=>({u_sky_color:ze.properties.get("sky-color"),u_horizon_color:ze.properties.get("horizon-color"),u_horizon:(Be.height/2+Be.getHorizon())*ke,u_sky_horizon_blend:ze.properties.get("sky-horizon-blend")*Be.height/2*ke}))(F,A.style.map.transform,A.pixelRatio),de=new ct($.LEQUAL,ct.ReadWrite,[0,1]),me=ir.disabled,be=A.colorModeForRenderPass(),Ie=A.useProgram("sky");if(!F.mesh){const ze=new u.aX;ze.emplaceBack(-1,-1),ze.emplaceBack(1,-1),ze.emplaceBack(1,1),ze.emplaceBack(-1,1);const Be=new u.aY;Be.emplaceBack(0,1,2),Be.emplaceBack(0,2,3),F.mesh=new fs(H.createVertexBuffer(ze,he.members),H.createIndexBuffer(Be),u.a0.simpleSegment(0,0,ze.length,Be.length))}Ie.draw(H,$.TRIANGLES,de,me,be,hr.disabled,ne,void 0,"sky",F.mesh.vertexBuffer,F.mesh.indexBuffer,F.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const A=this.style._layers[c[this.currentLayer]],F=h[A.source],H=m[A.source];this._renderTileClippingMasks(A,H),this.renderLayer(this,F,A,H)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const A=this.style._layers[c[this.currentLayer]],F=h[A.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(A))continue;const H=(A.type==="symbol"?k:S)[A.source];this._renderTileClippingMasks(A,m[A.source]),this.renderLayer(this,F,A,H)}if(this.options.showTileBoundaries){const A=function(F,H){let $=null;const ne=Object.values(F._layers).flatMap(Ie=>Ie.source&&!Ie.isHidden(H)?[F.sourceCaches[Ie.source]]:[]),de=ne.filter(Ie=>Ie.getSource().type==="vector"),me=ne.filter(Ie=>Ie.getSource().type!=="vector"),be=Ie=>{(!$||$.getSource().maxzoom<Ie.getSource().maxzoom)&&($=Ie)};return de.forEach(Ie=>be(Ie)),$||me.forEach(Ie=>be(Ie)),$}(this.style,this.transform.zoom);A&&function(F,H,$){for(let ne=0;ne<$.length;ne++)ph(F,H,$[ne])}(this,A,A.getVisibleCoordinates())}this.options.showPadding&&function(A){const F=A.transform.padding;wl(A,A.transform.height-(F.top||0),3,su),wl(A,F.bottom||0,3,on),fh(A,F.left||0,3,ou),fh(A,A.transform.width-(F.right||0),3,dh);const H=A.transform.centerPoint;(function($,ne,de,me){Ru($,ne-1,de-10,2,20,me),Ru($,ne-10,de-1,20,2,me)})(A,H.x,A.transform.height-H.y,dc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!u.a_(s,c):!u.a$(s,c)),h||(h=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),h&&(u.b0(s,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,S){const k=m.context,A=k.gl,F=tt.unblended,H=new ct(A.LEQUAL,ct.ReadWrite,[0,1]),$=S.getTerrainMesh(),ne=S.sourceCache.getRenderableTiles(),de=m.useProgram("terrainDepth");k.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),k.clear({color:u.aM.transparent,depth:1});for(const me of ne){const be=S.getTerrainData(me.tileID),Ie={u_matrix:m.transform.calculatePosMatrix(me.tileID.toUnwrapped()),u_ele_delta:S.getMeshFrameDelta(m.transform.zoom)};de.draw(k,A.TRIANGLES,H,ir.disabled,F,hr.backCCW,Ie,be,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,S){const k=m.context,A=k.gl,F=tt.unblended,H=new ct(A.LEQUAL,ct.ReadWrite,[0,1]),$=S.getTerrainMesh(),ne=S.getCoordsTexture(),de=S.sourceCache.getRenderableTiles(),me=m.useProgram("terrainCoords");k.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),k.clear({color:u.aM.transparent,depth:1}),S.coordsIndex=[];for(const be of de){const Ie=S.getTerrainData(be.tileID);k.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,ne.texture);const ze={u_matrix:m.transform.calculatePosMatrix(be.tileID.toUnwrapped()),u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(m.transform.zoom)};me.draw(k,A.TRIANGLES,H,ir.disabled,F,hr.backCCW,ze,Ie,"terrain",$.vertexBuffer,$.indexBuffer,$.segments),S.coordsIndex.push(be.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,s,c,h){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(h||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(m,S,k,A,F){if(m.renderPass!=="translucent")return;const H=ir.disabled,$=m.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ne,de,me,be,Ie,ze,Be,ke,Ge){const Xe=de.transform,it=Qi(),kt=Ie==="map",Bt=ze==="map";for(const $t of ne){const Qt=be.getTile($t),Gt=Qt.getBucket(me);if(!Gt||!Gt.text||!Gt.text.segments.get().length)continue;const Vt=u.ag(Gt.textSizeData,Xe.zoom),ur=Ur(Qt,1,de.transform.zoom),Fr=Xn($t.posMatrix,Bt,kt,de.transform,ur),Zt=me.layout.get("icon-text-fit")!=="none"&&Gt.hasIconData();if(Vt){const Xt=Math.pow(2,Xe.zoom-Qt.tileID.overscaledZ),Lr=de.style.map.terrain?($r,Wr)=>de.style.map.terrain.getElevation($t,$r,Wr):null,Sn=it.translatePosition(Xe,Qt,Be,ke);$s(Gt,kt,Bt,Ge,Xe,Fr,$t.posMatrix,Xt,Vt,Zt,it,Sn,$t.toUnwrapped(),Lr)}}}(A,m,k,S,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),F),k.paint.get("icon-opacity").constantOr(1)!==0&&Gs(m,S,k,A,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),H,$),k.paint.get("text-opacity").constantOr(1)!==0&&Gs(m,S,k,A,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),H,$),S.map.showCollisionBoxes&&(pn(m,S,k,A,!0),pn(m,S,k,A,!1))})(e,s,c,h,this.style.placement.variableOffsets);break;case"circle":(function(m,S,k,A){if(m.renderPass!=="translucent")return;const F=k.paint.get("circle-opacity"),H=k.paint.get("circle-stroke-width"),$=k.paint.get("circle-stroke-opacity"),ne=!k.layout.get("circle-sort-key").isConstant();if(F.constantOr(1)===0&&(H.constantOr(1)===0||$.constantOr(1)===0))return;const de=m.context,me=de.gl,be=m.depthModeForSublayer(0,ct.ReadOnly),Ie=ir.disabled,ze=m.colorModeForRenderPass(),Be=[];for(let ke=0;ke<A.length;ke++){const Ge=A[ke],Xe=S.getTile(Ge),it=Xe.getBucket(k);if(!it)continue;const kt=it.programConfigurations.get(k.id),Bt=m.useProgram("circle",kt),$t=it.layoutVertexBuffer,Qt=it.indexBuffer,Gt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ge),Vt={programConfiguration:kt,program:Bt,layoutVertexBuffer:$t,indexBuffer:Qt,uniformValues:us(m,Ge,Xe,k),terrainData:Gt};if(ne){const ur=it.segments.get();for(const Fr of ur)Be.push({segments:new u.a0([Fr]),sortKey:Fr.sortKey,state:Vt})}else Be.push({segments:it.segments,sortKey:0,state:Vt})}ne&&Be.sort((ke,Ge)=>ke.sortKey-Ge.sortKey);for(const ke of Be){const{programConfiguration:Ge,program:Xe,layoutVertexBuffer:it,indexBuffer:kt,uniformValues:Bt,terrainData:$t}=ke.state;Xe.draw(de,me.TRIANGLES,be,Ie,ze,hr.disabled,Bt,$t,k.id,it,kt,ke.segments,k.paint,m.transform.zoom,Ge)}})(e,s,c,h);break;case"heatmap":(function(m,S,k,A){if(k.paint.get("heatmap-opacity")===0)return;const F=m.context;if(m.style.map.terrain){for(const H of A){const $=S.getTile(H);S.hasRenderableParent(H)||(m.renderPass==="offscreen"?cc(m,$,k,H):m.renderPass==="translucent"&&Ya(m,k,H))}F.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(H,$,ne,de){const me=H.context,be=me.gl,Ie=ir.disabled,ze=new tt([be.ONE,be.ONE],u.aM.transparent,[!0,!0,!0,!0]);(function(Be,ke,Ge){const Xe=Be.gl;Be.activeTexture.set(Xe.TEXTURE1),Be.viewport.set([0,0,ke.width/4,ke.height/4]);let it=Ge.heatmapFbos.get(u.aU);it?(Xe.bindTexture(Xe.TEXTURE_2D,it.colorAttachment.get()),Be.bindFramebuffer.set(it.framebuffer)):(it=_l(Be,ke.width/4,ke.height/4),Ge.heatmapFbos.set(u.aU,it))})(me,H,ne),me.clear({color:u.aM.transparent});for(let Be=0;Be<de.length;Be++){const ke=de[Be];if($.hasRenderableParent(ke))continue;const Ge=$.getTile(ke),Xe=Ge.getBucket(ne);if(!Xe)continue;const it=Xe.programConfigurations.get(ne.id),kt=H.useProgram("heatmap",it),{zoom:Bt}=H.transform;kt.draw(me,be.TRIANGLES,ct.disabled,Ie,ze,hr.disabled,zn(ke.posMatrix,Ge,Bt,ne.paint.get("heatmap-intensity")),null,ne.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,ne.paint,H.transform.zoom,it)}me.viewport.set([0,0,H.width,H.height])}(m,S,k,A):m.renderPass==="translucent"&&function(H,$){const ne=H.context,de=ne.gl;ne.setColorMode(H.colorModeForRenderPass());const me=$.heatmapFbos.get(u.aU);me&&(ne.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,me.colorAttachment.get()),ne.activeTexture.set(de.TEXTURE1),vl(ne,$).bind(de.LINEAR,de.CLAMP_TO_EDGE),H.useProgram("heatmapTexture").draw(ne,de.TRIANGLES,ct.disabled,ir.disabled,H.colorModeForRenderPass(),hr.disabled,ks(H,$,0,1),null,$.id,H.viewportBuffer,H.quadTriangleIndexBuffer,H.viewportSegments,$.paint,H.transform.zoom))}(m,k)})(e,s,c,h);break;case"line":(function(m,S,k,A){if(m.renderPass!=="translucent")return;const F=k.paint.get("line-opacity"),H=k.paint.get("line-width");if(F.constantOr(1)===0||H.constantOr(1)===0)return;const $=m.depthModeForSublayer(0,ct.ReadOnly),ne=m.colorModeForRenderPass(),de=k.paint.get("line-dasharray"),me=k.paint.get("line-pattern"),be=me.constantOr(1),Ie=k.paint.get("line-gradient"),ze=k.getCrossfadeParameters(),Be=be?"linePattern":de?"lineSDF":Ie?"lineGradient":"line",ke=m.context,Ge=ke.gl;let Xe=!0;for(const it of A){const kt=S.getTile(it);if(be&&!kt.patternsLoaded())continue;const Bt=kt.getBucket(k);if(!Bt)continue;const $t=Bt.programConfigurations.get(k.id),Qt=m.context.program.get(),Gt=m.useProgram(Be,$t),Vt=Xe||Gt.program!==Qt,ur=m.style.map.terrain&&m.style.map.terrain.getTerrainData(it),Fr=me.constantOr(null);if(Fr&&kt.imageAtlas){const Lr=kt.imageAtlas,Sn=Lr.patternPositions[Fr.to.toString()],$r=Lr.patternPositions[Fr.from.toString()];Sn&&$r&&$t.setConstantPatternPositions(Sn,$r)}const Zt=ur?it:null,Xt=be?Us(m,kt,k,ze,Zt):de?ac(m,kt,k,de,ze,Zt):Ie?Ql(m,kt,k,Bt.lineClipsArray.length,Zt):ml(m,kt,k,Zt);if(be)ke.activeTexture.set(Ge.TEXTURE0),kt.imageAtlasTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),$t.updatePaintBuffers(ze);else if(de&&(Vt||m.lineAtlas.dirty))ke.activeTexture.set(Ge.TEXTURE0),m.lineAtlas.bind(ke);else if(Ie){const Lr=Bt.gradients[k.id];let Sn=Lr.texture;if(k.gradientVersion!==Lr.version){let $r=256;if(k.stepInterpolant){const Wr=S.getSource().maxzoom,Cn=it.canonical.z===Wr?Math.ceil(1<<m.transform.maxZoom-it.canonical.z):1;$r=u.ac(u.aV(Bt.maxLineLength/u.X*1024*Cn),256,ke.maxTextureSize)}Lr.gradient=u.aW({expression:k.gradientExpression(),evaluationKey:"lineProgress",resolution:$r,image:Lr.gradient||void 0,clips:Bt.lineClipsArray}),Lr.texture?Lr.texture.update(Lr.gradient):Lr.texture=new xt(ke,Lr.gradient,Ge.RGBA),Lr.version=k.gradientVersion,Sn=Lr.texture}ke.activeTexture.set(Ge.TEXTURE0),Sn.bind(k.stepInterpolant?Ge.NEAREST:Ge.LINEAR,Ge.CLAMP_TO_EDGE)}Gt.draw(ke,Ge.TRIANGLES,$,m.stencilModeForClipping(it),ne,hr.disabled,Xt,ur,k.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,k.paint,m.transform.zoom,$t,Bt.layoutVertexBuffer2),Xe=!1}})(e,s,c,h);break;case"fill":(function(m,S,k,A){const F=k.paint.get("fill-color"),H=k.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const $=m.colorModeForRenderPass(),ne=k.paint.get("fill-pattern"),de=m.opaquePassEnabledForLayer()&&!ne.constantOr(1)&&F.constantOr(u.aM.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===de){const me=m.depthModeForSublayer(1,m.renderPass==="opaque"?ct.ReadWrite:ct.ReadOnly);ea(m,S,k,A,me,$,!1)}if(m.renderPass==="translucent"&&k.paint.get("fill-antialias")){const me=m.depthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,ct.ReadOnly);ea(m,S,k,A,me,$,!0)}})(e,s,c,h);break;case"fill-extrusion":(function(m,S,k,A){const F=k.paint.get("fill-extrusion-opacity");if(F!==0&&m.renderPass==="translucent"){const H=new ct(m.context.gl.LEQUAL,ct.ReadWrite,m.depthRangeFor3D);if(F!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))zu(m,S,k,A,H,ir.disabled,tt.disabled),zu(m,S,k,A,H,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const $=m.colorModeForRenderPass();zu(m,S,k,A,H,ir.disabled,$)}}})(e,s,c,h);break;case"hillshade":(function(m,S,k,A){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const F=m.context,H=m.depthModeForSublayer(0,ct.ReadOnly),$=m.colorModeForRenderPass(),[ne,de]=m.renderPass==="translucent"?m.stencilConfigForOverlap(A):[{},A];for(const me of de){const be=S.getTile(me);be.needsHillshadePrepare!==void 0&&be.needsHillshadePrepare&&m.renderPass==="offscreen"?xl(m,be,k,H,ir.disabled,$):m.renderPass==="translucent"&&ta(m,me,be,k,H,ne[me.overscaledZ],$)}F.viewport.set([0,0,m.width,m.height])})(e,s,c,h);break;case"raster":(function(m,S,k,A){if(m.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!A.length)return;const F=m.context,H=F.gl,$=S.getSource(),ne=m.useProgram("raster"),de=m.colorModeForRenderPass(),[me,be]=$ instanceof zt?[{},A]:m.stencilConfigForOverlap(A),Ie=be[be.length-1].overscaledZ,ze=!m.options.moving;for(const Be of be){const ke=m.depthModeForSublayer(Be.overscaledZ-Ie,k.paint.get("raster-opacity")===1?ct.ReadWrite:ct.ReadOnly,H.LESS),Ge=S.getTile(Be);Ge.registerFadeDuration(k.paint.get("raster-fade-duration"));const Xe=S.findLoadedParent(Be,0),it=S.findLoadedSibling(Be),kt=hc(Ge,Xe||it||null,S,k,m.transform,m.style.map.terrain);let Bt,$t;const Qt=k.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;F.activeTexture.set(H.TEXTURE0),Ge.texture.bind(Qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),F.activeTexture.set(H.TEXTURE1),Xe?(Xe.texture.bind(Qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Bt=Math.pow(2,Xe.tileID.overscaledZ-Ge.tileID.overscaledZ),$t=[Ge.tileID.canonical.x*Bt%1,Ge.tileID.canonical.y*Bt%1]):Ge.texture.bind(Qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Ge.texture.useMipmap&&F.extTextureFilterAnisotropic&&m.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const Gt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Be),Vt=Gt?Be:null,ur=Vt?Vt.posMatrix:m.transform.calculatePosMatrix(Be.toUnwrapped(),ze),Fr=$a(ur,$t||[0,0],Bt||1,kt,k);$ instanceof zt?ne.draw(F,H.TRIANGLES,ke,ir.disabled,de,hr.disabled,Fr,Gt,k.id,$.boundsBuffer,m.quadTriangleIndexBuffer,$.boundsSegments):ne.draw(F,H.TRIANGLES,ke,me[Be.overscaledZ],de,hr.disabled,Fr,Gt,k.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(e,s,c,h);break;case"background":(function(m,S,k,A){const F=k.paint.get("background-color"),H=k.paint.get("background-opacity");if(H===0)return;const $=m.context,ne=$.gl,de=m.transform,me=de.tileSize,be=k.paint.get("background-pattern");if(m.isPatternMissing(be))return;const Ie=!be&&F.a===1&&H===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Ie)return;const ze=ir.disabled,Be=m.depthModeForSublayer(0,Ie==="opaque"?ct.ReadWrite:ct.ReadOnly),ke=m.colorModeForRenderPass(),Ge=m.useProgram(be?"backgroundPattern":"background"),Xe=A||de.coveringTiles({tileSize:me,terrain:m.style.map.terrain});be&&($.activeTexture.set(ne.TEXTURE0),m.imageManager.bind(m.context));const it=k.getCrossfadeParameters();for(const kt of Xe){const Bt=A?kt.posMatrix:m.transform.calculatePosMatrix(kt.toUnwrapped()),$t=be?wa(Bt,H,m,be,{tileID:kt,tileSize:me},it):Hi(Bt,H,F),Qt=m.style.map.terrain&&m.style.map.terrain.getTerrainData(kt);Ge.draw($,ne.TRIANGLES,Be,ze,ke,hr.disabled,$t,Qt,k.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(e,0,c,h);break;case"custom":(function(m,S,k){const A=m.context,F=k.implementation;if(m.renderPass==="offscreen"){const H=F.prerender;H&&(m.setCustomLayerDefaults(),A.setColorMode(m.colorModeForRenderPass()),H.call(F,A.gl,m.transform.customLayerMatrix()),A.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),A.setColorMode(m.colorModeForRenderPass()),A.setStencilMode(ir.disabled);const H=F.renderingMode==="3d"?new ct(m.context.gl.LEQUAL,ct.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,ct.ReadOnly);A.setDepthMode(H),F.render(A.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),A.setDirty(),m.setBaseState(),A.bindFramebuffer.set(null)}})(e,0,c)}}translatePosMatrix(e,s,c,h,m){if(!c[0]&&!c[1])return e;const S=m?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(S){const F=Math.sin(S),H=Math.cos(S);c=[c[0]*H-c[1]*F,c[0]*F+c[1]*H]}const k=[m?c[0]:Ur(s,c[0],this.transform.zoom),m?c[1]:Ur(s,c[1],this.transform.zoom),0],A=new Float32Array(16);return u.J(A,e,k),A}saveTileTexture(e){const s=this._tileTextures[e.size[0]];s?s.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const s=this._tileTextures[e];return s&&s.length>0?s.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const s=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!s||!c}useProgram(e,s){this.cache=this.cache||{};const c=e+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new Jt(this.context,Ee[e],s,uo[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:s}=this.context.gl;return this.width!==e||this.height!==s}}class Ja{constructor(e,s){this.points=e,this.planes=s}static fromInvProjectionMatrix(e,s,c){const h=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const A=1/(k=u.af([],k,e))[3]/s*h;return u.b1(k,k,[A,A,1/k[3],A])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const A=function(ne,de){var me=de[0],be=de[1],Ie=de[2],ze=me*me+be*be+Ie*Ie;return ze>0&&(ze=1/Math.sqrt(ze)),ne[0]=de[0]*ze,ne[1]=de[1]*ze,ne[2]=de[2]*ze,ne}([],function(ne,de,me){var be=de[0],Ie=de[1],ze=de[2],Be=me[0],ke=me[1],Ge=me[2];return ne[0]=Ie*Ge-ze*ke,ne[1]=ze*Be-be*Ge,ne[2]=be*ke-Ie*Be,ne}([],je([],m[k[0]],m[k[1]]),je([],m[k[2]],m[k[1]]))),F=-((H=A)[0]*($=m[k[1]])[0]+H[1]*$[1]+H[2]*$[2]);var H,$;return A.concat(F)});return new Ja(m,S)}}class Qa{constructor(e,s){this.min=e,this.max=s,this.center=function(c,h,m){return c[0]=.5*h[0],c[1]=.5*h[1],c[2]=.5*h[2],c}([],function(c,h,m){return c[0]=h[0]+m[0],c[1]=h[1]+m[1],c[2]=h[2]+m[2],c}([],this.min,this.max))}quadrant(e){const s=[e%2==0,e<2],c=ve(this.min),h=ve(this.max);for(let m=0;m<s.length;m++)c[m]=s[m]?this.min[m]:this.center[m],h[m]=s[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Qa(c,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let h=0;h<e.planes.length;h++){const m=e.planes[h];let S=0;for(let k=0;k<s.length;k++)u.b2(m,s[k])>=0&&S++;if(S===0)return 0;S!==s.length&&(c=!1)}if(c)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let k=0;k<e.points.length;k++){const A=e.points[k][h]-this.min[h];m=Math.min(m,A),S=Math.max(S,A)}if(S<0||m>this.max[h]-this.min[h])return 0}return 1}}class el{constructor(e=0,s=0,c=0,h=0){if(isNaN(e)||e<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=s,this.left=c,this.right=h}interpolate(e,s,c){return s.top!=null&&e.top!=null&&(this.top=u.y.number(e.top,s.top,c)),s.bottom!=null&&e.bottom!=null&&(this.bottom=u.y.number(e.bottom,s.bottom,c)),s.left!=null&&e.left!=null&&(this.left=u.y.number(e.left,s.left,c)),s.right!=null&&e.right!=null&&(this.right=u.y.number(e.right,s.right,c)),this}getCenter(e,s){const c=u.ac((this.left+e-this.right)/2,0,e),h=u.ac((this.top+s-this.bottom)/2,0,s);return new u.P(c,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new el(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Du=85.051129;class Ia{constructor(e,s,c,h,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=e||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new el,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new Ia(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const s=-u.b3(e,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var c=new u.A(4);return u.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,h,m){var S=h[0],k=h[1],A=h[2],F=h[3],H=Math.sin(m),$=Math.cos(m);c[0]=S*$+A*H,c[1]=k*$+F*H,c[2]=S*-H+A*$,c[3]=k*-H+F*$}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const s=u.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const s=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,s,c){this._unmodified=!1,this._edgeInsets.interpolate(e,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const s=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(e){const s=[new u.b4(0,e)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.P(0,0)),h=this.pointCoordinate(new u.P(this.width,0)),m=this.pointCoordinate(new u.P(this.width,this.height)),S=this.pointCoordinate(new u.P(0,this.height)),k=Math.floor(Math.min(c.x,h.x,m.x,S.x)),A=Math.floor(Math.max(c.x,h.x,m.x,S.x)),F=1;for(let H=k-F;H<=A+F;H++)H!==0&&s.push(new u.b4(H,e))}return s}coveringTiles(e){var s,c;let h=this.coveringZoomLevel(e);const m=h;if(e.minzoom!==void 0&&h<e.minzoom)return[];e.maxzoom!==void 0&&h>e.maxzoom&&(h=e.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),k=u.Z.fromLngLat(this.center),A=Math.pow(2,h),F=[A*S.x,A*S.y,0],H=[A*k.x,A*k.y,0],$=Ja.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,h);let ne=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ne=h);const de=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,me=ke=>({aabb:new Qa([ke*A,0,0],[(ke+1)*A,A,0]),zoom:0,x:0,y:0,wrap:ke,fullyVisible:!1}),be=[],Ie=[],ze=h,Be=e.reparseOverscaled?m:h;if(this._renderWorldCopies)for(let ke=1;ke<=3;ke++)be.push(me(-ke)),be.push(me(ke));for(be.push(me(0));be.length>0;){const ke=be.pop(),Ge=ke.x,Xe=ke.y;let it=ke.fullyVisible;if(!it){const Gt=ke.aabb.intersects($);if(Gt===0)continue;it=Gt===2}const kt=e.terrain?F:H,Bt=ke.aabb.distanceX(kt),$t=ke.aabb.distanceY(kt),Qt=Math.max(Math.abs(Bt),Math.abs($t));if(ke.zoom===ze||Qt>de+(1<<ze-ke.zoom)-2&&ke.zoom>=ne){const Gt=ze-ke.zoom,Vt=F[0]-.5-(Ge<<Gt),ur=F[1]-.5-(Xe<<Gt);Ie.push({tileID:new u.S(ke.zoom===ze?Be:ke.zoom,ke.wrap,ke.zoom,Ge,Xe),distanceSq:St([H[0]-.5-Ge,H[1]-.5-Xe]),tileDistanceToCamera:Math.sqrt(Vt*Vt+ur*ur)})}else for(let Gt=0;Gt<4;Gt++){const Vt=(Ge<<1)+Gt%2,ur=(Xe<<1)+(Gt>>1),Fr=ke.zoom+1;let Zt=ke.aabb.quadrant(Gt);if(e.terrain){const Xt=new u.S(Fr,ke.wrap,Fr,Vt,ur),Lr=e.terrain.getMinMaxElevation(Xt),Sn=(s=Lr.minElevation)!==null&&s!==void 0?s:this.elevation,$r=(c=Lr.maxElevation)!==null&&c!==void 0?c:this.elevation;Zt=new Qa([Zt.min[0],Zt.min[1],Sn],[Zt.max[0],Zt.max[1],$r])}be.push({aabb:Zt,zoom:Fr,x:Vt,y:ur,wrap:ke.wrap,fullyVisible:it})}}return Ie.sort((ke,Ge)=>ke.distanceSq-Ge.distanceSq).map(ke=>ke.tileID)}resize(e,s){this.width=e,this.height=s,this.pixelsToGLUnits=[2/e,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const s=u.ac(e.lat,-85.051129,Du);return new u.P(u.O(e.lng)*this.worldSize,u.Q(s)*this.worldSize)}unproject(e){return new u.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const s=this.elevation,c=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,h=this.pointLocation(this.centerPoint,e),m=e.getElevationForLngLatZoom(h,this.tileZoom);if(!(this.elevation-m))return;const S=c+s-m,k=Math.cos(this._pitch)*this.cameraToCenterDistance/S/u.b5(1,h.lat),A=this.scaleZoom(k/this.tileSize);this._elevation=m,this._center=h,this.zoom=A}setLocationAtPoint(e,s){const c=this.pointCoordinate(s),h=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(e),S=new u.Z(m.x-(c.x-h.x),m.y-(c.y-h.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,s){return s?this.coordinatePoint(this.locationCoordinate(e),s.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,s){return this.coordinateLocation(this.pointCoordinate(e,s))}locationCoordinate(e){return u.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,s){if(s){const ne=s.pointCoordinate(e);if(ne!=null)return ne}const c=[e.x,e.y,0,1],h=[e.x,e.y,1,1];u.af(c,c,this.pixelMatrixInverse),u.af(h,h,this.pixelMatrixInverse);const m=c[3],S=h[3],k=c[1]/m,A=h[1]/S,F=c[2]/m,H=h[2]/S,$=F===H?0:(0-F)/(H-F);return new u.Z(u.y.number(c[0]/m,h[0]/S,$)/this.worldSize,u.y.number(k,A,$)/this.worldSize)}coordinatePoint(e,s=0,c=this.pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,s,1];return u.af(h,h,c),new u.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return new ye().extend(this.pointLocation(new u.P(0,e))).extend(this.pointLocation(new u.P(this.width,e))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ye([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Du])}calculateTileMatrix(e){const s=e.canonical,c=this.worldSize/this.zoomScale(s.z),h=s.x+Math.pow(2,s.z)*e.wrap,m=u.an(new Float64Array(16));return u.J(m,m,[h*c,s.y*c,0]),u.K(m,m,[c/u.X,c/u.X,1]),m}calculatePosMatrix(e,s=!1){const c=e.key,h=s?this._alignedPosMatrixCache:this._posMatrixCache;if(h[c])return h[c];const m=this.calculateTileMatrix(e);return u.L(m,s?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),h[c]=new Float32Array(m),h[c]}calculateFogMatrix(e){const s=e.key,c=this._fogMatrixCache;if(c[s])return c[s];const h=this.calculateTileMatrix(e);return u.L(h,this.fogMatrix,h),c[s]=new Float32Array(h),c[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,s){s=u.ac(+s,this.minZoom,this.maxZoom);const c={center:new u.N(e.lng,e.lat),zoom:s};let h=this.lngRange;!this._renderWorldCopies&&h===null&&(h=[-179.9999999999,179.9999999999]);const m=this.tileSize*this.zoomScale(c.zoom);let S=0,k=m,A=0,F=m,H=0,$=0;const{x:ne,y:de}=this.size;if(this.latRange){const ke=this.latRange;S=u.Q(ke[1])*m,k=u.Q(ke[0])*m,k-S<de&&(H=de/(k-S))}h&&(A=u.b3(u.O(h[0])*m,0,m),F=u.b3(u.O(h[1])*m,0,m),F<A&&(F+=m),F-A<ne&&($=ne/(F-A)));const{x:me,y:be}=this.project.call({worldSize:m},e);let Ie,ze;const Be=Math.max($||0,H||0);if(Be){const ke=new u.P($?(F+A)/2:me,H?(k+S)/2:be);return c.center=this.unproject.call({worldSize:m},ke).wrap(),c.zoom+=this.scaleZoom(Be),c}if(this.latRange){const ke=de/2;be-ke<S&&(ze=S+ke),be+ke>k&&(ze=k-ke)}if(h){const ke=(A+F)/2;let Ge=me;this._renderWorldCopies&&(Ge=u.b3(me,ke-m/2,ke+m/2));const Xe=ne/2;Ge-Xe<A&&(Ie=A+Xe),Ge+Xe>F&&(Ie=F-Xe)}if(Ie!==void 0||ze!==void 0){const ke=new u.P(Ie??me,ze??be);c.center=this.unproject.call({worldSize:m},ke).wrap()}return c}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:s,zoom:c}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=c,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b5(1,this.center.lat)*this.worldSize;let h=u.an(new Float64Array(16));u.K(h,h,[this.width/2,-this.height/2,1]),u.J(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=u.an(new Float64Array(16)),u.K(h,h,[1,-1,1]),u.J(h,h,[-1,-1,0]),u.K(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),S=Math.min(this.elevation,this.minElevationForCurrentTile),k=m-S*this._pixelPerMeter/Math.cos(this._pitch),A=S<0?k:m,F=Math.PI/2+this._pitch,H=this._fov*(.5+e.y/this.height),$=Math.sin(H)*A/Math.sin(u.ac(Math.PI-F-H,.01,Math.PI-.01)),ne=this.getHorizon(),de=2*Math.atan(ne/this.cameraToCenterDistance)*(.5+e.y/(2*ne)),me=Math.sin(de)*A/Math.sin(u.ac(Math.PI-F-de,.01,Math.PI-.01)),be=Math.min($,me);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*be+A),this.nearZ=this.height/50,h=new Float64Array(16),u.b6(h,this._fov,this.width/this.height,this.nearZ,this.farZ),h[8]=2*-e.x/this.width,h[9]=2*e.y/this.height,this.projectionMatrix=u.ae(h),u.K(h,h,[1,-1,1]),u.J(h,h,[0,0,-this.cameraToCenterDistance]),u.b7(h,h,this._pitch),u.ad(h,h,this.angle),u.J(h,h,[-s,-c,0]),this.mercatorMatrix=u.K([],h,[this.worldSize,this.worldSize,this.worldSize]),u.K(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.L(new Float64Array(16),this.labelPlaneMatrix,h),u.J(h,h,[0,0,-this.elevation]),this.modelViewProjectionMatrix=h,this.invModelViewProjectionMatrix=u.as([],h),this.fogMatrix=new Float64Array(16),u.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,u.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),u.b7(this.fogMatrix,this.fogMatrix,this._pitch),u.ad(this.fogMatrix,this.fogMatrix,this.angle),u.J(this.fogMatrix,this.fogMatrix,[-s,-c,0]),u.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=u.L(new Float64Array(16),this.labelPlaneMatrix,h);const Ie=this.width%2/2,ze=this.height%2/2,Be=Math.cos(this.angle),ke=Math.sin(this.angle),Ge=s-Math.round(s)+Be*Ie+ke*ze,Xe=c-Math.round(c)+Be*ze+ke*Ie,it=new Float64Array(h);if(u.J(it,it,[Ge>.5?Ge-1:Ge,Xe>.5?Xe-1:Xe,0]),this.alignedModelViewProjectionMatrix=it,h=u.as(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new u.P(0,0)),s=[e.x*this.worldSize,e.y*this.worldSize,0,1];return u.af(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,e))}getCameraQueryGeometry(e){const s=this.getCameraPoint();if(e.length===1)return[e[0],s];{let c=s.x,h=s.y,m=s.x,S=s.y;for(const k of e)c=Math.min(c,k.x),h=Math.min(h,k.y),m=Math.max(m,k.x),S=Math.max(S,k.y);return[new u.P(c,h),new u.P(m,h),new u.P(m,S),new u.P(c,S),new u.P(c,h)]}}lngLatToCameraDepth(e,s){const c=this.locationCoordinate(e),h=[c.x*this.worldSize,c.y*this.worldSize,s,1];return u.af(h,h,this.modelViewProjectionMatrix),h[2]/h[3]}}function au(g,e){let s,c=!1,h=null,m=null;const S=()=>{h=null,c&&(g.apply(m,s),h=setTimeout(S,e),c=!1)};return(...k)=>(c=!0,m=this,s=k,h||S(),h)}class Lu{constructor(e){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let c;return s.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(c=h)}),(c&&c[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:c,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const c=s.join("/");let h=c;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${c}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let S=window.location.href.replace(/(#.+)?$/,m);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=au(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,h=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),S=Math.round(s.lng*m)/m,k=Math.round(s.lat*m)/m,A=this._map.getBearing(),F=this._map.getPitch();let H="";if(H+=e?`/${S}/${k}/${c}`:`${c}/${k}/${S}`,(A||F)&&(H+="/"+Math.round(10*A)/10),F&&(H+=`/${Math.round(F)}`),this._hashName){const $=this._hashName;let ne=!1;const de=window.location.hash.slice(1).split("&").map(me=>{const be=me.split("=")[0];return be===$?(ne=!0,`${be}=${H}`):me}).filter(me=>me);return ne||de.push(`${$}=${H}`),`#${de.join("&")}`}return`#${H}`}}const ra={linearity:.3,easing:u.b8(0,0,.3,1)},lu=u.e({deceleration:2500,maxSpeed:1400},ra),uu=u.e({deceleration:20,maxSpeed:1400},ra),Fu=u.e({deceleration:1e3,maxSpeed:360},ra),cu=u.e({deceleration:1e3,maxSpeed:90},ra);class bl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:j.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,s=j.now();for(;e.length>0&&s-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(s.pan.mag()){const m=tl(s.pan.mag(),c,u.e({},lu,e||{}));h.offset=s.pan.mult(m.amount/s.pan.mag()),h.center=this._map.transform.center,Lo(h,m)}if(s.zoom){const m=tl(s.zoom,c,uu);h.zoom=this._map.transform.zoom+m.amount,Lo(h,m)}if(s.bearing){const m=tl(s.bearing,c,Fu);h.bearing=this._map.transform.bearing+u.ac(m.amount,-179,179),Lo(h,m)}if(s.pitch){const m=tl(s.pitch,c,cu);h.pitch=this._map.transform.pitch+m.amount,Lo(h,m)}if(h.zoom||h.bearing){const m=s.pinchAround===void 0?s.around:s.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),u.e(h,{noMoveStart:!0})}}function Lo(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function tl(g,e,s){const{maxSpeed:c,linearity:h,deceleration:m}=s,S=u.ac(g*h/(e/1e3),-c,c),k=Math.abs(S)/(m*h);return{easing:s.easing,duration:1e3*k,amount:S*(k/2)}}class Fi extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,c,h={}){const m=N.mousePos(s.getCanvas(),c),S=s.unproject(m);super(e,u.e({point:m,lngLat:S,originalEvent:c},h)),this._defaultPrevented=!1,this.target=s}}class Fo extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,c){const h=e==="touchend"?c.changedTouches:c.touches,m=N.touchPos(s.getCanvasContainer(),h),S=m.map(A=>s.unproject(A)),k=m.reduce((A,F,H,$)=>A.add(F.div($.length)),new u.P(0,0));super(e,{points:m,point:k,lngLats:S,lngLat:s.unproject(k),originalEvent:c}),this._defaultPrevented=!1}}class fc extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,s,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class pc{constructor(e,s){this._map=e,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new fc(e.type,this._map,e))}mousedown(e,s){return this._mousedownPos=s,this._firePreventable(new Fi(e.type,this._map,e))}mouseup(e){this._map.fire(new Fi(e.type,this._map,e))}click(e,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Fi(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Fi(e.type,this._map,e))}mouseover(e){this._map.fire(new Fi(e.type,this._map,e))}mouseout(e){this._map.fire(new Fi(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Fo(e.type,this._map,e))}touchmove(e){this._map.fire(new Fo(e.type,this._map,e))}touchend(e){this._map.fire(new Fo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Fo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yn{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Fi(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Fi(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qs{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(u.P.convert(e),this._map.terrain)}}class ps{constructor(e,s){this._map=e,this._tr=new qs(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,s){this.isEnabled()&&e.shiftKey&&e.button===0&&(N.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(e,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=c,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(h.x,c.x),S=Math.max(h.x,c.x),k=Math.min(h.y,c.y),A=Math.max(h.y,c.y);N.setTransform(this._box,`translate(${m}px,${k}px)`),this._box.style.width=S-m+"px",this._box.style.height=A-k+"px"}mouseupWindow(e,s){if(!this._active||e.button!==0)return;const c=this._startPos,h=s;if(this.reset(),N.suppressClick(),c.x!==h.x||c.y!==h.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(c,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,s){return this._map.fire(new u.k(e,{originalEvent:s}))}}function Sl(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);const s={};for(let c=0;c<g.length;c++)s[g[c].identifier]=e[c];return s}class Oo{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(h){const m=new u.P(0,0);for(const S of h)m._add(S);return m.div(h.length)}(s),this.touches=Sl(c,s)))}touchmove(e,s,c){if(this.aborted||!this.centroid)return;const h=Sl(c,s);for(const m in this.touches){const S=h[m];(!S||S.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,s,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class El{constructor(e){this.singleTap=new Oo(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,s,c){this.singleTap.touchstart(e,s,c)}touchmove(e,s,c){this.singleTap.touchmove(e,s,c)}touchend(e,s,c){const h=this.singleTap.touchend(e,s,c);if(h){const m=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(h)<30;if(m&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Pa{constructor(e){this._tr=new qs(e),this._zoomIn=new El({numTouches:1,numTaps:2}),this._zoomOut=new El({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,s,c){this._zoomIn.touchstart(e,s,c),this._zoomOut.touchstart(e,s,c)}touchmove(e,s,c){this._zoomIn.touchmove(e,s,c),this._zoomOut.touchmove(e,s,c)}touchend(e,s,c){const h=this._zoomIn.touchend(e,s,c),m=this._zoomOut.touchend(e,s,c),S=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class na{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const s=this._moveFunction(...e);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(e,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,s){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=s.length?s[0]:s;return!this._moved&&h.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(c,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&N.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const mc={0:1,2:2};class Aa{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const s=N.mouseButton(e);this._eventButton=s}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(s,c){const h=mc[c];return s.buttons===void 0||(s.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return N.mouseButton(e)===this._eventButton}}class gc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const hu=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}},Ou=({enable:g,clickTolerance:e,bearingDegreesPerPixelMoved:s=.8})=>{const c=new Aa({checkCorrectEvent:h=>N.mouseButton(h)===0&&h.ctrlKey||N.mouseButton(h)===2});return new na({clickTolerance:e,move:(h,m)=>({bearingDelta:(m.x-h.x)*s}),moveStateManager:c,enable:g,assignEvents:hu})},Rn=({enable:g,clickTolerance:e,pitchDegreesPerPixelMoved:s=-.5})=>{const c=new Aa({checkCorrectEvent:h=>N.mouseButton(h)===0&&h.ctrlKey||N.mouseButton(h)===2});return new na({clickTolerance:e,move:(h,m)=>({pitchDelta:(m.y-h.y)*s}),moveStateManager:c,enable:g,assignEvents:hu})};class ia{constructor(e,s){this._clickTolerance=e.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,s,c){return this._calculateTransform(e,s,c)}touchmove(e,s,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,s,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,s,c){this._calculateTransform(e,s,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,s,c){c.length>0&&(this._active=!0);const h=Sl(c,s),m=new u.P(0,0),S=new u.P(0,0);let k=0;for(const F in h){const H=h[F],$=this._touches[F];$&&(m._add(H),S._add(H.sub($)),k++,h[F]=H)}if(this._touches=h,this._shouldBePrevented(k)||!S.mag())return;const A=S.div(k);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(k),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(e,s,c){if(!this._firstTwoTouches)return;e.preventDefault();const[h,m]=this._firstTwoTouches,S=sa(c,s,h),k=sa(c,s,m);if(!S||!k)return;const A=this._aroundCenter?null:S.add(k).div(2);return this._move([S,k],A,e)}touchend(e,s,c){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,S=sa(c,s,h),k=sa(c,s,m);S&&k||(this._active&&N.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function sa(g,e,s){for(let c=0;c<g.length;c++)if(g[c].identifier===s)return e[c]}function Bu(g,e){return Math.log(g/e)/Math.LN2}class du extends rl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,s){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Bu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Bu(this._distance,c),pinchAround:s}}}function nl(g,e){return 180*g.angleWith(e)/Math.PI}class Tl extends rl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,s,c){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:nl(this._vector,h),pinchAround:s}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const s=25/(Math.PI*this._minDiameter)*360,c=nl(e,this._startVector);return Math.abs(c)<s}}function oa(g){return Math.abs(g.y)>Math.abs(g.x)}class kl extends rl{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,s,c){super.touchstart(e,s,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,oa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,s,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,s,c){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,m=s.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const S=e.y>0==s.y>0;return oa(e)&&oa(s)&&S}}const gh={panStep:100,bearingStep:15,pitchStep:10};class Zs{constructor(e){this._tr=new qs(e);const s=gh;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let s=0,c=0,h=0,m=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,h=0),{cameraAnimation:k=>{const A=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:fo,zoom:s?Math.round(A.zoom)+s*(e.shiftKey?2:1):A.zoom,bearing:A.bearing+c*this._bearingStep,pitch:A.pitch+h*this._pitchStep,offset:[-m*this._panStep,-S*this._panStep],center:A.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function fo(g){return g*(2-g)}const Cl=4.000244140625;class ms{constructor(e,s){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new qs(e),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let s=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=j.now(),h=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%Cl==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),e.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=e,this._delta-=s,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=N.mousePos(this._map.getCanvas(),e),c=this._tr;this._around=s.y>c.transform.height/2-c.transform.getHorizon()?u.N.convert(this._aroundCenter?c.center:c.unproject(s)):u.N.convert(c.center),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>Cl?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&F!==0&&(F=1/F);const H=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(H*F))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,c=this._startZoom,h=this._easing;let m,S=!1;const k=j.now()-this._lastWheelEventTime;if(this._type==="wheel"&&c&&h&&k){const A=Math.min(k/200,1),F=h(A);m=u.y.number(c,s,F),A<1?this._frameId||(this._frameId=!0):S=!0}else m=s,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let s=u.b9;if(this._prevEase){const c=this._prevEase,h=(j.now()-c.start)/c.duration,m=c.easing(h+.01)-c.easing(h),S=.27/Math.sqrt(m*m+1e-4)*.01,k=Math.sqrt(.0729-S*S);s=u.b8(S,k,.25,1)}return this._prevEase={start:j.now(),duration:e,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class aa{constructor(e,s){this._clickZoom=e,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class yc{constructor(e){this._tr=new qs(e),this.reset()}reset(){this._active=!1}dblclick(e,s){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _c{constructor(){this._tap=new El({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,s,c){if(!this._swipePoint)if(this._tapTime){const h=s[0],m=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(h)<30;m&&S?c.length>0&&(this._swipePoint=h,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,s,c)}touchmove(e,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const h=s[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,s,c)}touchend(e,s,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const h=this._tap.touchend(e,s,c);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(e,s,c){this._el=e,this._mousePan=s,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yh{constructor(e,s,c){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ju{constructor(e,s,c,h){this._el=e,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Il{constructor(e,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",e);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=s,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=c,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,s){this._enabled&&(this._map.fire(new u.k("cooperativegestureprevented",{gestureType:e,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ws=g=>g.zoom||g.drag||g.pitch||g.rotate;class sr extends u.k{}function po(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Uu{constructor(e,s){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=h.type==="renderFrame"?void 0:h,k={needsRenderFrame:!1},A={},F={},H=h.touches,$=H?this._getMapTouches(H):void 0,ne=$?N.touchPos(this._map.getCanvas(),$):N.mousePos(this._map.getCanvas(),h);for(const{handlerName:be,handler:Ie,allowed:ze}of this._handlers){if(!Ie.isEnabled())continue;let Be;this._blockedByActive(F,ze,be)?Ie.reset():Ie[m||h.type]&&(Be=Ie[m||h.type](h,ne,$),this.mergeHandlerResult(k,A,Be,be,S),Be&&Be.needsRenderFrame&&this._triggerRenderFrame()),(Be||Ie.isActive())&&(F[be]=Ie)}const de={};for(const be in this._previousActiveHandlers)F[be]||(de[be]=S);this._previousActiveHandlers=F,(Object.keys(de).length||po(k))&&(this._changes.push([k,A,de]),this._triggerRenderFrame()),(Object.keys(F).length||po(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:me}=k;me&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],me(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bl(e),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,S]of this._listeners)N.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,s,c]of this._listeners)N.removeEventListener(e,s,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new pc(s,e));const h=s.boxZoom=new ps(s,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const m=s.cooperativeGestures=new Il(s,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const S=new Pa(s),k=new yc(s);s.doubleClickZoom=new aa(k,S),this._add("tapZoom",S),this._add("clickZoom",k),e.interactive&&e.doubleClickZoom&&s.doubleClickZoom.enable();const A=new _c;this._add("tapDragZoom",A);const F=s.touchPitch=new kl(s);this._add("touchPitch",F),e.interactive&&e.touchPitch&&s.touchPitch.enable(e.touchPitch);const H=Ou(e),$=Rn(e);s.dragRotate=new yh(e,H,$),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]),e.interactive&&e.dragRotate&&s.dragRotate.enable();const ne=(({enable:Be,clickTolerance:ke})=>{const Ge=new Aa({checkCorrectEvent:Xe=>N.mouseButton(Xe)===0&&!Xe.ctrlKey});return new na({clickTolerance:ke,move:(Xe,it)=>({around:it,panDelta:it.sub(Xe)}),activateOnStart:!0,moveStateManager:Ge,enable:Be,assignEvents:hu})})(e),de=new ia(e,s);s.dragPan=new Nu(c,ne,de),this._add("mousePan",ne),this._add("touchPan",de,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&s.dragPan.enable(e.dragPan);const me=new Tl,be=new du;s.touchZoomRotate=new ju(c,be,me,A),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&s.touchZoomRotate.enable(e.touchZoomRotate);const Ie=s.scrollZoom=new ms(s,()=>this._triggerRenderFrame());this._add("scrollZoom",Ie,["mousePan"]),e.interactive&&e.scrollZoom&&s.scrollZoom.enable(e.scrollZoom);const ze=s.keyboard=new Zs(s);this._add("keyboard",ze),e.interactive&&e.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new Yn(s))}_add(e,s,c){this._handlers.push({handlerName:e,handler:s,allowed:c}),this._handlersById[e]=s}stop(e){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ws(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,s,c){for(const h in e)if(h!==c&&(!s||s.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const s=[];for(const c of e)this._el.contains(c.target)&&s.push(c);return s}mergeHandlerResult(e,s,c,h,m){if(!c)return;u.e(e,c);const S={handlerName:h,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(s.zoom=S),c.panDelta!==void 0&&(s.drag=S),c.pitchDelta!==void 0&&(s.pitch=S),c.bearingDelta!==void 0&&(s.rotate=S)}_applyChanges(){const e={},s={},c={};for(const[h,m,S]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new u.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),u.e(s,m),u.e(c,S);this._updateMapTransform(e,s,c),this._changes=[]}_updateMapTransform(e,s,c){const h=this._map,m=h._getTransformForUpdate(),S=h.terrain;if(!(po(e)||S&&this._terrainMovement))return this._fireEvents(s,c,!0);let{panDelta:k,zoomDelta:A,bearingDelta:F,pitchDelta:H,around:$,pinchAround:ne}=e;ne!==void 0&&($=ne),h._stop(!0),$=$||h.transform.centerPoint;const de=m.pointLocation(k?$.sub(k):$);F&&(m.bearing+=F),H&&(m.pitch+=H),A&&(m.zoom+=A),S?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(k)):m.setLocationAtPoint(de,$):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(de,$)):m.setLocationAtPoint(de,$),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(s,c,!0)}_fireEvents(e,s,c){const h=Ws(this._eventsInProgress),m=Ws(e),S={};for(const $ in e){const{originalEvent:ne}=e[$];this._eventsInProgress[$]||(S[`${$}start`]=ne),this._eventsInProgress[$]=e[$]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const $ in S)this._fireEvent($,S[$]);m&&this._fireEvent("move",m.originalEvent);for(const $ in e){const{originalEvent:ne}=e[$];this._fireEvent($,ne)}const k={};let A;for(const $ in this._eventsInProgress){const{handlerName:ne,originalEvent:de}=this._eventsInProgress[$];this._handlersById[ne].isActive()||(delete this._eventsInProgress[$],A=s[ne]||de,k[`${$}end`]=A)}for(const $ in k)this._fireEvent($,k[$]);const F=Ws(this._eventsInProgress),H=(h||m)&&!F;if(H&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();$.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform($)}if(c&&H){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=de=>de!==0&&-this._bearingSnap<de&&de<this._bearingSnap;!$||!$.essential&&j.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:A})),ne(this._map.getBearing())&&this._map.resetNorth()):(ne($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(e,s){this._map.fire(new u.k(e,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new sr("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class il extends u.E{constructor(e,s){super(),this._renderFrameCallback=()=>{const c=Math.min((j.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,s){return this.jumpTo({center:e},s)}panBy(e,s,c){return e=u.P.convert(e).mult(-1),this.panTo(this.transform.center,u.e({offset:e},s),c)}panTo(e,s,c){return this.easeTo(u.e({center:e},s),c)}getZoom(){return this.transform.zoom}setZoom(e,s){return this.jumpTo({zoom:e},s),this}zoomTo(e,s,c){return this.easeTo(u.e({zoom:e},s),c)}zoomIn(e,s){return this.zoomTo(this.getZoom()+1,e,s),this}zoomOut(e,s){return this.zoomTo(this.getZoom()-1,e,s),this}getBearing(){return this.transform.bearing}setBearing(e,s){return this.jumpTo({bearing:e},s),this}getPadding(){return this.transform.padding}setPadding(e,s){return this.jumpTo({padding:e},s),this}rotateTo(e,s,c){return this.easeTo(u.e({bearing:e},s),c)}resetNorth(e,s){return this.rotateTo(0,u.e({duration:1e3},e),s),this}resetNorthPitch(e,s){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},e),s),this}snapToNorth(e,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,s):this}getPitch(){return this.transform.pitch}setPitch(e,s){return this.jumpTo({pitch:e},s),this}cameraForBounds(e,s){e=ye.convert(e).adjustAntiMeridian();const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,s)}_cameraForBoxAndBearing(e,s,c,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=u.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Gt=h.padding;h.padding={top:Gt,bottom:Gt,right:Gt,left:Gt}}h.padding=u.e(m,h.padding);const S=this.transform,k=S.padding,A=new ye(e,s),F=S.project(A.getNorthWest()),H=S.project(A.getNorthEast()),$=S.project(A.getSouthEast()),ne=S.project(A.getSouthWest()),de=u.ba(-c),me=F.rotate(de),be=H.rotate(de),Ie=$.rotate(de),ze=ne.rotate(de),Be=new u.P(Math.max(me.x,be.x,ze.x,Ie.x),Math.max(me.y,be.y,ze.y,Ie.y)),ke=new u.P(Math.min(me.x,be.x,ze.x,Ie.x),Math.min(me.y,be.y,ze.y,Ie.y)),Ge=Be.sub(ke),Xe=(S.width-(k.left+k.right+h.padding.left+h.padding.right))/Ge.x,it=(S.height-(k.top+k.bottom+h.padding.top+h.padding.bottom))/Ge.y;if(it<0||Xe<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const kt=Math.min(S.scaleZoom(S.scale*Math.min(Xe,it)),h.maxZoom),Bt=u.P.convert(h.offset),$t=new u.P((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(u.ba(c)),Qt=Bt.add($t).mult(S.scale/S.zoomScale(kt));return{center:S.unproject(F.add($).div(2).sub(Qt)),zoom:kt,bearing:c}}fitBounds(e,s,c){return this._fitInternal(this.cameraForBounds(e,s),s,c)}fitScreenCoordinates(e,s,c,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(e)),this.transform.pointLocation(u.P.convert(s)),c,h),h,m)}_fitInternal(e,s,c){return e?(delete(s=u.e(e,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(e,s){this.stop();const c=this._getTransformForUpdate();let h=!1,m=!1,S=!1;return"zoom"in e&&c.zoom!==+e.zoom&&(h=!0,c.zoom=+e.zoom),e.center!==void 0&&(c.center=u.N.convert(e.center)),"bearing"in e&&c.bearing!==+e.bearing&&(m=!0,c.bearing=+e.bearing),"pitch"in e&&c.pitch!==+e.pitch&&(S=!0,c.pitch=+e.pitch),e.padding==null||c.isPaddingEqual(e.padding)||(c.padding=e.padding),this._applyUpdatedTransform(c),this.fire(new u.k("movestart",s)).fire(new u.k("move",s)),h&&this.fire(new u.k("zoomstart",s)).fire(new u.k("zoom",s)).fire(new u.k("zoomend",s)),m&&this.fire(new u.k("rotatestart",s)).fire(new u.k("rotate",s)).fire(new u.k("rotateend",s)),S&&this.fire(new u.k("pitchstart",s)).fire(new u.k("pitch",s)).fire(new u.k("pitchend",s)),this.fire(new u.k("moveend",s))}calculateCameraOptionsFromTo(e,s,c,h=0){const m=u.Z.fromLngLat(e,s),S=u.Z.fromLngLat(c,h),k=S.x-m.x,A=S.y-m.y,F=S.z-m.z,H=Math.hypot(k,A,F);if(H===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(k,A),ne=this.transform.scaleZoom(this.transform.cameraToCenterDistance/H/this.transform.tileSize),de=180*Math.atan2(k,-A)/Math.PI;let me=180*Math.acos($/H)/Math.PI;return me=F<0?90-me:90+me,{center:S.toLngLat(),zoom:ne,pitch:me,bearing:de}}easeTo(e,s){var c;this._stop(!1,e.easeId),((e=u.e({offset:[0,0],duration:500,easing:u.b9},e)).animate===!1||!e.essential&&j.prefersReducedMotion)&&(e.duration=0);const h=this._getTransformForUpdate(),m=h.zoom,S=h.bearing,k=h.pitch,A=h.padding,F="bearing"in e?this._normalizeBearing(e.bearing,S):S,H="pitch"in e?+e.pitch:k,$="padding"in e?e.padding:h.padding,ne=u.P.convert(e.offset);let de=h.centerPoint.add(ne);const me=h.pointLocation(de),{center:be,zoom:Ie}=h.getConstrained(u.N.convert(e.center||me),(c=e.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(be,h);const ze=h.project(me),Be=h.project(be).sub(ze),ke=h.zoomScale(Ie-m);let Ge,Xe;e.around&&(Ge=u.N.convert(e.around),Xe=h.locationPoint(Ge));const it={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ie!==m,this._rotating=this._rotating||S!==F,this._pitching=this._pitching||H!==k,this._padding=!h.isPaddingEqual($),this._easeId=e.easeId,this._prepareEase(s,e.noMoveStart,it),this.terrain&&this._prepareElevation(be),this._ease(kt=>{if(this._zooming&&(h.zoom=u.y.number(m,Ie,kt)),this._rotating&&(h.bearing=u.y.number(S,F,kt)),this._pitching&&(h.pitch=u.y.number(k,H,kt)),this._padding&&(h.interpolatePadding(A,$,kt),de=h.centerPoint.add(ne)),this.terrain&&!e.freezeElevation&&this._updateElevation(kt),Ge)h.setLocationAtPoint(Ge,Xe);else{const Bt=h.zoomScale(h.zoom-m),$t=Ie>m?Math.min(2,ke):Math.max(.5,ke),Qt=Math.pow($t,1-kt),Gt=h.unproject(ze.add(Be.mult(kt*Qt)).mult(Bt));h.setLocationAtPoint(h.renderWorldCopies?Gt.wrap():Gt,de)}this._applyUpdatedTransform(h),this._fireMoveEvents(s)},kt=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s,kt)},e),this}_prepareEase(e,s,c={}){this._moving=!0,s||c.moving||this.fire(new u.k("movestart",e)),this._zooming&&!c.zooming&&this.fire(new u.k("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new u.k("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new u.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&s!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(s-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=s}this.transform.elevation=u.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const s=e.getCameraPosition(),c=this.terrain.getElevationForLngLatZoom(s.lngLat,e.zoom);if(s.altitude<c){const h=this.calculateCameraOptionsFromTo(s.lngLat,c,e.center,e.elevation);return{pitch:h.pitch,zoom:h.zoom}}return{}}_applyUpdatedTransform(e){const s=[];if(this.terrain&&s.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&s.push(h=>this.transformCameraUpdate(h)),!s.length)return;const c=e.clone();for(const h of s){const m=c.clone(),{center:S,zoom:k,pitch:A,bearing:F,elevation:H}=h(m);S&&(m.center=S),k!==void 0&&(m.zoom=k),A!==void 0&&(m.pitch=A),F!==void 0&&(m.bearing=F),H!==void 0&&(m.elevation=H),c.apply(m)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new u.k("move",e)),this._zooming&&this.fire(new u.k("zoom",e)),this._rotating&&this.fire(new u.k("rotate",e)),this._pitching&&this.fire(new u.k("pitch",e))}_afterEase(e,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const c=this._zooming,h=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.k("zoomend",e)),h&&this.fire(new u.k("rotateend",e)),m&&this.fire(new u.k("pitchend",e)),this.fire(new u.k("moveend",e))}flyTo(e,s){var c;if(!e.essential&&j.prefersReducedMotion){const Xt=u.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Xt,s)}this.stop(),e=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.b9},e);const h=this._getTransformForUpdate(),m=h.zoom,S=h.bearing,k=h.pitch,A=h.padding,F="bearing"in e?this._normalizeBearing(e.bearing,S):S,H="pitch"in e?+e.pitch:k,$="padding"in e?e.padding:h.padding,ne=u.P.convert(e.offset);let de=h.centerPoint.add(ne);const me=h.pointLocation(de),{center:be,zoom:Ie}=h.getConstrained(u.N.convert(e.center||me),(c=e.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(be,h);const ze=h.zoomScale(Ie-m),Be=h.project(me),ke=h.project(be).sub(Be);let Ge=e.curve;const Xe=Math.max(h.width,h.height),it=Xe/ze,kt=ke.mag();if("minZoom"in e){const Xt=u.ac(Math.min(e.minZoom,m,Ie),h.minZoom,h.maxZoom),Lr=Xe/h.zoomScale(Xt-m);Ge=Math.sqrt(Lr/kt*2)}const Bt=Ge*Ge;function $t(Xt){const Lr=(it*it-Xe*Xe+(Xt?-1:1)*Bt*Bt*kt*kt)/(2*(Xt?it:Xe)*Bt*kt);return Math.log(Math.sqrt(Lr*Lr+1)-Lr)}function Qt(Xt){return(Math.exp(Xt)-Math.exp(-Xt))/2}function Gt(Xt){return(Math.exp(Xt)+Math.exp(-Xt))/2}const Vt=$t(!1);let ur=function(Xt){return Gt(Vt)/Gt(Vt+Ge*Xt)},Fr=function(Xt){return Xe*((Gt(Vt)*(Qt(Lr=Vt+Ge*Xt)/Gt(Lr))-Qt(Vt))/Bt)/kt;var Lr},Zt=($t(!0)-Vt)/Ge;if(Math.abs(kt)<1e-6||!isFinite(Zt)){if(Math.abs(Xe-it)<1e-6)return this.easeTo(e,s);const Xt=it<Xe?-1:1;Zt=Math.abs(Math.log(it/Xe))/Ge,Fr=()=>0,ur=Lr=>Math.exp(Xt*Ge*Lr)}return e.duration="duration"in e?+e.duration:1e3*Zt/("screenSpeed"in e?+e.screenSpeed/Ge:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=S!==F,this._pitching=H!==k,this._padding=!h.isPaddingEqual($),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(be),this._ease(Xt=>{const Lr=Xt*Zt,Sn=1/ur(Lr);h.zoom=Xt===1?Ie:m+h.scaleZoom(Sn),this._rotating&&(h.bearing=u.y.number(S,F,Xt)),this._pitching&&(h.pitch=u.y.number(k,H,Xt)),this._padding&&(h.interpolatePadding(A,$,Xt),de=h.centerPoint.add(ne)),this.terrain&&!e.freezeElevation&&this._updateElevation(Xt);const $r=Xt===1?be:h.unproject(Be.add(ke.mult(Fr(Lr))).mult(Sn));h.setLocationAtPoint(h.renderWorldCopies?$r.wrap():$r,de),this._applyUpdatedTransform(h),this._fireMoveEvents(s)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,s){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,s)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,s,c){c.animate===!1||c.duration===0?(e(1),s()):(this._easeStart=j.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,s){e=u.b3(e,-180,180);const c=Math.abs(e-s);return Math.abs(e-360-s)<c&&(e-=360),Math.abs(e+360-s)<c&&(e+=360),e}_normalizeCenter(e,s){if(!s.renderWorldCopies||s.lngRange)return;const c=e.lng-s.center.lng;e.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(u.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const ns={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Bo{constructor(e=ns){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,s){const c=this._map._getUIString(`AttributionControl.${s}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const s=this._map.style.sourceCaches;for(const h in s){const m=s[h];if(m.used||m.usedForTerrain){const S=m.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let S=m+1;S<e.length;S++)if(e[S].indexOf(h)>=0)return!1;return!0});const c=e.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,e.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class mo{constructor(e={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const c=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl");const s=N.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const s=++this._id;return this._queue.push({callback:e,id:s,cancelled:!1}),s}remove(e){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const h of c)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var vc=u.Y([{name:"a_pos3d",type:"Int16",components:3}]);class cd extends u.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,s){this.sourceCache.update(e,s),this._renderableTilesKeys=[];const c={};for(const h of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))c[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.posMatrix=new Float64Array(16),u.aP(h.posMatrix,0,u.X,0,u.X,0,1),this._tiles[h.key]=new ui(h,this.tileSize));for(const h in this._tiles)c[h]||delete this._tiles[h]}freeRtt(e){for(const s in this._tiles){const c=this._tiles[s];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const s={};for(const c of this._renderableTilesKeys){const h=this._tiles[c].tileID;if(h.canonical.equals(e.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16),u.aP(m.posMatrix,0,u.X,0,u.X,0,1),s[c]=m}else if(h.canonical.isChildOf(e.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16);const S=h.canonical.z-e.canonical.z,k=h.canonical.x-(h.canonical.x>>S<<S),A=h.canonical.y-(h.canonical.y>>S<<S),F=u.X>>S;u.aP(m.posMatrix,0,F,0,F,0,1),u.J(m.posMatrix,m.posMatrix,[-k*F,-A*F,0]),s[c]=m}else if(e.canonical.isChildOf(h.canonical)){const m=e.clone();m.posMatrix=new Float64Array(16);const S=e.canonical.z-h.canonical.z,k=e.canonical.x-(e.canonical.x>>S<<S),A=e.canonical.y-(e.canonical.y>>S<<S),F=u.X>>S;u.aP(m.posMatrix,0,u.X,0,u.X,0,1),u.J(m.posMatrix,m.posMatrix,[k*F,A*F,0]),u.K(m.posMatrix,m.posMatrix,[1/2**S,1/2**S,0]),s[c]=m}}return s}getSourceTile(e,s){const c=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>c.maxzoom&&(h=c.maxzoom),h<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&s)for(;h>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=e)}}class la{constructor(e,s,c){this.painter=e,this.sourceCache=new cd(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,s,c,h=u.X){var m;if(!(s>=0&&s<h&&c>=0&&c<h))return 0;const S=this.getTerrainData(e),k=(m=S.tile)===null||m===void 0?void 0:m.dem;if(!k)return 0;const A=function(me,be,Ie){var ze=be[0],Be=be[1];return me[0]=Ie[0]*ze+Ie[4]*Be+Ie[12],me[1]=Ie[1]*ze+Ie[5]*Be+Ie[13],me}([],[s/h*u.X,c/h*u.X],S.u_terrain_matrix),F=[A[0]*k.dim,A[1]*k.dim],H=Math.floor(F[0]),$=Math.floor(F[1]),ne=F[0]-H,de=F[1]-$;return k.get(H,$)*(1-ne)*(1-de)+k.get(H+1,$)*ne*(1-de)+k.get(H,$+1)*(1-ne)*de+k.get(H+1,$+1)*ne*de}getElevationForLngLatZoom(e,s){if(!u.bb(s,e.wrap()))return 0;const{tileID:c,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,s);return this.getElevation(c,h%u.X,m%u.X,u.X)}getElevation(e,s,c,h=u.X){return this.getDEMElevation(e,s,c,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,m=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new xt(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new xt(h,new u.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.an([])}const s=this.sourceCache.getSourceTile(e,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const h=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new xt(h,s.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),s.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-s.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>m<<m),k=e.canonical.y-(e.canonical.y>>m<<m),A=u.bc(new Float64Array(16),[1/(u.X<<m),1/(u.X<<m),0]);u.J(A,A,[S*u.X,k*u.X,0]),this._demMatrixCache[e.key]={matrix:A,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(e){const s=this.painter,c=s.width/devicePixelRatio,h=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new xt(s.context,{width:c,height:h,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new xt(s.context,{width:c,height:h,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,h,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,S=0;m<this._coordsTextureSize;m++)for(let k=0;k<this._coordsTextureSize;k++,S+=4)s[S+0]=255&k,s[S+1]=255&m,s[S+2]=k>>8<<4|m>>8,s[S+3]=0;const c=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),h=new xt(e,c,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),c=this.painter.context,h=c.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,k-S-1,1,1,h.RGBA,h.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null);const A=s[0]+(s[2]>>4<<8),F=s[1]+((15&s[2])<<8),H=this.coordsIndex[255-s[3]],$=H&&this.sourceCache.getTileByID(H);if(!$)return null;const ne=this._coordsTextureSize,de=(1<<$.tileID.canonical.z)*ne;return new u.Z(($.tileID.canonical.x*ne+A)/de+$.tileID.wrap,($.tileID.canonical.y*ne+F)/de,this.getElevation($.tileID,A,F,ne))}depthAtPoint(e){const s=new Uint8Array(4),c=this.painter.context,h=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,s=new u.bd,c=new u.aY,h=this.meshSize,m=u.X/h,S=h*h;for(let $=0;$<=h;$++)for(let ne=0;ne<=h;ne++)s.emplaceBack(ne*m,$*m,0);for(let $=0;$<S;$+=h+1)for(let ne=0;ne<h;ne++)c.emplaceBack(ne+$,h+ne+$+1,h+ne+$+2),c.emplaceBack(ne+$,h+ne+$+2,ne+$+1);const k=s.length,A=k+2*(h+1);for(const $ of[0,1])for(let ne=0;ne<=h;ne++)for(const de of[0,1])s.emplaceBack(ne*m,$*u.X,de);for(let $=0;$<2*h;$+=2)c.emplaceBack(A+$,A+$+1,A+$+3),c.emplaceBack(A+$,A+$+3,A+$+2),c.emplaceBack(k+$,k+$+3,k+$+1),c.emplaceBack(k+$,k+$+2,k+$+3);const F=s.length,H=F+2*(h+1);for(const $ of[0,1])for(let ne=0;ne<=h;ne++)for(const de of[0,1])s.emplaceBack($*u.X,ne*m,de);for(let $=0;$<2*h;$+=2)c.emplaceBack(F+$,F+$+1,F+$+3),c.emplaceBack(F+$,F+$+3,F+$+2),c.emplaceBack(H+$,H+$+3,H+$+1),c.emplaceBack(H+$,H+$+2,H+$+3);return this._mesh=new fs(e.createVertexBuffer(s,vc.members),e.createIndexBuffer(c),u.a0.simpleSegment(0,0,s.length,c.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*u.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,s){var c;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,s);return(c=this.getMinMaxElevation(h).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const s=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=s.dem.min*this.exaggeration,c.maxElevation=s.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,s){const c=u.Z.fromLngLat(e.wrap()),h=(1<<s)*u.X,m=c.x*h,S=c.y*h,k=Math.floor(m/u.X),A=Math.floor(S/u.X);return{tileID:new u.S(s,0,s,k,A),mercatorX:m,mercatorY:S}}}class fu{constructor(e,s,c){this._context=e,this._size=s,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new xt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(c.texture),{id:e,fbo:s,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>e.id!==s),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const go={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class pu{constructor(e,s){this.painter=e,this.terrain=s,this.pool=new fu(e.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(s)),this._coordsDescendingInv={};for(const c in e.sourceCaches){this._coordsDescendingInv[c]={};const h=e.sourceCaches[c].getVisibleCoordinates();for(const m of h){const S=this.terrain.sourceCache.getTerrainCoords(m);for(const k in S)this._coordsDescendingInv[c][k]||(this._coordsDescendingInv[c][k]=[]),this._coordsDescendingInv[c][k].push(S[k])}}this._coordsDescendingInvStr={};for(const c of e._order){const h=e._layers[c],m=h.source;if(go[h.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const S in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][S]=this._coordsDescendingInv[m][S].map(k=>k.key).sort().join()}}for(const c of this._renderableTiles)for(const h in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[h][c.tileID.key];m&&m!==c.rttCoords[h]&&(c.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const s=e.type,c=this.painter,h=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(go[s]&&(this._prevType&&go[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(e.id),!h))return!0;if(go[this._prevType]||go[s]&&h){this._prevType=s;const m=this._stacks.length-1,S=this._stacks[m]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(mh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[m]){const F=this.pool.getObjectForId(k.rtt[m].id);if(F.stamp===k.rtt[m].stamp){this.pool.useObject(F);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),k.rtt[m]={id:A.id,stamp:A.stamp},c.context.bindFramebuffer.set(A.fbo.framebuffer),c.context.clear({color:u.aM.transparent,stencil:0}),c.currentStencilSource=void 0;for(let F=0;F<S.length;F++){const H=c.style._layers[S[F]],$=H.source?this._coordsDescendingInv[H.source][k.tileID.key]:[k.tileID];c.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),c._renderTileClippingMasks(H,$),c.renderLayer(c,c.style.sourceCaches[H.source],H,$),H.source&&(k.rttCoords[H.source]=this._coordsDescendingInvStr[H.source][k.tileID.key])}}return mh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),go[s]}return!1}}const mu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},sl=B,Ma={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ns,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Dn=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},Bn={showCompass:!0,showZoom:!0,visualizePitch:!1};class za{constructor(e,s,c=!1){this.mousedown=S=>{this.startMouse(u.e({},S,{ctrlKey:!0,preventDefault:()=>S.preventDefault()}),N.mousePos(this.element,S)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.moveMouse(S,N.mousePos(this.element,S))},this.mouseup=S=>{this.mouseRotate.dragEnd(S),this.mousePitch&&this.mousePitch.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.startTouch(S,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=N.touchPos(this.element,S.targetTouches)[0],this.moveTouch(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const h=e.dragRotate._mouseRotate.getClickTolerance(),m=e.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=Ou({clickTolerance:h,enable:!0}),this.touchRotate=(({enable:S,clickTolerance:k,bearingDegreesPerPixelMoved:A=.8})=>{const F=new gc;return new na({clickTolerance:k,move:(H,$)=>({bearingDelta:($.x-H.x)*A}),moveStateManager:F,enable:S,assignEvents:Dn})})({clickTolerance:h,enable:!0}),this.map=e,c&&(this.mousePitch=Rn({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:S,clickTolerance:k,pitchDegreesPerPixelMoved:A=-.5})=>{const F=new gc;return new na({clickTolerance:k,move:(H,$)=>({pitchDelta:($.y-H.y)*A}),moveStateManager:F,enable:S,assignEvents:Dn})})({clickTolerance:m,enable:!0})),N.addEventListener(s,"mousedown",this.mousedown),N.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(s,"touchcancel",this.reset)}startMouse(e,s){this.mouseRotate.dragStart(e,s),this.mousePitch&&this.mousePitch.dragStart(e,s),N.disableDrag()}startTouch(e,s){this.touchRotate.dragStart(e,s),this.touchPitch&&this.touchPitch.dragStart(e,s),N.disableDrag()}moveMouse(e,s){const c=this.map,{bearingDelta:h}=this.mouseRotate.dragMove(e,s)||{};if(h&&c.setBearing(c.getBearing()+h),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(e,s)||{};m&&c.setPitch(c.getPitch()+m)}}moveTouch(e,s){const c=this.map,{bearingDelta:h}=this.touchRotate.dragMove(e,s)||{};if(h&&c.setBearing(c.getBearing()+h),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(e,s)||{};m&&c.setPitch(c.getPitch()+m)}}off(){const e=this.element;N.removeEventListener(e,"mousedown",this.mousedown),N.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let kn;function tn(g,e,s){const c=new u.N(g.lng,g.lat);if(g=new u.N(g.lng,g.lat),e){const h=new u.N(g.lng-360,g.lat),m=new u.N(g.lng+360,g.lat),S=s.locationPoint(g).distSqr(e);s.locationPoint(h).distSqr(e)<S?g=h:s.locationPoint(m).distSqr(e)<S&&(g=m)}for(;Math.abs(g.lng-s.center.lng)>180;){const h=s.locationPoint(g);if(h.x>=0&&h.y>=0&&h.x<=s.width&&h.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g.lng!==c.lng&&s.locationPoint(g).y>s.height/2-s.getHorizon()?g:c}const Xs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ua(g,e,s){const c=g.classList;for(const h in Xs)c.remove(`maplibregl-${s}-anchor-${h}`);c.add(`maplibregl-${s}-anchor-${e}`)}class Oi extends u.E{constructor(e){if(super(),this._onKeyPress=s=>{const c=s.code,h=s.charCode||s.keyCode;c!=="Space"&&c!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=s=>{const c=s.originalEvent.target,h=this._element;this._popup&&(c===h||h.contains(c))&&this.togglePopup()},this._update=s=>{var c;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?tn(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),N.setTransform(this._element,`${Xs[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${m}`),j.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=u.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div");const s=N.createNS("http://www.w3.org/2000/svg","svg"),c=41,h=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${c}px`),s.setAttributeNS(null,"width",`${h}px`),s.setAttributeNS(null,"viewBox",`0 0 ${h} ${c}`);const m=N.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const S=N.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const k=N.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ze of A){const Be=N.createNS("http://www.w3.org/2000/svg","ellipse");Be.setAttributeNS(null,"opacity","0.04"),Be.setAttributeNS(null,"cx","10.5"),Be.setAttributeNS(null,"cy","5.80029008"),Be.setAttributeNS(null,"rx",ze.rx),Be.setAttributeNS(null,"ry",ze.ry),k.appendChild(Be)}const F=N.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);const H=N.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(H);const $=N.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const ne=N.createNS("http://www.w3.org/2000/svg","path");ne.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(ne);const de=N.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"transform","translate(6.0, 7.0)"),de.setAttributeNS(null,"fill","#FFFFFF");const me=N.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"transform","translate(8.0, 8.0)");const be=N.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#000000"),be.setAttributeNS(null,"opacity","0.25"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962");const Ie=N.createNS("http://www.w3.org/2000/svg","circle");Ie.setAttributeNS(null,"fill","#FFFFFF"),Ie.setAttributeNS(null,"cx","5.5"),Ie.setAttributeNS(null,"cy","5.5"),Ie.setAttributeNS(null,"r","5.4999962"),me.appendChild(be),me.appendChild(Ie),S.appendChild(k),S.appendChild(F),S.appendChild($),S.appendChild(de),S.appendChild(me),s.appendChild(S),s.setAttributeNS(null,"height",c*this._scale+"px"),s.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(s),this._offset=u.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),ua(this._element,this._anchor,"marker"),e&&e.className)for(const s of e.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=u.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var s,c;if(!(!((s=this._map)===null||s===void 0)&&s.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,m=h.terrain.depthAtPoint(this._pos),S=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,S)-m<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/h.transform._pixelPerMeter,A=Math.sin(h.getPitch()*Math.PI/180)*k,F=h.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),H=h.transform.lngLatToCameraDepth(this._lngLat,S+A)-F>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&H&&this._popup.remove(),this._element.style.opacity=H?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=u.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,s){return e===void 0&&s===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const gu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Pl=0,Al=!1;const Ps={maxWidth:100,unit:"metric"};function Ml(g,e,s){const c=s&&s.maxWidth||100,h=g._container.clientHeight/2,m=g.unproject([0,h]),S=g.unproject([c,h]),k=m.distanceTo(S);if(s&&s.unit==="imperial"){const A=3.2808*k;A>5280?or(e,c,A/5280,g._getUIString("ScaleControl.Miles")):or(e,c,A,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?or(e,c,k/1852,g._getUIString("ScaleControl.NauticalMiles")):k>=1e3?or(e,c,k/1e3,g._getUIString("ScaleControl.Kilometers")):or(e,c,k,g._getUIString("ScaleControl.Meters"))}function or(g,e,s,c){const h=function(m){const S=Math.pow(10,`${Math.floor(m)}`.length-1);let k=m/S;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(A){const F=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*F)/F}(k),S*k}(s);g.style.width=e*(h/s)+"px",g.innerHTML=`${h}&nbsp;${c}`}const Sr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},zl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yu(g){if(g){if(typeof g=="number"){const e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,g),"top-left":new u.P(e,e),"top-right":new u.P(-e,e),bottom:new u.P(0,-g),"bottom-left":new u.P(e,-e),"bottom-right":new u.P(-e,-e),left:new u.P(g,0),right:new u.P(-g,0)}}if(g instanceof u.P||Array.isArray(g)){const e=u.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:u.P.convert(g.center||[0,0]),top:u.P.convert(g.top||[0,0]),"top-left":u.P.convert(g["top-left"]||[0,0]),"top-right":u.P.convert(g["top-right"]||[0,0]),bottom:u.P.convert(g.bottom||[0,0]),"bottom-left":u.P.convert(g["bottom-left"]||[0,0]),"bottom-right":u.P.convert(g["bottom-right"]||[0,0]),left:u.P.convert(g.left||[0,0]),right:u.P.convert(g.right||[0,0])}}return yu(new u.P(0,0))}const xc=B;E.AJAXError=u.bh,E.Evented=u.E,E.LngLat=u.N,E.MercatorCoordinate=u.Z,E.Point=u.P,E.addProtocol=u.bi,E.config=u.a,E.removeProtocol=u.bj,E.AttributionControl=Bo,E.BoxZoomHandler=ps,E.CanvasSource=Lt,E.CooperativeGesturesHandler=Il,E.DoubleClickZoomHandler=aa,E.DragPanHandler=Nu,E.DragRotateHandler=yh,E.EdgeInsets=el,E.FullscreenControl=class extends u.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=s==null?void 0:s.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Mt,E.GeolocateControl=class extends u.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const s=new u.N(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,h=this._map.getBearing(),m=u.e({bearing:h},this.options.fitBoundsOptions),S=ye.fromLngLat(s,c);this._map.fitBounds(S,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const s=new u.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Al)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Oi({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")),this.fire(new u.k("userlocationlostfocus")))})}},this.options=u.e({},gu,g)}onAdd(g){return this._map=g,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(e=!1){if(kn!==void 0&&!e)return kn;if(window.navigator.permissions===void 0)return kn=!!window.navigator.geolocation,kn;try{kn=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{kn=!!window.navigator.geolocation}return kn})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pl=0,Al=!1}_isOutOfMapMaxBounds(g){const e=this._map.getMaxBounds(),s=g.coords;return e&&(s.longitude<e.getWest()||s.longitude>e.getEast()||s.latitude<e.getSouth()||s.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),e=g.getSouthEast(),s=g.getNorthEast(),c=e.distanceTo(s),h=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pl--,Al=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart")),this.fire(new u.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Pl++,Pl>1?(g={maximumAge:6e5,timeout:0},Al=!0):(g=this.options.positionOptions,Al=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.Hash=Lu,E.ImageSource=zt,E.KeyboardHandler=Zs,E.LngLatBounds=ye,E.LogoControl=mo,E.Map=class extends il{constructor(g){u.bf.mark(u.bg.create);const e=Object.assign(Object.assign({},Ma),g);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ia(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Qr,this._controls=[],this._mapId=u.a4(),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},mu),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ge.addThrottleControl(()=>this.isMoving()),this._requestManager=new Fe(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const c=au(h=>{this._trackResize&&!this._removed&&(this.resize(h),this.redraw())},50);this._resizeObserver=new ResizeObserver(h=>{s?c(h):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Uu(this,e),this._hash=e.hash&&new Lu(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,u.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Bo(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new mo,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new u.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new u.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new u.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,s,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,s,c)}resize(g){var e;const s=this._containerDimensions(),c=s[0],h=s[1],m=this._getClampedPixelRatio(c,h);if(this._resizeCanvas(c,h,m),this.painter.resize(c,h,m),this.painter.overLimit()){const k=this.painter.context.gl;this._maxCanvasSize=[k.drawingBufferWidth,k.drawingBufferHeight];const A=this._getClampedPixelRatio(c,h);this._resizeCanvas(c,h,A),this.painter.resize(c,h,A)}this.transform.resize(c,h),(e=this._requestedCameraState)===null||e===void 0||e.resize(c,h);const S=!this._moving;return S&&(this.stop(),this.fire(new u.k("movestart",g)).fire(new u.k("move",g))),this.fire(new u.k("resize",g)),S&&this.fire(new u.k("moveend",g)),this}_getClampedPixelRatio(g,e){const{0:s,1:c}=this._maxCanvasSize,h=this.getPixelRatio(),m=g*h,S=e*h;return Math.min(m>s?s/m:1,S>c?c/S:1)*h}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(ye.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(u.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(u.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,s){if(g==="mouseenter"||g==="mouseover"){let c=!1;return{layers:e,listener:s,delegates:{mousemove:m=>{const S=e.filter(A=>this.getLayer(A)),k=S.length!==0?this.queryRenderedFeatures(m.point,{layers:S}):[];k.length?c||(c=!0,s.call(this,new Fi(g,this,m.originalEvent,{features:k}))):c=!1},mouseout:()=>{c=!1}}}}if(g==="mouseleave"||g==="mouseout"){let c=!1;return{layers:e,listener:s,delegates:{mousemove:S=>{const k=e.filter(A=>this.getLayer(A));(k.length!==0?this.queryRenderedFeatures(S.point,{layers:k}):[]).length?c=!0:c&&(c=!1,s.call(this,new Fi(g,this,S.originalEvent)))},mouseout:S=>{c&&(c=!1,s.call(this,new Fi(g,this,S.originalEvent)))}}}}{const c=h=>{const m=e.filter(k=>this.getLayer(k)),S=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];S.length&&(h.features=S,s.call(this,h),delete h.features)};return{layers:e,listener:s,delegates:{[g]:c}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,s){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const c=this._delegatedListeners[g];for(let h=0;h<c.length;h++){const m=c[h];if(m.listener===s&&m.layers.length===e.length&&m.layers.every(S=>e.includes(S))){for(const S in m.delegates)this.off(S,m.delegates[S]);return void c.splice(h,1)}}}on(g,e,s){if(s===void 0)return super.on(g,e);const c=this._createDelegatedListener(g,typeof e=="string"?[e]:e,s);this._saveDelegatedListener(g,c);for(const h in c.delegates)this.on(h,c.delegates[h]);return this}once(g,e,s){if(s===void 0)return super.once(g,e);const c=typeof e=="string"?[e]:e,h=this._createDelegatedListener(g,c,s);for(const m in h.delegates){const S=h.delegates[m];h.delegates[m]=(...k)=>{this._removeDelegatedListener(g,c,s),S(...k)}}this._saveDelegatedListener(g,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(g,e,s){return s===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,s),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let s;const c=g instanceof u.P||Array.isArray(g),h=c?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:g)||{},h instanceof u.P||typeof h[0]=="number")s=[u.P.convert(h)];else{const m=u.P.convert(h[0]),S=u.P.convert(h[1]);s=[m,new u.P(S.x,m.y),S,new u.P(m.x,S.y),m]}return this.style.queryRenderedFeatures(s,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));const s=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Y(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,s):this.style.loadJSON(g,e,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Y(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,"Style");u.h(s,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new u.j(c))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(s){u.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){const e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new u.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(const s in this.style._layers){const c=this.style._layers[s];c.type==="hillshade"&&c.source===g.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new la(this.painter,e,g),this.painter.renderToTexture=new pu(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const e in g){const s=g[e]._tiles;for(const c in s){const h=s[c];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,e,s={}){const{pixelRatio:c=1,sdf:h=!1,stretchX:m,stretchY:S,content:k,textFitWidth:A,textFitHeight:F}=s;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||u.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:H,height:$,data:ne}=e,de=e;return this.style.addImage(g,{data:new u.R({width:H,height:$},new Uint8Array(ne)),pixelRatio:c,stretchX:m,stretchY:S,content:k,textFitWidth:A,textFitHeight:F,sdf:h,version:0,userImage:de}),de.onAdd&&de.onAdd(this,g),this}}{const{width:H,height:$,data:ne}=j.getImageData(e);this.style.addImage(g,{data:new u.R({width:H,height:$},ne),pixelRatio:c,stretchX:m,stretchY:S,content:k,textFitWidth:A,textFitHeight:F,sdf:h,version:0})}}updateImage(g,e){const s=this.style.getImage(g);if(!s)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||u.b(e)?j.getImageData(e):e,{width:h,height:m,data:S}=c;if(h===void 0||m===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==s.data.width||m!==s.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(e instanceof HTMLImageElement||u.b(e));return s.data.replace(S,k),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return ge.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,s){return this.style.setLayerZoomRange(g,e,s),this._update(!0)}setFilter(g,e,s={}){return this.style.setFilter(g,e,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,s,c={}){return this.style.setPaintProperty(g,e,s,c),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,s,c={}){return this.style.setLayoutProperty(g,e,s,c),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,s,c=>{c||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,s=>{s||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const e=this._canvasContainer=N.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),c=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],c);const h=this._controlContainer=N.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{m[S]=N.create("div",`maplibregl-ctrl-${S} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:g},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});const s=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!s){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Ca(s,this.transform),q.testSupport(s)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const h=this.transform.zoom,m=j.now();this.style.zoomHistory.update(h,m);const S=new u.z(h,{now:m,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=S.crossFadingFactor();k===1&&k===this._crossFadingFactor||(s=!0,this._crossFadingFactor=k),this.style.update(S)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bf.mark(u.bg.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,u.bf.mark(u.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ge.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),u.bf.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(g=>{u.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return sl}getCameraTargetElevation(){return this.transform.elevation}},E.MapMouseEvent=Fi,E.MapTouchEvent=Fo,E.MapWheelEvent=fc,E.Marker=Oi,E.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const e=this._map.getZoom(),s=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,s)=>{const c=this._map._getUIString(`NavigationControl.${s}`);e.title=c,e.setAttribute("aria-label",c)},this.options=u.e({},Bn,g),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new za(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){const s=N.create("button",g,this._container);return s.type="button",s.addEventListener("click",e),s}},E.Popup=class extends u.E{constructor(g){super(),this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const k of this.options.className.split(" "))this._container.classList.add(k);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?tn(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!e)return;const c=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let h=this.options.anchor;const m=yu(this.options.offset);if(!h){const k=this._container.offsetWidth,A=this._container.offsetHeight;let F;F=c.y+m.bottom.y<A?["top"]:c.y>this._map.transform.height-A?["bottom"]:[],c.x<k/2?F.push("left"):c.x>this._map.transform.width-k/2&&F.push("right"),h=F.length===0?"bottom":F.join("-")}let S=c.add(m[h]);this.options.subpixelPositioning||(S=S.round()),N.setTransform(this._container,`${Xs[h]} translate(${S.x}px,${S.y}px)`),ua(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Sr),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=u.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const e=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=g;c=s.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(zl);g&&g.focus()}},E.RasterDEMTileSource=_t,E.RasterTileSource=Ne,E.ScaleControl=class{constructor(g){this._onMove=()=>{Ml(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ml(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ps),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=ms,E.Style=Y,E.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=kl,E.TwoFingersTouchRotateHandler=Tl,E.TwoFingersTouchZoomHandler=du,E.TwoFingersTouchZoomRotateHandler=ju,E.VectorTileSource=we,E.VideoSource=rr,E.addSourceType=(g,e)=>u._(void 0,void 0,void 0,function*(){if(en(g))throw new Error(`A source type called "${g}" already exists.`);((s,c)=>{_r[s]=c})(g,e)}),E.clearPrewarmedResources=function(){const g=fr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(bt),fr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return wn().getRTLTextPluginStatus()},E.getVersion=function(){return xc},E.getWorkerCount=function(){return wt.workerCount},E.getWorkerUrl=function(){return u.a.WORKER_URL},E.importScriptInWorkers=function(g){return Br().broadcast("IS",g)},E.prewarm=function(){Kt().acquire(bt)},E.setMaxParallelImageRequests=function(g){u.a.MAX_PARALLEL_IMAGE_REQUESTS=g},E.setRTLTextPlugin=function(g,e){return wn().setRTLTextPlugin(g,e)},E.setWorkerCount=function(g){wt.workerCount=g},E.setWorkerUrl=function(g){u.a.WORKER_URL=g}});var z=v;return z})}(ep)),ep.exports}var dv=hv();const Ty=ld(dv),fv={version:8,sources:{osm:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap Contributors",maxzoom:19}},layers:[{id:"osm",type:"raster",source:"osm"}]};var rc={},th={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg;function pv(){if(pg)return th;pg=1;var d=ch();function x(R){for(var Y="https://reactjs.org/docs/error-decoder.html?invariant="+R,he=1;he<arguments.length;he++)Y+="&args[]="+encodeURIComponent(arguments[he]);return"Minified React error #"+R+"; visit "+Y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v=Object.prototype.hasOwnProperty,C=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I={},z={};function E(R){return v.call(z,R)?!0:v.call(I,R)?!1:C.test(R)?z[R]=!0:(I[R]=!0,!1)}function u(R,Y,he,Ee,Ye,st,Et){this.acceptsBooleans=Y===2||Y===3||Y===4,this.attributeName=Ee,this.attributeNamespace=Ye,this.mustUseProperty=he,this.propertyName=R,this.type=Y,this.sanitizeURL=st,this.removeEmptyString=Et}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(R){B[R]=new u(R,0,!1,R,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(R){var Y=R[0];B[Y]=new u(Y,1,!1,R[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(R){B[R]=new u(R,2,!1,R.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(R){B[R]=new u(R,2,!1,R,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(R){B[R]=new u(R,3,!1,R.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(R){B[R]=new u(R,3,!0,R,null,!1,!1)}),["capture","download"].forEach(function(R){B[R]=new u(R,4,!1,R,null,!1,!1)}),["cols","rows","size","span"].forEach(function(R){B[R]=new u(R,6,!1,R,null,!1,!1)}),["rowSpan","start"].forEach(function(R){B[R]=new u(R,5,!1,R.toLowerCase(),null,!1,!1)});var U=/[\-:]([a-z])/g;function K(R){return R[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(R){var Y=R.replace(U,K);B[Y]=new u(Y,1,!1,R,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(R){var Y=R.replace(U,K);B[Y]=new u(Y,1,!1,R,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(R){var Y=R.replace(U,K);B[Y]=new u(Y,1,!1,R,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(R){B[R]=new u(R,1,!1,R.toLowerCase(),null,!1,!1)}),B.xlinkHref=new u("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(R){B[R]=new u(R,1,!1,R.toLowerCase(),null,!0,!0)});var j={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N=["Webkit","ms","Moz","O"];Object.keys(j).forEach(function(R){N.forEach(function(Y){Y=Y+R.charAt(0).toUpperCase()+R.substring(1),j[Y]=j[R]})});var q=/["'&<>]/;function se(R){if(typeof R=="boolean"||typeof R=="number")return""+R;R=""+R;var Y=q.exec(R);if(Y){var he="",Ee,Ye=0;for(Ee=Y.index;Ee<R.length;Ee++){switch(R.charCodeAt(Ee)){case 34:Y="&quot;";break;case 38:Y="&amp;";break;case 39:Y="&#x27;";break;case 60:Y="&lt;";break;case 62:Y="&gt;";break;default:continue}Ye!==Ee&&(he+=R.substring(Ye,Ee)),Ye=Ee+1,he+=Y}R=Ye!==Ee?he+R.substring(Ye,Ee):he}return R}var J=/([A-Z])/g,ae=/^ms-/,re=Array.isArray;function pe(R,Y){return{insertionMode:R,selectedValue:Y}}function ge(R,Y,he){switch(Y){case"select":return pe(1,he.value!=null?he.value:he.defaultValue);case"svg":return pe(2,null);case"math":return pe(3,null);case"foreignObject":return pe(1,null);case"table":return pe(4,null);case"thead":case"tbody":case"tfoot":return pe(5,null);case"colgroup":return pe(7,null);case"tr":return pe(6,null)}return 4<=R.insertionMode||R.insertionMode===0?pe(1,null):R}var Fe=new Map;function ve(R,Y,he){if(typeof he!="object")throw Error(x(62));Y=!0;for(var Ee in he)if(v.call(he,Ee)){var Ye=he[Ee];if(Ye!=null&&typeof Ye!="boolean"&&Ye!==""){if(Ee.indexOf("--")===0){var st=se(Ee);Ye=se((""+Ye).trim())}else{st=Ee;var Et=Fe.get(st);Et!==void 0||(Et=se(st.replace(J,"-$1").toLowerCase().replace(ae,"-ms-")),Fe.set(st,Et)),st=Et,Ye=typeof Ye=="number"?Ye===0||v.call(j,Ee)?""+Ye:Ye+"px":se((""+Ye).trim())}Y?(Y=!1,R.push(' style="',st,":",Ye)):R.push(";",st,":",Ye)}}Y||R.push('"')}function qe(R,Y,he,Ee){switch(he){case"style":ve(R,Y,Ee);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<he.length)||he[0]!=="o"&&he[0]!=="O"||he[1]!=="n"&&he[1]!=="N"){if(Y=B.hasOwnProperty(he)?B[he]:null,Y!==null){switch(typeof Ee){case"function":case"symbol":return;case"boolean":if(!Y.acceptsBooleans)return}switch(he=Y.attributeName,Y.type){case 3:Ee&&R.push(" ",he,'=""');break;case 4:Ee===!0?R.push(" ",he,'=""'):Ee!==!1&&R.push(" ",he,'="',se(Ee),'"');break;case 5:isNaN(Ee)||R.push(" ",he,'="',se(Ee),'"');break;case 6:!isNaN(Ee)&&1<=Ee&&R.push(" ",he,'="',se(Ee),'"');break;default:Y.sanitizeURL&&(Ee=""+Ee),R.push(" ",he,'="',se(Ee),'"')}}else if(E(he)){switch(typeof Ee){case"function":case"symbol":return;case"boolean":if(Y=he.toLowerCase().slice(0,5),Y!=="data-"&&Y!=="aria-")return}R.push(" ",he,'="',se(Ee),'"')}}}function je(R,Y,he){if(Y!=null){if(he!=null)throw Error(x(60));if(typeof Y!="object"||!("__html"in Y))throw Error(x(61));Y=Y.__html,Y!=null&&R.push(""+Y)}}function St(R){var Y="";return d.Children.forEach(R,function(he){he!=null&&(Y+=he)}),Y}function ot(R,Y,he,Ee){R.push(xe(he));var Ye=he=null,st;for(st in Y)if(v.call(Y,st)){var Et=Y[st];if(Et!=null)switch(st){case"children":he=Et;break;case"dangerouslySetInnerHTML":Ye=Et;break;default:qe(R,Ee,st,Et)}}return R.push(">"),je(R,Ye,he),typeof he=="string"?(R.push(se(he)),null):he}var At=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,xt=new Map;function xe(R){var Y=xt.get(R);if(Y===void 0){if(!At.test(R))throw Error(x(65,R));Y="<"+R,xt.set(R,Y)}return Y}function Je(R,Y,he,Ee,Ye){switch(Y){case"select":R.push(xe("select"));var st=null,Et=null;for(Vr in he)if(v.call(he,Vr)){var Ht=he[Vr];if(Ht!=null)switch(Vr){case"children":st=Ht;break;case"dangerouslySetInnerHTML":Et=Ht;break;case"defaultValue":case"value":break;default:qe(R,Ee,Vr,Ht)}}return R.push(">"),je(R,Et,st),st;case"option":Et=Ye.selectedValue,R.push(xe("option"));var Jt=Ht=null,Rr=null,Vr=null;for(st in he)if(v.call(he,st)){var fn=he[st];if(fn!=null)switch(st){case"children":Ht=fn;break;case"selected":Rr=fn;break;case"dangerouslySetInnerHTML":Vr=fn;break;case"value":Jt=fn;default:qe(R,Ee,st,fn)}}if(Et!=null)if(he=Jt!==null?""+Jt:St(Ht),re(Et)){for(Ee=0;Ee<Et.length;Ee++)if(""+Et[Ee]===he){R.push(' selected=""');break}}else""+Et===he&&R.push(' selected=""');else Rr&&R.push(' selected=""');return R.push(">"),je(R,Vr,Ht),Ht;case"textarea":R.push(xe("textarea")),Vr=Et=st=null;for(Ht in he)if(v.call(he,Ht)&&(Jt=he[Ht],Jt!=null))switch(Ht){case"children":Vr=Jt;break;case"value":st=Jt;break;case"defaultValue":Et=Jt;break;case"dangerouslySetInnerHTML":throw Error(x(91));default:qe(R,Ee,Ht,Jt)}if(st===null&&Et!==null&&(st=Et),R.push(">"),Vr!=null){if(st!=null)throw Error(x(92));if(re(Vr)&&1<Vr.length)throw Error(x(93));st=""+Vr}return typeof st=="string"&&st[0]===`
`&&R.push(`
`),st!==null&&R.push(se(""+st)),null;case"input":R.push(xe("input")),Jt=Vr=Ht=st=null;for(Et in he)if(v.call(he,Et)&&(Rr=he[Et],Rr!=null))switch(Et){case"children":case"dangerouslySetInnerHTML":throw Error(x(399,"input"));case"defaultChecked":Jt=Rr;break;case"defaultValue":Ht=Rr;break;case"checked":Vr=Rr;break;case"value":st=Rr;break;default:qe(R,Ee,Et,Rr)}return Vr!==null?qe(R,Ee,"checked",Vr):Jt!==null&&qe(R,Ee,"checked",Jt),st!==null?qe(R,Ee,"value",st):Ht!==null&&qe(R,Ee,"value",Ht),R.push("/>"),null;case"menuitem":R.push(xe("menuitem"));for(var Ei in he)if(v.call(he,Ei)&&(st=he[Ei],st!=null))switch(Ei){case"children":case"dangerouslySetInnerHTML":throw Error(x(400));default:qe(R,Ee,Ei,st)}return R.push(">"),null;case"title":R.push(xe("title")),st=null;for(fn in he)if(v.call(he,fn)&&(Et=he[fn],Et!=null))switch(fn){case"children":st=Et;break;case"dangerouslySetInnerHTML":throw Error(x(434));default:qe(R,Ee,fn,Et)}return R.push(">"),st;case"listing":case"pre":R.push(xe(Y)),Et=st=null;for(Jt in he)if(v.call(he,Jt)&&(Ht=he[Jt],Ht!=null))switch(Jt){case"children":st=Ht;break;case"dangerouslySetInnerHTML":Et=Ht;break;default:qe(R,Ee,Jt,Ht)}if(R.push(">"),Et!=null){if(st!=null)throw Error(x(60));if(typeof Et!="object"||!("__html"in Et))throw Error(x(61));he=Et.__html,he!=null&&(typeof he=="string"&&0<he.length&&he[0]===`
`?R.push(`
`,he):R.push(""+he))}return typeof st=="string"&&st[0]===`
`&&R.push(`
`),st;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":R.push(xe(Y));for(var es in he)if(v.call(he,es)&&(st=he[es],st!=null))switch(es){case"children":case"dangerouslySetInnerHTML":throw Error(x(399,Y));default:qe(R,Ee,es,st)}return R.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ot(R,he,Y,Ee);case"html":return Ye.insertionMode===0&&R.push("<!DOCTYPE html>"),ot(R,he,Y,Ee);default:if(Y.indexOf("-")===-1&&typeof he.is!="string")return ot(R,he,Y,Ee);R.push(xe(Y)),Et=st=null;for(Rr in he)if(v.call(he,Rr)&&(Ht=he[Rr],Ht!=null))switch(Rr){case"children":st=Ht;break;case"dangerouslySetInnerHTML":Et=Ht;break;case"style":ve(R,Ee,Ht);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:E(Rr)&&typeof Ht!="function"&&typeof Ht!="symbol"&&R.push(" ",Rr,'="',se(Ht),'"')}return R.push(">"),je(R,Et,st),st}}function G(R,Y,he){if(R.push('<!--$?--><template id="'),he===null)throw Error(x(395));return R.push(he),R.push('"></template>')}function Ve(R,Y,he,Ee){switch(he.insertionMode){case 0:case 1:return R.push('<div hidden id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 2:return R.push('<svg aria-hidden="true" style="display:none" id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 3:return R.push('<math aria-hidden="true" style="display:none" id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 4:return R.push('<table hidden id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 5:return R.push('<table hidden><tbody id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 6:return R.push('<table hidden><tr id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');case 7:return R.push('<table hidden><colgroup id="'),R.push(Y.segmentPrefix),Y=Ee.toString(16),R.push(Y),R.push('">');default:throw Error(x(397))}}function Rt(R,Y){switch(Y.insertionMode){case 0:case 1:return R.push("</div>");case 2:return R.push("</svg>");case 3:return R.push("</math>");case 4:return R.push("</table>");case 5:return R.push("</tbody></table>");case 6:return R.push("</tr></table>");case 7:return R.push("</colgroup></table>");default:throw Error(x(397))}}var Ae=/[<\u2028\u2029]/g;function et(R){return JSON.stringify(R).replace(Ae,function(Y){switch(Y){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function Ze(R,Y){return Y=Y===void 0?"":Y,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:Y+"P:",segmentPrefix:Y+"S:",boundaryPrefix:Y+"B:",idPrefix:Y,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:R}}function ht(R,Y,he,Ee){return he.generateStaticMarkup?(R.push(se(Y)),!1):(Y===""?R=Ee:(Ee&&R.push("<!-- -->"),R.push(se(Y)),R=!0),R)}var oe=Object.assign,_e=Symbol.for("react.element"),Ct=Symbol.for("react.portal"),bt=Symbol.for("react.fragment"),wt=Symbol.for("react.strict_mode"),ar=Symbol.for("react.profiler"),fr=Symbol.for("react.provider"),qt=Symbol.for("react.context"),Kt=Symbol.for("react.forward_ref"),Cr=Symbol.for("react.suspense"),Br=Symbol.for("react.suspense_list"),Yr=Symbol.for("react.memo"),Zr=Symbol.for("react.lazy"),W=Symbol.for("react.scope"),ft=Symbol.for("react.debug_trace_mode"),ye=Symbol.for("react.legacy_hidden"),Me=Symbol.for("react.default_value"),we=Symbol.iterator;function Ne(R){if(R==null)return null;if(typeof R=="function")return R.displayName||R.name||null;if(typeof R=="string")return R;switch(R){case bt:return"Fragment";case Ct:return"Portal";case ar:return"Profiler";case wt:return"StrictMode";case Cr:return"Suspense";case Br:return"SuspenseList"}if(typeof R=="object")switch(R.$$typeof){case qt:return(R.displayName||"Context")+".Consumer";case fr:return(R._context.displayName||"Context")+".Provider";case Kt:var Y=R.render;return R=R.displayName,R||(R=Y.displayName||Y.name||"",R=R!==""?"ForwardRef("+R+")":"ForwardRef"),R;case Yr:return Y=R.displayName||null,Y!==null?Y:Ne(R.type)||"Memo";case Zr:Y=R._payload,R=R._init;try{return Ne(R(Y))}catch{}}return null}var _t={};function Mt(R,Y){if(R=R.contextTypes,!R)return _t;var he={},Ee;for(Ee in R)he[Ee]=Y[Ee];return he}var nt=null;function zt(R,Y){if(R!==Y){R.context._currentValue2=R.parentValue,R=R.parent;var he=Y.parent;if(R===null){if(he!==null)throw Error(x(401))}else{if(he===null)throw Error(x(401));zt(R,he)}Y.context._currentValue2=Y.value}}function rr(R){R.context._currentValue2=R.parentValue,R=R.parent,R!==null&&rr(R)}function Lt(R){var Y=R.parent;Y!==null&&Lt(Y),R.context._currentValue2=R.value}function _r(R,Y){if(R.context._currentValue2=R.parentValue,R=R.parent,R===null)throw Error(x(402));R.depth===Y.depth?zt(R,Y):_r(R,Y)}function en(R,Y){var he=Y.parent;if(he===null)throw Error(x(402));R.depth===he.depth?zt(R,he):en(R,he),Y.context._currentValue2=Y.value}function vt(R){var Y=nt;Y!==R&&(Y===null?Lt(R):R===null?rr(Y):Y.depth===R.depth?zt(Y,R):Y.depth>R.depth?_r(Y,R):en(Y,R),nt=R)}var xn={isMounted:function(){return!1},enqueueSetState:function(R,Y){R=R._reactInternals,R.queue!==null&&R.queue.push(Y)},enqueueReplaceState:function(R,Y){R=R._reactInternals,R.replace=!0,R.queue=[Y]},enqueueForceUpdate:function(){}};function yn(R,Y,he,Ee){var Ye=R.state!==void 0?R.state:null;R.updater=xn,R.props=he,R.state=Ye;var st={queue:[],replace:!1};R._reactInternals=st;var Et=Y.contextType;if(R.context=typeof Et=="object"&&Et!==null?Et._currentValue2:Ee,Et=Y.getDerivedStateFromProps,typeof Et=="function"&&(Et=Et(he,Ye),Ye=Et==null?Ye:oe({},Ye,Et),R.state=Ye),typeof Y.getDerivedStateFromProps!="function"&&typeof R.getSnapshotBeforeUpdate!="function"&&(typeof R.UNSAFE_componentWillMount=="function"||typeof R.componentWillMount=="function"))if(Y=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),Y!==R.state&&xn.enqueueReplaceState(R,R.state,null),st.queue!==null&&0<st.queue.length)if(Y=st.queue,Et=st.replace,st.queue=null,st.replace=!1,Et&&Y.length===1)R.state=Y[0];else{for(st=Et?Y[0]:R.state,Ye=!0,Et=Et?1:0;Et<Y.length;Et++){var Ht=Y[Et];Ht=typeof Ht=="function"?Ht.call(R,st,he,Ee):Ht,Ht!=null&&(Ye?(Ye=!1,st=oe({},st,Ht)):oe(st,Ht))}R.state=st}else st.queue=null}var wn={id:1,overflow:""};function ui(R,Y,he){var Ee=R.id;R=R.overflow;var Ye=32-Pt(Ee)-1;Ee&=~(1<<Ye),he+=1;var st=32-Pt(Y)+Ye;if(30<st){var Et=Ye-Ye%5;return st=(Ee&(1<<Et)-1).toString(32),Ee>>=Et,Ye-=Et,{id:1<<32-Pt(Y)+Ye|he<<Ye|Ee,overflow:st+R}}return{id:1<<st|he<<Ye|Ee,overflow:R}}var Pt=Math.clz32?Math.clz32:_n,zr=Math.log,wr=Math.LN2;function _n(R){return R>>>=0,R===0?32:31-(zr(R)/wr|0)|0}function ci(R,Y){return R===Y&&(R!==0||1/R===1/Y)||R!==R&&Y!==Y}var Ir=typeof Object.is=="function"?Object.is:ci,An=null,wi=null,Xn=null,Nr=null,Ce=!1,ee=!1,Q=0,ue=null,Se=0;function Oe(){if(An===null)throw Error(x(321));return An}function $e(){if(0<Se)throw Error(x(312));return{memoizedState:null,queue:null,next:null}}function Ke(){return Nr===null?Xn===null?(Ce=!1,Xn=Nr=$e()):(Ce=!0,Nr=Xn):Nr.next===null?(Ce=!1,Nr=Nr.next=$e()):(Ce=!0,Nr=Nr.next),Nr}function Le(){wi=An=null,ee=!1,Xn=null,Se=0,Nr=ue=null}function pt(R,Y){return typeof Y=="function"?Y(R):Y}function It(R,Y,he){if(An=Oe(),Nr=Ke(),Ce){var Ee=Nr.queue;if(Y=Ee.dispatch,ue!==null&&(he=ue.get(Ee),he!==void 0)){ue.delete(Ee),Ee=Nr.memoizedState;do Ee=R(Ee,he.action),he=he.next;while(he!==null);return Nr.memoizedState=Ee,[Ee,Y]}return[Nr.memoizedState,Y]}return R=R===pt?typeof Y=="function"?Y():Y:he!==void 0?he(Y):Y,Nr.memoizedState=R,R=Nr.queue={last:null,dispatch:null},R=R.dispatch=Nt.bind(null,An,R),[Nr.memoizedState,R]}function ut(R,Y){if(An=Oe(),Nr=Ke(),Y=Y===void 0?null:Y,Nr!==null){var he=Nr.memoizedState;if(he!==null&&Y!==null){var Ee=he[1];e:if(Ee===null)Ee=!1;else{for(var Ye=0;Ye<Ee.length&&Ye<Y.length;Ye++)if(!Ir(Y[Ye],Ee[Ye])){Ee=!1;break e}Ee=!0}if(Ee)return he[0]}}return R=R(),Nr.memoizedState=[R,Y],R}function Nt(R,Y,he){if(25<=Se)throw Error(x(301));if(R===An)if(ee=!0,R={action:he,next:null},ue===null&&(ue=new Map),he=ue.get(Y),he===void 0)ue.set(Y,R);else{for(Y=he;Y.next!==null;)Y=Y.next;Y.next=R}}function cr(){throw Error(x(394))}function pr(){}var Jr={readContext:function(R){return R._currentValue2},useContext:function(R){return Oe(),R._currentValue2},useMemo:ut,useReducer:It,useRef:function(R){An=Oe(),Nr=Ke();var Y=Nr.memoizedState;return Y===null?(R={current:R},Nr.memoizedState=R):Y},useState:function(R){return It(pt,R)},useInsertionEffect:pr,useLayoutEffect:function(){},useCallback:function(R,Y){return ut(function(){return R},Y)},useImperativeHandle:pr,useEffect:pr,useDebugValue:pr,useDeferredValue:function(R){return Oe(),R},useTransition:function(){return Oe(),[!1,cr]},useId:function(){var R=wi.treeContext,Y=R.overflow;R=R.id,R=(R&~(1<<32-Pt(R)-1)).toString(32)+Y;var he=Mr;if(he===null)throw Error(x(404));return Y=Q++,R=":"+he.idPrefix+"R"+R,0<Y&&(R+="H"+Y.toString(32)),R+":"},useMutableSource:function(R,Y){return Oe(),Y(R._source)},useSyncExternalStore:function(R,Y,he){if(he===void 0)throw Error(x(407));return he()}},Mr=null,Kr=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Ur(R){return console.error(R),null}function bn(){}function En(R,Y,he,Ee,Ye,st,Et,Ht,Jt){var Rr=[],Vr=new Set;return Y={destination:null,responseState:Y,progressiveChunkSize:Ee===void 0?12800:Ee,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Vr,pingedTasks:Rr,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:Ye===void 0?Ur:Ye,onAllReady:bn,onShellReady:Et===void 0?bn:Et,onShellError:bn,onFatalError:bn},he=rn(Y,0,null,he,!1,!1),he.parentFlushed=!0,R=Hr(Y,R,null,he,Vr,_t,null,wn),Rr.push(R),Y}function Hr(R,Y,he,Ee,Ye,st,Et,Ht){R.allPendingTasks++,he===null?R.pendingRootTasks++:he.pendingTasks++;var Jt={node:Y,ping:function(){var Rr=R.pingedTasks;Rr.push(Jt),Rr.length===1&&fi(R)},blockedBoundary:he,blockedSegment:Ee,abortSet:Ye,legacyContext:st,context:Et,treeContext:Ht};return Ye.add(Jt),Jt}function rn(R,Y,he,Ee,Ye,st){return{status:0,id:-1,index:Y,parentFlushed:!1,chunks:[],children:[],formatContext:Ee,boundary:he,lastPushedText:Ye,textEmbedded:st}}function un(R,Y){if(R=R.onError(Y),R!=null&&typeof R!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof R+'" instead');return R}function Fn(R,Y){var he=R.onShellError;he(Y),he=R.onFatalError,he(Y),R.destination!==null?(R.status=2,R.destination.destroy(Y)):(R.status=1,R.fatalError=Y)}function Kn(R,Y,he,Ee,Ye){for(An={},wi=Y,Q=0,R=he(Ee,Ye);ee;)ee=!1,Q=0,Se+=1,Nr=null,R=he(Ee,Ye);return Le(),R}function hi(R,Y,he,Ee){var Ye=he.render(),st=Ee.childContextTypes;if(st!=null){var Et=Y.legacyContext;if(typeof he.getChildContext!="function")Ee=Et;else{he=he.getChildContext();for(var Ht in he)if(!(Ht in st))throw Error(x(108,Ne(Ee)||"Unknown",Ht));Ee=oe({},Et,he)}Y.legacyContext=Ee,bi(R,Y,Ye),Y.legacyContext=Et}else bi(R,Y,Ye)}function ao(R,Y){if(R&&R.defaultProps){Y=oe({},Y),R=R.defaultProps;for(var he in R)Y[he]===void 0&&(Y[he]=R[he]);return Y}return Y}function Pr(R,Y,he,Ee,Ye){if(typeof he=="function")if(he.prototype&&he.prototype.isReactComponent){Ye=Mt(he,Y.legacyContext);var st=he.contextType;st=new he(Ee,typeof st=="object"&&st!==null?st._currentValue2:Ye),yn(st,he,Ee,Ye),hi(R,Y,st,he)}else{st=Mt(he,Y.legacyContext),Ye=Kn(R,Y,he,Ee,st);var Et=Q!==0;if(typeof Ye=="object"&&Ye!==null&&typeof Ye.render=="function"&&Ye.$$typeof===void 0)yn(Ye,he,Ee,st),hi(R,Y,Ye,he);else if(Et){Ee=Y.treeContext,Y.treeContext=ui(Ee,1,0);try{bi(R,Y,Ye)}finally{Y.treeContext=Ee}}else bi(R,Y,Ye)}else if(typeof he=="string"){switch(Ye=Y.blockedSegment,st=Je(Ye.chunks,he,Ee,R.responseState,Ye.formatContext),Ye.lastPushedText=!1,Et=Ye.formatContext,Ye.formatContext=ge(Et,he,Ee),di(R,Y,st),Ye.formatContext=Et,he){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:Ye.chunks.push("</",he,">")}Ye.lastPushedText=!1}else{switch(he){case ye:case ft:case wt:case ar:case bt:bi(R,Y,Ee.children);return;case Br:bi(R,Y,Ee.children);return;case W:throw Error(x(343));case Cr:e:{he=Y.blockedBoundary,Ye=Y.blockedSegment,st=Ee.fallback,Ee=Ee.children,Et=new Set;var Ht={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:Et,errorDigest:null},Jt=rn(R,Ye.chunks.length,Ht,Ye.formatContext,!1,!1);Ye.children.push(Jt),Ye.lastPushedText=!1;var Rr=rn(R,0,null,Ye.formatContext,!1,!1);Rr.parentFlushed=!0,Y.blockedBoundary=Ht,Y.blockedSegment=Rr;try{if(di(R,Y,Ee),R.responseState.generateStaticMarkup||Rr.lastPushedText&&Rr.textEmbedded&&Rr.chunks.push("<!-- -->"),Rr.status=1,ti(Ht,Rr),Ht.pendingTasks===0)break e}catch(Vr){Rr.status=4,Ht.forceClientRender=!0,Ht.errorDigest=un(R,Vr)}finally{Y.blockedBoundary=he,Y.blockedSegment=Ye}Y=Hr(R,st,he,Jt,Et,Y.legacyContext,Y.context,Y.treeContext),R.pingedTasks.push(Y)}return}if(typeof he=="object"&&he!==null)switch(he.$$typeof){case Kt:if(Ee=Kn(R,Y,he.render,Ee,Ye),Q!==0){he=Y.treeContext,Y.treeContext=ui(he,1,0);try{bi(R,Y,Ee)}finally{Y.treeContext=he}}else bi(R,Y,Ee);return;case Yr:he=he.type,Ee=ao(he,Ee),Pr(R,Y,he,Ee,Ye);return;case fr:if(Ye=Ee.children,he=he._context,Ee=Ee.value,st=he._currentValue2,he._currentValue2=Ee,Et=nt,nt=Ee={parent:Et,depth:Et===null?0:Et.depth+1,context:he,parentValue:st,value:Ee},Y.context=Ee,bi(R,Y,Ye),R=nt,R===null)throw Error(x(403));Ee=R.parentValue,R.context._currentValue2=Ee===Me?R.context._defaultValue:Ee,R=nt=R.parent,Y.context=R;return;case qt:Ee=Ee.children,Ee=Ee(he._currentValue2),bi(R,Y,Ee);return;case Zr:Ye=he._init,he=Ye(he._payload),Ee=ao(he,Ee),Pr(R,Y,he,Ee,void 0);return}throw Error(x(130,he==null?he:typeof he,""))}}function bi(R,Y,he){if(Y.node=he,typeof he=="object"&&he!==null){switch(he.$$typeof){case _e:Pr(R,Y,he.type,he.props,he.ref);return;case Ct:throw Error(x(257));case Zr:var Ee=he._init;he=Ee(he._payload),bi(R,Y,he);return}if(re(he)){zo(R,Y,he);return}if(he===null||typeof he!="object"?Ee=null:(Ee=we&&he[we]||he["@@iterator"],Ee=typeof Ee=="function"?Ee:null),Ee&&(Ee=Ee.call(he))){if(he=Ee.next(),!he.done){var Ye=[];do Ye.push(he.value),he=Ee.next();while(!he.done);zo(R,Y,Ye)}return}throw R=Object.prototype.toString.call(he),Error(x(31,R==="[object Object]"?"object with keys {"+Object.keys(he).join(", ")+"}":R))}typeof he=="string"?(Ee=Y.blockedSegment,Ee.lastPushedText=ht(Y.blockedSegment.chunks,he,R.responseState,Ee.lastPushedText)):typeof he=="number"&&(Ee=Y.blockedSegment,Ee.lastPushedText=ht(Y.blockedSegment.chunks,""+he,R.responseState,Ee.lastPushedText))}function zo(R,Y,he){for(var Ee=he.length,Ye=0;Ye<Ee;Ye++){var st=Y.treeContext;Y.treeContext=ui(st,Ee,Ye);try{di(R,Y,he[Ye])}finally{Y.treeContext=st}}}function di(R,Y,he){var Ee=Y.blockedSegment.formatContext,Ye=Y.legacyContext,st=Y.context;try{return bi(R,Y,he)}catch(Jt){if(Le(),typeof Jt=="object"&&Jt!==null&&typeof Jt.then=="function"){he=Jt;var Et=Y.blockedSegment,Ht=rn(R,Et.chunks.length,null,Et.formatContext,Et.lastPushedText,!0);Et.children.push(Ht),Et.lastPushedText=!1,R=Hr(R,Y.node,Y.blockedBoundary,Ht,Y.abortSet,Y.legacyContext,Y.context,Y.treeContext).ping,he.then(R,R),Y.blockedSegment.formatContext=Ee,Y.legacyContext=Ye,Y.context=st,vt(st)}else throw Y.blockedSegment.formatContext=Ee,Y.legacyContext=Ye,Y.context=st,vt(st),Jt}}function ei(R){var Y=R.blockedBoundary;R=R.blockedSegment,R.status=3,Hn(this,Y,R)}function pl(R,Y,he){var Ee=R.blockedBoundary;R.blockedSegment.status=3,Ee===null?(Y.allPendingTasks--,Y.status!==2&&(Y.status=2,Y.destination!==null&&Y.destination.push(null))):(Ee.pendingTasks--,Ee.forceClientRender||(Ee.forceClientRender=!0,R=he===void 0?Error(x(432)):he,Ee.errorDigest=Y.onError(R),Ee.parentFlushed&&Y.clientRenderedBoundaries.push(Ee)),Ee.fallbackAbortableTasks.forEach(function(Ye){return pl(Ye,Y,he)}),Ee.fallbackAbortableTasks.clear(),Y.allPendingTasks--,Y.allPendingTasks===0&&(Ee=Y.onAllReady,Ee()))}function ti(R,Y){if(Y.chunks.length===0&&Y.children.length===1&&Y.children[0].boundary===null){var he=Y.children[0];he.id=Y.id,he.parentFlushed=!0,he.status===1&&ti(R,he)}else R.completedSegments.push(Y)}function Hn(R,Y,he){if(Y===null){if(he.parentFlushed){if(R.completedRootSegment!==null)throw Error(x(389));R.completedRootSegment=he}R.pendingRootTasks--,R.pendingRootTasks===0&&(R.onShellError=bn,Y=R.onShellReady,Y())}else Y.pendingTasks--,Y.forceClientRender||(Y.pendingTasks===0?(he.parentFlushed&&he.status===1&&ti(Y,he),Y.parentFlushed&&R.completedBoundaries.push(Y),Y.fallbackAbortableTasks.forEach(ei,R),Y.fallbackAbortableTasks.clear()):he.parentFlushed&&he.status===1&&(ti(Y,he),Y.completedSegments.length===1&&Y.parentFlushed&&R.partialBoundaries.push(Y)));R.allPendingTasks--,R.allPendingTasks===0&&(R=R.onAllReady,R())}function fi(R){if(R.status!==2){var Y=nt,he=Kr.current;Kr.current=Jr;var Ee=Mr;Mr=R.responseState;try{var Ye=R.pingedTasks,st;for(st=0;st<Ye.length;st++){var Et=Ye[st],Ht=R,Jt=Et.blockedSegment;if(Jt.status===0){vt(Et.context);try{bi(Ht,Et,Et.node),Ht.responseState.generateStaticMarkup||Jt.lastPushedText&&Jt.textEmbedded&&Jt.chunks.push("<!-- -->"),Et.abortSet.delete(Et),Jt.status=1,Hn(Ht,Et.blockedBoundary,Jt)}catch(Vi){if(Le(),typeof Vi=="object"&&Vi!==null&&typeof Vi.then=="function"){var Rr=Et.ping;Vi.then(Rr,Rr)}else{Et.abortSet.delete(Et),Jt.status=4;var Vr=Et.blockedBoundary,fn=Vi,Ei=un(Ht,fn);if(Vr===null?Fn(Ht,fn):(Vr.pendingTasks--,Vr.forceClientRender||(Vr.forceClientRender=!0,Vr.errorDigest=Ei,Vr.parentFlushed&&Ht.clientRenderedBoundaries.push(Vr))),Ht.allPendingTasks--,Ht.allPendingTasks===0){var es=Ht.onAllReady;es()}}}finally{}}}Ye.splice(0,st),R.destination!==null&&ls(R,R.destination)}catch(Vi){un(R,Vi),Fn(R,Vi)}finally{Mr=Ee,Kr.current=he,he===Jr&&vt(Y)}}}function Qi(R,Y,he){switch(he.parentFlushed=!0,he.status){case 0:var Ee=he.id=R.nextSegmentId++;return he.lastPushedText=!1,he.textEmbedded=!1,R=R.responseState,Y.push('<template id="'),Y.push(R.placeholderPrefix),R=Ee.toString(16),Y.push(R),Y.push('"></template>');case 1:he.status=2;var Ye=!0;Ee=he.chunks;var st=0;he=he.children;for(var Et=0;Et<he.length;Et++){for(Ye=he[Et];st<Ye.index;st++)Y.push(Ee[st]);Ye=nn(R,Y,Ye)}for(;st<Ee.length-1;st++)Y.push(Ee[st]);return st<Ee.length&&(Ye=Y.push(Ee[st])),Ye;default:throw Error(x(390))}}function nn(R,Y,he){var Ee=he.boundary;if(Ee===null)return Qi(R,Y,he);if(Ee.parentFlushed=!0,Ee.forceClientRender)return R.responseState.generateStaticMarkup||(Ee=Ee.errorDigest,Y.push("<!--$!-->"),Y.push("<template"),Ee&&(Y.push(' data-dgst="'),Ee=se(Ee),Y.push(Ee),Y.push('"')),Y.push("></template>")),Qi(R,Y,he),R=R.responseState.generateStaticMarkup?!0:Y.push("<!--/$-->"),R;if(0<Ee.pendingTasks){Ee.rootSegmentID=R.nextSegmentId++,0<Ee.completedSegments.length&&R.partialBoundaries.push(Ee);var Ye=R.responseState,st=Ye.nextSuspenseID++;return Ye=Ye.boundaryPrefix+st.toString(16),Ee=Ee.id=Ye,G(Y,R.responseState,Ee),Qi(R,Y,he),Y.push("<!--/$-->")}if(Ee.byteSize>R.progressiveChunkSize)return Ee.rootSegmentID=R.nextSegmentId++,R.completedBoundaries.push(Ee),G(Y,R.responseState,Ee.id),Qi(R,Y,he),Y.push("<!--/$-->");if(R.responseState.generateStaticMarkup||Y.push("<!--$-->"),he=Ee.completedSegments,he.length!==1)throw Error(x(391));return nn(R,Y,he[0]),R=R.responseState.generateStaticMarkup?!0:Y.push("<!--/$-->"),R}function lo(R,Y,he){return Ve(Y,R.responseState,he.formatContext,he.id),nn(R,Y,he),Rt(Y,he.formatContext)}function Di(R,Y,he){for(var Ee=he.completedSegments,Ye=0;Ye<Ee.length;Ye++)Mn(R,Y,he,Ee[Ye]);if(Ee.length=0,R=R.responseState,Ee=he.id,he=he.rootSegmentID,Y.push(R.startInlineScript),R.sentCompleteBoundaryFunction?Y.push('$RC("'):(R.sentCompleteBoundaryFunction=!0,Y.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),Ee===null)throw Error(x(395));return he=he.toString(16),Y.push(Ee),Y.push('","'),Y.push(R.segmentPrefix),Y.push(he),Y.push('")<\/script>')}function Mn(R,Y,he,Ee){if(Ee.status===2)return!0;var Ye=Ee.id;if(Ye===-1){if((Ee.id=he.rootSegmentID)===-1)throw Error(x(392));return lo(R,Y,Ee)}return lo(R,Y,Ee),R=R.responseState,Y.push(R.startInlineScript),R.sentCompleteSegmentFunction?Y.push('$RS("'):(R.sentCompleteSegmentFunction=!0,Y.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),Y.push(R.segmentPrefix),Ye=Ye.toString(16),Y.push(Ye),Y.push('","'),Y.push(R.placeholderPrefix),Y.push(Ye),Y.push('")<\/script>')}function ls(R,Y){try{var he=R.completedRootSegment;if(he!==null&&R.pendingRootTasks===0){nn(R,Y,he),R.completedRootSegment=null;var Ee=R.responseState.bootstrapChunks;for(he=0;he<Ee.length-1;he++)Y.push(Ee[he]);he<Ee.length&&Y.push(Ee[he])}var Ye=R.clientRenderedBoundaries,st;for(st=0;st<Ye.length;st++){var Et=Ye[st];Ee=Y;var Ht=R.responseState,Jt=Et.id,Rr=Et.errorDigest,Vr=Et.errorMessage,fn=Et.errorComponentStack;if(Ee.push(Ht.startInlineScript),Ht.sentClientRenderFunction?Ee.push('$RX("'):(Ht.sentClientRenderFunction=!0,Ee.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),Jt===null)throw Error(x(395));if(Ee.push(Jt),Ee.push('"'),Rr||Vr||fn){Ee.push(",");var Ei=et(Rr||"");Ee.push(Ei)}if(Vr||fn){Ee.push(",");var es=et(Vr||"");Ee.push(es)}if(fn){Ee.push(",");var Vi=et(fn);Ee.push(Vi)}if(!Ee.push(")<\/script>")){R.destination=null,st++,Ye.splice(0,st);return}}Ye.splice(0,st);var js=R.completedBoundaries;for(st=0;st<js.length;st++)if(!Di(R,Y,js[st])){R.destination=null,st++,js.splice(0,st);return}js.splice(0,st);var us=R.partialBoundaries;for(st=0;st<us.length;st++){var mi=us[st];e:{Ye=R,Et=Y;var gi=mi.completedSegments;for(Ht=0;Ht<gi.length;Ht++)if(!Mn(Ye,Et,mi,gi[Ht])){Ht++,gi.splice(0,Ht);var On=!1;break e}gi.splice(0,Ht),On=!0}if(!On){R.destination=null,st++,us.splice(0,st);return}}us.splice(0,st);var zn=R.completedBoundaries;for(st=0;st<zn.length;st++)if(!Di(R,Y,zn[st])){R.destination=null,st++,zn.splice(0,st);return}zn.splice(0,st)}finally{R.allPendingTasks===0&&R.pingedTasks.length===0&&R.clientRenderedBoundaries.length===0&&R.completedBoundaries.length===0&&Y.push(null)}}function Si(R,Y){try{var he=R.abortableTasks;he.forEach(function(Ee){return pl(Ee,R,Y)}),he.clear(),R.destination!==null&&ls(R,R.destination)}catch(Ee){un(R,Ee),Fn(R,Ee)}}function Ns(){}function pi(R,Y,he,Ee){var Ye=!1,st=null,Et="",Ht={push:function(Rr){return Rr!==null&&(Et+=Rr),!0},destroy:function(Rr){Ye=!0,st=Rr}},Jt=!1;if(R=En(R,Ze(he,Y?Y.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,Ns,void 0,function(){Jt=!0}),fi(R),Si(R,Ee),R.status===1)R.status=2,Ht.destroy(R.fatalError);else if(R.status!==2&&R.destination===null){R.destination=Ht;try{ls(R,Ht)}catch(Rr){un(R,Rr),Fn(R,Rr)}}if(Ye)throw st;if(!Jt)throw Error(x(426));return Et}return th.renderToNodeStream=function(){throw Error(x(207))},th.renderToStaticMarkup=function(R,Y){return pi(R,Y,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},th.renderToStaticNodeStream=function(){throw Error(x(208))},th.renderToString=function(R,Y){return pi(R,Y,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},th.version="18.3.1",th}var $f={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg;function mv(){if(mg)return $f;mg=1;var d=ch();function x(D){for(var X="https://reactjs.org/docs/error-decoder.html?invariant="+D,ce=1;ce<arguments.length;ce++)X+="&args[]="+encodeURIComponent(arguments[ce]);return"Minified React error #"+D+"; visit "+X+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v=null,C=0;function I(D,X){if(X.length!==0)if(512<X.length)0<C&&(D.enqueue(new Uint8Array(v.buffer,0,C)),v=new Uint8Array(512),C=0),D.enqueue(X);else{var ce=v.length-C;ce<X.length&&(ce===0?D.enqueue(v):(v.set(X.subarray(0,ce),C),D.enqueue(v),X=X.subarray(ce)),v=new Uint8Array(512),C=0),v.set(X,C),C+=X.length}}function z(D,X){return I(D,X),!0}function E(D){v&&0<C&&(D.enqueue(new Uint8Array(v.buffer,0,C)),v=null,C=0)}var u=new TextEncoder;function B(D){return u.encode(D)}function U(D){return u.encode(D)}function K(D,X){typeof D.error=="function"?D.error(X):D.close()}var j=Object.prototype.hasOwnProperty,N=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q={},se={};function J(D){return j.call(se,D)?!0:j.call(q,D)?!1:N.test(D)?se[D]=!0:(q[D]=!0,!1)}function ae(D,X,ce,Te,tt,at,ct){this.acceptsBooleans=X===2||X===3||X===4,this.attributeName=Te,this.attributeNamespace=tt,this.mustUseProperty=ce,this.propertyName=D,this.type=X,this.sanitizeURL=at,this.removeEmptyString=ct}var re={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(D){re[D]=new ae(D,0,!1,D,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(D){var X=D[0];re[X]=new ae(X,1,!1,D[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(D){re[D]=new ae(D,2,!1,D.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(D){re[D]=new ae(D,2,!1,D,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(D){re[D]=new ae(D,3,!1,D.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(D){re[D]=new ae(D,3,!0,D,null,!1,!1)}),["capture","download"].forEach(function(D){re[D]=new ae(D,4,!1,D,null,!1,!1)}),["cols","rows","size","span"].forEach(function(D){re[D]=new ae(D,6,!1,D,null,!1,!1)}),["rowSpan","start"].forEach(function(D){re[D]=new ae(D,5,!1,D.toLowerCase(),null,!1,!1)});var pe=/[\-:]([a-z])/g;function ge(D){return D[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(D){var X=D.replace(pe,ge);re[X]=new ae(X,1,!1,D,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(D){var X=D.replace(pe,ge);re[X]=new ae(X,1,!1,D,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(D){var X=D.replace(pe,ge);re[X]=new ae(X,1,!1,D,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(D){re[D]=new ae(D,1,!1,D.toLowerCase(),null,!1,!1)}),re.xlinkHref=new ae("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(D){re[D]=new ae(D,1,!1,D.toLowerCase(),null,!0,!0)});var Fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ve=["Webkit","ms","Moz","O"];Object.keys(Fe).forEach(function(D){ve.forEach(function(X){X=X+D.charAt(0).toUpperCase()+D.substring(1),Fe[X]=Fe[D]})});var qe=/["'&<>]/;function je(D){if(typeof D=="boolean"||typeof D=="number")return""+D;D=""+D;var X=qe.exec(D);if(X){var ce="",Te,tt=0;for(Te=X.index;Te<D.length;Te++){switch(D.charCodeAt(Te)){case 34:X="&quot;";break;case 38:X="&amp;";break;case 39:X="&#x27;";break;case 60:X="&lt;";break;case 62:X="&gt;";break;default:continue}tt!==Te&&(ce+=D.substring(tt,Te)),tt=Te+1,ce+=X}D=tt!==Te?ce+D.substring(tt,Te):ce}return D}var St=/([A-Z])/g,ot=/^ms-/,At=Array.isArray,xt=U("<script>"),xe=U("<\/script>"),Je=U('<script src="'),G=U('<script type="module" src="'),Ve=U('" async=""><\/script>'),Rt=/(<\/|<)(s)(cript)/gi;function Ae(D,X,ce,Te){return""+X+(ce==="s"?"\\u0073":"\\u0053")+Te}function et(D,X,ce,Te,tt){D=D===void 0?"":D,X=X===void 0?xt:U('<script nonce="'+je(X)+'">');var at=[];if(ce!==void 0&&at.push(X,B((""+ce).replace(Rt,Ae)),xe),Te!==void 0)for(ce=0;ce<Te.length;ce++)at.push(Je,B(je(Te[ce])),Ve);if(tt!==void 0)for(Te=0;Te<tt.length;Te++)at.push(G,B(je(tt[Te])),Ve);return{bootstrapChunks:at,startInlineScript:X,placeholderPrefix:U(D+"P:"),segmentPrefix:U(D+"S:"),boundaryPrefix:D+"B:",idPrefix:D,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function Ze(D,X){return{insertionMode:D,selectedValue:X}}function ht(D){return Ze(D==="http://www.w3.org/2000/svg"?2:D==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function oe(D,X,ce){switch(X){case"select":return Ze(1,ce.value!=null?ce.value:ce.defaultValue);case"svg":return Ze(2,null);case"math":return Ze(3,null);case"foreignObject":return Ze(1,null);case"table":return Ze(4,null);case"thead":case"tbody":case"tfoot":return Ze(5,null);case"colgroup":return Ze(7,null);case"tr":return Ze(6,null)}return 4<=D.insertionMode||D.insertionMode===0?Ze(1,null):D}var _e=U("<!-- -->");function Ct(D,X,ce,Te){return X===""?Te:(Te&&D.push(_e),D.push(B(je(X))),!0)}var bt=new Map,wt=U(' style="'),ar=U(":"),fr=U(";");function qt(D,X,ce){if(typeof ce!="object")throw Error(x(62));X=!0;for(var Te in ce)if(j.call(ce,Te)){var tt=ce[Te];if(tt!=null&&typeof tt!="boolean"&&tt!==""){if(Te.indexOf("--")===0){var at=B(je(Te));tt=B(je((""+tt).trim()))}else{at=Te;var ct=bt.get(at);ct!==void 0||(ct=U(je(at.replace(St,"-$1").toLowerCase().replace(ot,"-ms-"))),bt.set(at,ct)),at=ct,tt=typeof tt=="number"?tt===0||j.call(Fe,Te)?B(""+tt):B(tt+"px"):B(je((""+tt).trim()))}X?(X=!1,D.push(wt,at,ar,tt)):D.push(fr,at,ar,tt)}}X||D.push(Br)}var Kt=U(" "),Cr=U('="'),Br=U('"'),Yr=U('=""');function Zr(D,X,ce,Te){switch(ce){case"style":qt(D,X,Te);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<ce.length)||ce[0]!=="o"&&ce[0]!=="O"||ce[1]!=="n"&&ce[1]!=="N"){if(X=re.hasOwnProperty(ce)?re[ce]:null,X!==null){switch(typeof Te){case"function":case"symbol":return;case"boolean":if(!X.acceptsBooleans)return}switch(ce=B(X.attributeName),X.type){case 3:Te&&D.push(Kt,ce,Yr);break;case 4:Te===!0?D.push(Kt,ce,Yr):Te!==!1&&D.push(Kt,ce,Cr,B(je(Te)),Br);break;case 5:isNaN(Te)||D.push(Kt,ce,Cr,B(je(Te)),Br);break;case 6:!isNaN(Te)&&1<=Te&&D.push(Kt,ce,Cr,B(je(Te)),Br);break;default:X.sanitizeURL&&(Te=""+Te),D.push(Kt,ce,Cr,B(je(Te)),Br)}}else if(J(ce)){switch(typeof Te){case"function":case"symbol":return;case"boolean":if(X=ce.toLowerCase().slice(0,5),X!=="data-"&&X!=="aria-")return}D.push(Kt,B(ce),Cr,B(je(Te)),Br)}}}var W=U(">"),ft=U("/>");function ye(D,X,ce){if(X!=null){if(ce!=null)throw Error(x(60));if(typeof X!="object"||!("__html"in X))throw Error(x(61));X=X.__html,X!=null&&D.push(B(""+X))}}function Me(D){var X="";return d.Children.forEach(D,function(ce){ce!=null&&(X+=ce)}),X}var we=U(' selected=""');function Ne(D,X,ce,Te){D.push(zt(ce));var tt=ce=null,at;for(at in X)if(j.call(X,at)){var ct=X[at];if(ct!=null)switch(at){case"children":ce=ct;break;case"dangerouslySetInnerHTML":tt=ct;break;default:Zr(D,Te,at,ct)}}return D.push(W),ye(D,tt,ce),typeof ce=="string"?(D.push(B(je(ce))),null):ce}var _t=U(`
`),Mt=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,nt=new Map;function zt(D){var X=nt.get(D);if(X===void 0){if(!Mt.test(D))throw Error(x(65,D));X=U("<"+D),nt.set(D,X)}return X}var rr=U("<!DOCTYPE html>");function Lt(D,X,ce,Te,tt){switch(X){case"select":D.push(zt("select"));var at=null,ct=null;for(Dr in ce)if(j.call(ce,Dr)){var Ut=ce[Dr];if(Ut!=null)switch(Dr){case"children":at=Ut;break;case"dangerouslySetInnerHTML":ct=Ut;break;case"defaultValue":case"value":break;default:Zr(D,Te,Dr,Ut)}}return D.push(W),ye(D,ct,at),at;case"option":ct=tt.selectedValue,D.push(zt("option"));var ir=Ut=null,hr=null,Dr=null;for(at in ce)if(j.call(ce,at)){var pn=ce[at];if(pn!=null)switch(at){case"children":Ut=pn;break;case"selected":hr=pn;break;case"dangerouslySetInnerHTML":Dr=pn;break;case"value":ir=pn;default:Zr(D,Te,at,pn)}}if(ct!=null)if(ce=ir!==null?""+ir:Me(Ut),At(ct)){for(Te=0;Te<ct.length;Te++)if(""+ct[Te]===ce){D.push(we);break}}else""+ct===ce&&D.push(we);else hr&&D.push(we);return D.push(W),ye(D,Dr,Ut),Ut;case"textarea":D.push(zt("textarea")),Dr=ct=at=null;for(Ut in ce)if(j.call(ce,Ut)&&(ir=ce[Ut],ir!=null))switch(Ut){case"children":Dr=ir;break;case"value":at=ir;break;case"defaultValue":ct=ir;break;case"dangerouslySetInnerHTML":throw Error(x(91));default:Zr(D,Te,Ut,ir)}if(at===null&&ct!==null&&(at=ct),D.push(W),Dr!=null){if(at!=null)throw Error(x(92));if(At(Dr)&&1<Dr.length)throw Error(x(93));at=""+Dr}return typeof at=="string"&&at[0]===`
`&&D.push(_t),at!==null&&D.push(B(je(""+at))),null;case"input":D.push(zt("input")),ir=Dr=Ut=at=null;for(ct in ce)if(j.call(ce,ct)&&(hr=ce[ct],hr!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":throw Error(x(399,"input"));case"defaultChecked":ir=hr;break;case"defaultValue":Ut=hr;break;case"checked":Dr=hr;break;case"value":at=hr;break;default:Zr(D,Te,ct,hr)}return Dr!==null?Zr(D,Te,"checked",Dr):ir!==null&&Zr(D,Te,"checked",ir),at!==null?Zr(D,Te,"value",at):Ut!==null&&Zr(D,Te,"value",Ut),D.push(ft),null;case"menuitem":D.push(zt("menuitem"));for(var yi in ce)if(j.call(ce,yi)&&(at=ce[yi],at!=null))switch(yi){case"children":case"dangerouslySetInnerHTML":throw Error(x(400));default:Zr(D,Te,yi,at)}return D.push(W),null;case"title":D.push(zt("title")),at=null;for(pn in ce)if(j.call(ce,pn)&&(ct=ce[pn],ct!=null))switch(pn){case"children":at=ct;break;case"dangerouslySetInnerHTML":throw Error(x(434));default:Zr(D,Te,pn,ct)}return D.push(W),at;case"listing":case"pre":D.push(zt(X)),ct=at=null;for(ir in ce)if(j.call(ce,ir)&&(Ut=ce[ir],Ut!=null))switch(ir){case"children":at=Ut;break;case"dangerouslySetInnerHTML":ct=Ut;break;default:Zr(D,Te,ir,Ut)}if(D.push(W),ct!=null){if(at!=null)throw Error(x(60));if(typeof ct!="object"||!("__html"in ct))throw Error(x(61));ce=ct.__html,ce!=null&&(typeof ce=="string"&&0<ce.length&&ce[0]===`
`?D.push(_t,B(ce)):D.push(B(""+ce)))}return typeof at=="string"&&at[0]===`
`&&D.push(_t),at;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":D.push(zt(X));for(var Gi in ce)if(j.call(ce,Gi)&&(at=ce[Gi],at!=null))switch(Gi){case"children":case"dangerouslySetInnerHTML":throw Error(x(399,X));default:Zr(D,Te,Gi,at)}return D.push(ft),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Ne(D,ce,X,Te);case"html":return tt.insertionMode===0&&D.push(rr),Ne(D,ce,X,Te);default:if(X.indexOf("-")===-1&&typeof ce.is!="string")return Ne(D,ce,X,Te);D.push(zt(X)),ct=at=null;for(hr in ce)if(j.call(ce,hr)&&(Ut=ce[hr],Ut!=null))switch(hr){case"children":at=Ut;break;case"dangerouslySetInnerHTML":ct=Ut;break;case"style":qt(D,Te,Ut);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:J(hr)&&typeof Ut!="function"&&typeof Ut!="symbol"&&D.push(Kt,B(hr),Cr,B(je(Ut)),Br)}return D.push(W),ye(D,ct,at),at}}var _r=U("</"),en=U(">"),vt=U('<template id="'),xn=U('"></template>'),yn=U("<!--$-->"),wn=U('<!--$?--><template id="'),ui=U('"></template>'),Pt=U("<!--$!-->"),zr=U("<!--/$-->"),wr=U("<template"),_n=U('"'),ci=U(' data-dgst="');U(' data-msg="'),U(' data-stck="');var Ir=U("></template>");function An(D,X,ce){if(I(D,wn),ce===null)throw Error(x(395));return I(D,ce),z(D,ui)}var wi=U('<div hidden id="'),Xn=U('">'),Nr=U("</div>"),Ce=U('<svg aria-hidden="true" style="display:none" id="'),ee=U('">'),Q=U("</svg>"),ue=U('<math aria-hidden="true" style="display:none" id="'),Se=U('">'),Oe=U("</math>"),$e=U('<table hidden id="'),Ke=U('">'),Le=U("</table>"),pt=U('<table hidden><tbody id="'),It=U('">'),ut=U("</tbody></table>"),Nt=U('<table hidden><tr id="'),cr=U('">'),pr=U("</tr></table>"),Jr=U('<table hidden><colgroup id="'),Mr=U('">'),Kr=U("</colgroup></table>");function Ur(D,X,ce,Te){switch(ce.insertionMode){case 0:case 1:return I(D,wi),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,Xn);case 2:return I(D,Ce),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,ee);case 3:return I(D,ue),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,Se);case 4:return I(D,$e),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,Ke);case 5:return I(D,pt),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,It);case 6:return I(D,Nt),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,cr);case 7:return I(D,Jr),I(D,X.segmentPrefix),I(D,B(Te.toString(16))),z(D,Mr);default:throw Error(x(397))}}function bn(D,X){switch(X.insertionMode){case 0:case 1:return z(D,Nr);case 2:return z(D,Q);case 3:return z(D,Oe);case 4:return z(D,Le);case 5:return z(D,ut);case 6:return z(D,pr);case 7:return z(D,Kr);default:throw Error(x(397))}}var En=U('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Hr=U('$RS("'),rn=U('","'),un=U('")<\/script>'),Fn=U('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Kn=U('$RC("'),hi=U('","'),ao=U('")<\/script>'),Pr=U('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),bi=U('$RX("'),zo=U('"'),di=U(")<\/script>"),ei=U(","),pl=/[<\u2028\u2029]/g;function ti(D){return JSON.stringify(D).replace(pl,function(X){switch(X){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Hn=Object.assign,fi=Symbol.for("react.element"),Qi=Symbol.for("react.portal"),nn=Symbol.for("react.fragment"),lo=Symbol.for("react.strict_mode"),Di=Symbol.for("react.profiler"),Mn=Symbol.for("react.provider"),ls=Symbol.for("react.context"),Si=Symbol.for("react.forward_ref"),Ns=Symbol.for("react.suspense"),pi=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),he=Symbol.for("react.scope"),Ee=Symbol.for("react.debug_trace_mode"),Ye=Symbol.for("react.legacy_hidden"),st=Symbol.for("react.default_value"),Et=Symbol.iterator;function Ht(D){if(D==null)return null;if(typeof D=="function")return D.displayName||D.name||null;if(typeof D=="string")return D;switch(D){case nn:return"Fragment";case Qi:return"Portal";case Di:return"Profiler";case lo:return"StrictMode";case Ns:return"Suspense";case pi:return"SuspenseList"}if(typeof D=="object")switch(D.$$typeof){case ls:return(D.displayName||"Context")+".Consumer";case Mn:return(D._context.displayName||"Context")+".Provider";case Si:var X=D.render;return D=D.displayName,D||(D=X.displayName||X.name||"",D=D!==""?"ForwardRef("+D+")":"ForwardRef"),D;case R:return X=D.displayName||null,X!==null?X:Ht(D.type)||"Memo";case Y:X=D._payload,D=D._init;try{return Ht(D(X))}catch{}}return null}var Jt={};function Rr(D,X){if(D=D.contextTypes,!D)return Jt;var ce={},Te;for(Te in D)ce[Te]=X[Te];return ce}var Vr=null;function fn(D,X){if(D!==X){D.context._currentValue=D.parentValue,D=D.parent;var ce=X.parent;if(D===null){if(ce!==null)throw Error(x(401))}else{if(ce===null)throw Error(x(401));fn(D,ce)}X.context._currentValue=X.value}}function Ei(D){D.context._currentValue=D.parentValue,D=D.parent,D!==null&&Ei(D)}function es(D){var X=D.parent;X!==null&&es(X),D.context._currentValue=D.value}function Vi(D,X){if(D.context._currentValue=D.parentValue,D=D.parent,D===null)throw Error(x(402));D.depth===X.depth?fn(D,X):Vi(D,X)}function js(D,X){var ce=X.parent;if(ce===null)throw Error(x(402));D.depth===ce.depth?fn(D,ce):js(D,ce),X.context._currentValue=X.value}function us(D){var X=Vr;X!==D&&(X===null?es(D):D===null?Ei(X):X.depth===D.depth?fn(X,D):X.depth>D.depth?Vi(X,D):js(X,D),Vr=D)}var mi={isMounted:function(){return!1},enqueueSetState:function(D,X){D=D._reactInternals,D.queue!==null&&D.queue.push(X)},enqueueReplaceState:function(D,X){D=D._reactInternals,D.replace=!0,D.queue=[X]},enqueueForceUpdate:function(){}};function gi(D,X,ce,Te){var tt=D.state!==void 0?D.state:null;D.updater=mi,D.props=ce,D.state=tt;var at={queue:[],replace:!1};D._reactInternals=at;var ct=X.contextType;if(D.context=typeof ct=="object"&&ct!==null?ct._currentValue:Te,ct=X.getDerivedStateFromProps,typeof ct=="function"&&(ct=ct(ce,tt),tt=ct==null?tt:Hn({},tt,ct),D.state=tt),typeof X.getDerivedStateFromProps!="function"&&typeof D.getSnapshotBeforeUpdate!="function"&&(typeof D.UNSAFE_componentWillMount=="function"||typeof D.componentWillMount=="function"))if(X=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),X!==D.state&&mi.enqueueReplaceState(D,D.state,null),at.queue!==null&&0<at.queue.length)if(X=at.queue,ct=at.replace,at.queue=null,at.replace=!1,ct&&X.length===1)D.state=X[0];else{for(at=ct?X[0]:D.state,tt=!0,ct=ct?1:0;ct<X.length;ct++){var Ut=X[ct];Ut=typeof Ut=="function"?Ut.call(D,at,ce,Te):Ut,Ut!=null&&(tt?(tt=!1,at=Hn({},at,Ut)):Hn(at,Ut))}D.state=at}else at.queue=null}var On={id:1,overflow:""};function zn(D,X,ce){var Te=D.id;D=D.overflow;var tt=32-ks(Te)-1;Te&=~(1<<tt),ce+=1;var at=32-ks(X)+tt;if(30<at){var ct=tt-tt%5;return at=(Te&(1<<ct)-1).toString(32),Te>>=ct,tt-=ct,{id:1<<32-ks(X)+tt|ce<<tt|Te,overflow:at+D}}return{id:1<<at|ce<<tt|Te,overflow:D}}var ks=Math.clz32?Math.clz32:Ql,Cs=Math.log,ml=Math.LN2;function Ql(D){return D>>>=0,D===0?32:31-(Cs(D)/ml|0)|0}function Us(D,X){return D===X&&(D!==0||1/D===1/X)||D!==D&&X!==X}var ac=typeof Object.is=="function"?Object.is:Us,Is=null,qo=null,$a=null,Tn=null,Vs=!1,cs=!1,hs=0,Hi=null,wa=0;function uo(){if(Is===null)throw Error(x(321));return Is}function ts(){if(0<wa)throw Error(x(312));return{memoizedState:null,queue:null,next:null}}function ba(){return Tn===null?$a===null?(Vs=!1,$a=Tn=ts()):(Vs=!0,Tn=$a):Tn.next===null?(Vs=!1,Tn=Tn.next=ts()):(Vs=!0,Tn=Tn.next),Tn}function Zo(){qo=Is=null,cs=!1,$a=null,wa=0,Tn=Hi=null}function co(D,X){return typeof X=="function"?X(D):X}function Ai(D,X,ce){if(Is=uo(),Tn=ba(),Vs){var Te=Tn.queue;if(X=Te.dispatch,Hi!==null&&(ce=Hi.get(Te),ce!==void 0)){Hi.delete(Te),Te=Tn.memoizedState;do Te=D(Te,ce.action),ce=ce.next;while(ce!==null);return Tn.memoizedState=Te,[Te,X]}return[Tn.memoizedState,X]}return D=D===co?typeof X=="function"?X():X:ce!==void 0?ce(X):X,Tn.memoizedState=D,D=Tn.queue={last:null,dispatch:null},D=D.dispatch=Wo.bind(null,Is,D),[Tn.memoizedState,D]}function sn(D,X){if(Is=uo(),Tn=ba(),X=X===void 0?null:X,Tn!==null){var ce=Tn.memoizedState;if(ce!==null&&X!==null){var Te=ce[1];e:if(Te===null)Te=!1;else{for(var tt=0;tt<Te.length&&tt<X.length;tt++)if(!ac(X[tt],Te[tt])){Te=!1;break e}Te=!0}if(Te)return ce[0]}}return D=D(),Tn.memoizedState=[D,X],D}function Wo(D,X,ce){if(25<=wa)throw Error(x(301));if(D===Is)if(cs=!0,D={action:ce,next:null},Hi===null&&(Hi=new Map),ce=Hi.get(X),ce===void 0)Hi.set(X,D);else{for(X=ce;X.next!==null;)X=X.next;X.next=D}}function Mu(){throw Error(x(394))}function ds(){}var Ga={readContext:function(D){return D._currentValue},useContext:function(D){return uo(),D._currentValue},useMemo:sn,useReducer:Ai,useRef:function(D){Is=uo(),Tn=ba();var X=Tn.memoizedState;return X===null?(D={current:D},Tn.memoizedState=D):X},useState:function(D){return Ai(co,D)},useInsertionEffect:ds,useLayoutEffect:function(){},useCallback:function(D,X){return sn(function(){return D},X)},useImperativeHandle:ds,useEffect:ds,useDebugValue:ds,useDeferredValue:function(D){return uo(),D},useTransition:function(){return uo(),[!1,Mu]},useId:function(){var D=qo.treeContext,X=D.overflow;D=D.id,D=(D&~(1<<32-ks(D)-1)).toString(32)+X;var ce=Sa;if(ce===null)throw Error(x(404));return X=hs++,D=":"+ce.idPrefix+"R"+D,0<X&&(D+="H"+X.toString(32)),D+":"},useMutableSource:function(D,X){return uo(),X(D._source)},useSyncExternalStore:function(D,X,ce){if(ce===void 0)throw Error(x(407));return ce()}},Sa=null,Li=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Xo(D){return console.error(D),null}function ho(){}function Ea(D,X,ce,Te,tt,at,ct,Ut,ir){var hr=[],Dr=new Set;return X={destination:null,responseState:X,progressiveChunkSize:Te===void 0?12800:Te,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Dr,pingedTasks:hr,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:tt===void 0?Xo:tt,onAllReady:at===void 0?ho:at,onShellReady:ct===void 0?ho:ct,onShellError:Ut===void 0?ho:Ut,onFatalError:ir===void 0?ho:ir},ce=Ko(X,0,null,ce,!1,!1),ce.parentFlushed=!0,D=gl(X,D,null,ce,Dr,Jt,null,On),hr.push(D),X}function gl(D,X,ce,Te,tt,at,ct,Ut){D.allPendingTasks++,ce===null?D.pendingRootTasks++:ce.pendingTasks++;var ir={node:X,ping:function(){var hr=D.pingedTasks;hr.push(ir),hr.length===1&&Za(D)},blockedBoundary:ce,blockedSegment:Te,abortSet:tt,legacyContext:at,context:ct,treeContext:Ut};return tt.add(ir),ir}function Ko(D,X,ce,Te,tt,at){return{status:0,id:-1,index:X,parentFlushed:!1,chunks:[],children:[],formatContext:Te,boundary:ce,lastPushedText:tt,textEmbedded:at}}function Ro(D,X){if(D=D.onError(X),D!=null&&typeof D!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof D+'" instead');return D}function $i(D,X){var ce=D.onShellError;ce(X),ce=D.onFatalError,ce(X),D.destination!==null?(D.status=2,K(D.destination,X)):(D.status=1,D.fatalError=X)}function Ta(D,X,ce,Te,tt){for(Is={},qo=X,hs=0,D=ce(Te,tt);cs;)cs=!1,hs=0,wa+=1,Tn=null,D=ce(Te,tt);return Zo(),D}function eu(D,X,ce,Te){var tt=ce.render(),at=Te.childContextTypes;if(at!=null){var ct=X.legacyContext;if(typeof ce.getChildContext!="function")Te=ct;else{ce=ce.getChildContext();for(var Ut in ce)if(!(Ut in at))throw Error(x(108,Ht(Te)||"Unknown",Ut));Te=Hn({},ct,ce)}X.legacyContext=Te,rs(D,X,tt),X.legacyContext=ct}else rs(D,X,tt)}function tu(D,X){if(D&&D.defaultProps){X=Hn({},X),D=D.defaultProps;for(var ce in D)X[ce]===void 0&&(X[ce]=D[ce]);return X}return X}function Yo(D,X,ce,Te,tt){if(typeof ce=="function")if(ce.prototype&&ce.prototype.isReactComponent){tt=Rr(ce,X.legacyContext);var at=ce.contextType;at=new ce(Te,typeof at=="object"&&at!==null?at._currentValue:tt),gi(at,ce,Te,tt),eu(D,X,at,ce)}else{at=Rr(ce,X.legacyContext),tt=Ta(D,X,ce,Te,at);var ct=hs!==0;if(typeof tt=="object"&&tt!==null&&typeof tt.render=="function"&&tt.$$typeof===void 0)gi(tt,ce,Te,at),eu(D,X,tt,ce);else if(ct){Te=X.treeContext,X.treeContext=zn(Te,1,0);try{rs(D,X,tt)}finally{X.treeContext=Te}}else rs(D,X,tt)}else if(typeof ce=="string"){switch(tt=X.blockedSegment,at=Lt(tt.chunks,ce,Te,D.responseState,tt.formatContext),tt.lastPushedText=!1,ct=tt.formatContext,tt.formatContext=oe(ct,ce,Te),ru(D,X,at),tt.formatContext=ct,ce){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:tt.chunks.push(_r,B(ce),en)}tt.lastPushedText=!1}else{switch(ce){case Ye:case Ee:case lo:case Di:case nn:rs(D,X,Te.children);return;case pi:rs(D,X,Te.children);return;case he:throw Error(x(343));case Ns:e:{ce=X.blockedBoundary,tt=X.blockedSegment,at=Te.fallback,Te=Te.children,ct=new Set;var Ut={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:ct,errorDigest:null},ir=Ko(D,tt.chunks.length,Ut,tt.formatContext,!1,!1);tt.children.push(ir),tt.lastPushedText=!1;var hr=Ko(D,0,null,tt.formatContext,!1,!1);hr.parentFlushed=!0,X.blockedBoundary=Ut,X.blockedSegment=hr;try{if(ru(D,X,Te),hr.lastPushedText&&hr.textEmbedded&&hr.chunks.push(_e),hr.status=1,qa(Ut,hr),Ut.pendingTasks===0)break e}catch(Dr){hr.status=4,Ut.forceClientRender=!0,Ut.errorDigest=Ro(D,Dr)}finally{X.blockedBoundary=ce,X.blockedSegment=tt}X=gl(D,at,ce,ir,ct,X.legacyContext,X.context,X.treeContext),D.pingedTasks.push(X)}return}if(typeof ce=="object"&&ce!==null)switch(ce.$$typeof){case Si:if(Te=Ta(D,X,ce.render,Te,tt),hs!==0){ce=X.treeContext,X.treeContext=zn(ce,1,0);try{rs(D,X,Te)}finally{X.treeContext=ce}}else rs(D,X,Te);return;case R:ce=ce.type,Te=tu(ce,Te),Yo(D,X,ce,Te,tt);return;case Mn:if(tt=Te.children,ce=ce._context,Te=Te.value,at=ce._currentValue,ce._currentValue=Te,ct=Vr,Vr=Te={parent:ct,depth:ct===null?0:ct.depth+1,context:ce,parentValue:at,value:Te},X.context=Te,rs(D,X,tt),D=Vr,D===null)throw Error(x(403));Te=D.parentValue,D.context._currentValue=Te===st?D.context._defaultValue:Te,D=Vr=D.parent,X.context=D;return;case ls:Te=Te.children,Te=Te(ce._currentValue),rs(D,X,Te);return;case Y:tt=ce._init,ce=tt(ce._payload),Te=tu(ce,Te),Yo(D,X,ce,Te,void 0);return}throw Error(x(130,ce==null?ce:typeof ce,""))}}function rs(D,X,ce){if(X.node=ce,typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case fi:Yo(D,X,ce.type,ce.props,ce.ref);return;case Qi:throw Error(x(257));case Y:var Te=ce._init;ce=Te(ce._payload),rs(D,X,ce);return}if(At(ce)){Jo(D,X,ce);return}if(ce===null||typeof ce!="object"?Te=null:(Te=Et&&ce[Et]||ce["@@iterator"],Te=typeof Te=="function"?Te:null),Te&&(Te=Te.call(ce))){if(ce=Te.next(),!ce.done){var tt=[];do tt.push(ce.value),ce=Te.next();while(!ce.done);Jo(D,X,tt)}return}throw D=Object.prototype.toString.call(ce),Error(x(31,D==="[object Object]"?"object with keys {"+Object.keys(ce).join(", ")+"}":D))}typeof ce=="string"?(Te=X.blockedSegment,Te.lastPushedText=Ct(X.blockedSegment.chunks,ce,D.responseState,Te.lastPushedText)):typeof ce=="number"&&(Te=X.blockedSegment,Te.lastPushedText=Ct(X.blockedSegment.chunks,""+ce,D.responseState,Te.lastPushedText))}function Jo(D,X,ce){for(var Te=ce.length,tt=0;tt<Te;tt++){var at=X.treeContext;X.treeContext=zn(at,Te,tt);try{ru(D,X,ce[tt])}finally{X.treeContext=at}}}function ru(D,X,ce){var Te=X.blockedSegment.formatContext,tt=X.legacyContext,at=X.context;try{return rs(D,X,ce)}catch(ir){if(Zo(),typeof ir=="object"&&ir!==null&&typeof ir.then=="function"){ce=ir;var ct=X.blockedSegment,Ut=Ko(D,ct.chunks.length,null,ct.formatContext,ct.lastPushedText,!0);ct.children.push(Ut),ct.lastPushedText=!1,D=gl(D,X.node,X.blockedBoundary,Ut,X.abortSet,X.legacyContext,X.context,X.treeContext).ping,ce.then(D,D),X.blockedSegment.formatContext=Te,X.legacyContext=tt,X.context=at,us(at)}else throw X.blockedSegment.formatContext=Te,X.legacyContext=tt,X.context=at,us(at),ir}}function lc(D){var X=D.blockedBoundary;D=D.blockedSegment,D.status=3,iu(this,X,D)}function nu(D,X,ce){var Te=D.blockedBoundary;D.blockedSegment.status=3,Te===null?(X.allPendingTasks--,X.status!==2&&(X.status=2,X.destination!==null&&X.destination.close())):(Te.pendingTasks--,Te.forceClientRender||(Te.forceClientRender=!0,D=ce===void 0?Error(x(432)):ce,Te.errorDigest=X.onError(D),Te.parentFlushed&&X.clientRenderedBoundaries.push(Te)),Te.fallbackAbortableTasks.forEach(function(tt){return nu(tt,X,ce)}),Te.fallbackAbortableTasks.clear(),X.allPendingTasks--,X.allPendingTasks===0&&(Te=X.onAllReady,Te()))}function qa(D,X){if(X.chunks.length===0&&X.children.length===1&&X.children[0].boundary===null){var ce=X.children[0];ce.id=X.id,ce.parentFlushed=!0,ce.status===1&&qa(D,ce)}else D.completedSegments.push(X)}function iu(D,X,ce){if(X===null){if(ce.parentFlushed){if(D.completedRootSegment!==null)throw Error(x(389));D.completedRootSegment=ce}D.pendingRootTasks--,D.pendingRootTasks===0&&(D.onShellError=ho,X=D.onShellReady,X())}else X.pendingTasks--,X.forceClientRender||(X.pendingTasks===0?(ce.parentFlushed&&ce.status===1&&qa(X,ce),X.parentFlushed&&D.completedBoundaries.push(X),X.fallbackAbortableTasks.forEach(lc,D),X.fallbackAbortableTasks.clear()):ce.parentFlushed&&ce.status===1&&(qa(X,ce),X.completedSegments.length===1&&X.parentFlushed&&D.partialBoundaries.push(X)));D.allPendingTasks--,D.allPendingTasks===0&&(D=D.onAllReady,D())}function Za(D){if(D.status!==2){var X=Vr,ce=Li.current;Li.current=Ga;var Te=Sa;Sa=D.responseState;try{var tt=D.pingedTasks,at;for(at=0;at<tt.length;at++){var ct=tt[at],Ut=D,ir=ct.blockedSegment;if(ir.status===0){us(ct.context);try{rs(Ut,ct,ct.node),ir.lastPushedText&&ir.textEmbedded&&ir.chunks.push(_e),ct.abortSet.delete(ct),ir.status=1,iu(Ut,ct.blockedBoundary,ir)}catch(_i){if(Zo(),typeof _i=="object"&&_i!==null&&typeof _i.then=="function"){var hr=ct.ping;_i.then(hr,hr)}else{ct.abortSet.delete(ct),ir.status=4;var Dr=ct.blockedBoundary,pn=_i,yi=Ro(Ut,pn);if(Dr===null?$i(Ut,pn):(Dr.pendingTasks--,Dr.forceClientRender||(Dr.forceClientRender=!0,Dr.errorDigest=yi,Dr.parentFlushed&&Ut.clientRenderedBoundaries.push(Dr))),Ut.allPendingTasks--,Ut.allPendingTasks===0){var Gi=Ut.onAllReady;Gi()}}}finally{}}}tt.splice(0,at),D.destination!==null&&Xa(D,D.destination)}catch(_i){Ro(D,_i),$i(D,_i)}finally{Sa=Te,Li.current=ce,ce===Ga&&us(X)}}}function Wa(D,X,ce){switch(ce.parentFlushed=!0,ce.status){case 0:var Te=ce.id=D.nextSegmentId++;return ce.lastPushedText=!1,ce.textEmbedded=!1,D=D.responseState,I(X,vt),I(X,D.placeholderPrefix),D=B(Te.toString(16)),I(X,D),z(X,xn);case 1:ce.status=2;var tt=!0;Te=ce.chunks;var at=0;ce=ce.children;for(var ct=0;ct<ce.length;ct++){for(tt=ce[ct];at<tt.index;at++)I(X,Te[at]);tt=Qo(D,X,tt)}for(;at<Te.length-1;at++)I(X,Te[at]);return at<Te.length&&(tt=z(X,Te[at])),tt;default:throw Error(x(390))}}function Qo(D,X,ce){var Te=ce.boundary;if(Te===null)return Wa(D,X,ce);if(Te.parentFlushed=!0,Te.forceClientRender)Te=Te.errorDigest,z(X,Pt),I(X,wr),Te&&(I(X,ci),I(X,B(je(Te))),I(X,_n)),z(X,Ir),Wa(D,X,ce);else if(0<Te.pendingTasks){Te.rootSegmentID=D.nextSegmentId++,0<Te.completedSegments.length&&D.partialBoundaries.push(Te);var tt=D.responseState,at=tt.nextSuspenseID++;tt=U(tt.boundaryPrefix+at.toString(16)),Te=Te.id=tt,An(X,D.responseState,Te),Wa(D,X,ce)}else if(Te.byteSize>D.progressiveChunkSize)Te.rootSegmentID=D.nextSegmentId++,D.completedBoundaries.push(Te),An(X,D.responseState,Te.id),Wa(D,X,ce);else{if(z(X,yn),ce=Te.completedSegments,ce.length!==1)throw Error(x(391));Qo(D,X,ce[0])}return z(X,zr)}function Hs(D,X,ce){return Ur(X,D.responseState,ce.formatContext,ce.id),Qo(D,X,ce),bn(X,ce.formatContext)}function yl(D,X,ce){for(var Te=ce.completedSegments,tt=0;tt<Te.length;tt++)ka(D,X,ce,Te[tt]);if(Te.length=0,D=D.responseState,Te=ce.id,ce=ce.rootSegmentID,I(X,D.startInlineScript),D.sentCompleteBoundaryFunction?I(X,Kn):(D.sentCompleteBoundaryFunction=!0,I(X,Fn)),Te===null)throw Error(x(395));return ce=B(ce.toString(16)),I(X,Te),I(X,hi),I(X,D.segmentPrefix),I(X,ce),z(X,ao)}function ka(D,X,ce,Te){if(Te.status===2)return!0;var tt=Te.id;if(tt===-1){if((Te.id=ce.rootSegmentID)===-1)throw Error(x(392));return Hs(D,X,Te)}return Hs(D,X,Te),D=D.responseState,I(X,D.startInlineScript),D.sentCompleteSegmentFunction?I(X,Hr):(D.sentCompleteSegmentFunction=!0,I(X,En)),I(X,D.segmentPrefix),tt=B(tt.toString(16)),I(X,tt),I(X,rn),I(X,D.placeholderPrefix),I(X,tt),z(X,un)}function Xa(D,X){v=new Uint8Array(512),C=0;try{var ce=D.completedRootSegment;if(ce!==null&&D.pendingRootTasks===0){Qo(D,X,ce),D.completedRootSegment=null;var Te=D.responseState.bootstrapChunks;for(ce=0;ce<Te.length-1;ce++)I(X,Te[ce]);ce<Te.length&&z(X,Te[ce])}var tt=D.clientRenderedBoundaries,at;for(at=0;at<tt.length;at++){var ct=tt[at];Te=X;var Ut=D.responseState,ir=ct.id,hr=ct.errorDigest,Dr=ct.errorMessage,pn=ct.errorComponentStack;if(I(Te,Ut.startInlineScript),Ut.sentClientRenderFunction?I(Te,bi):(Ut.sentClientRenderFunction=!0,I(Te,Pr)),ir===null)throw Error(x(395));I(Te,ir),I(Te,zo),(hr||Dr||pn)&&(I(Te,ei),I(Te,B(ti(hr||"")))),(Dr||pn)&&(I(Te,ei),I(Te,B(ti(Dr||"")))),pn&&(I(Te,ei),I(Te,B(ti(pn)))),z(Te,di)}tt.splice(0,at);var yi=D.completedBoundaries;for(at=0;at<yi.length;at++)yl(D,X,yi[at]);yi.splice(0,at),E(X),v=new Uint8Array(512),C=0;var Gi=D.partialBoundaries;for(at=0;at<Gi.length;at++){var _i=Gi[at];e:{tt=D,ct=X;var $s=_i.completedSegments;for(Ut=0;Ut<$s.length;Ut++)if(!ka(tt,ct,_i,$s[Ut])){Ut++,$s.splice(0,Ut);var qi=!1;break e}$s.splice(0,Ut),qi=!0}if(!qi){D.destination=null,at++,Gi.splice(0,at);return}}Gi.splice(0,at);var Gs=D.completedBoundaries;for(at=0;at<Gs.length;at++)yl(D,X,Gs[at]);Gs.splice(0,at)}finally{E(X),D.allPendingTasks===0&&D.pingedTasks.length===0&&D.clientRenderedBoundaries.length===0&&D.completedBoundaries.length===0&&X.close()}}function Ka(D,X){try{var ce=D.abortableTasks;ce.forEach(function(Te){return nu(Te,D,X)}),ce.clear(),D.destination!==null&&Xa(D,D.destination)}catch(Te){Ro(D,Te),$i(D,Te)}}return $f.renderToReadableStream=function(D,X){return new Promise(function(ce,Te){var tt,at,ct=new Promise(function(Dr,pn){at=Dr,tt=pn}),Ut=Ea(D,et(X?X.identifierPrefix:void 0,X?X.nonce:void 0,X?X.bootstrapScriptContent:void 0,X?X.bootstrapScripts:void 0,X?X.bootstrapModules:void 0),ht(X?X.namespaceURI:void 0),X?X.progressiveChunkSize:void 0,X?X.onError:void 0,at,function(){var Dr=new ReadableStream({type:"bytes",pull:function(pn){if(Ut.status===1)Ut.status=2,K(pn,Ut.fatalError);else if(Ut.status!==2&&Ut.destination===null){Ut.destination=pn;try{Xa(Ut,pn)}catch(yi){Ro(Ut,yi),$i(Ut,yi)}}},cancel:function(){Ka(Ut)}},{highWaterMark:0});Dr.allReady=ct,ce(Dr)},function(Dr){ct.catch(function(){}),Te(Dr)},tt);if(X&&X.signal){var ir=X.signal,hr=function(){Ka(Ut,ir.reason),ir.removeEventListener("abort",hr)};ir.addEventListener("abort",hr)}Za(Ut)})},$f.version="18.3.1",$f}var gg;function gv(){if(gg)return rc;gg=1;var d,x;return d=pv(),x=mv(),rc.version=d.version,rc.renderToString=d.renderToString,rc.renderToStaticMarkup=d.renderToStaticMarkup,rc.renderToNodeStream=d.renderToNodeStream,rc.renderToStaticNodeStream=d.renderToStaticNodeStream,rc.renderToReadableStream=x.renderToReadableStream,rc}var yv=gv();function _v({latitude:d,longitude:x,children:v,closeOnMove:C,closeButton:I,closeOnClick:z,popupRef:E}){return qr.useEffect(()=>{E.current||(E.current=new Ty.Popup({closeOnClick:!1,closeOnMove:C,closeButton:I,className:"popup"})),E.current.setLngLat([x,d]).setHTML(yv.renderToString(v))},[d,x,v,z,C,I,E]),null}var Yh={},yg;function vv(){if(yg)return Yh;yg=1;function d(I,z,E){var u,B,U,K,j,N,q,se,J=0,ae,re=I.type==="FeatureCollection",pe=I.type==="Feature",ge=re?I.features.length:1;for(u=0;u<ge;u++)for(se=re?I.features[u].geometry:pe?I.geometry:I,ae=se.type==="GeometryCollection",N=ae?se.geometries.length:1,K=0;K<N;K++)if(j=ae?se.geometries[K]:se,q=j.coordinates,J=E&&(j.type==="Polygon"||j.type==="MultiPolygon")?1:0,j.type==="Point")z(q);else if(j.type==="LineString"||j.type==="MultiPoint")for(B=0;B<q.length;B++)z(q[B]);else if(j.type==="Polygon"||j.type==="MultiLineString")for(B=0;B<q.length;B++)for(U=0;U<q[B].length-J;U++)z(q[B][U]);else if(j.type==="MultiPolygon")for(B=0;B<q.length;B++)for(U=0;U<q[B].length;U++)for(l=0;l<q[B][U].length-J;l++)z(q[B][U][l]);else throw new Error("Unknown Geometry Type")}Yh.coordEach=d;function x(I,z,E,u){return d(I,function(B){E=z(E,B)},u),E}Yh.coordReduce=x;function v(I,z){var E;switch(I.type){case"FeatureCollection":for(features=I.features,E=0;E<I.features.length;E++)z(I.features[E].properties);break;case"Feature":z(I.properties);break}}Yh.propEach=v;function C(I,z,E){return v(I,function(u){E=z(E,u)}),E}return Yh.propReduce=C,Yh}var Xp,_g;function xv(){if(_g)return Xp;_g=1;var d=vv().coordEach;return Xp=function(x){var v=[1/0,1/0,-1/0,-1/0];return d(x,function(C){v[0]>C[0]&&(v[0]=C[0]),v[1]>C[1]&&(v[1]=C[1]),v[2]<C[0]&&(v[2]=C[0]),v[3]<C[1]&&(v[3]=C[1])}),v},Xp}var wv=xv();const bv=ld(wv),Sv=(d,x)=>{if(d.file&&x&&d.file in x){if(d.file.endsWith("jpg")||d.file.endsWith("jpeg"))return yt.jsx("img",{className:"popupImage",alt:"Message attached file",src:URL.createObjectURL(x[d.file])});if(d.file.endsWith("mp4"))return yt.jsx("video",{controls:!0,autoplay:!0,loop:!0,className:"popupImage",alt:"Message attached file",src:URL.createObjectURL(x[d.file])})}return d.message},Ev=d=>{const x=new Date(d.time);return String(x.getHours()).padStart(2,"0")+":"+String(x.getMinutes()).padStart(2,"0")};function Tv({data:d,dataFiles:x}){const v=qr.useRef(null),C=qr.useRef(null),[I,z]=qr.useState(null),E=qr.useRef(null);return qr.useEffect(()=>{C.current||(C.current=new Ty.Map({container:v.current,center:[0,0],zoom:17,style:fv}),C.current.on("load",()=>{C.current.setCenter(d.features[0].geometry.coordinates),C.current.addSource("locations",{data:d,type:"geojson"});const u=bv(d);C.current.fitBounds(u,{padding:50}),C.current.on("mouseenter","pois",()=>{C.current.getCanvas().style.cursor="pointer"}),C.current.on("mouseleave","pois",()=>{C.current.getCanvas().style.cursor="inherit"}),C.current.addLayer({id:"pois",type:"circle",source:"locations",layout:{},paint:{"circle-color":"#D63F40","circle-radius":10}}),C.current.on("click","pois",B=>{z(B.features[0])})}))},[d,E]),qr.useEffect(()=>{!C.current||!I||(z(I),E.current.addTo(C.current))},[I]),yt.jsxs("div",{className:"map-wrap",children:[yt.jsx("div",{ref:v,className:"map"}),C.current&&I&&yt.jsx(_v,{longitude:I.geometry.coordinates[0],latitude:I.geometry.coordinates[1],popupRef:E,closeOnMove:!1,closeButton:!0,children:yt.jsxs("div",{className:"activePopupFeatureContent",children:[yt.jsxs("p",{children:[yt.jsx("span",{className:"msgUsername",children:I.properties.username}),yt.jsx("span",{className:"msgDatetime",children:Ev(I.properties)})]}),yt.jsx("p",{children:Sv(I.properties,x)}),"}"]})})]})}function kv(d){const[x,v]=qr.useState(d);return[x,z=>{v(z)},()=>{v(d)}]}function Cv(d){return d.substring(d.lastIndexOf("/")+1,d.length)}function Iv(){const[d,x]=qr.useState(),[v,C]=qr.useState();return[u=>{C(u)},(u,B)=>{x(U=>({...U,[Cv(u)]:B}))},()=>{C(null),x()},d,v]}const Pv="modulepreload",Av=function(d){return"/"+d},vg={},Kp=function(x,v,C){let I=Promise.resolve();if(v&&v.length>0){document.getElementsByTagName("link");const E=document.querySelector("meta[property=csp-nonce]"),u=(E==null?void 0:E.nonce)||(E==null?void 0:E.getAttribute("nonce"));I=Promise.allSettled(v.map(B=>{if(B=Av(B),B in vg)return;vg[B]=!0;const U=B.endsWith(".css"),K=U?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${B}"]${K}`))return;const j=document.createElement("link");if(j.rel=U?"stylesheet":Pv,U||(j.as="script"),j.crossOrigin="",j.href=B,u&&j.setAttribute("nonce",u),document.head.appendChild(j),U)return new Promise((N,q)=>{j.addEventListener("load",N),j.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${B}`)))})}))}function z(E){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=E,window.dispatchEvent(u),!u.defaultPrevented)throw E}return I.then(E=>{for(const u of E||[])u.status==="rejected"&&z(u.reason);return x().catch(z)})};async function Mv(d){return d?d[0]==="{"?(await Kp(async()=>{const{default:C}=await import("./telegram-naMZCWTL.js");return{default:C}},__vite__mapDeps([0,1]))).default:d.indexOf("group-v2-change")>-1?(await Kp(async()=>{const{default:C}=await import("./signal-BZi8xF_p.js");return{default:C}},__vite__mapDeps([2,1]))).default:(await Kp(async()=>{const{default:v}=await import("./whatsapp-C86084Ia.js");return{default:v}},__vite__mapDeps([3,1]))).default:void 0}function zv({files:d,msgPosition:x}){const[v,C]=qr.useState({type:"FeatureCollection",features:[]});return qr.useEffect(()=>{async function z(){if(!d)return;let E=[];for(let u in d){const U=(await Mv(d[u]))({text:d[u],msgPosition:x});E=E.concat(U.features)}C(u=>({type:"FeatureCollection",features:[...u.features,...E]}))}z()},[d]),[v,()=>{C({type:"FeatureCollection",features:[]})}]}const ky="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='80'%20height='48'%20viewBox='0%200%2080%2048'%3e%3cg%20fill='%23D73F3F'%20fill-rule='evenodd'%3e%3cpath%20d='M37.02656,20.77496%20C37.02656,20.29096%2037.12976,19.85896%2037.33616,19.48616%20C37.54096,19.11176%2037.81296,18.80696%2038.15056,18.56376%20C38.48656,18.32136%2038.86496,18.13736%2039.28576,18.01336%20C39.70496,17.89016%2040.12736,17.82776%2040.55376,17.82776%20C40.97856,17.82776%2041.40256,17.89016%2041.82336,18.01336%20C42.24176,18.13736%2042.62016,18.32136%2042.95616,18.56376%20C43.29456,18.80696%2043.56576,19.11176%2043.77216,19.48616%20C43.97856,19.85896%2044.08096,20.29096%2044.08096,20.77496%20L44.08096,27.14696%20C44.08096,27.64136%2043.97856,28.07496%2043.77216,28.44216%20C43.56576,28.81096%2043.29456,29.11416%2042.95616,29.35736%20C42.62016,29.60136%2042.24176,29.78616%2041.82336,29.90856%20C41.40256,30.03176%2040.97856,30.09336%2040.55376,30.09336%20C40.12736,30.09336%2039.70496,30.03176%2039.28576,29.90856%20C38.86496,29.78616%2038.48656,29.60136%2038.15056,29.35736%20C37.81296,29.11416%2037.54096,28.81096%2037.33616,28.44216%20C37.12976,28.07496%2037.02656,27.64136%2037.02656,27.14696%20L37.02656,20.77496%20Z%20M39.05136,27.15016%20C39.05136,27.56536%2039.28256,27.87496%2039.56576,28.07176%20C39.84736,28.27016%2040.18096,28.37496%2040.56576,28.37496%20C40.94896,28.37496%2041.28416,28.27016%2041.56656,28.07176%20C41.84736,27.87496%2042.00816,27.56536%2042.00816,27.15016%20L42.00816,20.77816%20C42.00816,20.36136%2041.84736,20.05256%2041.56656,19.85576%20C41.28416,19.65816%2040.94896,19.52536%2040.56576,19.52536%20C40.18096,19.52536%2039.84736,19.65816%2039.56576,19.85576%20C39.28256,20.05256%2039.05136,20.36136%2039.05136,20.77816%20L39.05136,27.15016%20Z'/%3e%3cpolygon%20points='33.379%2017.815%2033.379%2022.99%2030.152%2022.99%2030.152%2017.815%2028.387%2017.815%2028.387%2030.1%2030.152%2030.1%2030.152%2024.923%2033.379%2024.923%2033.379%2030.1%2035.278%2030.1%2035.278%2017.815'/%3e%3cpolygon%20points='52.431%2017.815%2045.426%2017.815%2045.426%2019.622%2048.015%2019.622%2047.985%2030.1%2049.847%2030.1%2049.847%2019.622%2052.431%2019.622'/%3e%3cpath%20d='M65.42344,28.7668%20L79.67944,28.7668%20L71.15544,19.1684%20L62.66904,9.57%20L54.18104,0.000400000001%20L11.53944,0.000400000001%20L20.02584,9.57%20L5.73784,9.57%20L14.22584,19.1684%20L14.29144,19.2332%20L0.000239999999,19.2332%20L8.52184,28.8316%20L17.01304,38.43%20L25.50024,48.0004%20L68.14184,48.0004%20L59.65064,38.43%20L59.58824,38.3364%20L73.87864,38.3364%20L65.42344,28.7668%20Z%20M39.83944,39.9492%20C30.31864,39.9492%2022.60104,32.8084%2022.60104,24.0012%20C22.60104,15.1908%2030.31864,8.05%2039.83944,8.05%20C49.36104,8.05%2057.07944,15.1908%2057.07944,24.0012%20C57.07944,32.8084%2049.36104,39.9492%2039.83944,39.9492%20Z'/%3e%3c/g%3e%3c/svg%3e";var gm=function(d,x){return gm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,C){v.__proto__=C}||function(v,C){for(var I in C)Object.prototype.hasOwnProperty.call(C,I)&&(v[I]=C[I])},gm(d,x)};function Va(d,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");gm(d,x);function v(){this.constructor=d}d.prototype=x===null?Object.create(x):(v.prototype=x.prototype,new v)}var kr=function(){return kr=Object.assign||function(x){for(var v,C=1,I=arguments.length;C<I;C++){v=arguments[C];for(var z in v)Object.prototype.hasOwnProperty.call(v,z)&&(x[z]=v[z])}return x},kr.apply(this,arguments)};function td(d,x){var v={};for(var C in d)Object.prototype.hasOwnProperty.call(d,C)&&x.indexOf(C)<0&&(v[C]=d[C]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,C=Object.getOwnPropertySymbols(d);I<C.length;I++)x.indexOf(C[I])<0&&Object.prototype.propertyIsEnumerable.call(d,C[I])&&(v[C[I]]=d[C[I]]);return v}function Mo(d,x,v){if(v||arguments.length===2)for(var C=0,I=x.length,z;C<I;C++)(z||!(C in x))&&(z||(z=Array.prototype.slice.call(x,0,C)),z[C]=x[C]);return d.concat(z||Array.prototype.slice.call(x))}function Po(d,x){var v=x&&x.cache?x.cache:Bv,C=x&&x.serializer?x.serializer:Ov,I=x&&x.strategy?x.strategy:Lv;return I(d,{cache:v,serializer:C})}function Rv(d){return d==null||typeof d=="number"||typeof d=="boolean"}function Dv(d,x,v,C){var I=Rv(C)?C:v(C),z=x.get(I);return typeof z>"u"&&(z=d.call(this,C),x.set(I,z)),z}function Cy(d,x,v){var C=Array.prototype.slice.call(arguments,3),I=v(C),z=x.get(I);return typeof z>"u"&&(z=d.apply(this,C),x.set(I,z)),z}function Iy(d,x,v,C,I){return v.bind(x,d,C,I)}function Lv(d,x){var v=d.length===1?Dv:Cy;return Iy(d,this,v,x.cache.create(),x.serializer)}function Fv(d,x){return Iy(d,this,Cy,x.cache.create(),x.serializer)}var Ov=function(){return JSON.stringify(arguments)};function Dm(){this.cache=Object.create(null)}Dm.prototype.get=function(d){return this.cache[d]};Dm.prototype.set=function(d,x){this.cache[d]=x};var Bv={create:function(){return new Dm}},Ao={variadic:Fv};function Py(d,x,v){if(v===void 0&&(v=Error),!d)throw new v(x)}Po(function(){for(var d,x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];return new((d=Intl.NumberFormat).bind.apply(d,Mo([void 0],x,!1)))},{strategy:Ao.variadic});Po(function(){for(var d,x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];return new((d=Intl.DateTimeFormat).bind.apply(d,Mo([void 0],x,!1)))},{strategy:Ao.variadic});Po(function(){for(var d,x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];return new((d=Intl.PluralRules).bind.apply(d,Mo([void 0],x,!1)))},{strategy:Ao.variadic});Po(function(){for(var d,x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];return new((d=Intl.Locale).bind.apply(d,Mo([void 0],x,!1)))},{strategy:Ao.variadic});Po(function(){for(var d,x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];return new((d=Intl.ListFormat).bind.apply(d,Mo([void 0],x,!1)))},{strategy:Ao.variadic});var gn;(function(d){d[d.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",d[d.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",d[d.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",d[d.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",d[d.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",d[d.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",d[d.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",d[d.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",d[d.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",d[d.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",d[d.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",d[d.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",d[d.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",d[d.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",d[d.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",d[d.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",d[d.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",d[d.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",d[d.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",d[d.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",d[d.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",d[d.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",d[d.INVALID_TAG=23]="INVALID_TAG",d[d.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",d[d.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",d[d.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(gn||(gn={}));var li;(function(d){d[d.literal=0]="literal",d[d.argument=1]="argument",d[d.number=2]="number",d[d.date=3]="date",d[d.time=4]="time",d[d.select=5]="select",d[d.plural=6]="plural",d[d.pound=7]="pound",d[d.tag=8]="tag"})(li||(li={}));var rd;(function(d){d[d.number=0]="number",d[d.dateTime=1]="dateTime"})(rd||(rd={}));function xg(d){return d.type===li.literal}function Nv(d){return d.type===li.argument}function Ay(d){return d.type===li.number}function My(d){return d.type===li.date}function zy(d){return d.type===li.time}function Ry(d){return d.type===li.select}function Dy(d){return d.type===li.plural}function jv(d){return d.type===li.pound}function Ly(d){return d.type===li.tag}function Fy(d){return!!(d&&typeof d=="object"&&d.type===rd.number)}function ym(d){return!!(d&&typeof d=="object"&&d.type===rd.dateTime)}var Oy=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Uv=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Vv(d){var x={};return d.replace(Uv,function(v){var C=v.length;switch(v[0]){case"G":x.era=C===4?"long":C===5?"narrow":"short";break;case"y":x.year=C===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":x.month=["numeric","2-digit","short","long","narrow"][C-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":x.day=["numeric","2-digit"][C-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":x.weekday=C===4?"long":C===5?"narrow":"short";break;case"e":if(C<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");x.weekday=["short","long","narrow","short"][C-4];break;case"c":if(C<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");x.weekday=["short","long","narrow","short"][C-4];break;case"a":x.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":x.hourCycle="h12",x.hour=["numeric","2-digit"][C-1];break;case"H":x.hourCycle="h23",x.hour=["numeric","2-digit"][C-1];break;case"K":x.hourCycle="h11",x.hour=["numeric","2-digit"][C-1];break;case"k":x.hourCycle="h24",x.hour=["numeric","2-digit"][C-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":x.minute=["numeric","2-digit"][C-1];break;case"s":x.second=["numeric","2-digit"][C-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":x.timeZoneName=C<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),x}var Hv=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function $v(d){if(d.length===0)throw new Error("Number skeleton cannot be empty");for(var x=d.split(Hv).filter(function(N){return N.length>0}),v=[],C=0,I=x;C<I.length;C++){var z=I[C],E=z.split("/");if(E.length===0)throw new Error("Invalid number skeleton");for(var u=E[0],B=E.slice(1),U=0,K=B;U<K.length;U++){var j=K[U];if(j.length===0)throw new Error("Invalid number skeleton")}v.push({stem:u,options:B})}return v}function Gv(d){return d.replace(/^(.*?)-/,"")}var wg=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,By=/^(@+)?(\+|#+)?[rs]?$/g,qv=/(\*)(0+)|(#+)(0+)|(0+)/g,Ny=/^(0+)$/;function bg(d){var x={};return d[d.length-1]==="r"?x.roundingPriority="morePrecision":d[d.length-1]==="s"&&(x.roundingPriority="lessPrecision"),d.replace(By,function(v,C,I){return typeof I!="string"?(x.minimumSignificantDigits=C.length,x.maximumSignificantDigits=C.length):I==="+"?x.minimumSignificantDigits=C.length:C[0]==="#"?x.maximumSignificantDigits=C.length:(x.minimumSignificantDigits=C.length,x.maximumSignificantDigits=C.length+(typeof I=="string"?I.length:0)),""}),x}function jy(d){switch(d){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function Zv(d){var x;if(d[0]==="E"&&d[1]==="E"?(x={notation:"engineering"},d=d.slice(2)):d[0]==="E"&&(x={notation:"scientific"},d=d.slice(1)),x){var v=d.slice(0,2);if(v==="+!"?(x.signDisplay="always",d=d.slice(2)):v==="+?"&&(x.signDisplay="exceptZero",d=d.slice(2)),!Ny.test(d))throw new Error("Malformed concise eng/scientific notation");x.minimumIntegerDigits=d.length}return x}function Sg(d){var x={},v=jy(d);return v||x}function Wv(d){for(var x={},v=0,C=d;v<C.length;v++){var I=C[v];switch(I.stem){case"percent":case"%":x.style="percent";continue;case"%x100":x.style="percent",x.scale=100;continue;case"currency":x.style="currency",x.currency=I.options[0];continue;case"group-off":case",_":x.useGrouping=!1;continue;case"precision-integer":case".":x.maximumFractionDigits=0;continue;case"measure-unit":case"unit":x.style="unit",x.unit=Gv(I.options[0]);continue;case"compact-short":case"K":x.notation="compact",x.compactDisplay="short";continue;case"compact-long":case"KK":x.notation="compact",x.compactDisplay="long";continue;case"scientific":x=kr(kr(kr({},x),{notation:"scientific"}),I.options.reduce(function(B,U){return kr(kr({},B),Sg(U))},{}));continue;case"engineering":x=kr(kr(kr({},x),{notation:"engineering"}),I.options.reduce(function(B,U){return kr(kr({},B),Sg(U))},{}));continue;case"notation-simple":x.notation="standard";continue;case"unit-width-narrow":x.currencyDisplay="narrowSymbol",x.unitDisplay="narrow";continue;case"unit-width-short":x.currencyDisplay="code",x.unitDisplay="short";continue;case"unit-width-full-name":x.currencyDisplay="name",x.unitDisplay="long";continue;case"unit-width-iso-code":x.currencyDisplay="symbol";continue;case"scale":x.scale=parseFloat(I.options[0]);continue;case"rounding-mode-floor":x.roundingMode="floor";continue;case"rounding-mode-ceiling":x.roundingMode="ceil";continue;case"rounding-mode-down":x.roundingMode="trunc";continue;case"rounding-mode-up":x.roundingMode="expand";continue;case"rounding-mode-half-even":x.roundingMode="halfEven";continue;case"rounding-mode-half-down":x.roundingMode="halfTrunc";continue;case"rounding-mode-half-up":x.roundingMode="halfExpand";continue;case"integer-width":if(I.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");I.options[0].replace(qv,function(B,U,K,j,N,q){if(U)x.minimumIntegerDigits=K.length;else{if(j&&N)throw new Error("We currently do not support maximum integer digits");if(q)throw new Error("We currently do not support exact integer digits")}return""});continue}if(Ny.test(I.stem)){x.minimumIntegerDigits=I.stem.length;continue}if(wg.test(I.stem)){if(I.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");I.stem.replace(wg,function(B,U,K,j,N,q){return K==="*"?x.minimumFractionDigits=U.length:j&&j[0]==="#"?x.maximumFractionDigits=j.length:N&&q?(x.minimumFractionDigits=N.length,x.maximumFractionDigits=N.length+q.length):(x.minimumFractionDigits=U.length,x.maximumFractionDigits=U.length),""});var z=I.options[0];z==="w"?x=kr(kr({},x),{trailingZeroDisplay:"stripIfInteger"}):z&&(x=kr(kr({},x),bg(z)));continue}if(By.test(I.stem)){x=kr(kr({},x),bg(I.stem));continue}var E=jy(I.stem);E&&(x=kr(kr({},x),E));var u=Zv(I.stem);u&&(x=kr(kr({},x),u))}return x}var Gf={"001":["H","h"],419:["h","H","hB","hb"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["h","H","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["h","H","hB","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["h","H","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["h","H","hB","hb"],CU:["h","H","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["h","H","hB","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["h","H","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["h","H","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["h","H","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["h","H","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["h","H","hB","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["h","H","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["h","H","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["h","H","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"en-HK":["h","hb","H","hB"],"en-IL":["H","h","hb","hB"],"en-MY":["h","hb","H","hB"],"es-BR":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function Xv(d,x){for(var v="",C=0;C<d.length;C++){var I=d.charAt(C);if(I==="j"){for(var z=0;C+1<d.length&&d.charAt(C+1)===I;)z++,C++;var E=1+(z&1),u=z<2?1:3+(z>>1),B="a",U=Kv(x);for((U=="H"||U=="k")&&(u=0);u-- >0;)v+=B;for(;E-- >0;)v=U+v}else I==="J"?v+="H":v+=I}return v}function Kv(d){var x=d.hourCycle;if(x===void 0&&d.hourCycles&&d.hourCycles.length&&(x=d.hourCycles[0]),x)switch(x){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var v=d.language,C;v!=="root"&&(C=d.maximize().region);var I=Gf[C||""]||Gf[v||""]||Gf["".concat(v,"-001")]||Gf["001"];return I[0]}var Yp,Yv=new RegExp("^".concat(Oy.source,"*")),Jv=new RegExp("".concat(Oy.source,"*$"));function vn(d,x){return{start:d,end:x}}var Qv=!!String.prototype.startsWith&&"_a".startsWith("a",1),e0=!!String.fromCodePoint,t0=!!Object.fromEntries,r0=!!String.prototype.codePointAt,n0=!!String.prototype.trimStart,i0=!!String.prototype.trimEnd,s0=!!Number.isSafeInteger,o0=s0?Number.isSafeInteger:function(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d&&Math.abs(d)<=9007199254740991},_m=!0;try{var a0=Vy("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");_m=((Yp=a0.exec("a"))===null||Yp===void 0?void 0:Yp[0])==="a"}catch{_m=!1}var Eg=Qv?function(x,v,C){return x.startsWith(v,C)}:function(x,v,C){return x.slice(C,C+v.length)===v},vm=e0?String.fromCodePoint:function(){for(var x=[],v=0;v<arguments.length;v++)x[v]=arguments[v];for(var C="",I=x.length,z=0,E;I>z;){if(E=x[z++],E>1114111)throw RangeError(E+" is not a valid code point");C+=E<65536?String.fromCharCode(E):String.fromCharCode(((E-=65536)>>10)+55296,E%1024+56320)}return C},Tg=t0?Object.fromEntries:function(x){for(var v={},C=0,I=x;C<I.length;C++){var z=I[C],E=z[0],u=z[1];v[E]=u}return v},Uy=r0?function(x,v){return x.codePointAt(v)}:function(x,v){var C=x.length;if(!(v<0||v>=C)){var I=x.charCodeAt(v),z;return I<55296||I>56319||v+1===C||(z=x.charCodeAt(v+1))<56320||z>57343?I:(I-55296<<10)+(z-56320)+65536}},l0=n0?function(x){return x.trimStart()}:function(x){return x.replace(Yv,"")},u0=i0?function(x){return x.trimEnd()}:function(x){return x.replace(Jv,"")};function Vy(d,x){return new RegExp(d,x)}var xm;if(_m){var kg=Vy("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");xm=function(x,v){var C;kg.lastIndex=v;var I=kg.exec(x);return(C=I[1])!==null&&C!==void 0?C:""}}else xm=function(x,v){for(var C=[];;){var I=Uy(x,v);if(I===void 0||Hy(I)||f0(I))break;C.push(I),v+=I>=65536?2:1}return vm.apply(void 0,C)};var c0=function(){function d(x,v){v===void 0&&(v={}),this.message=x,this.position={offset:0,line:1,column:1},this.ignoreTag=!!v.ignoreTag,this.locale=v.locale,this.requiresOtherClause=!!v.requiresOtherClause,this.shouldParseSkeletons=!!v.shouldParseSkeletons}return d.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},d.prototype.parseMessage=function(x,v,C){for(var I=[];!this.isEOF();){var z=this.char();if(z===123){var E=this.parseArgument(x,C);if(E.err)return E;I.push(E.val)}else{if(z===125&&x>0)break;if(z===35&&(v==="plural"||v==="selectordinal")){var u=this.clonePosition();this.bump(),I.push({type:li.pound,location:vn(u,this.clonePosition())})}else if(z===60&&!this.ignoreTag&&this.peek()===47){if(C)break;return this.error(gn.UNMATCHED_CLOSING_TAG,vn(this.clonePosition(),this.clonePosition()))}else if(z===60&&!this.ignoreTag&&wm(this.peek()||0)){var E=this.parseTag(x,v);if(E.err)return E;I.push(E.val)}else{var E=this.parseLiteral(x,v);if(E.err)return E;I.push(E.val)}}}return{val:I,err:null}},d.prototype.parseTag=function(x,v){var C=this.clonePosition();this.bump();var I=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:li.literal,value:"<".concat(I,"/>"),location:vn(C,this.clonePosition())},err:null};if(this.bumpIf(">")){var z=this.parseMessage(x+1,v,!0);if(z.err)return z;var E=z.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!wm(this.char()))return this.error(gn.INVALID_TAG,vn(u,this.clonePosition()));var B=this.clonePosition(),U=this.parseTagName();return I!==U?this.error(gn.UNMATCHED_CLOSING_TAG,vn(B,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:li.tag,value:I,children:E,location:vn(C,this.clonePosition())},err:null}:this.error(gn.INVALID_TAG,vn(u,this.clonePosition())))}else return this.error(gn.UNCLOSED_TAG,vn(C,this.clonePosition()))}else return this.error(gn.INVALID_TAG,vn(C,this.clonePosition()))},d.prototype.parseTagName=function(){var x=this.offset();for(this.bump();!this.isEOF()&&d0(this.char());)this.bump();return this.message.slice(x,this.offset())},d.prototype.parseLiteral=function(x,v){for(var C=this.clonePosition(),I="";;){var z=this.tryParseQuote(v);if(z){I+=z;continue}var E=this.tryParseUnquoted(x,v);if(E){I+=E;continue}var u=this.tryParseLeftAngleBracket();if(u){I+=u;continue}break}var B=vn(C,this.clonePosition());return{val:{type:li.literal,value:I,location:B},err:null}},d.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!h0(this.peek()||0))?(this.bump(),"<"):null},d.prototype.tryParseQuote=function(x){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(x==="plural"||x==="selectordinal")break;return null;default:return null}this.bump();var v=[this.char()];for(this.bump();!this.isEOF();){var C=this.char();if(C===39)if(this.peek()===39)v.push(39),this.bump();else{this.bump();break}else v.push(C);this.bump()}return vm.apply(void 0,v)},d.prototype.tryParseUnquoted=function(x,v){if(this.isEOF())return null;var C=this.char();return C===60||C===123||C===35&&(v==="plural"||v==="selectordinal")||C===125&&x>0?null:(this.bump(),vm(C))},d.prototype.parseArgument=function(x,v){var C=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(gn.EXPECT_ARGUMENT_CLOSING_BRACE,vn(C,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(gn.EMPTY_ARGUMENT,vn(C,this.clonePosition()));var I=this.parseIdentifierIfPossible().value;if(!I)return this.error(gn.MALFORMED_ARGUMENT,vn(C,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(gn.EXPECT_ARGUMENT_CLOSING_BRACE,vn(C,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:li.argument,value:I,location:vn(C,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(gn.EXPECT_ARGUMENT_CLOSING_BRACE,vn(C,this.clonePosition())):this.parseArgumentOptions(x,v,I,C);default:return this.error(gn.MALFORMED_ARGUMENT,vn(C,this.clonePosition()))}},d.prototype.parseIdentifierIfPossible=function(){var x=this.clonePosition(),v=this.offset(),C=xm(this.message,v),I=v+C.length;this.bumpTo(I);var z=this.clonePosition(),E=vn(x,z);return{value:C,location:E}},d.prototype.parseArgumentOptions=function(x,v,C,I){var z,E=this.clonePosition(),u=this.parseIdentifierIfPossible().value,B=this.clonePosition();switch(u){case"":return this.error(gn.EXPECT_ARGUMENT_TYPE,vn(E,B));case"number":case"date":case"time":{this.bumpSpace();var U=null;if(this.bumpIf(",")){this.bumpSpace();var K=this.clonePosition(),j=this.parseSimpleArgStyleIfPossible();if(j.err)return j;var N=u0(j.val);if(N.length===0)return this.error(gn.EXPECT_ARGUMENT_STYLE,vn(this.clonePosition(),this.clonePosition()));var q=vn(K,this.clonePosition());U={style:N,styleLocation:q}}var se=this.tryParseArgumentClose(I);if(se.err)return se;var J=vn(I,this.clonePosition());if(U&&Eg(U==null?void 0:U.style,"::",0)){var ae=l0(U.style.slice(2));if(u==="number"){var j=this.parseNumberSkeletonFromString(ae,U.styleLocation);return j.err?j:{val:{type:li.number,value:C,location:J,style:j.val},err:null}}else{if(ae.length===0)return this.error(gn.EXPECT_DATE_TIME_SKELETON,J);var re=ae;this.locale&&(re=Xv(ae,this.locale));var N={type:rd.dateTime,pattern:re,location:U.styleLocation,parsedOptions:this.shouldParseSkeletons?Vv(re):{}},pe=u==="date"?li.date:li.time;return{val:{type:pe,value:C,location:J,style:N},err:null}}}return{val:{type:u==="number"?li.number:u==="date"?li.date:li.time,value:C,location:J,style:(z=U==null?void 0:U.style)!==null&&z!==void 0?z:null},err:null}}case"plural":case"selectordinal":case"select":{var ge=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(gn.EXPECT_SELECT_ARGUMENT_OPTIONS,vn(ge,kr({},ge)));this.bumpSpace();var Fe=this.parseIdentifierIfPossible(),ve=0;if(u!=="select"&&Fe.value==="offset"){if(!this.bumpIf(":"))return this.error(gn.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,vn(this.clonePosition(),this.clonePosition()));this.bumpSpace();var j=this.tryParseDecimalInteger(gn.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,gn.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(j.err)return j;this.bumpSpace(),Fe=this.parseIdentifierIfPossible(),ve=j.val}var qe=this.tryParsePluralOrSelectOptions(x,u,v,Fe);if(qe.err)return qe;var se=this.tryParseArgumentClose(I);if(se.err)return se;var je=vn(I,this.clonePosition());return u==="select"?{val:{type:li.select,value:C,options:Tg(qe.val),location:je},err:null}:{val:{type:li.plural,value:C,options:Tg(qe.val),offset:ve,pluralType:u==="plural"?"cardinal":"ordinal",location:je},err:null}}default:return this.error(gn.INVALID_ARGUMENT_TYPE,vn(E,B))}},d.prototype.tryParseArgumentClose=function(x){return this.isEOF()||this.char()!==125?this.error(gn.EXPECT_ARGUMENT_CLOSING_BRACE,vn(x,this.clonePosition())):(this.bump(),{val:!0,err:null})},d.prototype.parseSimpleArgStyleIfPossible=function(){for(var x=0,v=this.clonePosition();!this.isEOF();){var C=this.char();switch(C){case 39:{this.bump();var I=this.clonePosition();if(!this.bumpUntil("'"))return this.error(gn.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,vn(I,this.clonePosition()));this.bump();break}case 123:{x+=1,this.bump();break}case 125:{if(x>0)x-=1;else return{val:this.message.slice(v.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(v.offset,this.offset()),err:null}},d.prototype.parseNumberSkeletonFromString=function(x,v){var C=[];try{C=$v(x)}catch{return this.error(gn.INVALID_NUMBER_SKELETON,v)}return{val:{type:rd.number,tokens:C,location:v,parsedOptions:this.shouldParseSkeletons?Wv(C):{}},err:null}},d.prototype.tryParsePluralOrSelectOptions=function(x,v,C,I){for(var z,E=!1,u=[],B=new Set,U=I.value,K=I.location;;){if(U.length===0){var j=this.clonePosition();if(v!=="select"&&this.bumpIf("=")){var N=this.tryParseDecimalInteger(gn.EXPECT_PLURAL_ARGUMENT_SELECTOR,gn.INVALID_PLURAL_ARGUMENT_SELECTOR);if(N.err)return N;K=vn(j,this.clonePosition()),U=this.message.slice(j.offset,this.offset())}else break}if(B.has(U))return this.error(v==="select"?gn.DUPLICATE_SELECT_ARGUMENT_SELECTOR:gn.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,K);U==="other"&&(E=!0),this.bumpSpace();var q=this.clonePosition();if(!this.bumpIf("{"))return this.error(v==="select"?gn.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:gn.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,vn(this.clonePosition(),this.clonePosition()));var se=this.parseMessage(x+1,v,C);if(se.err)return se;var J=this.tryParseArgumentClose(q);if(J.err)return J;u.push([U,{value:se.val,location:vn(q,this.clonePosition())}]),B.add(U),this.bumpSpace(),z=this.parseIdentifierIfPossible(),U=z.value,K=z.location}return u.length===0?this.error(v==="select"?gn.EXPECT_SELECT_ARGUMENT_SELECTOR:gn.EXPECT_PLURAL_ARGUMENT_SELECTOR,vn(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!E?this.error(gn.MISSING_OTHER_CLAUSE,vn(this.clonePosition(),this.clonePosition())):{val:u,err:null}},d.prototype.tryParseDecimalInteger=function(x,v){var C=1,I=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(C=-1);for(var z=!1,E=0;!this.isEOF();){var u=this.char();if(u>=48&&u<=57)z=!0,E=E*10+(u-48),this.bump();else break}var B=vn(I,this.clonePosition());return z?(E*=C,o0(E)?{val:E,err:null}:this.error(v,B)):this.error(x,B)},d.prototype.offset=function(){return this.position.offset},d.prototype.isEOF=function(){return this.offset()===this.message.length},d.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},d.prototype.char=function(){var x=this.position.offset;if(x>=this.message.length)throw Error("out of bound");var v=Uy(this.message,x);if(v===void 0)throw Error("Offset ".concat(x," is at invalid UTF-16 code unit boundary"));return v},d.prototype.error=function(x,v){return{val:null,err:{kind:x,message:this.message,location:v}}},d.prototype.bump=function(){if(!this.isEOF()){var x=this.char();x===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=x<65536?1:2)}},d.prototype.bumpIf=function(x){if(Eg(this.message,x,this.offset())){for(var v=0;v<x.length;v++)this.bump();return!0}return!1},d.prototype.bumpUntil=function(x){var v=this.offset(),C=this.message.indexOf(x,v);return C>=0?(this.bumpTo(C),!0):(this.bumpTo(this.message.length),!1)},d.prototype.bumpTo=function(x){if(this.offset()>x)throw Error("targetOffset ".concat(x," must be greater than or equal to the current offset ").concat(this.offset()));for(x=Math.min(x,this.message.length);;){var v=this.offset();if(v===x)break;if(v>x)throw Error("targetOffset ".concat(x," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},d.prototype.bumpSpace=function(){for(;!this.isEOF()&&Hy(this.char());)this.bump()},d.prototype.peek=function(){if(this.isEOF())return null;var x=this.char(),v=this.offset(),C=this.message.charCodeAt(v+(x>=65536?2:1));return C??null},d}();function wm(d){return d>=97&&d<=122||d>=65&&d<=90}function h0(d){return wm(d)||d===47}function d0(d){return d===45||d===46||d>=48&&d<=57||d===95||d>=97&&d<=122||d>=65&&d<=90||d==183||d>=192&&d<=214||d>=216&&d<=246||d>=248&&d<=893||d>=895&&d<=8191||d>=8204&&d<=8205||d>=8255&&d<=8256||d>=8304&&d<=8591||d>=11264&&d<=12271||d>=12289&&d<=55295||d>=63744&&d<=64975||d>=65008&&d<=65533||d>=65536&&d<=983039}function Hy(d){return d>=9&&d<=13||d===32||d===133||d>=8206&&d<=8207||d===8232||d===8233}function f0(d){return d>=33&&d<=35||d===36||d>=37&&d<=39||d===40||d===41||d===42||d===43||d===44||d===45||d>=46&&d<=47||d>=58&&d<=59||d>=60&&d<=62||d>=63&&d<=64||d===91||d===92||d===93||d===94||d===96||d===123||d===124||d===125||d===126||d===161||d>=162&&d<=165||d===166||d===167||d===169||d===171||d===172||d===174||d===176||d===177||d===182||d===187||d===191||d===215||d===247||d>=8208&&d<=8213||d>=8214&&d<=8215||d===8216||d===8217||d===8218||d>=8219&&d<=8220||d===8221||d===8222||d===8223||d>=8224&&d<=8231||d>=8240&&d<=8248||d===8249||d===8250||d>=8251&&d<=8254||d>=8257&&d<=8259||d===8260||d===8261||d===8262||d>=8263&&d<=8273||d===8274||d===8275||d>=8277&&d<=8286||d>=8592&&d<=8596||d>=8597&&d<=8601||d>=8602&&d<=8603||d>=8604&&d<=8607||d===8608||d>=8609&&d<=8610||d===8611||d>=8612&&d<=8613||d===8614||d>=8615&&d<=8621||d===8622||d>=8623&&d<=8653||d>=8654&&d<=8655||d>=8656&&d<=8657||d===8658||d===8659||d===8660||d>=8661&&d<=8691||d>=8692&&d<=8959||d>=8960&&d<=8967||d===8968||d===8969||d===8970||d===8971||d>=8972&&d<=8991||d>=8992&&d<=8993||d>=8994&&d<=9e3||d===9001||d===9002||d>=9003&&d<=9083||d===9084||d>=9085&&d<=9114||d>=9115&&d<=9139||d>=9140&&d<=9179||d>=9180&&d<=9185||d>=9186&&d<=9254||d>=9255&&d<=9279||d>=9280&&d<=9290||d>=9291&&d<=9311||d>=9472&&d<=9654||d===9655||d>=9656&&d<=9664||d===9665||d>=9666&&d<=9719||d>=9720&&d<=9727||d>=9728&&d<=9838||d===9839||d>=9840&&d<=10087||d===10088||d===10089||d===10090||d===10091||d===10092||d===10093||d===10094||d===10095||d===10096||d===10097||d===10098||d===10099||d===10100||d===10101||d>=10132&&d<=10175||d>=10176&&d<=10180||d===10181||d===10182||d>=10183&&d<=10213||d===10214||d===10215||d===10216||d===10217||d===10218||d===10219||d===10220||d===10221||d===10222||d===10223||d>=10224&&d<=10239||d>=10240&&d<=10495||d>=10496&&d<=10626||d===10627||d===10628||d===10629||d===10630||d===10631||d===10632||d===10633||d===10634||d===10635||d===10636||d===10637||d===10638||d===10639||d===10640||d===10641||d===10642||d===10643||d===10644||d===10645||d===10646||d===10647||d===10648||d>=10649&&d<=10711||d===10712||d===10713||d===10714||d===10715||d>=10716&&d<=10747||d===10748||d===10749||d>=10750&&d<=11007||d>=11008&&d<=11055||d>=11056&&d<=11076||d>=11077&&d<=11078||d>=11079&&d<=11084||d>=11085&&d<=11123||d>=11124&&d<=11125||d>=11126&&d<=11157||d===11158||d>=11159&&d<=11263||d>=11776&&d<=11777||d===11778||d===11779||d===11780||d===11781||d>=11782&&d<=11784||d===11785||d===11786||d===11787||d===11788||d===11789||d>=11790&&d<=11798||d===11799||d>=11800&&d<=11801||d===11802||d===11803||d===11804||d===11805||d>=11806&&d<=11807||d===11808||d===11809||d===11810||d===11811||d===11812||d===11813||d===11814||d===11815||d===11816||d===11817||d>=11818&&d<=11822||d===11823||d>=11824&&d<=11833||d>=11834&&d<=11835||d>=11836&&d<=11839||d===11840||d===11841||d===11842||d>=11843&&d<=11855||d>=11856&&d<=11857||d===11858||d>=11859&&d<=11903||d>=12289&&d<=12291||d===12296||d===12297||d===12298||d===12299||d===12300||d===12301||d===12302||d===12303||d===12304||d===12305||d>=12306&&d<=12307||d===12308||d===12309||d===12310||d===12311||d===12312||d===12313||d===12314||d===12315||d===12316||d===12317||d>=12318&&d<=12319||d===12320||d===12336||d===64830||d===64831||d>=65093&&d<=65094}function bm(d){d.forEach(function(x){if(delete x.location,Ry(x)||Dy(x))for(var v in x.options)delete x.options[v].location,bm(x.options[v].value);else Ay(x)&&Fy(x.style)||(My(x)||zy(x))&&ym(x.style)?delete x.style.location:Ly(x)&&bm(x.children)})}function p0(d,x){x===void 0&&(x={}),x=kr({shouldParseSkeletons:!0,requiresOtherClause:!0},x);var v=new c0(d,x).parse();if(v.err){var C=SyntaxError(gn[v.err.kind]);throw C.location=v.err.location,C.originalMessage=v.err.message,C}return x!=null&&x.captureLocation||bm(v.val),v.val}var Jl;(function(d){d.MISSING_VALUE="MISSING_VALUE",d.INVALID_VALUE="INVALID_VALUE",d.MISSING_INTL_API="MISSING_INTL_API"})(Jl||(Jl={}));var oc=function(d){Va(x,d);function x(v,C,I){var z=d.call(this,v)||this;return z.code=C,z.originalMessage=I,z}return x.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},x}(Error),Cg=function(d){Va(x,d);function x(v,C,I,z){return d.call(this,'Invalid values for "'.concat(v,'": "').concat(C,'". Options are "').concat(Object.keys(I).join('", "'),'"'),Jl.INVALID_VALUE,z)||this}return x}(oc),m0=function(d){Va(x,d);function x(v,C,I){return d.call(this,'Value for "'.concat(v,'" must be of type ').concat(C),Jl.INVALID_VALUE,I)||this}return x}(oc),g0=function(d){Va(x,d);function x(v,C){return d.call(this,'The intl string context variable "'.concat(v,'" was not provided to the string "').concat(C,'"'),Jl.MISSING_VALUE,C)||this}return x}(oc),Io;(function(d){d[d.literal=0]="literal",d[d.object=1]="object"})(Io||(Io={}));function y0(d){return d.length<2?d:d.reduce(function(x,v){var C=x[x.length-1];return!C||C.type!==Io.literal||v.type!==Io.literal?x.push(v):C.value+=v.value,x},[])}function $y(d){return typeof d=="function"}function tp(d,x,v,C,I,z,E){if(d.length===1&&xg(d[0]))return[{type:Io.literal,value:d[0].value}];for(var u=[],B=0,U=d;B<U.length;B++){var K=U[B];if(xg(K)){u.push({type:Io.literal,value:K.value});continue}if(jv(K)){typeof z=="number"&&u.push({type:Io.literal,value:v.getNumberFormat(x).format(z)});continue}var j=K.value;if(!(I&&j in I))throw new g0(j,E);var N=I[j];if(Nv(K)){(!N||typeof N=="string"||typeof N=="number")&&(N=typeof N=="string"||typeof N=="number"?String(N):""),u.push({type:typeof N=="string"?Io.literal:Io.object,value:N});continue}if(My(K)){var q=typeof K.style=="string"?C.date[K.style]:ym(K.style)?K.style.parsedOptions:void 0;u.push({type:Io.literal,value:v.getDateTimeFormat(x,q).format(N)});continue}if(zy(K)){var q=typeof K.style=="string"?C.time[K.style]:ym(K.style)?K.style.parsedOptions:C.time.medium;u.push({type:Io.literal,value:v.getDateTimeFormat(x,q).format(N)});continue}if(Ay(K)){var q=typeof K.style=="string"?C.number[K.style]:Fy(K.style)?K.style.parsedOptions:void 0;q&&q.scale&&(N=N*(q.scale||1)),u.push({type:Io.literal,value:v.getNumberFormat(x,q).format(N)});continue}if(Ly(K)){var se=K.children,J=K.value,ae=I[J];if(!$y(ae))throw new m0(J,"function",E);var re=tp(se,x,v,C,I,z),pe=ae(re.map(function(ve){return ve.value}));Array.isArray(pe)||(pe=[pe]),u.push.apply(u,pe.map(function(ve){return{type:typeof ve=="string"?Io.literal:Io.object,value:ve}}))}if(Ry(K)){var ge=K.options[N]||K.options.other;if(!ge)throw new Cg(K.value,N,Object.keys(K.options),E);u.push.apply(u,tp(ge.value,x,v,C,I));continue}if(Dy(K)){var ge=K.options["=".concat(N)];if(!ge){if(!Intl.PluralRules)throw new oc(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,Jl.MISSING_INTL_API,E);var Fe=v.getPluralRules(x,{type:K.pluralType}).select(N-(K.offset||0));ge=K.options[Fe]||K.options.other}if(!ge)throw new Cg(K.value,N,Object.keys(K.options),E);u.push.apply(u,tp(ge.value,x,v,C,I,N-(K.offset||0)));continue}}return y0(u)}function _0(d,x){return x?kr(kr(kr({},d||{}),x||{}),Object.keys(d).reduce(function(v,C){return v[C]=kr(kr({},d[C]),x[C]||{}),v},{})):d}function v0(d,x){return x?Object.keys(d).reduce(function(v,C){return v[C]=_0(d[C],x[C]),v},kr({},d)):d}function Jp(d){return{create:function(){return{get:function(x){return d[x]},set:function(x,v){d[x]=v}}}}}function x0(d){return d===void 0&&(d={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Po(function(){for(var x,v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];return new((x=Intl.NumberFormat).bind.apply(x,Mo([void 0],v,!1)))},{cache:Jp(d.number),strategy:Ao.variadic}),getDateTimeFormat:Po(function(){for(var x,v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];return new((x=Intl.DateTimeFormat).bind.apply(x,Mo([void 0],v,!1)))},{cache:Jp(d.dateTime),strategy:Ao.variadic}),getPluralRules:Po(function(){for(var x,v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];return new((x=Intl.PluralRules).bind.apply(x,Mo([void 0],v,!1)))},{cache:Jp(d.pluralRules),strategy:Ao.variadic})}}var Gy=function(){function d(x,v,C,I){v===void 0&&(v=d.defaultLocale);var z=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(B){var U=z.formatToParts(B);if(U.length===1)return U[0].value;var K=U.reduce(function(j,N){return!j.length||N.type!==Io.literal||typeof j[j.length-1]!="string"?j.push(N.value):j[j.length-1]+=N.value,j},[]);return K.length<=1?K[0]||"":K},this.formatToParts=function(B){return tp(z.ast,z.locales,z.formatters,z.formats,B,void 0,z.message)},this.resolvedOptions=function(){var B;return{locale:((B=z.resolvedLocale)===null||B===void 0?void 0:B.toString())||Intl.NumberFormat.supportedLocalesOf(z.locales)[0]}},this.getAst=function(){return z.ast},this.locales=v,this.resolvedLocale=d.resolveLocale(v),typeof x=="string"){if(this.message=x,!d.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var E=I||{};E.formatters;var u=td(E,["formatters"]);this.ast=d.__parse(x,kr(kr({},u),{locale:this.resolvedLocale}))}else this.ast=x;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=v0(d.formats,C),this.formatters=I&&I.formatters||x0(this.formatterCache)}return Object.defineProperty(d,"defaultLocale",{get:function(){return d.memoizedDefaultLocale||(d.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),d.memoizedDefaultLocale},enumerable:!1,configurable:!0}),d.memoizedDefaultLocale=null,d.resolveLocale=function(x){if(!(typeof Intl.Locale>"u")){var v=Intl.NumberFormat.supportedLocalesOf(x);return v.length>0?new Intl.Locale(v[0]):new Intl.Locale(typeof x=="string"?x:x[0])}},d.__parse=p0,d.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},d}(),uh;(function(d){d.FORMAT_ERROR="FORMAT_ERROR",d.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",d.INVALID_CONFIG="INVALID_CONFIG",d.MISSING_DATA="MISSING_DATA",d.MISSING_TRANSLATION="MISSING_TRANSLATION"})(uh||(uh={}));var Zd=function(d){Va(x,d);function x(v,C,I){var z=this,E=I?I instanceof Error?I:new Error(String(I)):void 0;return z=d.call(this,"[@formatjs/intl Error ".concat(v,"] ").concat(C,`
`).concat(E?`
`.concat(E.message,`
`).concat(E.stack):""))||this,z.code=v,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(z,x),z}return x}(Error),w0=function(d){Va(x,d);function x(v,C){return d.call(this,uh.UNSUPPORTED_FORMATTER,v,C)||this}return x}(Zd),b0=function(d){Va(x,d);function x(v,C){return d.call(this,uh.INVALID_CONFIG,v,C)||this}return x}(Zd),Ig=function(d){Va(x,d);function x(v,C){return d.call(this,uh.MISSING_DATA,v,C)||this}return x}(Zd),Ha=function(d){Va(x,d);function x(v,C,I){var z=d.call(this,uh.FORMAT_ERROR,"".concat(v,`
Locale: `).concat(C,`
`),I)||this;return z.locale=C,z}return x}(Zd),Qp=function(d){Va(x,d);function x(v,C,I,z){var E=d.call(this,"".concat(v,`
MessageID: `).concat(I==null?void 0:I.id,`
Default Message: `).concat(I==null?void 0:I.defaultMessage,`
Description: `).concat(I==null?void 0:I.description,`
`),C,z)||this;return E.descriptor=I,E.locale=C,E}return x}(Ha),S0=function(d){Va(x,d);function x(v,C){var I=d.call(this,uh.MISSING_TRANSLATION,'Missing message: "'.concat(v.id,'" for locale "').concat(C,'", using ').concat(v.defaultMessage?"default message (".concat(typeof v.defaultMessage=="string"?v.defaultMessage:v.defaultMessage.map(function(z){var E;return(E=z.value)!==null&&E!==void 0?E:JSON.stringify(z)}).join(),")"):"id"," as fallback."))||this;return I.descriptor=v,I}return x}(Zd);function hh(d,x,v){return v===void 0&&(v={}),x.reduce(function(C,I){return I in d?C[I]=d[I]:I in v&&(C[I]=v[I]),C},{})}var E0=function(d){},T0=function(d){},qy={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:E0,onWarn:T0};function Zy(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function rh(d){return{create:function(){return{get:function(x){return d[x]},set:function(x,v){d[x]=v}}}}}function k0(d){d===void 0&&(d=Zy());var x=Intl.RelativeTimeFormat,v=Intl.ListFormat,C=Intl.DisplayNames,I=Po(function(){for(var u,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];return new((u=Intl.DateTimeFormat).bind.apply(u,Mo([void 0],B,!1)))},{cache:rh(d.dateTime),strategy:Ao.variadic}),z=Po(function(){for(var u,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];return new((u=Intl.NumberFormat).bind.apply(u,Mo([void 0],B,!1)))},{cache:rh(d.number),strategy:Ao.variadic}),E=Po(function(){for(var u,B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];return new((u=Intl.PluralRules).bind.apply(u,Mo([void 0],B,!1)))},{cache:rh(d.pluralRules),strategy:Ao.variadic});return{getDateTimeFormat:I,getNumberFormat:z,getMessageFormat:Po(function(u,B,U,K){return new Gy(u,B,U,kr({formatters:{getNumberFormat:z,getDateTimeFormat:I,getPluralRules:E}},K||{}))},{cache:rh(d.message),strategy:Ao.variadic}),getRelativeTimeFormat:Po(function(){for(var u=[],B=0;B<arguments.length;B++)u[B]=arguments[B];return new(x.bind.apply(x,Mo([void 0],u,!1)))},{cache:rh(d.relativeTime),strategy:Ao.variadic}),getPluralRules:E,getListFormat:Po(function(){for(var u=[],B=0;B<arguments.length;B++)u[B]=arguments[B];return new(v.bind.apply(v,Mo([void 0],u,!1)))},{cache:rh(d.list),strategy:Ao.variadic}),getDisplayNames:Po(function(){for(var u=[],B=0;B<arguments.length;B++)u[B]=arguments[B];return new(C.bind.apply(C,Mo([void 0],u,!1)))},{cache:rh(d.displayNames),strategy:Ao.variadic})}}function Lm(d,x,v,C){var I=d&&d[x],z;if(I&&(z=I[v]),z)return z;C(new w0("No ".concat(x," format named: ").concat(v)))}function qf(d,x){return Object.keys(d).reduce(function(v,C){return v[C]=kr({timeZone:x},d[C]),v},{})}function Pg(d,x){var v=Object.keys(kr(kr({},d),x));return v.reduce(function(C,I){return C[I]=kr(kr({},d[I]||{}),x[I]||{}),C},{})}function Ag(d,x){if(!x)return d;var v=Gy.formats;return kr(kr(kr({},v),d),{date:Pg(qf(v.date,x),qf(d.date||{},x)),time:Pg(qf(v.time,x),qf(d.time||{},x))})}var Sm=function(d,x,v,C,I){var z=d.locale,E=d.formats,u=d.messages,B=d.defaultLocale,U=d.defaultFormats,K=d.fallbackOnEmptyString,j=d.onError,N=d.timeZone,q=d.defaultRichTextElements;v===void 0&&(v={id:""});var se=v.id,J=v.defaultMessage;Py(!!se,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var ae=String(se),re=u&&Object.prototype.hasOwnProperty.call(u,ae)&&u[ae];if(Array.isArray(re)&&re.length===1&&re[0].type===li.literal)return re[0].value;if(!C&&re&&typeof re=="string"&&!q)return re.replace(/'\{(.*?)\}'/gi,"{$1}");if(C=kr(kr({},q),C||{}),E=Ag(E,N),U=Ag(U,N),!re){if(K===!1&&re==="")return re;if((!J||z&&z.toLowerCase()!==B.toLowerCase())&&j(new S0(v,z)),J)try{var pe=x.getMessageFormat(J,B,U,I);return pe.format(C)}catch(ge){return j(new Qp('Error formatting default message for: "'.concat(ae,'", rendering default message verbatim'),z,v,ge)),typeof J=="string"?J:ae}return ae}try{var pe=x.getMessageFormat(re,z,E,kr({formatters:x},I||{}));return pe.format(C)}catch(ge){j(new Qp('Error formatting message: "'.concat(ae,'", using ').concat(J?"default message":"id"," as fallback."),z,v,ge))}if(J)try{var pe=x.getMessageFormat(J,B,U,I);return pe.format(C)}catch(ge){j(new Qp('Error formatting the default message for: "'.concat(ae,'", rendering message verbatim'),z,v,ge))}return typeof re=="string"?re:typeof J=="string"?J:ae},Wy=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function dp(d,x,v,C){var I=d.locale,z=d.formats,E=d.onError,u=d.timeZone;C===void 0&&(C={});var B=C.format,U=kr(kr({},u&&{timeZone:u}),B&&Lm(z,x,B,E)),K=hh(C,Wy,U);return x==="time"&&!K.hour&&!K.minute&&!K.second&&!K.timeStyle&&!K.dateStyle&&(K=kr(kr({},K),{hour:"numeric",minute:"numeric"})),v(I,K)}function C0(d,x){for(var v=[],C=2;C<arguments.length;C++)v[C-2]=arguments[C];var I=v[0],z=v[1],E=z===void 0?{}:z,u=typeof I=="string"?new Date(I||0):I;try{return dp(d,"date",x,E).format(u)}catch(B){d.onError(new Ha("Error formatting date.",d.locale,B))}return String(u)}function I0(d,x){for(var v=[],C=2;C<arguments.length;C++)v[C-2]=arguments[C];var I=v[0],z=v[1],E=z===void 0?{}:z,u=typeof I=="string"?new Date(I||0):I;try{return dp(d,"time",x,E).format(u)}catch(B){d.onError(new Ha("Error formatting time.",d.locale,B))}return String(u)}function P0(d,x){for(var v=[],C=2;C<arguments.length;C++)v[C-2]=arguments[C];var I=v[0],z=v[1],E=v[2],u=E===void 0?{}:E,B=d.timeZone,U=d.locale,K=d.onError,j=hh(u,Wy,B?{timeZone:B}:{});try{return x(U,j).formatRange(I,z)}catch(N){K(new Ha("Error formatting date time range.",d.locale,N))}return String(I)}function A0(d,x){for(var v=[],C=2;C<arguments.length;C++)v[C-2]=arguments[C];var I=v[0],z=v[1],E=z===void 0?{}:z,u=typeof I=="string"?new Date(I||0):I;try{return dp(d,"date",x,E).formatToParts(u)}catch(B){d.onError(new Ha("Error formatting date.",d.locale,B))}return[]}function M0(d,x){for(var v=[],C=2;C<arguments.length;C++)v[C-2]=arguments[C];var I=v[0],z=v[1],E=z===void 0?{}:z,u=typeof I=="string"?new Date(I||0):I;try{return dp(d,"time",x,E).formatToParts(u)}catch(B){d.onError(new Ha("Error formatting time.",d.locale,B))}return[]}var z0=["style","type","fallback","languageDisplay"];function R0(d,x,v,C){var I=d.locale,z=d.onError,E=Intl.DisplayNames;E||z(new oc(`Intl.DisplayNames is not available in this environment.
Try polyfilling it using "@formatjs/intl-displaynames"
`,Jl.MISSING_INTL_API));var u=hh(C,z0);try{return x(I,u).of(v)}catch(B){z(new Ha("Error formatting display name.",I,B))}}var D0=["type","style"],Mg=Date.now();function L0(d){return"".concat(Mg,"_").concat(d,"_").concat(Mg)}function F0(d,x,v,C){C===void 0&&(C={});var I=Xy(d,x,v,C).reduce(function(z,E){var u=E.value;return typeof u!="string"?z.push(u):typeof z[z.length-1]=="string"?z[z.length-1]+=u:z.push(u),z},[]);return I.length===1?I[0]:I.length===0?"":I}function Xy(d,x,v,C){var I=d.locale,z=d.onError;C===void 0&&(C={});var E=Intl.ListFormat;E||z(new oc(`Intl.ListFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-listformat"
`,Jl.MISSING_INTL_API));var u=hh(C,D0);try{var B={},U=v.map(function(K,j){if(typeof K=="object"){var N=L0(j);return B[N]=K,N}return String(K)});return x(I,u).formatToParts(U).map(function(K){return K.type==="literal"?K:kr(kr({},K),{value:B[K.value]||K.value})})}catch(K){z(new Ha("Error formatting list.",I,K))}return v}var O0=["type"];function B0(d,x,v,C){var I=d.locale,z=d.onError;C===void 0&&(C={}),Intl.PluralRules||z(new oc(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,Jl.MISSING_INTL_API));var E=hh(C,O0);try{return x(I,E).select(v)}catch(u){z(new Ha("Error formatting plural.",I,u))}return"other"}var N0=["numeric","style"];function j0(d,x,v){var C=d.locale,I=d.formats,z=d.onError;v===void 0&&(v={});var E=v.format,u=!!E&&Lm(I,"relative",E,z)||{},B=hh(v,N0,u);return x(C,B)}function U0(d,x,v,C,I){I===void 0&&(I={}),C||(C="second");var z=Intl.RelativeTimeFormat;z||d.onError(new oc(`Intl.RelativeTimeFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-relativetimeformat"
`,Jl.MISSING_INTL_API));try{return j0(d,x,I).format(v,C)}catch(E){d.onError(new Ha("Error formatting relative time.",d.locale,E))}return String(v)}var V0=["style","currency","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem","trailingZeroDisplay","roundingPriority","roundingIncrement","roundingMode"];function Ky(d,x,v){var C=d.locale,I=d.formats,z=d.onError;v===void 0&&(v={});var E=v.format,u=E&&Lm(I,"number",E,z)||{},B=hh(v,V0,u);return x(C,B)}function H0(d,x,v,C){C===void 0&&(C={});try{return Ky(d,x,C).format(v)}catch(I){d.onError(new Ha("Error formatting number.",d.locale,I))}return String(v)}function $0(d,x,v,C){C===void 0&&(C={});try{return Ky(d,x,C).formatToParts(v)}catch(I){d.onError(new Ha("Error formatting number.",d.locale,I))}return[]}function G0(d){var x=d?d[Object.keys(d)[0]]:void 0;return typeof x=="string"}function q0(d){d.onWarn&&d.defaultRichTextElements&&G0(d.messages||{})&&d.onWarn(`[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. 
Please consider using "@formatjs/cli" to pre-compile your messages for performance.
For more details see https://formatjs.io/docs/getting-started/message-distribution`)}function Z0(d,x){var v=k0(x),C=kr(kr({},qy),d),I=C.locale,z=C.defaultLocale,E=C.onError;return I?!Intl.NumberFormat.supportedLocalesOf(I).length&&E?E(new Ig('Missing locale data for locale: "'.concat(I,'" in Intl.NumberFormat. Using default locale: "').concat(z,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(I).length&&E&&E(new Ig('Missing locale data for locale: "'.concat(I,'" in Intl.DateTimeFormat. Using default locale: "').concat(z,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(E&&E(new b0('"locale" was not configured, using "'.concat(z,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),C.locale=C.defaultLocale||"en"),q0(C),kr(kr({},C),{formatters:v,formatNumber:H0.bind(null,C,v.getNumberFormat),formatNumberToParts:$0.bind(null,C,v.getNumberFormat),formatRelativeTime:U0.bind(null,C,v.getRelativeTimeFormat),formatDate:C0.bind(null,C,v.getDateTimeFormat),formatDateToParts:A0.bind(null,C,v.getDateTimeFormat),formatTime:I0.bind(null,C,v.getDateTimeFormat),formatDateTimeRange:P0.bind(null,C,v.getDateTimeFormat),formatTimeToParts:M0.bind(null,C,v.getDateTimeFormat),formatPlural:B0.bind(null,C,v.getPluralRules),formatMessage:Sm.bind(null,C,v),$t:Sm.bind(null,C,v),formatList:F0.bind(null,C,v.getListFormat),formatListToParts:Xy.bind(null,C,v.getListFormat),formatDisplayName:R0.bind(null,C,v.getDisplayNames)})}function Yy(d){Py(d,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var Jy=kr(kr({},qy),{textComponent:qr.Fragment});function W0(d){return function(x){return d(qr.Children.toArray(x))}}function Em(d,x){if(d===x)return!0;if(!d||!x)return!1;var v=Object.keys(d),C=Object.keys(x),I=v.length;if(C.length!==I)return!1;for(var z=0;z<I;z++){var E=v[z];if(d[E]!==x[E]||!Object.prototype.hasOwnProperty.call(x,E))return!1}return!0}var em={exports:{}},Un={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function X0(){if(zg)return Un;zg=1;var d=typeof Symbol=="function"&&Symbol.for,x=d?Symbol.for("react.element"):60103,v=d?Symbol.for("react.portal"):60106,C=d?Symbol.for("react.fragment"):60107,I=d?Symbol.for("react.strict_mode"):60108,z=d?Symbol.for("react.profiler"):60114,E=d?Symbol.for("react.provider"):60109,u=d?Symbol.for("react.context"):60110,B=d?Symbol.for("react.async_mode"):60111,U=d?Symbol.for("react.concurrent_mode"):60111,K=d?Symbol.for("react.forward_ref"):60112,j=d?Symbol.for("react.suspense"):60113,N=d?Symbol.for("react.suspense_list"):60120,q=d?Symbol.for("react.memo"):60115,se=d?Symbol.for("react.lazy"):60116,J=d?Symbol.for("react.block"):60121,ae=d?Symbol.for("react.fundamental"):60117,re=d?Symbol.for("react.responder"):60118,pe=d?Symbol.for("react.scope"):60119;function ge(ve){if(typeof ve=="object"&&ve!==null){var qe=ve.$$typeof;switch(qe){case x:switch(ve=ve.type,ve){case B:case U:case C:case z:case I:case j:return ve;default:switch(ve=ve&&ve.$$typeof,ve){case u:case K:case se:case q:case E:return ve;default:return qe}}case v:return qe}}}function Fe(ve){return ge(ve)===U}return Un.AsyncMode=B,Un.ConcurrentMode=U,Un.ContextConsumer=u,Un.ContextProvider=E,Un.Element=x,Un.ForwardRef=K,Un.Fragment=C,Un.Lazy=se,Un.Memo=q,Un.Portal=v,Un.Profiler=z,Un.StrictMode=I,Un.Suspense=j,Un.isAsyncMode=function(ve){return Fe(ve)||ge(ve)===B},Un.isConcurrentMode=Fe,Un.isContextConsumer=function(ve){return ge(ve)===u},Un.isContextProvider=function(ve){return ge(ve)===E},Un.isElement=function(ve){return typeof ve=="object"&&ve!==null&&ve.$$typeof===x},Un.isForwardRef=function(ve){return ge(ve)===K},Un.isFragment=function(ve){return ge(ve)===C},Un.isLazy=function(ve){return ge(ve)===se},Un.isMemo=function(ve){return ge(ve)===q},Un.isPortal=function(ve){return ge(ve)===v},Un.isProfiler=function(ve){return ge(ve)===z},Un.isStrictMode=function(ve){return ge(ve)===I},Un.isSuspense=function(ve){return ge(ve)===j},Un.isValidElementType=function(ve){return typeof ve=="string"||typeof ve=="function"||ve===C||ve===U||ve===z||ve===I||ve===j||ve===N||typeof ve=="object"&&ve!==null&&(ve.$$typeof===se||ve.$$typeof===q||ve.$$typeof===E||ve.$$typeof===u||ve.$$typeof===K||ve.$$typeof===ae||ve.$$typeof===re||ve.$$typeof===pe||ve.$$typeof===J)},Un.typeOf=ge,Un}var Rg;function K0(){return Rg||(Rg=1,em.exports=X0()),em.exports}var tm,Dg;function Y0(){if(Dg)return tm;Dg=1;var d=K0(),x={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},v={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},C={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},I={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},z={};z[d.ForwardRef]=C,z[d.Memo]=I;function E(se){return d.isMemo(se)?I:z[se.$$typeof]||x}var u=Object.defineProperty,B=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,K=Object.getOwnPropertyDescriptor,j=Object.getPrototypeOf,N=Object.prototype;function q(se,J,ae){if(typeof J!="string"){if(N){var re=j(J);re&&re!==N&&q(se,re,ae)}var pe=B(J);U&&(pe=pe.concat(U(J)));for(var ge=E(se),Fe=E(J),ve=0;ve<pe.length;++ve){var qe=pe[ve];if(!v[qe]&&!(ae&&ae[qe])&&!(Fe&&Fe[qe])&&!(ge&&ge[qe])){var je=K(J,qe);try{u(se,qe,je)}catch{}}}}return se}return tm=q,tm}Y0();var Fm=typeof window<"u"&&!window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=qr.createContext(null)):qr.createContext(null);Fm.Consumer;var J0=Fm.Provider,Q0=J0,ex=Fm;function fp(){var d=qr.useContext(ex);return Yy(d),d}var Tm;(function(d){d.formatDate="FormattedDate",d.formatTime="FormattedTime",d.formatNumber="FormattedNumber",d.formatList="FormattedList",d.formatDisplayName="FormattedDisplayName"})(Tm||(Tm={}));var km;(function(d){d.formatDate="FormattedDateParts",d.formatTime="FormattedTimeParts",d.formatNumber="FormattedNumberParts",d.formatList="FormattedListParts"})(km||(km={}));function Qy(d){var x=function(v){var C=fp(),I=v.value,z=v.children,E=td(v,["value","children"]),u=typeof I=="string"?new Date(I||0):I,B=d==="formatDate"?C.formatDateToParts(u,E):C.formatTimeToParts(u,E);return z(B)};return x.displayName=km[d],x}function Wd(d){var x=function(v){var C=fp(),I=v.value,z=v.children,E=td(v,["value","children"]),u=C[d](I,E);if(typeof z=="function")return z(u);var B=C.textComponent||qr.Fragment;return qr.createElement(B,null,u)};return x.displayName=Tm[d],x}function e_(d){return d&&Object.keys(d).reduce(function(x,v){var C=d[v];return x[v]=$y(C)?W0(C):C,x},{})}var Lg=function(d,x,v,C){for(var I=[],z=4;z<arguments.length;z++)I[z-4]=arguments[z];var E=e_(C),u=Sm.apply(void 0,Mo([d,x,v,E],I,!1));return Array.isArray(u)?qr.Children.toArray(u):u},Fg=function(d,x){var v=d.defaultRichTextElements,C=td(d,["defaultRichTextElements"]),I=e_(v),z=Z0(kr(kr(kr({},Jy),C),{defaultRichTextElements:I}),x),E={locale:z.locale,timeZone:z.timeZone,fallbackOnEmptyString:z.fallbackOnEmptyString,formats:z.formats,defaultLocale:z.defaultLocale,defaultFormats:z.defaultFormats,messages:z.messages,onError:z.onError,defaultRichTextElements:I};return kr(kr({},z),{formatMessage:Lg.bind(null,E,z.formatters),$t:Lg.bind(null,E,z.formatters)})};function rm(d){return{locale:d.locale,timeZone:d.timeZone,fallbackOnEmptyString:d.fallbackOnEmptyString,formats:d.formats,textComponent:d.textComponent,messages:d.messages,defaultLocale:d.defaultLocale,defaultFormats:d.defaultFormats,onError:d.onError,onWarn:d.onWarn,wrapRichTextChunksInFragment:d.wrapRichTextChunksInFragment,defaultRichTextElements:d.defaultRichTextElements}}var tx=function(d){Va(x,d);function x(){var v=d!==null&&d.apply(this,arguments)||this;return v.cache=Zy(),v.state={cache:v.cache,intl:Fg(rm(v.props),v.cache),prevConfig:rm(v.props)},v}return x.getDerivedStateFromProps=function(v,C){var I=C.prevConfig,z=C.cache,E=rm(v);return Em(I,E)?null:{intl:Fg(E,z),prevConfig:E}},x.prototype.render=function(){return Yy(this.state.intl),qr.createElement(Q0,{value:this.state.intl},this.props.children)},x.displayName="IntlProvider",x.defaultProps=Jy,x}(qr.PureComponent);function rx(d,x){var v=d.values,C=td(d,["values"]),I=x.values,z=td(x,["values"]);return Em(I,v)&&Em(C,z)}function t_(d){var x=fp(),v=x.formatMessage,C=x.textComponent,I=C===void 0?qr.Fragment:C,z=d.id,E=d.description,u=d.defaultMessage,B=d.values,U=d.children,K=d.tagName,j=K===void 0?I:K,N=d.ignoreTag,q={id:z,description:E,defaultMessage:u},se=v(q,B,{ignoreTag:N});return typeof U=="function"?U(Array.isArray(se)?se:[se]):j?qr.createElement(j,null,qr.Children.toArray(se)):qr.createElement(qr.Fragment,null,se)}t_.displayName="FormattedMessage";var Yi=qr.memo(t_,rx);Yi.displayName="MemoizedFormattedMessage";Wd("formatDate");Wd("formatTime");Wd("formatNumber");Wd("formatList");Wd("formatDisplayName");Qy("formatDate");Qy("formatTime");function Zf(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nm={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var Og;function nx(){return Og||(Og=1,function(d,x){(function(v){d.exports=v()})(function(){return function v(C,I,z){function E(U,K){if(!I[U]){if(!C[U]){var j=typeof Zf=="function"&&Zf;if(!K&&j)return j(U,!0);if(u)return u(U,!0);var N=new Error("Cannot find module '"+U+"'");throw N.code="MODULE_NOT_FOUND",N}var q=I[U]={exports:{}};C[U][0].call(q.exports,function(se){var J=C[U][1][se];return E(J||se)},q,q.exports,v,C,I,z)}return I[U].exports}for(var u=typeof Zf=="function"&&Zf,B=0;B<z.length;B++)E(z[B]);return E}({1:[function(v,C,I){var z=v("./utils"),E=v("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";I.encode=function(B){for(var U,K,j,N,q,se,J,ae=[],re=0,pe=B.length,ge=pe,Fe=z.getTypeOf(B)!=="string";re<B.length;)ge=pe-re,j=Fe?(U=B[re++],K=re<pe?B[re++]:0,re<pe?B[re++]:0):(U=B.charCodeAt(re++),K=re<pe?B.charCodeAt(re++):0,re<pe?B.charCodeAt(re++):0),N=U>>2,q=(3&U)<<4|K>>4,se=1<ge?(15&K)<<2|j>>6:64,J=2<ge?63&j:64,ae.push(u.charAt(N)+u.charAt(q)+u.charAt(se)+u.charAt(J));return ae.join("")},I.decode=function(B){var U,K,j,N,q,se,J=0,ae=0,re="data:";if(B.substr(0,re.length)===re)throw new Error("Invalid base64 input, it looks like a data url.");var pe,ge=3*(B=B.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(B.charAt(B.length-1)===u.charAt(64)&&ge--,B.charAt(B.length-2)===u.charAt(64)&&ge--,ge%1!=0)throw new Error("Invalid base64 input, bad content length.");for(pe=E.uint8array?new Uint8Array(0|ge):new Array(0|ge);J<B.length;)U=u.indexOf(B.charAt(J++))<<2|(N=u.indexOf(B.charAt(J++)))>>4,K=(15&N)<<4|(q=u.indexOf(B.charAt(J++)))>>2,j=(3&q)<<6|(se=u.indexOf(B.charAt(J++))),pe[ae++]=U,q!==64&&(pe[ae++]=K),se!==64&&(pe[ae++]=j);return pe}},{"./support":30,"./utils":32}],2:[function(v,C,I){var z=v("./external"),E=v("./stream/DataWorker"),u=v("./stream/Crc32Probe"),B=v("./stream/DataLengthProbe");function U(K,j,N,q,se){this.compressedSize=K,this.uncompressedSize=j,this.crc32=N,this.compression=q,this.compressedContent=se}U.prototype={getContentWorker:function(){var K=new E(z.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new B("data_length")),j=this;return K.on("end",function(){if(this.streamInfo.data_length!==j.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),K},getCompressedWorker:function(){return new E(z.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},U.createWorkerFrom=function(K,j,N){return K.pipe(new u).pipe(new B("uncompressedSize")).pipe(j.compressWorker(N)).pipe(new B("compressedSize")).withStreamInfo("compression",j)},C.exports=U},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(v,C,I){var z=v("./stream/GenericWorker");I.STORE={magic:"\0\0",compressWorker:function(){return new z("STORE compression")},uncompressWorker:function(){return new z("STORE decompression")}},I.DEFLATE=v("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(v,C,I){var z=v("./utils"),E=function(){for(var u,B=[],U=0;U<256;U++){u=U;for(var K=0;K<8;K++)u=1&u?3988292384^u>>>1:u>>>1;B[U]=u}return B}();C.exports=function(u,B){return u!==void 0&&u.length?z.getTypeOf(u)!=="string"?function(U,K,j,N){var q=E,se=N+j;U^=-1;for(var J=N;J<se;J++)U=U>>>8^q[255&(U^K[J])];return-1^U}(0|B,u,u.length,0):function(U,K,j,N){var q=E,se=N+j;U^=-1;for(var J=N;J<se;J++)U=U>>>8^q[255&(U^K.charCodeAt(J))];return-1^U}(0|B,u,u.length,0):0}},{"./utils":32}],5:[function(v,C,I){I.base64=!1,I.binary=!1,I.dir=!1,I.createFolders=!0,I.date=null,I.compression=null,I.compressionOptions=null,I.comment=null,I.unixPermissions=null,I.dosPermissions=null},{}],6:[function(v,C,I){var z=null;z=typeof Promise<"u"?Promise:v("lie"),C.exports={Promise:z}},{lie:37}],7:[function(v,C,I){var z=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",E=v("pako"),u=v("./utils"),B=v("./stream/GenericWorker"),U=z?"uint8array":"array";function K(j,N){B.call(this,"FlateWorker/"+j),this._pako=null,this._pakoAction=j,this._pakoOptions=N,this.meta={}}I.magic="\b\0",u.inherits(K,B),K.prototype.processChunk=function(j){this.meta=j.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(U,j.data),!1)},K.prototype.flush=function(){B.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},K.prototype.cleanUp=function(){B.prototype.cleanUp.call(this),this._pako=null},K.prototype._createPako=function(){this._pako=new E[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var j=this;this._pako.onData=function(N){j.push({data:N,meta:j.meta})}},I.compressWorker=function(j){return new K("Deflate",j)},I.uncompressWorker=function(){return new K("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(v,C,I){function z(q,se){var J,ae="";for(J=0;J<se;J++)ae+=String.fromCharCode(255&q),q>>>=8;return ae}function E(q,se,J,ae,re,pe){var ge,Fe,ve=q.file,qe=q.compression,je=pe!==U.utf8encode,St=u.transformTo("string",pe(ve.name)),ot=u.transformTo("string",U.utf8encode(ve.name)),At=ve.comment,xt=u.transformTo("string",pe(At)),xe=u.transformTo("string",U.utf8encode(At)),Je=ot.length!==ve.name.length,G=xe.length!==At.length,Ve="",Rt="",Ae="",et=ve.dir,Ze=ve.date,ht={crc32:0,compressedSize:0,uncompressedSize:0};se&&!J||(ht.crc32=q.crc32,ht.compressedSize=q.compressedSize,ht.uncompressedSize=q.uncompressedSize);var oe=0;se&&(oe|=8),je||!Je&&!G||(oe|=2048);var _e=0,Ct=0;et&&(_e|=16),re==="UNIX"?(Ct=798,_e|=function(wt,ar){var fr=wt;return wt||(fr=ar?16893:33204),(65535&fr)<<16}(ve.unixPermissions,et)):(Ct=20,_e|=function(wt){return 63&(wt||0)}(ve.dosPermissions)),ge=Ze.getUTCHours(),ge<<=6,ge|=Ze.getUTCMinutes(),ge<<=5,ge|=Ze.getUTCSeconds()/2,Fe=Ze.getUTCFullYear()-1980,Fe<<=4,Fe|=Ze.getUTCMonth()+1,Fe<<=5,Fe|=Ze.getUTCDate(),Je&&(Rt=z(1,1)+z(K(St),4)+ot,Ve+="up"+z(Rt.length,2)+Rt),G&&(Ae=z(1,1)+z(K(xt),4)+xe,Ve+="uc"+z(Ae.length,2)+Ae);var bt="";return bt+=`
\0`,bt+=z(oe,2),bt+=qe.magic,bt+=z(ge,2),bt+=z(Fe,2),bt+=z(ht.crc32,4),bt+=z(ht.compressedSize,4),bt+=z(ht.uncompressedSize,4),bt+=z(St.length,2),bt+=z(Ve.length,2),{fileRecord:j.LOCAL_FILE_HEADER+bt+St+Ve,dirRecord:j.CENTRAL_FILE_HEADER+z(Ct,2)+bt+z(xt.length,2)+"\0\0\0\0"+z(_e,4)+z(ae,4)+St+Ve+xt}}var u=v("../utils"),B=v("../stream/GenericWorker"),U=v("../utf8"),K=v("../crc32"),j=v("../signature");function N(q,se,J,ae){B.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=se,this.zipPlatform=J,this.encodeFileName=ae,this.streamFiles=q,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(N,B),N.prototype.push=function(q){var se=q.meta.percent||0,J=this.entriesCount,ae=this._sources.length;this.accumulate?this.contentBuffer.push(q):(this.bytesWritten+=q.data.length,B.prototype.push.call(this,{data:q.data,meta:{currentFile:this.currentFile,percent:J?(se+100*(J-ae-1))/J:100}}))},N.prototype.openedSource=function(q){this.currentSourceOffset=this.bytesWritten,this.currentFile=q.file.name;var se=this.streamFiles&&!q.file.dir;if(se){var J=E(q,se,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:J.fileRecord,meta:{percent:0}})}else this.accumulate=!0},N.prototype.closedSource=function(q){this.accumulate=!1;var se=this.streamFiles&&!q.file.dir,J=E(q,se,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(J.dirRecord),se)this.push({data:function(ae){return j.DATA_DESCRIPTOR+z(ae.crc32,4)+z(ae.compressedSize,4)+z(ae.uncompressedSize,4)}(q),meta:{percent:100}});else for(this.push({data:J.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},N.prototype.flush=function(){for(var q=this.bytesWritten,se=0;se<this.dirRecords.length;se++)this.push({data:this.dirRecords[se],meta:{percent:100}});var J=this.bytesWritten-q,ae=function(re,pe,ge,Fe,ve){var qe=u.transformTo("string",ve(Fe));return j.CENTRAL_DIRECTORY_END+"\0\0\0\0"+z(re,2)+z(re,2)+z(pe,4)+z(ge,4)+z(qe.length,2)+qe}(this.dirRecords.length,J,q,this.zipComment,this.encodeFileName);this.push({data:ae,meta:{percent:100}})},N.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},N.prototype.registerPrevious=function(q){this._sources.push(q);var se=this;return q.on("data",function(J){se.processChunk(J)}),q.on("end",function(){se.closedSource(se.previous.streamInfo),se._sources.length?se.prepareNextSource():se.end()}),q.on("error",function(J){se.error(J)}),this},N.prototype.resume=function(){return!!B.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},N.prototype.error=function(q){var se=this._sources;if(!B.prototype.error.call(this,q))return!1;for(var J=0;J<se.length;J++)try{se[J].error(q)}catch{}return!0},N.prototype.lock=function(){B.prototype.lock.call(this);for(var q=this._sources,se=0;se<q.length;se++)q[se].lock()},C.exports=N},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(v,C,I){var z=v("../compressions"),E=v("./ZipFileWorker");I.generateWorker=function(u,B,U){var K=new E(B.streamFiles,U,B.platform,B.encodeFileName),j=0;try{u.forEach(function(N,q){j++;var se=function(pe,ge){var Fe=pe||ge,ve=z[Fe];if(!ve)throw new Error(Fe+" is not a valid compression method !");return ve}(q.options.compression,B.compression),J=q.options.compressionOptions||B.compressionOptions||{},ae=q.dir,re=q.date;q._compressWorker(se,J).withStreamInfo("file",{name:N,dir:ae,date:re,comment:q.comment||"",unixPermissions:q.unixPermissions,dosPermissions:q.dosPermissions}).pipe(K)}),K.entriesCount=j}catch(N){K.error(N)}return K}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(v,C,I){function z(){if(!(this instanceof z))return new z;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var E=new z;for(var u in this)typeof this[u]!="function"&&(E[u]=this[u]);return E}}(z.prototype=v("./object")).loadAsync=v("./load"),z.support=v("./support"),z.defaults=v("./defaults"),z.version="3.10.1",z.loadAsync=function(E,u){return new z().loadAsync(E,u)},z.external=v("./external"),C.exports=z},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(v,C,I){var z=v("./utils"),E=v("./external"),u=v("./utf8"),B=v("./zipEntries"),U=v("./stream/Crc32Probe"),K=v("./nodejsUtils");function j(N){return new E.Promise(function(q,se){var J=N.decompressed.getContentWorker().pipe(new U);J.on("error",function(ae){se(ae)}).on("end",function(){J.streamInfo.crc32!==N.decompressed.crc32?se(new Error("Corrupted zip : CRC32 mismatch")):q()}).resume()})}C.exports=function(N,q){var se=this;return q=z.extend(q||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),K.isNode&&K.isStream(N)?E.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):z.prepareContent("the loaded zip file",N,!0,q.optimizedBinaryString,q.base64).then(function(J){var ae=new B(q);return ae.load(J),ae}).then(function(J){var ae=[E.Promise.resolve(J)],re=J.files;if(q.checkCRC32)for(var pe=0;pe<re.length;pe++)ae.push(j(re[pe]));return E.Promise.all(ae)}).then(function(J){for(var ae=J.shift(),re=ae.files,pe=0;pe<re.length;pe++){var ge=re[pe],Fe=ge.fileNameStr,ve=z.resolve(ge.fileNameStr);se.file(ve,ge.decompressed,{binary:!0,optimizedBinaryString:!0,date:ge.date,dir:ge.dir,comment:ge.fileCommentStr.length?ge.fileCommentStr:null,unixPermissions:ge.unixPermissions,dosPermissions:ge.dosPermissions,createFolders:q.createFolders}),ge.dir||(se.file(ve).unsafeOriginalName=Fe)}return ae.zipComment.length&&(se.comment=ae.zipComment),se})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(v,C,I){var z=v("../utils"),E=v("../stream/GenericWorker");function u(B,U){E.call(this,"Nodejs stream input adapter for "+B),this._upstreamEnded=!1,this._bindStream(U)}z.inherits(u,E),u.prototype._bindStream=function(B){var U=this;(this._stream=B).pause(),B.on("data",function(K){U.push({data:K,meta:{percent:0}})}).on("error",function(K){U.isPaused?this.generatedError=K:U.error(K)}).on("end",function(){U.isPaused?U._upstreamEnded=!0:U.end()})},u.prototype.pause=function(){return!!E.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},C.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(v,C,I){var z=v("readable-stream").Readable;function E(u,B,U){z.call(this,B),this._helper=u;var K=this;u.on("data",function(j,N){K.push(j)||K._helper.pause(),U&&U(N)}).on("error",function(j){K.emit("error",j)}).on("end",function(){K.push(null)})}v("../utils").inherits(E,z),E.prototype._read=function(){this._helper.resume()},C.exports=E},{"../utils":32,"readable-stream":16}],14:[function(v,C,I){C.exports={isNode:typeof Buffer<"u",newBufferFrom:function(z,E){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(z,E);if(typeof z=="number")throw new Error('The "data" argument must not be a number');return new Buffer(z,E)},allocBuffer:function(z){if(Buffer.alloc)return Buffer.alloc(z);var E=new Buffer(z);return E.fill(0),E},isBuffer:function(z){return Buffer.isBuffer(z)},isStream:function(z){return z&&typeof z.on=="function"&&typeof z.pause=="function"&&typeof z.resume=="function"}}},{}],15:[function(v,C,I){function z(ve,qe,je){var St,ot=u.getTypeOf(qe),At=u.extend(je||{},K);At.date=At.date||new Date,At.compression!==null&&(At.compression=At.compression.toUpperCase()),typeof At.unixPermissions=="string"&&(At.unixPermissions=parseInt(At.unixPermissions,8)),At.unixPermissions&&16384&At.unixPermissions&&(At.dir=!0),At.dosPermissions&&16&At.dosPermissions&&(At.dir=!0),At.dir&&(ve=re(ve)),At.createFolders&&(St=ae(ve))&&pe.call(this,St,!0);var xt=ot==="string"&&At.binary===!1&&At.base64===!1;je&&je.binary!==void 0||(At.binary=!xt),(qe instanceof j&&qe.uncompressedSize===0||At.dir||!qe||qe.length===0)&&(At.base64=!1,At.binary=!0,qe="",At.compression="STORE",ot="string");var xe=null;xe=qe instanceof j||qe instanceof B?qe:se.isNode&&se.isStream(qe)?new J(ve,qe):u.prepareContent(ve,qe,At.binary,At.optimizedBinaryString,At.base64);var Je=new N(ve,xe,At);this.files[ve]=Je}var E=v("./utf8"),u=v("./utils"),B=v("./stream/GenericWorker"),U=v("./stream/StreamHelper"),K=v("./defaults"),j=v("./compressedObject"),N=v("./zipObject"),q=v("./generate"),se=v("./nodejsUtils"),J=v("./nodejs/NodejsStreamInputAdapter"),ae=function(ve){ve.slice(-1)==="/"&&(ve=ve.substring(0,ve.length-1));var qe=ve.lastIndexOf("/");return 0<qe?ve.substring(0,qe):""},re=function(ve){return ve.slice(-1)!=="/"&&(ve+="/"),ve},pe=function(ve,qe){return qe=qe!==void 0?qe:K.createFolders,ve=re(ve),this.files[ve]||z.call(this,ve,null,{dir:!0,createFolders:qe}),this.files[ve]};function ge(ve){return Object.prototype.toString.call(ve)==="[object RegExp]"}var Fe={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(ve){var qe,je,St;for(qe in this.files)St=this.files[qe],(je=qe.slice(this.root.length,qe.length))&&qe.slice(0,this.root.length)===this.root&&ve(je,St)},filter:function(ve){var qe=[];return this.forEach(function(je,St){ve(je,St)&&qe.push(St)}),qe},file:function(ve,qe,je){if(arguments.length!==1)return ve=this.root+ve,z.call(this,ve,qe,je),this;if(ge(ve)){var St=ve;return this.filter(function(At,xt){return!xt.dir&&St.test(At)})}var ot=this.files[this.root+ve];return ot&&!ot.dir?ot:null},folder:function(ve){if(!ve)return this;if(ge(ve))return this.filter(function(ot,At){return At.dir&&ve.test(ot)});var qe=this.root+ve,je=pe.call(this,qe),St=this.clone();return St.root=je.name,St},remove:function(ve){ve=this.root+ve;var qe=this.files[ve];if(qe||(ve.slice(-1)!=="/"&&(ve+="/"),qe=this.files[ve]),qe&&!qe.dir)delete this.files[ve];else for(var je=this.filter(function(ot,At){return At.name.slice(0,ve.length)===ve}),St=0;St<je.length;St++)delete this.files[je[St].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(ve){var qe,je={};try{if((je=u.extend(ve||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:E.utf8encode})).type=je.type.toLowerCase(),je.compression=je.compression.toUpperCase(),je.type==="binarystring"&&(je.type="string"),!je.type)throw new Error("No output type specified.");u.checkSupport(je.type),je.platform!=="darwin"&&je.platform!=="freebsd"&&je.platform!=="linux"&&je.platform!=="sunos"||(je.platform="UNIX"),je.platform==="win32"&&(je.platform="DOS");var St=je.comment||this.comment||"";qe=q.generateWorker(this,je,St)}catch(ot){(qe=new B("error")).error(ot)}return new U(qe,je.type||"string",je.mimeType)},generateAsync:function(ve,qe){return this.generateInternalStream(ve).accumulate(qe)},generateNodeStream:function(ve,qe){return(ve=ve||{}).type||(ve.type="nodebuffer"),this.generateInternalStream(ve).toNodejsStream(qe)}};C.exports=Fe},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(v,C,I){C.exports=v("stream")},{stream:void 0}],17:[function(v,C,I){var z=v("./DataReader");function E(u){z.call(this,u);for(var B=0;B<this.data.length;B++)u[B]=255&u[B]}v("../utils").inherits(E,z),E.prototype.byteAt=function(u){return this.data[this.zero+u]},E.prototype.lastIndexOfSignature=function(u){for(var B=u.charCodeAt(0),U=u.charCodeAt(1),K=u.charCodeAt(2),j=u.charCodeAt(3),N=this.length-4;0<=N;--N)if(this.data[N]===B&&this.data[N+1]===U&&this.data[N+2]===K&&this.data[N+3]===j)return N-this.zero;return-1},E.prototype.readAndCheckSignature=function(u){var B=u.charCodeAt(0),U=u.charCodeAt(1),K=u.charCodeAt(2),j=u.charCodeAt(3),N=this.readData(4);return B===N[0]&&U===N[1]&&K===N[2]&&j===N[3]},E.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var B=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,B},C.exports=E},{"../utils":32,"./DataReader":18}],18:[function(v,C,I){var z=v("../utils");function E(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}E.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var B,U=0;for(this.checkOffset(u),B=this.index+u-1;B>=this.index;B--)U=(U<<8)+this.byteAt(B);return this.index+=u,U},readString:function(u){return z.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},C.exports=E},{"../utils":32}],19:[function(v,C,I){var z=v("./Uint8ArrayReader");function E(u){z.call(this,u)}v("../utils").inherits(E,z),E.prototype.readData=function(u){this.checkOffset(u);var B=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,B},C.exports=E},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(v,C,I){var z=v("./DataReader");function E(u){z.call(this,u)}v("../utils").inherits(E,z),E.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},E.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},E.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},E.prototype.readData=function(u){this.checkOffset(u);var B=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,B},C.exports=E},{"../utils":32,"./DataReader":18}],21:[function(v,C,I){var z=v("./ArrayReader");function E(u){z.call(this,u)}v("../utils").inherits(E,z),E.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var B=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,B},C.exports=E},{"../utils":32,"./ArrayReader":17}],22:[function(v,C,I){var z=v("../utils"),E=v("../support"),u=v("./ArrayReader"),B=v("./StringReader"),U=v("./NodeBufferReader"),K=v("./Uint8ArrayReader");C.exports=function(j){var N=z.getTypeOf(j);return z.checkSupport(N),N!=="string"||E.uint8array?N==="nodebuffer"?new U(j):E.uint8array?new K(z.transformTo("uint8array",j)):new u(z.transformTo("array",j)):new B(j)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(v,C,I){I.LOCAL_FILE_HEADER="PK",I.CENTRAL_FILE_HEADER="PK",I.CENTRAL_DIRECTORY_END="PK",I.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",I.ZIP64_CENTRAL_DIRECTORY_END="PK",I.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(v,C,I){var z=v("./GenericWorker"),E=v("../utils");function u(B){z.call(this,"ConvertWorker to "+B),this.destType=B}E.inherits(u,z),u.prototype.processChunk=function(B){this.push({data:E.transformTo(this.destType,B.data),meta:B.meta})},C.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(v,C,I){var z=v("./GenericWorker"),E=v("../crc32");function u(){z.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}v("../utils").inherits(u,z),u.prototype.processChunk=function(B){this.streamInfo.crc32=E(B.data,this.streamInfo.crc32||0),this.push(B)},C.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(v,C,I){var z=v("../utils"),E=v("./GenericWorker");function u(B){E.call(this,"DataLengthProbe for "+B),this.propName=B,this.withStreamInfo(B,0)}z.inherits(u,E),u.prototype.processChunk=function(B){if(B){var U=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=U+B.data.length}E.prototype.processChunk.call(this,B)},C.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(v,C,I){var z=v("../utils"),E=v("./GenericWorker");function u(B){E.call(this,"DataWorker");var U=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,B.then(function(K){U.dataIsReady=!0,U.data=K,U.max=K&&K.length||0,U.type=z.getTypeOf(K),U.isPaused||U._tickAndRepeat()},function(K){U.error(K)})}z.inherits(u,E),u.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,z.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(z.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var B=null,U=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":B=this.data.substring(this.index,U);break;case"uint8array":B=this.data.subarray(this.index,U);break;case"array":case"nodebuffer":B=this.data.slice(this.index,U)}return this.index=U,this.push({data:B,meta:{percent:this.max?this.index/this.max*100:0}})},C.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(v,C,I){function z(E){this.name=E||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}z.prototype={push:function(E){this.emit("data",E)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(E){this.emit("error",E)}return!0},error:function(E){return!this.isFinished&&(this.isPaused?this.generatedError=E:(this.isFinished=!0,this.emit("error",E),this.previous&&this.previous.error(E),this.cleanUp()),!0)},on:function(E,u){return this._listeners[E].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(E,u){if(this._listeners[E])for(var B=0;B<this._listeners[E].length;B++)this._listeners[E][B].call(this,u)},pipe:function(E){return E.registerPrevious(this)},registerPrevious:function(E){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=E.streamInfo,this.mergeStreamInfo(),this.previous=E;var u=this;return E.on("data",function(B){u.processChunk(B)}),E.on("end",function(){u.end()}),E.on("error",function(B){u.error(B)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var E=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),E=!0),this.previous&&this.previous.resume(),!E},flush:function(){},processChunk:function(E){this.push(E)},withStreamInfo:function(E,u){return this.extraStreamInfo[E]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var E in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,E)&&(this.streamInfo[E]=this.extraStreamInfo[E])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var E="Worker "+this.name;return this.previous?this.previous+" -> "+E:E}},C.exports=z},{}],29:[function(v,C,I){var z=v("../utils"),E=v("./ConvertWorker"),u=v("./GenericWorker"),B=v("../base64"),U=v("../support"),K=v("../external"),j=null;if(U.nodestream)try{j=v("../nodejs/NodejsStreamOutputAdapter")}catch{}function N(se,J){return new K.Promise(function(ae,re){var pe=[],ge=se._internalType,Fe=se._outputType,ve=se._mimeType;se.on("data",function(qe,je){pe.push(qe),J&&J(je)}).on("error",function(qe){pe=[],re(qe)}).on("end",function(){try{var qe=function(je,St,ot){switch(je){case"blob":return z.newBlob(z.transformTo("arraybuffer",St),ot);case"base64":return B.encode(St);default:return z.transformTo(je,St)}}(Fe,function(je,St){var ot,At=0,xt=null,xe=0;for(ot=0;ot<St.length;ot++)xe+=St[ot].length;switch(je){case"string":return St.join("");case"array":return Array.prototype.concat.apply([],St);case"uint8array":for(xt=new Uint8Array(xe),ot=0;ot<St.length;ot++)xt.set(St[ot],At),At+=St[ot].length;return xt;case"nodebuffer":return Buffer.concat(St);default:throw new Error("concat : unsupported type '"+je+"'")}}(ge,pe),ve);ae(qe)}catch(je){re(je)}pe=[]}).resume()})}function q(se,J,ae){var re=J;switch(J){case"blob":case"arraybuffer":re="uint8array";break;case"base64":re="string"}try{this._internalType=re,this._outputType=J,this._mimeType=ae,z.checkSupport(re),this._worker=se.pipe(new E(re)),se.lock()}catch(pe){this._worker=new u("error"),this._worker.error(pe)}}q.prototype={accumulate:function(se){return N(this,se)},on:function(se,J){var ae=this;return se==="data"?this._worker.on(se,function(re){J.call(ae,re.data,re.meta)}):this._worker.on(se,function(){z.delay(J,arguments,ae)}),this},resume:function(){return z.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(se){if(z.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new j(this,{objectMode:this._outputType!=="nodebuffer"},se)}},C.exports=q},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(v,C,I){if(I.base64=!0,I.array=!0,I.string=!0,I.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",I.nodebuffer=typeof Buffer<"u",I.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")I.blob=!1;else{var z=new ArrayBuffer(0);try{I.blob=new Blob([z],{type:"application/zip"}).size===0}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);E.append(z),I.blob=E.getBlob("application/zip").size===0}catch{I.blob=!1}}}try{I.nodestream=!!v("readable-stream").Readable}catch{I.nodestream=!1}},{"readable-stream":16}],31:[function(v,C,I){for(var z=v("./utils"),E=v("./support"),u=v("./nodejsUtils"),B=v("./stream/GenericWorker"),U=new Array(256),K=0;K<256;K++)U[K]=252<=K?6:248<=K?5:240<=K?4:224<=K?3:192<=K?2:1;U[254]=U[254]=1;function j(){B.call(this,"utf-8 decode"),this.leftOver=null}function N(){B.call(this,"utf-8 encode")}I.utf8encode=function(q){return E.nodebuffer?u.newBufferFrom(q,"utf-8"):function(se){var J,ae,re,pe,ge,Fe=se.length,ve=0;for(pe=0;pe<Fe;pe++)(64512&(ae=se.charCodeAt(pe)))==55296&&pe+1<Fe&&(64512&(re=se.charCodeAt(pe+1)))==56320&&(ae=65536+(ae-55296<<10)+(re-56320),pe++),ve+=ae<128?1:ae<2048?2:ae<65536?3:4;for(J=E.uint8array?new Uint8Array(ve):new Array(ve),pe=ge=0;ge<ve;pe++)(64512&(ae=se.charCodeAt(pe)))==55296&&pe+1<Fe&&(64512&(re=se.charCodeAt(pe+1)))==56320&&(ae=65536+(ae-55296<<10)+(re-56320),pe++),ae<128?J[ge++]=ae:(ae<2048?J[ge++]=192|ae>>>6:(ae<65536?J[ge++]=224|ae>>>12:(J[ge++]=240|ae>>>18,J[ge++]=128|ae>>>12&63),J[ge++]=128|ae>>>6&63),J[ge++]=128|63&ae);return J}(q)},I.utf8decode=function(q){return E.nodebuffer?z.transformTo("nodebuffer",q).toString("utf-8"):function(se){var J,ae,re,pe,ge=se.length,Fe=new Array(2*ge);for(J=ae=0;J<ge;)if((re=se[J++])<128)Fe[ae++]=re;else if(4<(pe=U[re]))Fe[ae++]=65533,J+=pe-1;else{for(re&=pe===2?31:pe===3?15:7;1<pe&&J<ge;)re=re<<6|63&se[J++],pe--;1<pe?Fe[ae++]=65533:re<65536?Fe[ae++]=re:(re-=65536,Fe[ae++]=55296|re>>10&1023,Fe[ae++]=56320|1023&re)}return Fe.length!==ae&&(Fe.subarray?Fe=Fe.subarray(0,ae):Fe.length=ae),z.applyFromCharCode(Fe)}(q=z.transformTo(E.uint8array?"uint8array":"array",q))},z.inherits(j,B),j.prototype.processChunk=function(q){var se=z.transformTo(E.uint8array?"uint8array":"array",q.data);if(this.leftOver&&this.leftOver.length){if(E.uint8array){var J=se;(se=new Uint8Array(J.length+this.leftOver.length)).set(this.leftOver,0),se.set(J,this.leftOver.length)}else se=this.leftOver.concat(se);this.leftOver=null}var ae=function(pe,ge){var Fe;for((ge=ge||pe.length)>pe.length&&(ge=pe.length),Fe=ge-1;0<=Fe&&(192&pe[Fe])==128;)Fe--;return Fe<0||Fe===0?ge:Fe+U[pe[Fe]]>ge?Fe:ge}(se),re=se;ae!==se.length&&(E.uint8array?(re=se.subarray(0,ae),this.leftOver=se.subarray(ae,se.length)):(re=se.slice(0,ae),this.leftOver=se.slice(ae,se.length))),this.push({data:I.utf8decode(re),meta:q.meta})},j.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:I.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},I.Utf8DecodeWorker=j,z.inherits(N,B),N.prototype.processChunk=function(q){this.push({data:I.utf8encode(q.data),meta:q.meta})},I.Utf8EncodeWorker=N},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(v,C,I){var z=v("./support"),E=v("./base64"),u=v("./nodejsUtils"),B=v("./external");function U(J){return J}function K(J,ae){for(var re=0;re<J.length;++re)ae[re]=255&J.charCodeAt(re);return ae}v("setimmediate"),I.newBlob=function(J,ae){I.checkSupport("blob");try{return new Blob([J],{type:ae})}catch{try{var re=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return re.append(J),re.getBlob(ae)}catch{throw new Error("Bug : can't construct the Blob.")}}};var j={stringifyByChunk:function(J,ae,re){var pe=[],ge=0,Fe=J.length;if(Fe<=re)return String.fromCharCode.apply(null,J);for(;ge<Fe;)ae==="array"||ae==="nodebuffer"?pe.push(String.fromCharCode.apply(null,J.slice(ge,Math.min(ge+re,Fe)))):pe.push(String.fromCharCode.apply(null,J.subarray(ge,Math.min(ge+re,Fe)))),ge+=re;return pe.join("")},stringifyByChar:function(J){for(var ae="",re=0;re<J.length;re++)ae+=String.fromCharCode(J[re]);return ae},applyCanBeUsed:{uint8array:function(){try{return z.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return z.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}}()}};function N(J){var ae=65536,re=I.getTypeOf(J),pe=!0;if(re==="uint8array"?pe=j.applyCanBeUsed.uint8array:re==="nodebuffer"&&(pe=j.applyCanBeUsed.nodebuffer),pe)for(;1<ae;)try{return j.stringifyByChunk(J,re,ae)}catch{ae=Math.floor(ae/2)}return j.stringifyByChar(J)}function q(J,ae){for(var re=0;re<J.length;re++)ae[re]=J[re];return ae}I.applyFromCharCode=N;var se={};se.string={string:U,array:function(J){return K(J,new Array(J.length))},arraybuffer:function(J){return se.string.uint8array(J).buffer},uint8array:function(J){return K(J,new Uint8Array(J.length))},nodebuffer:function(J){return K(J,u.allocBuffer(J.length))}},se.array={string:N,array:U,arraybuffer:function(J){return new Uint8Array(J).buffer},uint8array:function(J){return new Uint8Array(J)},nodebuffer:function(J){return u.newBufferFrom(J)}},se.arraybuffer={string:function(J){return N(new Uint8Array(J))},array:function(J){return q(new Uint8Array(J),new Array(J.byteLength))},arraybuffer:U,uint8array:function(J){return new Uint8Array(J)},nodebuffer:function(J){return u.newBufferFrom(new Uint8Array(J))}},se.uint8array={string:N,array:function(J){return q(J,new Array(J.length))},arraybuffer:function(J){return J.buffer},uint8array:U,nodebuffer:function(J){return u.newBufferFrom(J)}},se.nodebuffer={string:N,array:function(J){return q(J,new Array(J.length))},arraybuffer:function(J){return se.nodebuffer.uint8array(J).buffer},uint8array:function(J){return q(J,new Uint8Array(J.length))},nodebuffer:U},I.transformTo=function(J,ae){if(ae=ae||"",!J)return ae;I.checkSupport(J);var re=I.getTypeOf(ae);return se[re][J](ae)},I.resolve=function(J){for(var ae=J.split("/"),re=[],pe=0;pe<ae.length;pe++){var ge=ae[pe];ge==="."||ge===""&&pe!==0&&pe!==ae.length-1||(ge===".."?re.pop():re.push(ge))}return re.join("/")},I.getTypeOf=function(J){return typeof J=="string"?"string":Object.prototype.toString.call(J)==="[object Array]"?"array":z.nodebuffer&&u.isBuffer(J)?"nodebuffer":z.uint8array&&J instanceof Uint8Array?"uint8array":z.arraybuffer&&J instanceof ArrayBuffer?"arraybuffer":void 0},I.checkSupport=function(J){if(!z[J.toLowerCase()])throw new Error(J+" is not supported by this platform")},I.MAX_VALUE_16BITS=65535,I.MAX_VALUE_32BITS=-1,I.pretty=function(J){var ae,re,pe="";for(re=0;re<(J||"").length;re++)pe+="\\x"+((ae=J.charCodeAt(re))<16?"0":"")+ae.toString(16).toUpperCase();return pe},I.delay=function(J,ae,re){setImmediate(function(){J.apply(re||null,ae||[])})},I.inherits=function(J,ae){function re(){}re.prototype=ae.prototype,J.prototype=new re},I.extend=function(){var J,ae,re={};for(J=0;J<arguments.length;J++)for(ae in arguments[J])Object.prototype.hasOwnProperty.call(arguments[J],ae)&&re[ae]===void 0&&(re[ae]=arguments[J][ae]);return re},I.prepareContent=function(J,ae,re,pe,ge){return B.Promise.resolve(ae).then(function(Fe){return z.blob&&(Fe instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Fe))!==-1)&&typeof FileReader<"u"?new B.Promise(function(ve,qe){var je=new FileReader;je.onload=function(St){ve(St.target.result)},je.onerror=function(St){qe(St.target.error)},je.readAsArrayBuffer(Fe)}):Fe}).then(function(Fe){var ve=I.getTypeOf(Fe);return ve?(ve==="arraybuffer"?Fe=I.transformTo("uint8array",Fe):ve==="string"&&(ge?Fe=E.decode(Fe):re&&pe!==!0&&(Fe=function(qe){return K(qe,z.uint8array?new Uint8Array(qe.length):new Array(qe.length))}(Fe))),Fe):B.Promise.reject(new Error("Can't read the data of '"+J+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(v,C,I){var z=v("./reader/readerFor"),E=v("./utils"),u=v("./signature"),B=v("./zipEntry"),U=v("./support");function K(j){this.files=[],this.loadOptions=j}K.prototype={checkSignature:function(j){if(!this.reader.readAndCheckSignature(j)){this.reader.index-=4;var N=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+E.pretty(N)+", expected "+E.pretty(j)+")")}},isSignature:function(j,N){var q=this.reader.index;this.reader.setIndex(j);var se=this.reader.readString(4)===N;return this.reader.setIndex(q),se},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var j=this.reader.readData(this.zipCommentLength),N=U.uint8array?"uint8array":"array",q=E.transformTo(N,j);this.zipComment=this.loadOptions.decodeFileName(q)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var j,N,q,se=this.zip64EndOfCentralSize-44;0<se;)j=this.reader.readInt(2),N=this.reader.readInt(4),q=this.reader.readData(N),this.zip64ExtensibleData[j]={id:j,length:N,value:q}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var j,N;for(j=0;j<this.files.length;j++)N=this.files[j],this.reader.setIndex(N.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),N.readLocalPart(this.reader),N.handleUTF8(),N.processAttributes()},readCentralDir:function(){var j;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(j=new B({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(j);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var j=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(j<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(j);var N=j;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===E.MAX_VALUE_16BITS||this.diskWithCentralDirStart===E.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===E.MAX_VALUE_16BITS||this.centralDirRecords===E.MAX_VALUE_16BITS||this.centralDirSize===E.MAX_VALUE_32BITS||this.centralDirOffset===E.MAX_VALUE_32BITS){if(this.zip64=!0,(j=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(j),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var q=this.centralDirOffset+this.centralDirSize;this.zip64&&(q+=20,q+=12+this.zip64EndOfCentralSize);var se=N-q;if(0<se)this.isSignature(N,u.CENTRAL_FILE_HEADER)||(this.reader.zero=se);else if(se<0)throw new Error("Corrupted zip: missing "+Math.abs(se)+" bytes.")},prepareReader:function(j){this.reader=z(j)},load:function(j){this.prepareReader(j),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},C.exports=K},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(v,C,I){var z=v("./reader/readerFor"),E=v("./utils"),u=v("./compressedObject"),B=v("./crc32"),U=v("./utf8"),K=v("./compressions"),j=v("./support");function N(q,se){this.options=q,this.loadOptions=se}N.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(q){var se,J;if(q.skip(22),this.fileNameLength=q.readInt(2),J=q.readInt(2),this.fileName=q.readData(this.fileNameLength),q.skip(J),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((se=function(ae){for(var re in K)if(Object.prototype.hasOwnProperty.call(K,re)&&K[re].magic===ae)return K[re];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+E.pretty(this.compressionMethod)+" unknown (inner file : "+E.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,se,q.readData(this.compressedSize))},readCentralPart:function(q){this.versionMadeBy=q.readInt(2),q.skip(2),this.bitFlag=q.readInt(2),this.compressionMethod=q.readString(2),this.date=q.readDate(),this.crc32=q.readInt(4),this.compressedSize=q.readInt(4),this.uncompressedSize=q.readInt(4);var se=q.readInt(2);if(this.extraFieldsLength=q.readInt(2),this.fileCommentLength=q.readInt(2),this.diskNumberStart=q.readInt(2),this.internalFileAttributes=q.readInt(2),this.externalFileAttributes=q.readInt(4),this.localHeaderOffset=q.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");q.skip(se),this.readExtraFields(q),this.parseZIP64ExtraField(q),this.fileComment=q.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var q=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),q==0&&(this.dosPermissions=63&this.externalFileAttributes),q==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var q=z(this.extraFields[1].value);this.uncompressedSize===E.MAX_VALUE_32BITS&&(this.uncompressedSize=q.readInt(8)),this.compressedSize===E.MAX_VALUE_32BITS&&(this.compressedSize=q.readInt(8)),this.localHeaderOffset===E.MAX_VALUE_32BITS&&(this.localHeaderOffset=q.readInt(8)),this.diskNumberStart===E.MAX_VALUE_32BITS&&(this.diskNumberStart=q.readInt(4))}},readExtraFields:function(q){var se,J,ae,re=q.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});q.index+4<re;)se=q.readInt(2),J=q.readInt(2),ae=q.readData(J),this.extraFields[se]={id:se,length:J,value:ae};q.setIndex(re)},handleUTF8:function(){var q=j.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=U.utf8decode(this.fileName),this.fileCommentStr=U.utf8decode(this.fileComment);else{var se=this.findExtraFieldUnicodePath();if(se!==null)this.fileNameStr=se;else{var J=E.transformTo(q,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(J)}var ae=this.findExtraFieldUnicodeComment();if(ae!==null)this.fileCommentStr=ae;else{var re=E.transformTo(q,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(re)}}},findExtraFieldUnicodePath:function(){var q=this.extraFields[28789];if(q){var se=z(q.value);return se.readInt(1)!==1||B(this.fileName)!==se.readInt(4)?null:U.utf8decode(se.readData(q.length-5))}return null},findExtraFieldUnicodeComment:function(){var q=this.extraFields[25461];if(q){var se=z(q.value);return se.readInt(1)!==1||B(this.fileComment)!==se.readInt(4)?null:U.utf8decode(se.readData(q.length-5))}return null}},C.exports=N},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(v,C,I){function z(se,J,ae){this.name=se,this.dir=ae.dir,this.date=ae.date,this.comment=ae.comment,this.unixPermissions=ae.unixPermissions,this.dosPermissions=ae.dosPermissions,this._data=J,this._dataBinary=ae.binary,this.options={compression:ae.compression,compressionOptions:ae.compressionOptions}}var E=v("./stream/StreamHelper"),u=v("./stream/DataWorker"),B=v("./utf8"),U=v("./compressedObject"),K=v("./stream/GenericWorker");z.prototype={internalStream:function(se){var J=null,ae="string";try{if(!se)throw new Error("No output type specified.");var re=(ae=se.toLowerCase())==="string"||ae==="text";ae!=="binarystring"&&ae!=="text"||(ae="string"),J=this._decompressWorker();var pe=!this._dataBinary;pe&&!re&&(J=J.pipe(new B.Utf8EncodeWorker)),!pe&&re&&(J=J.pipe(new B.Utf8DecodeWorker))}catch(ge){(J=new K("error")).error(ge)}return new E(J,ae,"")},async:function(se,J){return this.internalStream(se).accumulate(J)},nodeStream:function(se,J){return this.internalStream(se||"nodebuffer").toNodejsStream(J)},_compressWorker:function(se,J){if(this._data instanceof U&&this._data.compression.magic===se.magic)return this._data.getCompressedWorker();var ae=this._decompressWorker();return this._dataBinary||(ae=ae.pipe(new B.Utf8EncodeWorker)),U.createWorkerFrom(ae,se,J)},_decompressWorker:function(){return this._data instanceof U?this._data.getContentWorker():this._data instanceof K?this._data:new u(this._data)}};for(var j=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],N=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},q=0;q<j.length;q++)z.prototype[j[q]]=N;C.exports=z},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(v,C,I){(function(z){var E,u,B=z.MutationObserver||z.WebKitMutationObserver;if(B){var U=0,K=new B(se),j=z.document.createTextNode("");K.observe(j,{characterData:!0}),E=function(){j.data=U=++U%2}}else if(z.setImmediate||z.MessageChannel===void 0)E="document"in z&&"onreadystatechange"in z.document.createElement("script")?function(){var J=z.document.createElement("script");J.onreadystatechange=function(){se(),J.onreadystatechange=null,J.parentNode.removeChild(J),J=null},z.document.documentElement.appendChild(J)}:function(){setTimeout(se,0)};else{var N=new z.MessageChannel;N.port1.onmessage=se,E=function(){N.port2.postMessage(0)}}var q=[];function se(){var J,ae;u=!0;for(var re=q.length;re;){for(ae=q,q=[],J=-1;++J<re;)ae[J]();re=q.length}u=!1}C.exports=function(J){q.push(J)!==1||u||E()}}).call(this,typeof sc<"u"?sc:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(v,C,I){var z=v("immediate");function E(){}var u={},B=["REJECTED"],U=["FULFILLED"],K=["PENDING"];function j(re){if(typeof re!="function")throw new TypeError("resolver must be a function");this.state=K,this.queue=[],this.outcome=void 0,re!==E&&J(this,re)}function N(re,pe,ge){this.promise=re,typeof pe=="function"&&(this.onFulfilled=pe,this.callFulfilled=this.otherCallFulfilled),typeof ge=="function"&&(this.onRejected=ge,this.callRejected=this.otherCallRejected)}function q(re,pe,ge){z(function(){var Fe;try{Fe=pe(ge)}catch(ve){return u.reject(re,ve)}Fe===re?u.reject(re,new TypeError("Cannot resolve promise with itself")):u.resolve(re,Fe)})}function se(re){var pe=re&&re.then;if(re&&(typeof re=="object"||typeof re=="function")&&typeof pe=="function")return function(){pe.apply(re,arguments)}}function J(re,pe){var ge=!1;function Fe(je){ge||(ge=!0,u.reject(re,je))}function ve(je){ge||(ge=!0,u.resolve(re,je))}var qe=ae(function(){pe(ve,Fe)});qe.status==="error"&&Fe(qe.value)}function ae(re,pe){var ge={};try{ge.value=re(pe),ge.status="success"}catch(Fe){ge.status="error",ge.value=Fe}return ge}(C.exports=j).prototype.finally=function(re){if(typeof re!="function")return this;var pe=this.constructor;return this.then(function(ge){return pe.resolve(re()).then(function(){return ge})},function(ge){return pe.resolve(re()).then(function(){throw ge})})},j.prototype.catch=function(re){return this.then(null,re)},j.prototype.then=function(re,pe){if(typeof re!="function"&&this.state===U||typeof pe!="function"&&this.state===B)return this;var ge=new this.constructor(E);return this.state!==K?q(ge,this.state===U?re:pe,this.outcome):this.queue.push(new N(ge,re,pe)),ge},N.prototype.callFulfilled=function(re){u.resolve(this.promise,re)},N.prototype.otherCallFulfilled=function(re){q(this.promise,this.onFulfilled,re)},N.prototype.callRejected=function(re){u.reject(this.promise,re)},N.prototype.otherCallRejected=function(re){q(this.promise,this.onRejected,re)},u.resolve=function(re,pe){var ge=ae(se,pe);if(ge.status==="error")return u.reject(re,ge.value);var Fe=ge.value;if(Fe)J(re,Fe);else{re.state=U,re.outcome=pe;for(var ve=-1,qe=re.queue.length;++ve<qe;)re.queue[ve].callFulfilled(pe)}return re},u.reject=function(re,pe){re.state=B,re.outcome=pe;for(var ge=-1,Fe=re.queue.length;++ge<Fe;)re.queue[ge].callRejected(pe);return re},j.resolve=function(re){return re instanceof this?re:u.resolve(new this(E),re)},j.reject=function(re){var pe=new this(E);return u.reject(pe,re)},j.all=function(re){var pe=this;if(Object.prototype.toString.call(re)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ge=re.length,Fe=!1;if(!ge)return this.resolve([]);for(var ve=new Array(ge),qe=0,je=-1,St=new this(E);++je<ge;)ot(re[je],je);return St;function ot(At,xt){pe.resolve(At).then(function(xe){ve[xt]=xe,++qe!==ge||Fe||(Fe=!0,u.resolve(St,ve))},function(xe){Fe||(Fe=!0,u.reject(St,xe))})}},j.race=function(re){var pe=this;if(Object.prototype.toString.call(re)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ge=re.length,Fe=!1;if(!ge)return this.resolve([]);for(var ve=-1,qe=new this(E);++ve<ge;)je=re[ve],pe.resolve(je).then(function(St){Fe||(Fe=!0,u.resolve(qe,St))},function(St){Fe||(Fe=!0,u.reject(qe,St))});var je;return qe}},{immediate:36}],38:[function(v,C,I){var z={};(0,v("./lib/utils/common").assign)(z,v("./lib/deflate"),v("./lib/inflate"),v("./lib/zlib/constants")),C.exports=z},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(v,C,I){var z=v("./zlib/deflate"),E=v("./utils/common"),u=v("./utils/strings"),B=v("./zlib/messages"),U=v("./zlib/zstream"),K=Object.prototype.toString,j=0,N=-1,q=0,se=8;function J(re){if(!(this instanceof J))return new J(re);this.options=E.assign({level:N,method:se,chunkSize:16384,windowBits:15,memLevel:8,strategy:q,to:""},re||{});var pe=this.options;pe.raw&&0<pe.windowBits?pe.windowBits=-pe.windowBits:pe.gzip&&0<pe.windowBits&&pe.windowBits<16&&(pe.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new U,this.strm.avail_out=0;var ge=z.deflateInit2(this.strm,pe.level,pe.method,pe.windowBits,pe.memLevel,pe.strategy);if(ge!==j)throw new Error(B[ge]);if(pe.header&&z.deflateSetHeader(this.strm,pe.header),pe.dictionary){var Fe;if(Fe=typeof pe.dictionary=="string"?u.string2buf(pe.dictionary):K.call(pe.dictionary)==="[object ArrayBuffer]"?new Uint8Array(pe.dictionary):pe.dictionary,(ge=z.deflateSetDictionary(this.strm,Fe))!==j)throw new Error(B[ge]);this._dict_set=!0}}function ae(re,pe){var ge=new J(pe);if(ge.push(re,!0),ge.err)throw ge.msg||B[ge.err];return ge.result}J.prototype.push=function(re,pe){var ge,Fe,ve=this.strm,qe=this.options.chunkSize;if(this.ended)return!1;Fe=pe===~~pe?pe:pe===!0?4:0,typeof re=="string"?ve.input=u.string2buf(re):K.call(re)==="[object ArrayBuffer]"?ve.input=new Uint8Array(re):ve.input=re,ve.next_in=0,ve.avail_in=ve.input.length;do{if(ve.avail_out===0&&(ve.output=new E.Buf8(qe),ve.next_out=0,ve.avail_out=qe),(ge=z.deflate(ve,Fe))!==1&&ge!==j)return this.onEnd(ge),!(this.ended=!0);ve.avail_out!==0&&(ve.avail_in!==0||Fe!==4&&Fe!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(E.shrinkBuf(ve.output,ve.next_out))):this.onData(E.shrinkBuf(ve.output,ve.next_out)))}while((0<ve.avail_in||ve.avail_out===0)&&ge!==1);return Fe===4?(ge=z.deflateEnd(this.strm),this.onEnd(ge),this.ended=!0,ge===j):Fe!==2||(this.onEnd(j),!(ve.avail_out=0))},J.prototype.onData=function(re){this.chunks.push(re)},J.prototype.onEnd=function(re){re===j&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=re,this.msg=this.strm.msg},I.Deflate=J,I.deflate=ae,I.deflateRaw=function(re,pe){return(pe=pe||{}).raw=!0,ae(re,pe)},I.gzip=function(re,pe){return(pe=pe||{}).gzip=!0,ae(re,pe)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(v,C,I){var z=v("./zlib/inflate"),E=v("./utils/common"),u=v("./utils/strings"),B=v("./zlib/constants"),U=v("./zlib/messages"),K=v("./zlib/zstream"),j=v("./zlib/gzheader"),N=Object.prototype.toString;function q(J){if(!(this instanceof q))return new q(J);this.options=E.assign({chunkSize:16384,windowBits:0,to:""},J||{});var ae=this.options;ae.raw&&0<=ae.windowBits&&ae.windowBits<16&&(ae.windowBits=-ae.windowBits,ae.windowBits===0&&(ae.windowBits=-15)),!(0<=ae.windowBits&&ae.windowBits<16)||J&&J.windowBits||(ae.windowBits+=32),15<ae.windowBits&&ae.windowBits<48&&(15&ae.windowBits)==0&&(ae.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new K,this.strm.avail_out=0;var re=z.inflateInit2(this.strm,ae.windowBits);if(re!==B.Z_OK)throw new Error(U[re]);this.header=new j,z.inflateGetHeader(this.strm,this.header)}function se(J,ae){var re=new q(ae);if(re.push(J,!0),re.err)throw re.msg||U[re.err];return re.result}q.prototype.push=function(J,ae){var re,pe,ge,Fe,ve,qe,je=this.strm,St=this.options.chunkSize,ot=this.options.dictionary,At=!1;if(this.ended)return!1;pe=ae===~~ae?ae:ae===!0?B.Z_FINISH:B.Z_NO_FLUSH,typeof J=="string"?je.input=u.binstring2buf(J):N.call(J)==="[object ArrayBuffer]"?je.input=new Uint8Array(J):je.input=J,je.next_in=0,je.avail_in=je.input.length;do{if(je.avail_out===0&&(je.output=new E.Buf8(St),je.next_out=0,je.avail_out=St),(re=z.inflate(je,B.Z_NO_FLUSH))===B.Z_NEED_DICT&&ot&&(qe=typeof ot=="string"?u.string2buf(ot):N.call(ot)==="[object ArrayBuffer]"?new Uint8Array(ot):ot,re=z.inflateSetDictionary(this.strm,qe)),re===B.Z_BUF_ERROR&&At===!0&&(re=B.Z_OK,At=!1),re!==B.Z_STREAM_END&&re!==B.Z_OK)return this.onEnd(re),!(this.ended=!0);je.next_out&&(je.avail_out!==0&&re!==B.Z_STREAM_END&&(je.avail_in!==0||pe!==B.Z_FINISH&&pe!==B.Z_SYNC_FLUSH)||(this.options.to==="string"?(ge=u.utf8border(je.output,je.next_out),Fe=je.next_out-ge,ve=u.buf2string(je.output,ge),je.next_out=Fe,je.avail_out=St-Fe,Fe&&E.arraySet(je.output,je.output,ge,Fe,0),this.onData(ve)):this.onData(E.shrinkBuf(je.output,je.next_out)))),je.avail_in===0&&je.avail_out===0&&(At=!0)}while((0<je.avail_in||je.avail_out===0)&&re!==B.Z_STREAM_END);return re===B.Z_STREAM_END&&(pe=B.Z_FINISH),pe===B.Z_FINISH?(re=z.inflateEnd(this.strm),this.onEnd(re),this.ended=!0,re===B.Z_OK):pe!==B.Z_SYNC_FLUSH||(this.onEnd(B.Z_OK),!(je.avail_out=0))},q.prototype.onData=function(J){this.chunks.push(J)},q.prototype.onEnd=function(J){J===B.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=E.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg},I.Inflate=q,I.inflate=se,I.inflateRaw=function(J,ae){return(ae=ae||{}).raw=!0,se(J,ae)},I.ungzip=se},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(v,C,I){var z=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";I.assign=function(B){for(var U=Array.prototype.slice.call(arguments,1);U.length;){var K=U.shift();if(K){if(typeof K!="object")throw new TypeError(K+"must be non-object");for(var j in K)K.hasOwnProperty(j)&&(B[j]=K[j])}}return B},I.shrinkBuf=function(B,U){return B.length===U?B:B.subarray?B.subarray(0,U):(B.length=U,B)};var E={arraySet:function(B,U,K,j,N){if(U.subarray&&B.subarray)B.set(U.subarray(K,K+j),N);else for(var q=0;q<j;q++)B[N+q]=U[K+q]},flattenChunks:function(B){var U,K,j,N,q,se;for(U=j=0,K=B.length;U<K;U++)j+=B[U].length;for(se=new Uint8Array(j),U=N=0,K=B.length;U<K;U++)q=B[U],se.set(q,N),N+=q.length;return se}},u={arraySet:function(B,U,K,j,N){for(var q=0;q<j;q++)B[N+q]=U[K+q]},flattenChunks:function(B){return[].concat.apply([],B)}};I.setTyped=function(B){B?(I.Buf8=Uint8Array,I.Buf16=Uint16Array,I.Buf32=Int32Array,I.assign(I,E)):(I.Buf8=Array,I.Buf16=Array,I.Buf32=Array,I.assign(I,u))},I.setTyped(z)},{}],42:[function(v,C,I){var z=v("./common"),E=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{E=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var B=new z.Buf8(256),U=0;U<256;U++)B[U]=252<=U?6:248<=U?5:240<=U?4:224<=U?3:192<=U?2:1;function K(j,N){if(N<65537&&(j.subarray&&u||!j.subarray&&E))return String.fromCharCode.apply(null,z.shrinkBuf(j,N));for(var q="",se=0;se<N;se++)q+=String.fromCharCode(j[se]);return q}B[254]=B[254]=1,I.string2buf=function(j){var N,q,se,J,ae,re=j.length,pe=0;for(J=0;J<re;J++)(64512&(q=j.charCodeAt(J)))==55296&&J+1<re&&(64512&(se=j.charCodeAt(J+1)))==56320&&(q=65536+(q-55296<<10)+(se-56320),J++),pe+=q<128?1:q<2048?2:q<65536?3:4;for(N=new z.Buf8(pe),J=ae=0;ae<pe;J++)(64512&(q=j.charCodeAt(J)))==55296&&J+1<re&&(64512&(se=j.charCodeAt(J+1)))==56320&&(q=65536+(q-55296<<10)+(se-56320),J++),q<128?N[ae++]=q:(q<2048?N[ae++]=192|q>>>6:(q<65536?N[ae++]=224|q>>>12:(N[ae++]=240|q>>>18,N[ae++]=128|q>>>12&63),N[ae++]=128|q>>>6&63),N[ae++]=128|63&q);return N},I.buf2binstring=function(j){return K(j,j.length)},I.binstring2buf=function(j){for(var N=new z.Buf8(j.length),q=0,se=N.length;q<se;q++)N[q]=j.charCodeAt(q);return N},I.buf2string=function(j,N){var q,se,J,ae,re=N||j.length,pe=new Array(2*re);for(q=se=0;q<re;)if((J=j[q++])<128)pe[se++]=J;else if(4<(ae=B[J]))pe[se++]=65533,q+=ae-1;else{for(J&=ae===2?31:ae===3?15:7;1<ae&&q<re;)J=J<<6|63&j[q++],ae--;1<ae?pe[se++]=65533:J<65536?pe[se++]=J:(J-=65536,pe[se++]=55296|J>>10&1023,pe[se++]=56320|1023&J)}return K(pe,se)},I.utf8border=function(j,N){var q;for((N=N||j.length)>j.length&&(N=j.length),q=N-1;0<=q&&(192&j[q])==128;)q--;return q<0||q===0?N:q+B[j[q]]>N?q:N}},{"./common":41}],43:[function(v,C,I){C.exports=function(z,E,u,B){for(var U=65535&z|0,K=z>>>16&65535|0,j=0;u!==0;){for(u-=j=2e3<u?2e3:u;K=K+(U=U+E[B++]|0)|0,--j;);U%=65521,K%=65521}return U|K<<16|0}},{}],44:[function(v,C,I){C.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(v,C,I){var z=function(){for(var E,u=[],B=0;B<256;B++){E=B;for(var U=0;U<8;U++)E=1&E?3988292384^E>>>1:E>>>1;u[B]=E}return u}();C.exports=function(E,u,B,U){var K=z,j=U+B;E^=-1;for(var N=U;N<j;N++)E=E>>>8^K[255&(E^u[N])];return-1^E}},{}],46:[function(v,C,I){var z,E=v("../utils/common"),u=v("./trees"),B=v("./adler32"),U=v("./crc32"),K=v("./messages"),j=0,N=4,q=0,se=-2,J=-1,ae=4,re=2,pe=8,ge=9,Fe=286,ve=30,qe=19,je=2*Fe+1,St=15,ot=3,At=258,xt=At+ot+1,xe=42,Je=113,G=1,Ve=2,Rt=3,Ae=4;function et(W,ft){return W.msg=K[ft],ft}function Ze(W){return(W<<1)-(4<W?9:0)}function ht(W){for(var ft=W.length;0<=--ft;)W[ft]=0}function oe(W){var ft=W.state,ye=ft.pending;ye>W.avail_out&&(ye=W.avail_out),ye!==0&&(E.arraySet(W.output,ft.pending_buf,ft.pending_out,ye,W.next_out),W.next_out+=ye,ft.pending_out+=ye,W.total_out+=ye,W.avail_out-=ye,ft.pending-=ye,ft.pending===0&&(ft.pending_out=0))}function _e(W,ft){u._tr_flush_block(W,0<=W.block_start?W.block_start:-1,W.strstart-W.block_start,ft),W.block_start=W.strstart,oe(W.strm)}function Ct(W,ft){W.pending_buf[W.pending++]=ft}function bt(W,ft){W.pending_buf[W.pending++]=ft>>>8&255,W.pending_buf[W.pending++]=255&ft}function wt(W,ft){var ye,Me,we=W.max_chain_length,Ne=W.strstart,_t=W.prev_length,Mt=W.nice_match,nt=W.strstart>W.w_size-xt?W.strstart-(W.w_size-xt):0,zt=W.window,rr=W.w_mask,Lt=W.prev,_r=W.strstart+At,en=zt[Ne+_t-1],vt=zt[Ne+_t];W.prev_length>=W.good_match&&(we>>=2),Mt>W.lookahead&&(Mt=W.lookahead);do if(zt[(ye=ft)+_t]===vt&&zt[ye+_t-1]===en&&zt[ye]===zt[Ne]&&zt[++ye]===zt[Ne+1]){Ne+=2,ye++;do;while(zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&zt[++Ne]===zt[++ye]&&Ne<_r);if(Me=At-(_r-Ne),Ne=_r-At,_t<Me){if(W.match_start=ft,Mt<=(_t=Me))break;en=zt[Ne+_t-1],vt=zt[Ne+_t]}}while((ft=Lt[ft&rr])>nt&&--we!=0);return _t<=W.lookahead?_t:W.lookahead}function ar(W){var ft,ye,Me,we,Ne,_t,Mt,nt,zt,rr,Lt=W.w_size;do{if(we=W.window_size-W.lookahead-W.strstart,W.strstart>=Lt+(Lt-xt)){for(E.arraySet(W.window,W.window,Lt,Lt,0),W.match_start-=Lt,W.strstart-=Lt,W.block_start-=Lt,ft=ye=W.hash_size;Me=W.head[--ft],W.head[ft]=Lt<=Me?Me-Lt:0,--ye;);for(ft=ye=Lt;Me=W.prev[--ft],W.prev[ft]=Lt<=Me?Me-Lt:0,--ye;);we+=Lt}if(W.strm.avail_in===0)break;if(_t=W.strm,Mt=W.window,nt=W.strstart+W.lookahead,zt=we,rr=void 0,rr=_t.avail_in,zt<rr&&(rr=zt),ye=rr===0?0:(_t.avail_in-=rr,E.arraySet(Mt,_t.input,_t.next_in,rr,nt),_t.state.wrap===1?_t.adler=B(_t.adler,Mt,rr,nt):_t.state.wrap===2&&(_t.adler=U(_t.adler,Mt,rr,nt)),_t.next_in+=rr,_t.total_in+=rr,rr),W.lookahead+=ye,W.lookahead+W.insert>=ot)for(Ne=W.strstart-W.insert,W.ins_h=W.window[Ne],W.ins_h=(W.ins_h<<W.hash_shift^W.window[Ne+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[Ne+ot-1])&W.hash_mask,W.prev[Ne&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=Ne,Ne++,W.insert--,!(W.lookahead+W.insert<ot)););}while(W.lookahead<xt&&W.strm.avail_in!==0)}function fr(W,ft){for(var ye,Me;;){if(W.lookahead<xt){if(ar(W),W.lookahead<xt&&ft===j)return G;if(W.lookahead===0)break}if(ye=0,W.lookahead>=ot&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+ot-1])&W.hash_mask,ye=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),ye!==0&&W.strstart-ye<=W.w_size-xt&&(W.match_length=wt(W,ye)),W.match_length>=ot)if(Me=u._tr_tally(W,W.strstart-W.match_start,W.match_length-ot),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=ot){for(W.match_length--;W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+ot-1])&W.hash_mask,ye=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart,--W.match_length!=0;);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else Me=u._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(Me&&(_e(W,!1),W.strm.avail_out===0))return G}return W.insert=W.strstart<ot-1?W.strstart:ot-1,ft===N?(_e(W,!0),W.strm.avail_out===0?Rt:Ae):W.last_lit&&(_e(W,!1),W.strm.avail_out===0)?G:Ve}function qt(W,ft){for(var ye,Me,we;;){if(W.lookahead<xt){if(ar(W),W.lookahead<xt&&ft===j)return G;if(W.lookahead===0)break}if(ye=0,W.lookahead>=ot&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+ot-1])&W.hash_mask,ye=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=ot-1,ye!==0&&W.prev_length<W.max_lazy_match&&W.strstart-ye<=W.w_size-xt&&(W.match_length=wt(W,ye),W.match_length<=5&&(W.strategy===1||W.match_length===ot&&4096<W.strstart-W.match_start)&&(W.match_length=ot-1)),W.prev_length>=ot&&W.match_length<=W.prev_length){for(we=W.strstart+W.lookahead-ot,Me=u._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-ot),W.lookahead-=W.prev_length-1,W.prev_length-=2;++W.strstart<=we&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+ot-1])&W.hash_mask,ye=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),--W.prev_length!=0;);if(W.match_available=0,W.match_length=ot-1,W.strstart++,Me&&(_e(W,!1),W.strm.avail_out===0))return G}else if(W.match_available){if((Me=u._tr_tally(W,0,W.window[W.strstart-1]))&&_e(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return G}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(Me=u._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<ot-1?W.strstart:ot-1,ft===N?(_e(W,!0),W.strm.avail_out===0?Rt:Ae):W.last_lit&&(_e(W,!1),W.strm.avail_out===0)?G:Ve}function Kt(W,ft,ye,Me,we){this.good_length=W,this.max_lazy=ft,this.nice_length=ye,this.max_chain=Me,this.func=we}function Cr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*je),this.dyn_dtree=new E.Buf16(2*(2*ve+1)),this.bl_tree=new E.Buf16(2*(2*qe+1)),ht(this.dyn_ltree),ht(this.dyn_dtree),ht(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(St+1),this.heap=new E.Buf16(2*Fe+1),ht(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*Fe+1),ht(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Br(W){var ft;return W&&W.state?(W.total_in=W.total_out=0,W.data_type=re,(ft=W.state).pending=0,ft.pending_out=0,ft.wrap<0&&(ft.wrap=-ft.wrap),ft.status=ft.wrap?xe:Je,W.adler=ft.wrap===2?0:1,ft.last_flush=j,u._tr_init(ft),q):et(W,se)}function Yr(W){var ft=Br(W);return ft===q&&function(ye){ye.window_size=2*ye.w_size,ht(ye.head),ye.max_lazy_match=z[ye.level].max_lazy,ye.good_match=z[ye.level].good_length,ye.nice_match=z[ye.level].nice_length,ye.max_chain_length=z[ye.level].max_chain,ye.strstart=0,ye.block_start=0,ye.lookahead=0,ye.insert=0,ye.match_length=ye.prev_length=ot-1,ye.match_available=0,ye.ins_h=0}(W.state),ft}function Zr(W,ft,ye,Me,we,Ne){if(!W)return se;var _t=1;if(ft===J&&(ft=6),Me<0?(_t=0,Me=-Me):15<Me&&(_t=2,Me-=16),we<1||ge<we||ye!==pe||Me<8||15<Me||ft<0||9<ft||Ne<0||ae<Ne)return et(W,se);Me===8&&(Me=9);var Mt=new Cr;return(W.state=Mt).strm=W,Mt.wrap=_t,Mt.gzhead=null,Mt.w_bits=Me,Mt.w_size=1<<Mt.w_bits,Mt.w_mask=Mt.w_size-1,Mt.hash_bits=we+7,Mt.hash_size=1<<Mt.hash_bits,Mt.hash_mask=Mt.hash_size-1,Mt.hash_shift=~~((Mt.hash_bits+ot-1)/ot),Mt.window=new E.Buf8(2*Mt.w_size),Mt.head=new E.Buf16(Mt.hash_size),Mt.prev=new E.Buf16(Mt.w_size),Mt.lit_bufsize=1<<we+6,Mt.pending_buf_size=4*Mt.lit_bufsize,Mt.pending_buf=new E.Buf8(Mt.pending_buf_size),Mt.d_buf=1*Mt.lit_bufsize,Mt.l_buf=3*Mt.lit_bufsize,Mt.level=ft,Mt.strategy=Ne,Mt.method=ye,Yr(W)}z=[new Kt(0,0,0,0,function(W,ft){var ye=65535;for(ye>W.pending_buf_size-5&&(ye=W.pending_buf_size-5);;){if(W.lookahead<=1){if(ar(W),W.lookahead===0&&ft===j)return G;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var Me=W.block_start+ye;if((W.strstart===0||W.strstart>=Me)&&(W.lookahead=W.strstart-Me,W.strstart=Me,_e(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-xt&&(_e(W,!1),W.strm.avail_out===0))return G}return W.insert=0,ft===N?(_e(W,!0),W.strm.avail_out===0?Rt:Ae):(W.strstart>W.block_start&&(_e(W,!1),W.strm.avail_out),G)}),new Kt(4,4,8,4,fr),new Kt(4,5,16,8,fr),new Kt(4,6,32,32,fr),new Kt(4,4,16,16,qt),new Kt(8,16,32,32,qt),new Kt(8,16,128,128,qt),new Kt(8,32,128,256,qt),new Kt(32,128,258,1024,qt),new Kt(32,258,258,4096,qt)],I.deflateInit=function(W,ft){return Zr(W,ft,pe,15,8,0)},I.deflateInit2=Zr,I.deflateReset=Yr,I.deflateResetKeep=Br,I.deflateSetHeader=function(W,ft){return W&&W.state?W.state.wrap!==2?se:(W.state.gzhead=ft,q):se},I.deflate=function(W,ft){var ye,Me,we,Ne;if(!W||!W.state||5<ft||ft<0)return W?et(W,se):se;if(Me=W.state,!W.output||!W.input&&W.avail_in!==0||Me.status===666&&ft!==N)return et(W,W.avail_out===0?-5:se);if(Me.strm=W,ye=Me.last_flush,Me.last_flush=ft,Me.status===xe)if(Me.wrap===2)W.adler=0,Ct(Me,31),Ct(Me,139),Ct(Me,8),Me.gzhead?(Ct(Me,(Me.gzhead.text?1:0)+(Me.gzhead.hcrc?2:0)+(Me.gzhead.extra?4:0)+(Me.gzhead.name?8:0)+(Me.gzhead.comment?16:0)),Ct(Me,255&Me.gzhead.time),Ct(Me,Me.gzhead.time>>8&255),Ct(Me,Me.gzhead.time>>16&255),Ct(Me,Me.gzhead.time>>24&255),Ct(Me,Me.level===9?2:2<=Me.strategy||Me.level<2?4:0),Ct(Me,255&Me.gzhead.os),Me.gzhead.extra&&Me.gzhead.extra.length&&(Ct(Me,255&Me.gzhead.extra.length),Ct(Me,Me.gzhead.extra.length>>8&255)),Me.gzhead.hcrc&&(W.adler=U(W.adler,Me.pending_buf,Me.pending,0)),Me.gzindex=0,Me.status=69):(Ct(Me,0),Ct(Me,0),Ct(Me,0),Ct(Me,0),Ct(Me,0),Ct(Me,Me.level===9?2:2<=Me.strategy||Me.level<2?4:0),Ct(Me,3),Me.status=Je);else{var _t=pe+(Me.w_bits-8<<4)<<8;_t|=(2<=Me.strategy||Me.level<2?0:Me.level<6?1:Me.level===6?2:3)<<6,Me.strstart!==0&&(_t|=32),_t+=31-_t%31,Me.status=Je,bt(Me,_t),Me.strstart!==0&&(bt(Me,W.adler>>>16),bt(Me,65535&W.adler)),W.adler=1}if(Me.status===69)if(Me.gzhead.extra){for(we=Me.pending;Me.gzindex<(65535&Me.gzhead.extra.length)&&(Me.pending!==Me.pending_buf_size||(Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),oe(W),we=Me.pending,Me.pending!==Me.pending_buf_size));)Ct(Me,255&Me.gzhead.extra[Me.gzindex]),Me.gzindex++;Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),Me.gzindex===Me.gzhead.extra.length&&(Me.gzindex=0,Me.status=73)}else Me.status=73;if(Me.status===73)if(Me.gzhead.name){we=Me.pending;do{if(Me.pending===Me.pending_buf_size&&(Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),oe(W),we=Me.pending,Me.pending===Me.pending_buf_size)){Ne=1;break}Ne=Me.gzindex<Me.gzhead.name.length?255&Me.gzhead.name.charCodeAt(Me.gzindex++):0,Ct(Me,Ne)}while(Ne!==0);Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),Ne===0&&(Me.gzindex=0,Me.status=91)}else Me.status=91;if(Me.status===91)if(Me.gzhead.comment){we=Me.pending;do{if(Me.pending===Me.pending_buf_size&&(Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),oe(W),we=Me.pending,Me.pending===Me.pending_buf_size)){Ne=1;break}Ne=Me.gzindex<Me.gzhead.comment.length?255&Me.gzhead.comment.charCodeAt(Me.gzindex++):0,Ct(Me,Ne)}while(Ne!==0);Me.gzhead.hcrc&&Me.pending>we&&(W.adler=U(W.adler,Me.pending_buf,Me.pending-we,we)),Ne===0&&(Me.status=103)}else Me.status=103;if(Me.status===103&&(Me.gzhead.hcrc?(Me.pending+2>Me.pending_buf_size&&oe(W),Me.pending+2<=Me.pending_buf_size&&(Ct(Me,255&W.adler),Ct(Me,W.adler>>8&255),W.adler=0,Me.status=Je)):Me.status=Je),Me.pending!==0){if(oe(W),W.avail_out===0)return Me.last_flush=-1,q}else if(W.avail_in===0&&Ze(ft)<=Ze(ye)&&ft!==N)return et(W,-5);if(Me.status===666&&W.avail_in!==0)return et(W,-5);if(W.avail_in!==0||Me.lookahead!==0||ft!==j&&Me.status!==666){var Mt=Me.strategy===2?function(nt,zt){for(var rr;;){if(nt.lookahead===0&&(ar(nt),nt.lookahead===0)){if(zt===j)return G;break}if(nt.match_length=0,rr=u._tr_tally(nt,0,nt.window[nt.strstart]),nt.lookahead--,nt.strstart++,rr&&(_e(nt,!1),nt.strm.avail_out===0))return G}return nt.insert=0,zt===N?(_e(nt,!0),nt.strm.avail_out===0?Rt:Ae):nt.last_lit&&(_e(nt,!1),nt.strm.avail_out===0)?G:Ve}(Me,ft):Me.strategy===3?function(nt,zt){for(var rr,Lt,_r,en,vt=nt.window;;){if(nt.lookahead<=At){if(ar(nt),nt.lookahead<=At&&zt===j)return G;if(nt.lookahead===0)break}if(nt.match_length=0,nt.lookahead>=ot&&0<nt.strstart&&(Lt=vt[_r=nt.strstart-1])===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]){en=nt.strstart+At;do;while(Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&Lt===vt[++_r]&&_r<en);nt.match_length=At-(en-_r),nt.match_length>nt.lookahead&&(nt.match_length=nt.lookahead)}if(nt.match_length>=ot?(rr=u._tr_tally(nt,1,nt.match_length-ot),nt.lookahead-=nt.match_length,nt.strstart+=nt.match_length,nt.match_length=0):(rr=u._tr_tally(nt,0,nt.window[nt.strstart]),nt.lookahead--,nt.strstart++),rr&&(_e(nt,!1),nt.strm.avail_out===0))return G}return nt.insert=0,zt===N?(_e(nt,!0),nt.strm.avail_out===0?Rt:Ae):nt.last_lit&&(_e(nt,!1),nt.strm.avail_out===0)?G:Ve}(Me,ft):z[Me.level].func(Me,ft);if(Mt!==Rt&&Mt!==Ae||(Me.status=666),Mt===G||Mt===Rt)return W.avail_out===0&&(Me.last_flush=-1),q;if(Mt===Ve&&(ft===1?u._tr_align(Me):ft!==5&&(u._tr_stored_block(Me,0,0,!1),ft===3&&(ht(Me.head),Me.lookahead===0&&(Me.strstart=0,Me.block_start=0,Me.insert=0))),oe(W),W.avail_out===0))return Me.last_flush=-1,q}return ft!==N?q:Me.wrap<=0?1:(Me.wrap===2?(Ct(Me,255&W.adler),Ct(Me,W.adler>>8&255),Ct(Me,W.adler>>16&255),Ct(Me,W.adler>>24&255),Ct(Me,255&W.total_in),Ct(Me,W.total_in>>8&255),Ct(Me,W.total_in>>16&255),Ct(Me,W.total_in>>24&255)):(bt(Me,W.adler>>>16),bt(Me,65535&W.adler)),oe(W),0<Me.wrap&&(Me.wrap=-Me.wrap),Me.pending!==0?q:1)},I.deflateEnd=function(W){var ft;return W&&W.state?(ft=W.state.status)!==xe&&ft!==69&&ft!==73&&ft!==91&&ft!==103&&ft!==Je&&ft!==666?et(W,se):(W.state=null,ft===Je?et(W,-3):q):se},I.deflateSetDictionary=function(W,ft){var ye,Me,we,Ne,_t,Mt,nt,zt,rr=ft.length;if(!W||!W.state||(Ne=(ye=W.state).wrap)===2||Ne===1&&ye.status!==xe||ye.lookahead)return se;for(Ne===1&&(W.adler=B(W.adler,ft,rr,0)),ye.wrap=0,rr>=ye.w_size&&(Ne===0&&(ht(ye.head),ye.strstart=0,ye.block_start=0,ye.insert=0),zt=new E.Buf8(ye.w_size),E.arraySet(zt,ft,rr-ye.w_size,ye.w_size,0),ft=zt,rr=ye.w_size),_t=W.avail_in,Mt=W.next_in,nt=W.input,W.avail_in=rr,W.next_in=0,W.input=ft,ar(ye);ye.lookahead>=ot;){for(Me=ye.strstart,we=ye.lookahead-(ot-1);ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[Me+ot-1])&ye.hash_mask,ye.prev[Me&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=Me,Me++,--we;);ye.strstart=Me,ye.lookahead=ot-1,ar(ye)}return ye.strstart+=ye.lookahead,ye.block_start=ye.strstart,ye.insert=ye.lookahead,ye.lookahead=0,ye.match_length=ye.prev_length=ot-1,ye.match_available=0,W.next_in=Mt,W.input=nt,W.avail_in=_t,ye.wrap=Ne,q},I.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(v,C,I){C.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(v,C,I){C.exports=function(z,E){var u,B,U,K,j,N,q,se,J,ae,re,pe,ge,Fe,ve,qe,je,St,ot,At,xt,xe,Je,G,Ve;u=z.state,B=z.next_in,G=z.input,U=B+(z.avail_in-5),K=z.next_out,Ve=z.output,j=K-(E-z.avail_out),N=K+(z.avail_out-257),q=u.dmax,se=u.wsize,J=u.whave,ae=u.wnext,re=u.window,pe=u.hold,ge=u.bits,Fe=u.lencode,ve=u.distcode,qe=(1<<u.lenbits)-1,je=(1<<u.distbits)-1;e:do{ge<15&&(pe+=G[B++]<<ge,ge+=8,pe+=G[B++]<<ge,ge+=8),St=Fe[pe&qe];t:for(;;){if(pe>>>=ot=St>>>24,ge-=ot,(ot=St>>>16&255)===0)Ve[K++]=65535&St;else{if(!(16&ot)){if((64&ot)==0){St=Fe[(65535&St)+(pe&(1<<ot)-1)];continue t}if(32&ot){u.mode=12;break e}z.msg="invalid literal/length code",u.mode=30;break e}At=65535&St,(ot&=15)&&(ge<ot&&(pe+=G[B++]<<ge,ge+=8),At+=pe&(1<<ot)-1,pe>>>=ot,ge-=ot),ge<15&&(pe+=G[B++]<<ge,ge+=8,pe+=G[B++]<<ge,ge+=8),St=ve[pe&je];r:for(;;){if(pe>>>=ot=St>>>24,ge-=ot,!(16&(ot=St>>>16&255))){if((64&ot)==0){St=ve[(65535&St)+(pe&(1<<ot)-1)];continue r}z.msg="invalid distance code",u.mode=30;break e}if(xt=65535&St,ge<(ot&=15)&&(pe+=G[B++]<<ge,(ge+=8)<ot&&(pe+=G[B++]<<ge,ge+=8)),q<(xt+=pe&(1<<ot)-1)){z.msg="invalid distance too far back",u.mode=30;break e}if(pe>>>=ot,ge-=ot,(ot=K-j)<xt){if(J<(ot=xt-ot)&&u.sane){z.msg="invalid distance too far back",u.mode=30;break e}if(Je=re,(xe=0)===ae){if(xe+=se-ot,ot<At){for(At-=ot;Ve[K++]=re[xe++],--ot;);xe=K-xt,Je=Ve}}else if(ae<ot){if(xe+=se+ae-ot,(ot-=ae)<At){for(At-=ot;Ve[K++]=re[xe++],--ot;);if(xe=0,ae<At){for(At-=ot=ae;Ve[K++]=re[xe++],--ot;);xe=K-xt,Je=Ve}}}else if(xe+=ae-ot,ot<At){for(At-=ot;Ve[K++]=re[xe++],--ot;);xe=K-xt,Je=Ve}for(;2<At;)Ve[K++]=Je[xe++],Ve[K++]=Je[xe++],Ve[K++]=Je[xe++],At-=3;At&&(Ve[K++]=Je[xe++],1<At&&(Ve[K++]=Je[xe++]))}else{for(xe=K-xt;Ve[K++]=Ve[xe++],Ve[K++]=Ve[xe++],Ve[K++]=Ve[xe++],2<(At-=3););At&&(Ve[K++]=Ve[xe++],1<At&&(Ve[K++]=Ve[xe++]))}break}}break}}while(B<U&&K<N);B-=At=ge>>3,pe&=(1<<(ge-=At<<3))-1,z.next_in=B,z.next_out=K,z.avail_in=B<U?U-B+5:5-(B-U),z.avail_out=K<N?N-K+257:257-(K-N),u.hold=pe,u.bits=ge}},{}],49:[function(v,C,I){var z=v("../utils/common"),E=v("./adler32"),u=v("./crc32"),B=v("./inffast"),U=v("./inftrees"),K=1,j=2,N=0,q=-2,se=1,J=852,ae=592;function re(xe){return(xe>>>24&255)+(xe>>>8&65280)+((65280&xe)<<8)+((255&xe)<<24)}function pe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new z.Buf16(320),this.work=new z.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ge(xe){var Je;return xe&&xe.state?(Je=xe.state,xe.total_in=xe.total_out=Je.total=0,xe.msg="",Je.wrap&&(xe.adler=1&Je.wrap),Je.mode=se,Je.last=0,Je.havedict=0,Je.dmax=32768,Je.head=null,Je.hold=0,Je.bits=0,Je.lencode=Je.lendyn=new z.Buf32(J),Je.distcode=Je.distdyn=new z.Buf32(ae),Je.sane=1,Je.back=-1,N):q}function Fe(xe){var Je;return xe&&xe.state?((Je=xe.state).wsize=0,Je.whave=0,Je.wnext=0,ge(xe)):q}function ve(xe,Je){var G,Ve;return xe&&xe.state?(Ve=xe.state,Je<0?(G=0,Je=-Je):(G=1+(Je>>4),Je<48&&(Je&=15)),Je&&(Je<8||15<Je)?q:(Ve.window!==null&&Ve.wbits!==Je&&(Ve.window=null),Ve.wrap=G,Ve.wbits=Je,Fe(xe))):q}function qe(xe,Je){var G,Ve;return xe?(Ve=new pe,(xe.state=Ve).window=null,(G=ve(xe,Je))!==N&&(xe.state=null),G):q}var je,St,ot=!0;function At(xe){if(ot){var Je;for(je=new z.Buf32(512),St=new z.Buf32(32),Je=0;Je<144;)xe.lens[Je++]=8;for(;Je<256;)xe.lens[Je++]=9;for(;Je<280;)xe.lens[Je++]=7;for(;Je<288;)xe.lens[Je++]=8;for(U(K,xe.lens,0,288,je,0,xe.work,{bits:9}),Je=0;Je<32;)xe.lens[Je++]=5;U(j,xe.lens,0,32,St,0,xe.work,{bits:5}),ot=!1}xe.lencode=je,xe.lenbits=9,xe.distcode=St,xe.distbits=5}function xt(xe,Je,G,Ve){var Rt,Ae=xe.state;return Ae.window===null&&(Ae.wsize=1<<Ae.wbits,Ae.wnext=0,Ae.whave=0,Ae.window=new z.Buf8(Ae.wsize)),Ve>=Ae.wsize?(z.arraySet(Ae.window,Je,G-Ae.wsize,Ae.wsize,0),Ae.wnext=0,Ae.whave=Ae.wsize):(Ve<(Rt=Ae.wsize-Ae.wnext)&&(Rt=Ve),z.arraySet(Ae.window,Je,G-Ve,Rt,Ae.wnext),(Ve-=Rt)?(z.arraySet(Ae.window,Je,G-Ve,Ve,0),Ae.wnext=Ve,Ae.whave=Ae.wsize):(Ae.wnext+=Rt,Ae.wnext===Ae.wsize&&(Ae.wnext=0),Ae.whave<Ae.wsize&&(Ae.whave+=Rt))),0}I.inflateReset=Fe,I.inflateReset2=ve,I.inflateResetKeep=ge,I.inflateInit=function(xe){return qe(xe,15)},I.inflateInit2=qe,I.inflate=function(xe,Je){var G,Ve,Rt,Ae,et,Ze,ht,oe,_e,Ct,bt,wt,ar,fr,qt,Kt,Cr,Br,Yr,Zr,W,ft,ye,Me,we=0,Ne=new z.Buf8(4),_t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!xe||!xe.state||!xe.output||!xe.input&&xe.avail_in!==0)return q;(G=xe.state).mode===12&&(G.mode=13),et=xe.next_out,Rt=xe.output,ht=xe.avail_out,Ae=xe.next_in,Ve=xe.input,Ze=xe.avail_in,oe=G.hold,_e=G.bits,Ct=Ze,bt=ht,ft=N;e:for(;;)switch(G.mode){case se:if(G.wrap===0){G.mode=13;break}for(;_e<16;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(2&G.wrap&&oe===35615){Ne[G.check=0]=255&oe,Ne[1]=oe>>>8&255,G.check=u(G.check,Ne,2,0),_e=oe=0,G.mode=2;break}if(G.flags=0,G.head&&(G.head.done=!1),!(1&G.wrap)||(((255&oe)<<8)+(oe>>8))%31){xe.msg="incorrect header check",G.mode=30;break}if((15&oe)!=8){xe.msg="unknown compression method",G.mode=30;break}if(_e-=4,W=8+(15&(oe>>>=4)),G.wbits===0)G.wbits=W;else if(W>G.wbits){xe.msg="invalid window size",G.mode=30;break}G.dmax=1<<W,xe.adler=G.check=1,G.mode=512&oe?10:12,_e=oe=0;break;case 2:for(;_e<16;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(G.flags=oe,(255&G.flags)!=8){xe.msg="unknown compression method",G.mode=30;break}if(57344&G.flags){xe.msg="unknown header flags set",G.mode=30;break}G.head&&(G.head.text=oe>>8&1),512&G.flags&&(Ne[0]=255&oe,Ne[1]=oe>>>8&255,G.check=u(G.check,Ne,2,0)),_e=oe=0,G.mode=3;case 3:for(;_e<32;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.head&&(G.head.time=oe),512&G.flags&&(Ne[0]=255&oe,Ne[1]=oe>>>8&255,Ne[2]=oe>>>16&255,Ne[3]=oe>>>24&255,G.check=u(G.check,Ne,4,0)),_e=oe=0,G.mode=4;case 4:for(;_e<16;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.head&&(G.head.xflags=255&oe,G.head.os=oe>>8),512&G.flags&&(Ne[0]=255&oe,Ne[1]=oe>>>8&255,G.check=u(G.check,Ne,2,0)),_e=oe=0,G.mode=5;case 5:if(1024&G.flags){for(;_e<16;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.length=oe,G.head&&(G.head.extra_len=oe),512&G.flags&&(Ne[0]=255&oe,Ne[1]=oe>>>8&255,G.check=u(G.check,Ne,2,0)),_e=oe=0}else G.head&&(G.head.extra=null);G.mode=6;case 6:if(1024&G.flags&&(Ze<(wt=G.length)&&(wt=Ze),wt&&(G.head&&(W=G.head.extra_len-G.length,G.head.extra||(G.head.extra=new Array(G.head.extra_len)),z.arraySet(G.head.extra,Ve,Ae,wt,W)),512&G.flags&&(G.check=u(G.check,Ve,wt,Ae)),Ze-=wt,Ae+=wt,G.length-=wt),G.length))break e;G.length=0,G.mode=7;case 7:if(2048&G.flags){if(Ze===0)break e;for(wt=0;W=Ve[Ae+wt++],G.head&&W&&G.length<65536&&(G.head.name+=String.fromCharCode(W)),W&&wt<Ze;);if(512&G.flags&&(G.check=u(G.check,Ve,wt,Ae)),Ze-=wt,Ae+=wt,W)break e}else G.head&&(G.head.name=null);G.length=0,G.mode=8;case 8:if(4096&G.flags){if(Ze===0)break e;for(wt=0;W=Ve[Ae+wt++],G.head&&W&&G.length<65536&&(G.head.comment+=String.fromCharCode(W)),W&&wt<Ze;);if(512&G.flags&&(G.check=u(G.check,Ve,wt,Ae)),Ze-=wt,Ae+=wt,W)break e}else G.head&&(G.head.comment=null);G.mode=9;case 9:if(512&G.flags){for(;_e<16;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(oe!==(65535&G.check)){xe.msg="header crc mismatch",G.mode=30;break}_e=oe=0}G.head&&(G.head.hcrc=G.flags>>9&1,G.head.done=!0),xe.adler=G.check=0,G.mode=12;break;case 10:for(;_e<32;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}xe.adler=G.check=re(oe),_e=oe=0,G.mode=11;case 11:if(G.havedict===0)return xe.next_out=et,xe.avail_out=ht,xe.next_in=Ae,xe.avail_in=Ze,G.hold=oe,G.bits=_e,2;xe.adler=G.check=1,G.mode=12;case 12:if(Je===5||Je===6)break e;case 13:if(G.last){oe>>>=7&_e,_e-=7&_e,G.mode=27;break}for(;_e<3;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}switch(G.last=1&oe,_e-=1,3&(oe>>>=1)){case 0:G.mode=14;break;case 1:if(At(G),G.mode=20,Je!==6)break;oe>>>=2,_e-=2;break e;case 2:G.mode=17;break;case 3:xe.msg="invalid block type",G.mode=30}oe>>>=2,_e-=2;break;case 14:for(oe>>>=7&_e,_e-=7&_e;_e<32;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if((65535&oe)!=(oe>>>16^65535)){xe.msg="invalid stored block lengths",G.mode=30;break}if(G.length=65535&oe,_e=oe=0,G.mode=15,Je===6)break e;case 15:G.mode=16;case 16:if(wt=G.length){if(Ze<wt&&(wt=Ze),ht<wt&&(wt=ht),wt===0)break e;z.arraySet(Rt,Ve,Ae,wt,et),Ze-=wt,Ae+=wt,ht-=wt,et+=wt,G.length-=wt;break}G.mode=12;break;case 17:for(;_e<14;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(G.nlen=257+(31&oe),oe>>>=5,_e-=5,G.ndist=1+(31&oe),oe>>>=5,_e-=5,G.ncode=4+(15&oe),oe>>>=4,_e-=4,286<G.nlen||30<G.ndist){xe.msg="too many length or distance symbols",G.mode=30;break}G.have=0,G.mode=18;case 18:for(;G.have<G.ncode;){for(;_e<3;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.lens[_t[G.have++]]=7&oe,oe>>>=3,_e-=3}for(;G.have<19;)G.lens[_t[G.have++]]=0;if(G.lencode=G.lendyn,G.lenbits=7,ye={bits:G.lenbits},ft=U(0,G.lens,0,19,G.lencode,0,G.work,ye),G.lenbits=ye.bits,ft){xe.msg="invalid code lengths set",G.mode=30;break}G.have=0,G.mode=19;case 19:for(;G.have<G.nlen+G.ndist;){for(;Kt=(we=G.lencode[oe&(1<<G.lenbits)-1])>>>16&255,Cr=65535&we,!((qt=we>>>24)<=_e);){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(Cr<16)oe>>>=qt,_e-=qt,G.lens[G.have++]=Cr;else{if(Cr===16){for(Me=qt+2;_e<Me;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(oe>>>=qt,_e-=qt,G.have===0){xe.msg="invalid bit length repeat",G.mode=30;break}W=G.lens[G.have-1],wt=3+(3&oe),oe>>>=2,_e-=2}else if(Cr===17){for(Me=qt+3;_e<Me;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}_e-=qt,W=0,wt=3+(7&(oe>>>=qt)),oe>>>=3,_e-=3}else{for(Me=qt+7;_e<Me;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}_e-=qt,W=0,wt=11+(127&(oe>>>=qt)),oe>>>=7,_e-=7}if(G.have+wt>G.nlen+G.ndist){xe.msg="invalid bit length repeat",G.mode=30;break}for(;wt--;)G.lens[G.have++]=W}}if(G.mode===30)break;if(G.lens[256]===0){xe.msg="invalid code -- missing end-of-block",G.mode=30;break}if(G.lenbits=9,ye={bits:G.lenbits},ft=U(K,G.lens,0,G.nlen,G.lencode,0,G.work,ye),G.lenbits=ye.bits,ft){xe.msg="invalid literal/lengths set",G.mode=30;break}if(G.distbits=6,G.distcode=G.distdyn,ye={bits:G.distbits},ft=U(j,G.lens,G.nlen,G.ndist,G.distcode,0,G.work,ye),G.distbits=ye.bits,ft){xe.msg="invalid distances set",G.mode=30;break}if(G.mode=20,Je===6)break e;case 20:G.mode=21;case 21:if(6<=Ze&&258<=ht){xe.next_out=et,xe.avail_out=ht,xe.next_in=Ae,xe.avail_in=Ze,G.hold=oe,G.bits=_e,B(xe,bt),et=xe.next_out,Rt=xe.output,ht=xe.avail_out,Ae=xe.next_in,Ve=xe.input,Ze=xe.avail_in,oe=G.hold,_e=G.bits,G.mode===12&&(G.back=-1);break}for(G.back=0;Kt=(we=G.lencode[oe&(1<<G.lenbits)-1])>>>16&255,Cr=65535&we,!((qt=we>>>24)<=_e);){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(Kt&&(240&Kt)==0){for(Br=qt,Yr=Kt,Zr=Cr;Kt=(we=G.lencode[Zr+((oe&(1<<Br+Yr)-1)>>Br)])>>>16&255,Cr=65535&we,!(Br+(qt=we>>>24)<=_e);){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}oe>>>=Br,_e-=Br,G.back+=Br}if(oe>>>=qt,_e-=qt,G.back+=qt,G.length=Cr,Kt===0){G.mode=26;break}if(32&Kt){G.back=-1,G.mode=12;break}if(64&Kt){xe.msg="invalid literal/length code",G.mode=30;break}G.extra=15&Kt,G.mode=22;case 22:if(G.extra){for(Me=G.extra;_e<Me;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.length+=oe&(1<<G.extra)-1,oe>>>=G.extra,_e-=G.extra,G.back+=G.extra}G.was=G.length,G.mode=23;case 23:for(;Kt=(we=G.distcode[oe&(1<<G.distbits)-1])>>>16&255,Cr=65535&we,!((qt=we>>>24)<=_e);){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if((240&Kt)==0){for(Br=qt,Yr=Kt,Zr=Cr;Kt=(we=G.distcode[Zr+((oe&(1<<Br+Yr)-1)>>Br)])>>>16&255,Cr=65535&we,!(Br+(qt=we>>>24)<=_e);){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}oe>>>=Br,_e-=Br,G.back+=Br}if(oe>>>=qt,_e-=qt,G.back+=qt,64&Kt){xe.msg="invalid distance code",G.mode=30;break}G.offset=Cr,G.extra=15&Kt,G.mode=24;case 24:if(G.extra){for(Me=G.extra;_e<Me;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}G.offset+=oe&(1<<G.extra)-1,oe>>>=G.extra,_e-=G.extra,G.back+=G.extra}if(G.offset>G.dmax){xe.msg="invalid distance too far back",G.mode=30;break}G.mode=25;case 25:if(ht===0)break e;if(wt=bt-ht,G.offset>wt){if((wt=G.offset-wt)>G.whave&&G.sane){xe.msg="invalid distance too far back",G.mode=30;break}ar=wt>G.wnext?(wt-=G.wnext,G.wsize-wt):G.wnext-wt,wt>G.length&&(wt=G.length),fr=G.window}else fr=Rt,ar=et-G.offset,wt=G.length;for(ht<wt&&(wt=ht),ht-=wt,G.length-=wt;Rt[et++]=fr[ar++],--wt;);G.length===0&&(G.mode=21);break;case 26:if(ht===0)break e;Rt[et++]=G.length,ht--,G.mode=21;break;case 27:if(G.wrap){for(;_e<32;){if(Ze===0)break e;Ze--,oe|=Ve[Ae++]<<_e,_e+=8}if(bt-=ht,xe.total_out+=bt,G.total+=bt,bt&&(xe.adler=G.check=G.flags?u(G.check,Rt,bt,et-bt):E(G.check,Rt,bt,et-bt)),bt=ht,(G.flags?oe:re(oe))!==G.check){xe.msg="incorrect data check",G.mode=30;break}_e=oe=0}G.mode=28;case 28:if(G.wrap&&G.flags){for(;_e<32;){if(Ze===0)break e;Ze--,oe+=Ve[Ae++]<<_e,_e+=8}if(oe!==(4294967295&G.total)){xe.msg="incorrect length check",G.mode=30;break}_e=oe=0}G.mode=29;case 29:ft=1;break e;case 30:ft=-3;break e;case 31:return-4;case 32:default:return q}return xe.next_out=et,xe.avail_out=ht,xe.next_in=Ae,xe.avail_in=Ze,G.hold=oe,G.bits=_e,(G.wsize||bt!==xe.avail_out&&G.mode<30&&(G.mode<27||Je!==4))&&xt(xe,xe.output,xe.next_out,bt-xe.avail_out)?(G.mode=31,-4):(Ct-=xe.avail_in,bt-=xe.avail_out,xe.total_in+=Ct,xe.total_out+=bt,G.total+=bt,G.wrap&&bt&&(xe.adler=G.check=G.flags?u(G.check,Rt,bt,xe.next_out-bt):E(G.check,Rt,bt,xe.next_out-bt)),xe.data_type=G.bits+(G.last?64:0)+(G.mode===12?128:0)+(G.mode===20||G.mode===15?256:0),(Ct==0&&bt===0||Je===4)&&ft===N&&(ft=-5),ft)},I.inflateEnd=function(xe){if(!xe||!xe.state)return q;var Je=xe.state;return Je.window&&(Je.window=null),xe.state=null,N},I.inflateGetHeader=function(xe,Je){var G;return xe&&xe.state?(2&(G=xe.state).wrap)==0?q:((G.head=Je).done=!1,N):q},I.inflateSetDictionary=function(xe,Je){var G,Ve=Je.length;return xe&&xe.state?(G=xe.state).wrap!==0&&G.mode!==11?q:G.mode===11&&E(1,Je,Ve,0)!==G.check?-3:xt(xe,Je,Ve,Ve)?(G.mode=31,-4):(G.havedict=1,N):q},I.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(v,C,I){var z=v("../utils/common"),E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],U=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];C.exports=function(K,j,N,q,se,J,ae,re){var pe,ge,Fe,ve,qe,je,St,ot,At,xt=re.bits,xe=0,Je=0,G=0,Ve=0,Rt=0,Ae=0,et=0,Ze=0,ht=0,oe=0,_e=null,Ct=0,bt=new z.Buf16(16),wt=new z.Buf16(16),ar=null,fr=0;for(xe=0;xe<=15;xe++)bt[xe]=0;for(Je=0;Je<q;Je++)bt[j[N+Je]]++;for(Rt=xt,Ve=15;1<=Ve&&bt[Ve]===0;Ve--);if(Ve<Rt&&(Rt=Ve),Ve===0)return se[J++]=20971520,se[J++]=20971520,re.bits=1,0;for(G=1;G<Ve&&bt[G]===0;G++);for(Rt<G&&(Rt=G),xe=Ze=1;xe<=15;xe++)if(Ze<<=1,(Ze-=bt[xe])<0)return-1;if(0<Ze&&(K===0||Ve!==1))return-1;for(wt[1]=0,xe=1;xe<15;xe++)wt[xe+1]=wt[xe]+bt[xe];for(Je=0;Je<q;Je++)j[N+Je]!==0&&(ae[wt[j[N+Je]]++]=Je);if(je=K===0?(_e=ar=ae,19):K===1?(_e=E,Ct-=257,ar=u,fr-=257,256):(_e=B,ar=U,-1),xe=G,qe=J,et=Je=oe=0,Fe=-1,ve=(ht=1<<(Ae=Rt))-1,K===1&&852<ht||K===2&&592<ht)return 1;for(;;){for(St=xe-et,At=ae[Je]<je?(ot=0,ae[Je]):ae[Je]>je?(ot=ar[fr+ae[Je]],_e[Ct+ae[Je]]):(ot=96,0),pe=1<<xe-et,G=ge=1<<Ae;se[qe+(oe>>et)+(ge-=pe)]=St<<24|ot<<16|At|0,ge!==0;);for(pe=1<<xe-1;oe&pe;)pe>>=1;if(pe!==0?(oe&=pe-1,oe+=pe):oe=0,Je++,--bt[xe]==0){if(xe===Ve)break;xe=j[N+ae[Je]]}if(Rt<xe&&(oe&ve)!==Fe){for(et===0&&(et=Rt),qe+=G,Ze=1<<(Ae=xe-et);Ae+et<Ve&&!((Ze-=bt[Ae+et])<=0);)Ae++,Ze<<=1;if(ht+=1<<Ae,K===1&&852<ht||K===2&&592<ht)return 1;se[Fe=oe&ve]=Rt<<24|Ae<<16|qe-J|0}}return oe!==0&&(se[qe+oe]=xe-et<<24|64<<16|0),re.bits=Rt,0}},{"../utils/common":41}],51:[function(v,C,I){C.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(v,C,I){var z=v("../utils/common"),E=0,u=1;function B(we){for(var Ne=we.length;0<=--Ne;)we[Ne]=0}var U=0,K=29,j=256,N=j+1+K,q=30,se=19,J=2*N+1,ae=15,re=16,pe=7,ge=256,Fe=16,ve=17,qe=18,je=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],St=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xt=new Array(2*(N+2));B(xt);var xe=new Array(2*q);B(xe);var Je=new Array(512);B(Je);var G=new Array(256);B(G);var Ve=new Array(K);B(Ve);var Rt,Ae,et,Ze=new Array(q);function ht(we,Ne,_t,Mt,nt){this.static_tree=we,this.extra_bits=Ne,this.extra_base=_t,this.elems=Mt,this.max_length=nt,this.has_stree=we&&we.length}function oe(we,Ne){this.dyn_tree=we,this.max_code=0,this.stat_desc=Ne}function _e(we){return we<256?Je[we]:Je[256+(we>>>7)]}function Ct(we,Ne){we.pending_buf[we.pending++]=255&Ne,we.pending_buf[we.pending++]=Ne>>>8&255}function bt(we,Ne,_t){we.bi_valid>re-_t?(we.bi_buf|=Ne<<we.bi_valid&65535,Ct(we,we.bi_buf),we.bi_buf=Ne>>re-we.bi_valid,we.bi_valid+=_t-re):(we.bi_buf|=Ne<<we.bi_valid&65535,we.bi_valid+=_t)}function wt(we,Ne,_t){bt(we,_t[2*Ne],_t[2*Ne+1])}function ar(we,Ne){for(var _t=0;_t|=1&we,we>>>=1,_t<<=1,0<--Ne;);return _t>>>1}function fr(we,Ne,_t){var Mt,nt,zt=new Array(ae+1),rr=0;for(Mt=1;Mt<=ae;Mt++)zt[Mt]=rr=rr+_t[Mt-1]<<1;for(nt=0;nt<=Ne;nt++){var Lt=we[2*nt+1];Lt!==0&&(we[2*nt]=ar(zt[Lt]++,Lt))}}function qt(we){var Ne;for(Ne=0;Ne<N;Ne++)we.dyn_ltree[2*Ne]=0;for(Ne=0;Ne<q;Ne++)we.dyn_dtree[2*Ne]=0;for(Ne=0;Ne<se;Ne++)we.bl_tree[2*Ne]=0;we.dyn_ltree[2*ge]=1,we.opt_len=we.static_len=0,we.last_lit=we.matches=0}function Kt(we){8<we.bi_valid?Ct(we,we.bi_buf):0<we.bi_valid&&(we.pending_buf[we.pending++]=we.bi_buf),we.bi_buf=0,we.bi_valid=0}function Cr(we,Ne,_t,Mt){var nt=2*Ne,zt=2*_t;return we[nt]<we[zt]||we[nt]===we[zt]&&Mt[Ne]<=Mt[_t]}function Br(we,Ne,_t){for(var Mt=we.heap[_t],nt=_t<<1;nt<=we.heap_len&&(nt<we.heap_len&&Cr(Ne,we.heap[nt+1],we.heap[nt],we.depth)&&nt++,!Cr(Ne,Mt,we.heap[nt],we.depth));)we.heap[_t]=we.heap[nt],_t=nt,nt<<=1;we.heap[_t]=Mt}function Yr(we,Ne,_t){var Mt,nt,zt,rr,Lt=0;if(we.last_lit!==0)for(;Mt=we.pending_buf[we.d_buf+2*Lt]<<8|we.pending_buf[we.d_buf+2*Lt+1],nt=we.pending_buf[we.l_buf+Lt],Lt++,Mt===0?wt(we,nt,Ne):(wt(we,(zt=G[nt])+j+1,Ne),(rr=je[zt])!==0&&bt(we,nt-=Ve[zt],rr),wt(we,zt=_e(--Mt),_t),(rr=St[zt])!==0&&bt(we,Mt-=Ze[zt],rr)),Lt<we.last_lit;);wt(we,ge,Ne)}function Zr(we,Ne){var _t,Mt,nt,zt=Ne.dyn_tree,rr=Ne.stat_desc.static_tree,Lt=Ne.stat_desc.has_stree,_r=Ne.stat_desc.elems,en=-1;for(we.heap_len=0,we.heap_max=J,_t=0;_t<_r;_t++)zt[2*_t]!==0?(we.heap[++we.heap_len]=en=_t,we.depth[_t]=0):zt[2*_t+1]=0;for(;we.heap_len<2;)zt[2*(nt=we.heap[++we.heap_len]=en<2?++en:0)]=1,we.depth[nt]=0,we.opt_len--,Lt&&(we.static_len-=rr[2*nt+1]);for(Ne.max_code=en,_t=we.heap_len>>1;1<=_t;_t--)Br(we,zt,_t);for(nt=_r;_t=we.heap[1],we.heap[1]=we.heap[we.heap_len--],Br(we,zt,1),Mt=we.heap[1],we.heap[--we.heap_max]=_t,we.heap[--we.heap_max]=Mt,zt[2*nt]=zt[2*_t]+zt[2*Mt],we.depth[nt]=(we.depth[_t]>=we.depth[Mt]?we.depth[_t]:we.depth[Mt])+1,zt[2*_t+1]=zt[2*Mt+1]=nt,we.heap[1]=nt++,Br(we,zt,1),2<=we.heap_len;);we.heap[--we.heap_max]=we.heap[1],function(vt,xn){var yn,wn,ui,Pt,zr,wr,_n=xn.dyn_tree,ci=xn.max_code,Ir=xn.stat_desc.static_tree,An=xn.stat_desc.has_stree,wi=xn.stat_desc.extra_bits,Xn=xn.stat_desc.extra_base,Nr=xn.stat_desc.max_length,Ce=0;for(Pt=0;Pt<=ae;Pt++)vt.bl_count[Pt]=0;for(_n[2*vt.heap[vt.heap_max]+1]=0,yn=vt.heap_max+1;yn<J;yn++)Nr<(Pt=_n[2*_n[2*(wn=vt.heap[yn])+1]+1]+1)&&(Pt=Nr,Ce++),_n[2*wn+1]=Pt,ci<wn||(vt.bl_count[Pt]++,zr=0,Xn<=wn&&(zr=wi[wn-Xn]),wr=_n[2*wn],vt.opt_len+=wr*(Pt+zr),An&&(vt.static_len+=wr*(Ir[2*wn+1]+zr)));if(Ce!==0){do{for(Pt=Nr-1;vt.bl_count[Pt]===0;)Pt--;vt.bl_count[Pt]--,vt.bl_count[Pt+1]+=2,vt.bl_count[Nr]--,Ce-=2}while(0<Ce);for(Pt=Nr;Pt!==0;Pt--)for(wn=vt.bl_count[Pt];wn!==0;)ci<(ui=vt.heap[--yn])||(_n[2*ui+1]!==Pt&&(vt.opt_len+=(Pt-_n[2*ui+1])*_n[2*ui],_n[2*ui+1]=Pt),wn--)}}(we,Ne),fr(zt,en,we.bl_count)}function W(we,Ne,_t){var Mt,nt,zt=-1,rr=Ne[1],Lt=0,_r=7,en=4;for(rr===0&&(_r=138,en=3),Ne[2*(_t+1)+1]=65535,Mt=0;Mt<=_t;Mt++)nt=rr,rr=Ne[2*(Mt+1)+1],++Lt<_r&&nt===rr||(Lt<en?we.bl_tree[2*nt]+=Lt:nt!==0?(nt!==zt&&we.bl_tree[2*nt]++,we.bl_tree[2*Fe]++):Lt<=10?we.bl_tree[2*ve]++:we.bl_tree[2*qe]++,zt=nt,en=(Lt=0)===rr?(_r=138,3):nt===rr?(_r=6,3):(_r=7,4))}function ft(we,Ne,_t){var Mt,nt,zt=-1,rr=Ne[1],Lt=0,_r=7,en=4;for(rr===0&&(_r=138,en=3),Mt=0;Mt<=_t;Mt++)if(nt=rr,rr=Ne[2*(Mt+1)+1],!(++Lt<_r&&nt===rr)){if(Lt<en)for(;wt(we,nt,we.bl_tree),--Lt!=0;);else nt!==0?(nt!==zt&&(wt(we,nt,we.bl_tree),Lt--),wt(we,Fe,we.bl_tree),bt(we,Lt-3,2)):Lt<=10?(wt(we,ve,we.bl_tree),bt(we,Lt-3,3)):(wt(we,qe,we.bl_tree),bt(we,Lt-11,7));zt=nt,en=(Lt=0)===rr?(_r=138,3):nt===rr?(_r=6,3):(_r=7,4)}}B(Ze);var ye=!1;function Me(we,Ne,_t,Mt){bt(we,(U<<1)+(Mt?1:0),3),function(nt,zt,rr,Lt){Kt(nt),Ct(nt,rr),Ct(nt,~rr),z.arraySet(nt.pending_buf,nt.window,zt,rr,nt.pending),nt.pending+=rr}(we,Ne,_t)}I._tr_init=function(we){ye||(function(){var Ne,_t,Mt,nt,zt,rr=new Array(ae+1);for(nt=Mt=0;nt<K-1;nt++)for(Ve[nt]=Mt,Ne=0;Ne<1<<je[nt];Ne++)G[Mt++]=nt;for(G[Mt-1]=nt,nt=zt=0;nt<16;nt++)for(Ze[nt]=zt,Ne=0;Ne<1<<St[nt];Ne++)Je[zt++]=nt;for(zt>>=7;nt<q;nt++)for(Ze[nt]=zt<<7,Ne=0;Ne<1<<St[nt]-7;Ne++)Je[256+zt++]=nt;for(_t=0;_t<=ae;_t++)rr[_t]=0;for(Ne=0;Ne<=143;)xt[2*Ne+1]=8,Ne++,rr[8]++;for(;Ne<=255;)xt[2*Ne+1]=9,Ne++,rr[9]++;for(;Ne<=279;)xt[2*Ne+1]=7,Ne++,rr[7]++;for(;Ne<=287;)xt[2*Ne+1]=8,Ne++,rr[8]++;for(fr(xt,N+1,rr),Ne=0;Ne<q;Ne++)xe[2*Ne+1]=5,xe[2*Ne]=ar(Ne,5);Rt=new ht(xt,je,j+1,N,ae),Ae=new ht(xe,St,0,q,ae),et=new ht(new Array(0),ot,0,se,pe)}(),ye=!0),we.l_desc=new oe(we.dyn_ltree,Rt),we.d_desc=new oe(we.dyn_dtree,Ae),we.bl_desc=new oe(we.bl_tree,et),we.bi_buf=0,we.bi_valid=0,qt(we)},I._tr_stored_block=Me,I._tr_flush_block=function(we,Ne,_t,Mt){var nt,zt,rr=0;0<we.level?(we.strm.data_type===2&&(we.strm.data_type=function(Lt){var _r,en=4093624447;for(_r=0;_r<=31;_r++,en>>>=1)if(1&en&&Lt.dyn_ltree[2*_r]!==0)return E;if(Lt.dyn_ltree[18]!==0||Lt.dyn_ltree[20]!==0||Lt.dyn_ltree[26]!==0)return u;for(_r=32;_r<j;_r++)if(Lt.dyn_ltree[2*_r]!==0)return u;return E}(we)),Zr(we,we.l_desc),Zr(we,we.d_desc),rr=function(Lt){var _r;for(W(Lt,Lt.dyn_ltree,Lt.l_desc.max_code),W(Lt,Lt.dyn_dtree,Lt.d_desc.max_code),Zr(Lt,Lt.bl_desc),_r=se-1;3<=_r&&Lt.bl_tree[2*At[_r]+1]===0;_r--);return Lt.opt_len+=3*(_r+1)+5+5+4,_r}(we),nt=we.opt_len+3+7>>>3,(zt=we.static_len+3+7>>>3)<=nt&&(nt=zt)):nt=zt=_t+5,_t+4<=nt&&Ne!==-1?Me(we,Ne,_t,Mt):we.strategy===4||zt===nt?(bt(we,2+(Mt?1:0),3),Yr(we,xt,xe)):(bt(we,4+(Mt?1:0),3),function(Lt,_r,en,vt){var xn;for(bt(Lt,_r-257,5),bt(Lt,en-1,5),bt(Lt,vt-4,4),xn=0;xn<vt;xn++)bt(Lt,Lt.bl_tree[2*At[xn]+1],3);ft(Lt,Lt.dyn_ltree,_r-1),ft(Lt,Lt.dyn_dtree,en-1)}(we,we.l_desc.max_code+1,we.d_desc.max_code+1,rr+1),Yr(we,we.dyn_ltree,we.dyn_dtree)),qt(we),Mt&&Kt(we)},I._tr_tally=function(we,Ne,_t){return we.pending_buf[we.d_buf+2*we.last_lit]=Ne>>>8&255,we.pending_buf[we.d_buf+2*we.last_lit+1]=255&Ne,we.pending_buf[we.l_buf+we.last_lit]=255&_t,we.last_lit++,Ne===0?we.dyn_ltree[2*_t]++:(we.matches++,Ne--,we.dyn_ltree[2*(G[_t]+j+1)]++,we.dyn_dtree[2*_e(Ne)]++),we.last_lit===we.lit_bufsize-1},I._tr_align=function(we){bt(we,2,3),wt(we,ge,xt),function(Ne){Ne.bi_valid===16?(Ct(Ne,Ne.bi_buf),Ne.bi_buf=0,Ne.bi_valid=0):8<=Ne.bi_valid&&(Ne.pending_buf[Ne.pending++]=255&Ne.bi_buf,Ne.bi_buf>>=8,Ne.bi_valid-=8)}(we)}},{"../utils/common":41}],53:[function(v,C,I){C.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(v,C,I){(function(z){(function(E,u){if(!E.setImmediate){var B,U,K,j,N=1,q={},se=!1,J=E.document,ae=Object.getPrototypeOf&&Object.getPrototypeOf(E);ae=ae&&ae.setTimeout?ae:E,B={}.toString.call(E.process)==="[object process]"?function(Fe){process.nextTick(function(){pe(Fe)})}:function(){if(E.postMessage&&!E.importScripts){var Fe=!0,ve=E.onmessage;return E.onmessage=function(){Fe=!1},E.postMessage("","*"),E.onmessage=ve,Fe}}()?(j="setImmediate$"+Math.random()+"$",E.addEventListener?E.addEventListener("message",ge,!1):E.attachEvent("onmessage",ge),function(Fe){E.postMessage(j+Fe,"*")}):E.MessageChannel?((K=new MessageChannel).port1.onmessage=function(Fe){pe(Fe.data)},function(Fe){K.port2.postMessage(Fe)}):J&&"onreadystatechange"in J.createElement("script")?(U=J.documentElement,function(Fe){var ve=J.createElement("script");ve.onreadystatechange=function(){pe(Fe),ve.onreadystatechange=null,U.removeChild(ve),ve=null},U.appendChild(ve)}):function(Fe){setTimeout(pe,0,Fe)},ae.setImmediate=function(Fe){typeof Fe!="function"&&(Fe=new Function(""+Fe));for(var ve=new Array(arguments.length-1),qe=0;qe<ve.length;qe++)ve[qe]=arguments[qe+1];var je={callback:Fe,args:ve};return q[N]=je,B(N),N++},ae.clearImmediate=re}function re(Fe){delete q[Fe]}function pe(Fe){if(se)setTimeout(pe,0,Fe);else{var ve=q[Fe];if(ve){se=!0;try{(function(qe){var je=qe.callback,St=qe.args;switch(St.length){case 0:je();break;case 1:je(St[0]);break;case 2:je(St[0],St[1]);break;case 3:je(St[0],St[1],St[2]);break;default:je.apply(u,St)}})(ve)}finally{re(Fe),se=!1}}}}function ge(Fe){Fe.source===E&&typeof Fe.data=="string"&&Fe.data.indexOf(j)===0&&pe(+Fe.data.slice(j.length))}})(typeof self>"u"?z===void 0?this:z:self)}).call(this,typeof sc<"u"?sc:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(nm)),nm.exports}var ix=nx();const r_=ld(ix);var rp={exports:{}},sx=rp.exports,Bg;function ox(){return Bg||(Bg=1,function(d,x){(function(v,C){C()})(sx,function(){function v(U,K){return typeof K>"u"?K={autoBom:!1}:typeof K!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),K={autoBom:!K}),K.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(U.type)?new Blob(["\uFEFF",U],{type:U.type}):U}function C(U,K,j){var N=new XMLHttpRequest;N.open("GET",U),N.responseType="blob",N.onload=function(){B(N.response,K,j)},N.onerror=function(){console.error("could not download file")},N.send()}function I(U){var K=new XMLHttpRequest;K.open("HEAD",U,!1);try{K.send()}catch{}return 200<=K.status&&299>=K.status}function z(U){try{U.dispatchEvent(new MouseEvent("click"))}catch{var K=document.createEvent("MouseEvents");K.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),U.dispatchEvent(K)}}var E=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof sc=="object"&&sc.global===sc?sc:void 0,u=E.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),B=E.saveAs||(typeof window!="object"||window!==E?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(U,K,j){var N=E.URL||E.webkitURL,q=document.createElement("a");K=K||U.name||"download",q.download=K,q.rel="noopener",typeof U=="string"?(q.href=U,q.origin===location.origin?z(q):I(q.href)?C(U,K,j):z(q,q.target="_blank")):(q.href=N.createObjectURL(U),setTimeout(function(){N.revokeObjectURL(q.href)},4e4),setTimeout(function(){z(q)},0))}:"msSaveOrOpenBlob"in navigator?function(U,K,j){if(K=K||U.name||"download",typeof U!="string")navigator.msSaveOrOpenBlob(v(U,j),K);else if(I(U))C(U,K,j);else{var N=document.createElement("a");N.href=U,N.target="_blank",setTimeout(function(){z(N)})}}:function(U,K,j,N){if(N=N||open("","_blank"),N&&(N.document.title=N.document.body.innerText="downloading..."),typeof U=="string")return C(U,K,j);var q=U.type==="application/octet-stream",se=/constructor/i.test(E.HTMLElement)||E.safari,J=/CriOS\/[\d]+/.test(navigator.userAgent);if((J||q&&se||u)&&typeof FileReader<"u"){var ae=new FileReader;ae.onloadend=function(){var ge=ae.result;ge=J?ge:ge.replace(/^data:[^;]*;/,"data:attachment/file;"),N?N.location.href=ge:location=ge,N=null},ae.readAsDataURL(U)}else{var re=E.URL||E.webkitURL,pe=re.createObjectURL(U);N?N.location=pe:location.href=pe,N=null,setTimeout(function(){re.revokeObjectURL(pe)},4e4)}});E.saveAs=B.saveAs=B,d.exports=B})}(rp)),rp.exports}var ax=ox();function lx(d,x){const v=new r_,C=d.features.map(z=>z.properties.file),I=new Blob([JSON.stringify(d)],{type:"application/json"});if(v.file("data.geojson",I),x)for(const[z,E]of Object.entries(x))C.indexOf(z)>-1&&v.file(z,E);v.generateAsync({type:"blob"}).then(z=>{ax.saveAs(z,`chatmap-${Math.floor(1e4+Math.random()*9e4)}.zip`)})}function ux({data:d,dataFiles:x}){const v=()=>{lx(d,x)};return yt.jsx("button",{className:"primaryButton",onClick:v,children:yt.jsx(Yi,{id:"app.download",defaultMessage:"Download"})})}function cx({onOptionClick:d}){return yt.jsx(yt.Fragment,{children:yt.jsx("div",{className:"appNav",children:yt.jsx("button",{className:"textButton",onClick:()=>d("options"),children:yt.jsx(Yi,{id:"app.options",defaultMessage:"Options"})})})})}var Wf={exports:{}},nc={},im={exports:{}},sm,Ng;function hx(){if(Ng)return sm;Ng=1;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return sm=d,sm}var om,jg;function dx(){if(jg)return om;jg=1;var d=hx();function x(){}function v(){}return v.resetWarningCache=x,om=function(){function C(E,u,B,U,K,j){if(j!==d){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}}C.isRequired=C;function I(){return C}var z={array:C,bigint:C,bool:C,func:C,number:C,object:C,string:C,symbol:C,any:C,arrayOf:I,element:C,elementType:C,instanceOf:I,node:C,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:v,resetWarningCache:x};return z.PropTypes=z,z},om}var Ug;function n_(){return Ug||(Ug=1,im.exports=dx()()),im.exports}var Xf={exports:{}},ja={},Kf={exports:{}},Vg;function i_(){return Vg||(Vg=1,function(d,x){Object.defineProperty(x,"__esModule",{value:!0}),x.default=K;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var v="none",C="contents",I=/input|select|textarea|button|object|iframe/;function z(j,N){return N.getPropertyValue("overflow")!=="visible"||j.scrollWidth<=0&&j.scrollHeight<=0}function E(j){var N=j.offsetWidth<=0&&j.offsetHeight<=0;if(N&&!j.innerHTML)return!0;try{var q=window.getComputedStyle(j),se=q.getPropertyValue("display");return N?se!==C&&z(j,q):se===v}catch{return console.warn("Failed to inspect element style"),!1}}function u(j){for(var N=j,q=j.getRootNode&&j.getRootNode();N&&N!==document.body;){if(q&&N===q&&(N=q.host.parentNode),E(N))return!1;N=N.parentNode}return!0}function B(j,N){var q=j.nodeName.toLowerCase(),se=I.test(q)&&!j.disabled||q==="a"&&j.href||N;return se&&u(j)}function U(j){var N=j.getAttribute("tabindex");N===null&&(N=void 0);var q=isNaN(N);return(q||N>=0)&&B(j,!q)}function K(j){var N=[].slice.call(j.querySelectorAll("*"),0).reduce(function(q,se){return q.concat(se.shadowRoot?K(se.shadowRoot):[se])},[]);return N.filter(U)}d.exports=x.default}(Kf,Kf.exports)),Kf.exports}var Hg;function fx(){if(Hg)return ja;Hg=1,Object.defineProperty(ja,"__esModule",{value:!0}),ja.resetState=E,ja.log=u,ja.handleBlur=B,ja.handleFocus=U,ja.markForFocusLater=K,ja.returnFocus=j,ja.popWithoutFocus=N,ja.setupScopedFocus=q,ja.teardownScopedFocus=se;var d=i_(),x=v(d);function v(J){return J&&J.__esModule?J:{default:J}}var C=[],I=null,z=!1;function E(){C=[]}function u(){}function B(){z=!0}function U(){if(z){if(z=!1,!I)return;setTimeout(function(){if(!I.contains(document.activeElement)){var J=(0,x.default)(I)[0]||I;J.focus()}},0)}}function K(){C.push(document.activeElement)}function j(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ae=null;try{C.length!==0&&(ae=C.pop(),ae.focus({preventScroll:J}));return}catch{console.warn(["You tried to return focus to",ae,"but it is not in the DOM anymore"].join(" "))}}function N(){C.length>0&&C.pop()}function q(J){I=J,window.addEventListener?(window.addEventListener("blur",B,!1),document.addEventListener("focus",U,!0)):(window.attachEvent("onBlur",B),document.attachEvent("onFocus",U))}function se(){I=null,window.addEventListener?(window.removeEventListener("blur",B),document.removeEventListener("focus",U)):(window.detachEvent("onBlur",B),document.detachEvent("onFocus",U))}return ja}var Yf={exports:{}},$g;function px(){return $g||($g=1,function(d,x){Object.defineProperty(x,"__esModule",{value:!0}),x.default=E;var v=i_(),C=I(v);function I(u){return u&&u.__esModule?u:{default:u}}function z(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return u.activeElement.shadowRoot?z(u.activeElement.shadowRoot):u.activeElement}function E(u,B){var U=(0,C.default)(u);if(!U.length){B.preventDefault();return}var K=void 0,j=B.shiftKey,N=U[0],q=U[U.length-1],se=z();if(u===se){if(!j)return;K=q}if(q===se&&!j&&(K=N),N===se&&j&&(K=q),K){B.preventDefault(),K.focus();return}var J=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),ae=J!=null&&J[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(ae){var re=U.indexOf(se);if(re>-1&&(re+=j?-1:1),K=U[re],typeof K>"u"){B.preventDefault(),K=j?q:N,K.focus();return}B.preventDefault(),K.focus()}}d.exports=x.default}(Yf,Yf.exports)),Yf.exports}var dl={},am,Gg;function mx(){if(Gg)return am;Gg=1;var d=function(){};return am=d,am}var Kl={},lm={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/var qg;function gx(){return qg||(qg=1,function(d){(function(){var x=!!(typeof window<"u"&&window.document&&window.document.createElement),v={canUseDOM:x,canUseWorkers:typeof Worker<"u",canUseEventListeners:x&&!!(window.addEventListener||window.attachEvent),canUseViewport:x&&!!window.screen};d.exports?d.exports=v:window.ExecutionEnvironment=v})()}(lm)),lm.exports}var Zg;function Om(){if(Zg)return Kl;Zg=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.canUseDOM=Kl.SafeNodeList=Kl.SafeHTMLCollection=void 0;var d=gx(),x=v(d);function v(z){return z&&z.__esModule?z:{default:z}}var C=x.default,I=C.canUseDOM?window.HTMLElement:{};return Kl.SafeHTMLCollection=C.canUseDOM?window.HTMLCollection:{},Kl.SafeNodeList=C.canUseDOM?window.NodeList:{},Kl.canUseDOM=C.canUseDOM,Kl.default=I,Kl}var Wg;function s_(){if(Wg)return dl;Wg=1,Object.defineProperty(dl,"__esModule",{value:!0}),dl.resetState=z,dl.log=E,dl.assertNodeList=u,dl.setElement=B,dl.validateElement=U,dl.hide=K,dl.show=j,dl.documentNotReadyOrSSRTesting=N;var d=mx(),x=C(d),v=Om();function C(q){return q&&q.__esModule?q:{default:q}}var I=null;function z(){I&&(I.removeAttribute?I.removeAttribute("aria-hidden"):I.length!=null?I.forEach(function(q){return q.removeAttribute("aria-hidden")}):document.querySelectorAll(I).forEach(function(q){return q.removeAttribute("aria-hidden")})),I=null}function E(){}function u(q,se){if(!q||!q.length)throw new Error("react-modal: No elements were found for selector "+se+".")}function B(q){var se=q;if(typeof se=="string"&&v.canUseDOM){var J=document.querySelectorAll(se);u(J,se),se=J}return I=se||I,I}function U(q){var se=q||I;return se?Array.isArray(se)||se instanceof HTMLCollection||se instanceof NodeList?se:[se]:((0,x.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function K(q){var se=!0,J=!1,ae=void 0;try{for(var re=U(q)[Symbol.iterator](),pe;!(se=(pe=re.next()).done);se=!0){var ge=pe.value;ge.setAttribute("aria-hidden","true")}}catch(Fe){J=!0,ae=Fe}finally{try{!se&&re.return&&re.return()}finally{if(J)throw ae}}}function j(q){var se=!0,J=!1,ae=void 0;try{for(var re=U(q)[Symbol.iterator](),pe;!(se=(pe=re.next()).done);se=!0){var ge=pe.value;ge.removeAttribute("aria-hidden")}}catch(Fe){J=!0,ae=Fe}finally{try{!se&&re.return&&re.return()}finally{if(J)throw ae}}}function N(){I=null}return dl}var nh={},Xg;function yx(){if(Xg)return nh;Xg=1,Object.defineProperty(nh,"__esModule",{value:!0}),nh.resetState=C,nh.log=I;var d={},x={};function v(U,K){U.classList.remove(K)}function C(){var U=document.getElementsByTagName("html")[0];for(var K in d)v(U,d[K]);var j=document.body;for(var N in x)v(j,x[N]);d={},x={}}function I(){}var z=function(K,j){return K[j]||(K[j]=0),K[j]+=1,j},E=function(K,j){return K[j]&&(K[j]-=1),j},u=function(K,j,N){N.forEach(function(q){z(j,q),K.add(q)})},B=function(K,j,N){N.forEach(function(q){E(j,q),j[q]===0&&K.remove(q)})};return nh.add=function(K,j){return u(K.classList,K.nodeName.toLowerCase()=="html"?d:x,j.split(" "))},nh.remove=function(K,j){return B(K.classList,K.nodeName.toLowerCase()=="html"?d:x,j.split(" "))},nh}var Jh={},Kg;function o_(){if(Kg)return Jh;Kg=1,Object.defineProperty(Jh,"__esModule",{value:!0}),Jh.log=C,Jh.resetState=I;function d(z,E){if(!(z instanceof E))throw new TypeError("Cannot call a class as a function")}var x=function z(){var E=this;d(this,z),this.register=function(u){E.openInstances.indexOf(u)===-1&&(E.openInstances.push(u),E.emit("register"))},this.deregister=function(u){var B=E.openInstances.indexOf(u);B!==-1&&(E.openInstances.splice(B,1),E.emit("deregister"))},this.subscribe=function(u){E.subscribers.push(u)},this.emit=function(u){E.subscribers.forEach(function(B){return B(u,E.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},v=new x;function C(){console.log("portalOpenInstances ----------"),console.log(v.openInstances.length),v.openInstances.forEach(function(z){return console.log(z)}),console.log("end portalOpenInstances ----------")}function I(){v=new x}return Jh.default=v,Jh}var Hd={},Yg;function _x(){if(Yg)return Hd;Yg=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.resetState=E,Hd.log=u;var d=o_(),x=v(d);function v(K){return K&&K.__esModule?K:{default:K}}var C=void 0,I=void 0,z=[];function E(){for(var K=[C,I],j=0;j<K.length;j++){var N=K[j];N&&N.parentNode&&N.parentNode.removeChild(N)}C=I=null,z=[]}function u(){console.log("bodyTrap ----------"),console.log(z.length);for(var K=[C,I],j=0;j<K.length;j++){var N=K[j],q=N||{};console.log(q.nodeName,q.className,q.id)}console.log("edn bodyTrap ----------")}function B(){z.length!==0&&z[z.length-1].focusContent()}function U(K,j){!C&&!I&&(C=document.createElement("div"),C.setAttribute("data-react-modal-body-trap",""),C.style.position="absolute",C.style.opacity="0",C.setAttribute("tabindex","0"),C.addEventListener("focus",B),I=C.cloneNode(),I.addEventListener("focus",B)),z=j,z.length>0?(document.body.firstChild!==C&&document.body.insertBefore(C,document.body.firstChild),document.body.lastChild!==I&&document.body.appendChild(I)):(C.parentElement&&C.parentElement.removeChild(C),I.parentElement&&I.parentElement.removeChild(I))}return x.default.subscribe(U),Hd}var Jg;function vx(){return Jg||(Jg=1,function(d,x){Object.defineProperty(x,"__esModule",{value:!0});var v=Object.assign||function(G){for(var Ve=1;Ve<arguments.length;Ve++){var Rt=arguments[Ve];for(var Ae in Rt)Object.prototype.hasOwnProperty.call(Rt,Ae)&&(G[Ae]=Rt[Ae])}return G},C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},I=function(){function G(Ve,Rt){for(var Ae=0;Ae<Rt.length;Ae++){var et=Rt[Ae];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(Ve,et.key,et)}}return function(Ve,Rt,Ae){return Rt&&G(Ve.prototype,Rt),Ae&&G(Ve,Ae),Ve}}(),z=ch(),E=n_(),u=ve(E),B=fx(),U=Fe(B),K=px(),j=ve(K),N=s_(),q=Fe(N),se=yx(),J=Fe(se),ae=Om(),re=ve(ae),pe=o_(),ge=ve(pe);_x();function Fe(G){if(G&&G.__esModule)return G;var Ve={};if(G!=null)for(var Rt in G)Object.prototype.hasOwnProperty.call(G,Rt)&&(Ve[Rt]=G[Rt]);return Ve.default=G,Ve}function ve(G){return G&&G.__esModule?G:{default:G}}function qe(G,Ve){if(!(G instanceof Ve))throw new TypeError("Cannot call a class as a function")}function je(G,Ve){if(!G)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ve&&(typeof Ve=="object"||typeof Ve=="function")?Ve:G}function St(G,Ve){if(typeof Ve!="function"&&Ve!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ve);G.prototype=Object.create(Ve&&Ve.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}}),Ve&&(Object.setPrototypeOf?Object.setPrototypeOf(G,Ve):G.__proto__=Ve)}var ot={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},At=function(Ve){return Ve.code==="Tab"||Ve.keyCode===9},xt=function(Ve){return Ve.code==="Escape"||Ve.keyCode===27},xe=0,Je=function(G){St(Ve,G);function Ve(Rt){qe(this,Ve);var Ae=je(this,(Ve.__proto__||Object.getPrototypeOf(Ve)).call(this,Rt));return Ae.setOverlayRef=function(et){Ae.overlay=et,Ae.props.overlayRef&&Ae.props.overlayRef(et)},Ae.setContentRef=function(et){Ae.content=et,Ae.props.contentRef&&Ae.props.contentRef(et)},Ae.afterClose=function(){var et=Ae.props,Ze=et.appElement,ht=et.ariaHideApp,oe=et.htmlOpenClassName,_e=et.bodyOpenClassName,Ct=et.parentSelector,bt=Ct&&Ct().ownerDocument||document;_e&&J.remove(bt.body,_e),oe&&J.remove(bt.getElementsByTagName("html")[0],oe),ht&&xe>0&&(xe-=1,xe===0&&q.show(Ze)),Ae.props.shouldFocusAfterRender&&(Ae.props.shouldReturnFocusAfterClose?(U.returnFocus(Ae.props.preventScroll),U.teardownScopedFocus()):U.popWithoutFocus()),Ae.props.onAfterClose&&Ae.props.onAfterClose(),ge.default.deregister(Ae)},Ae.open=function(){Ae.beforeOpen(),Ae.state.afterOpen&&Ae.state.beforeClose?(clearTimeout(Ae.closeTimer),Ae.setState({beforeClose:!1})):(Ae.props.shouldFocusAfterRender&&(U.setupScopedFocus(Ae.node),U.markForFocusLater()),Ae.setState({isOpen:!0},function(){Ae.openAnimationFrame=requestAnimationFrame(function(){Ae.setState({afterOpen:!0}),Ae.props.isOpen&&Ae.props.onAfterOpen&&Ae.props.onAfterOpen({overlayEl:Ae.overlay,contentEl:Ae.content})})}))},Ae.close=function(){Ae.props.closeTimeoutMS>0?Ae.closeWithTimeout():Ae.closeWithoutTimeout()},Ae.focusContent=function(){return Ae.content&&!Ae.contentHasFocus()&&Ae.content.focus({preventScroll:!0})},Ae.closeWithTimeout=function(){var et=Date.now()+Ae.props.closeTimeoutMS;Ae.setState({beforeClose:!0,closesAt:et},function(){Ae.closeTimer=setTimeout(Ae.closeWithoutTimeout,Ae.state.closesAt-Date.now())})},Ae.closeWithoutTimeout=function(){Ae.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},Ae.afterClose)},Ae.handleKeyDown=function(et){At(et)&&(0,j.default)(Ae.content,et),Ae.props.shouldCloseOnEsc&&xt(et)&&(et.stopPropagation(),Ae.requestClose(et))},Ae.handleOverlayOnClick=function(et){Ae.shouldClose===null&&(Ae.shouldClose=!0),Ae.shouldClose&&Ae.props.shouldCloseOnOverlayClick&&(Ae.ownerHandlesClose()?Ae.requestClose(et):Ae.focusContent()),Ae.shouldClose=null},Ae.handleContentOnMouseUp=function(){Ae.shouldClose=!1},Ae.handleOverlayOnMouseDown=function(et){!Ae.props.shouldCloseOnOverlayClick&&et.target==Ae.overlay&&et.preventDefault()},Ae.handleContentOnClick=function(){Ae.shouldClose=!1},Ae.handleContentOnMouseDown=function(){Ae.shouldClose=!1},Ae.requestClose=function(et){return Ae.ownerHandlesClose()&&Ae.props.onRequestClose(et)},Ae.ownerHandlesClose=function(){return Ae.props.onRequestClose},Ae.shouldBeClosed=function(){return!Ae.state.isOpen&&!Ae.state.beforeClose},Ae.contentHasFocus=function(){return document.activeElement===Ae.content||Ae.content.contains(document.activeElement)},Ae.buildClassName=function(et,Ze){var ht=(typeof Ze>"u"?"undefined":C(Ze))==="object"?Ze:{base:ot[et],afterOpen:ot[et]+"--after-open",beforeClose:ot[et]+"--before-close"},oe=ht.base;return Ae.state.afterOpen&&(oe=oe+" "+ht.afterOpen),Ae.state.beforeClose&&(oe=oe+" "+ht.beforeClose),typeof Ze=="string"&&Ze?oe+" "+Ze:oe},Ae.attributesFromObject=function(et,Ze){return Object.keys(Ze).reduce(function(ht,oe){return ht[et+"-"+oe]=Ze[oe],ht},{})},Ae.state={afterOpen:!1,beforeClose:!1},Ae.shouldClose=null,Ae.moveFromContentToOverlay=null,Ae}return I(Ve,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(Ae,et){this.props.isOpen&&!Ae.isOpen?this.open():!this.props.isOpen&&Ae.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!et.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var Ae=this.props,et=Ae.appElement,Ze=Ae.ariaHideApp,ht=Ae.htmlOpenClassName,oe=Ae.bodyOpenClassName,_e=Ae.parentSelector,Ct=_e&&_e().ownerDocument||document;oe&&J.add(Ct.body,oe),ht&&J.add(Ct.getElementsByTagName("html")[0],ht),Ze&&(xe+=1,q.hide(et)),ge.default.register(this)}},{key:"render",value:function(){var Ae=this.props,et=Ae.id,Ze=Ae.className,ht=Ae.overlayClassName,oe=Ae.defaultStyles,_e=Ae.children,Ct=Ze?{}:oe.content,bt=ht?{}:oe.overlay;if(this.shouldBeClosed())return null;var wt={ref:this.setOverlayRef,className:this.buildClassName("overlay",ht),style:v({},bt,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},ar=v({id:et,ref:this.setContentRef,style:v({},Ct,this.props.style.content),className:this.buildClassName("content",Ze),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",v({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),fr=this.props.contentElement(ar,_e);return this.props.overlayElement(wt,fr)}}]),Ve}(z.Component);Je.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},Je.propTypes={isOpen:u.default.bool.isRequired,defaultStyles:u.default.shape({content:u.default.object,overlay:u.default.object}),style:u.default.shape({content:u.default.object,overlay:u.default.object}),className:u.default.oneOfType([u.default.string,u.default.object]),overlayClassName:u.default.oneOfType([u.default.string,u.default.object]),parentSelector:u.default.func,bodyOpenClassName:u.default.string,htmlOpenClassName:u.default.string,ariaHideApp:u.default.bool,appElement:u.default.oneOfType([u.default.instanceOf(re.default),u.default.instanceOf(ae.SafeHTMLCollection),u.default.instanceOf(ae.SafeNodeList),u.default.arrayOf(u.default.instanceOf(re.default))]),onAfterOpen:u.default.func,onAfterClose:u.default.func,onRequestClose:u.default.func,closeTimeoutMS:u.default.number,shouldFocusAfterRender:u.default.bool,shouldCloseOnOverlayClick:u.default.bool,shouldReturnFocusAfterClose:u.default.bool,preventScroll:u.default.bool,role:u.default.string,contentLabel:u.default.string,aria:u.default.object,data:u.default.object,children:u.default.node,shouldCloseOnEsc:u.default.bool,overlayRef:u.default.func,contentRef:u.default.func,id:u.default.string,overlayElement:u.default.func,contentElement:u.default.func,testId:u.default.string},x.default=Je,d.exports=x.default}(Xf,Xf.exports)),Xf.exports}function a_(){var d=this.constructor.getDerivedStateFromProps(this.props,this.state);d!=null&&this.setState(d)}function l_(d){function x(v){var C=this.constructor.getDerivedStateFromProps(d,v);return C??null}this.setState(x.bind(this))}function u_(d,x){try{var v=this.props,C=this.state;this.props=d,this.state=x,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(v,C)}finally{this.props=v,this.state=C}}a_.__suppressDeprecationWarning=!0;l_.__suppressDeprecationWarning=!0;u_.__suppressDeprecationWarning=!0;function xx(d){var x=d.prototype;if(!x||!x.isReactComponent)throw new Error("Can only polyfill class components");if(typeof d.getDerivedStateFromProps!="function"&&typeof x.getSnapshotBeforeUpdate!="function")return d;var v=null,C=null,I=null;if(typeof x.componentWillMount=="function"?v="componentWillMount":typeof x.UNSAFE_componentWillMount=="function"&&(v="UNSAFE_componentWillMount"),typeof x.componentWillReceiveProps=="function"?C="componentWillReceiveProps":typeof x.UNSAFE_componentWillReceiveProps=="function"&&(C="UNSAFE_componentWillReceiveProps"),typeof x.componentWillUpdate=="function"?I="componentWillUpdate":typeof x.UNSAFE_componentWillUpdate=="function"&&(I="UNSAFE_componentWillUpdate"),v!==null||C!==null||I!==null){var z=d.displayName||d.name,E=typeof d.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+z+" uses "+E+" but also contains the following legacy lifecycles:"+(v!==null?`
  `+v:"")+(C!==null?`
  `+C:"")+(I!==null?`
  `+I:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof d.getDerivedStateFromProps=="function"&&(x.componentWillMount=a_,x.componentWillReceiveProps=l_),typeof x.getSnapshotBeforeUpdate=="function"){if(typeof x.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");x.componentWillUpdate=u_;var u=x.componentDidUpdate;x.componentDidUpdate=function(U,K,j){var N=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:j;u.call(this,U,K,N)}}return d}const wx=Object.freeze(Object.defineProperty({__proto__:null,polyfill:xx},Symbol.toStringTag,{value:"Module"})),bx=ev(wx);var Qg;function Sx(){if(Qg)return nc;Qg=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.bodyOpenClassName=nc.portalClassName=void 0;var d=Object.assign||function(xt){for(var xe=1;xe<arguments.length;xe++){var Je=arguments[xe];for(var G in Je)Object.prototype.hasOwnProperty.call(Je,G)&&(xt[G]=Je[G])}return xt},x=function(){function xt(xe,Je){for(var G=0;G<Je.length;G++){var Ve=Je[G];Ve.enumerable=Ve.enumerable||!1,Ve.configurable=!0,"value"in Ve&&(Ve.writable=!0),Object.defineProperty(xe,Ve.key,Ve)}}return function(xe,Je,G){return Je&&xt(xe.prototype,Je),G&&xt(xe,G),xe}}(),v=ch(),C=ae(v),I=Sy(),z=ae(I),E=n_(),u=ae(E),B=vx(),U=ae(B),K=s_(),j=J(K),N=Om(),q=ae(N),se=bx;function J(xt){if(xt&&xt.__esModule)return xt;var xe={};if(xt!=null)for(var Je in xt)Object.prototype.hasOwnProperty.call(xt,Je)&&(xe[Je]=xt[Je]);return xe.default=xt,xe}function ae(xt){return xt&&xt.__esModule?xt:{default:xt}}function re(xt,xe){if(!(xt instanceof xe))throw new TypeError("Cannot call a class as a function")}function pe(xt,xe){if(!xt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return xe&&(typeof xe=="object"||typeof xe=="function")?xe:xt}function ge(xt,xe){if(typeof xe!="function"&&xe!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof xe);xt.prototype=Object.create(xe&&xe.prototype,{constructor:{value:xt,enumerable:!1,writable:!0,configurable:!0}}),xe&&(Object.setPrototypeOf?Object.setPrototypeOf(xt,xe):xt.__proto__=xe)}var Fe=nc.portalClassName="ReactModalPortal",ve=nc.bodyOpenClassName="ReactModal__Body--open",qe=N.canUseDOM&&z.default.createPortal!==void 0,je=function(xe){return document.createElement(xe)},St=function(){return qe?z.default.createPortal:z.default.unstable_renderSubtreeIntoContainer};function ot(xt){return xt()}var At=function(xt){ge(xe,xt);function xe(){var Je,G,Ve,Rt;re(this,xe);for(var Ae=arguments.length,et=Array(Ae),Ze=0;Ze<Ae;Ze++)et[Ze]=arguments[Ze];return Rt=(G=(Ve=pe(this,(Je=xe.__proto__||Object.getPrototypeOf(xe)).call.apply(Je,[this].concat(et))),Ve),Ve.removePortal=function(){!qe&&z.default.unmountComponentAtNode(Ve.node);var ht=ot(Ve.props.parentSelector);ht&&ht.contains(Ve.node)?ht.removeChild(Ve.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},Ve.portalRef=function(ht){Ve.portal=ht},Ve.renderPortal=function(ht){var oe=St(),_e=oe(Ve,C.default.createElement(U.default,d({defaultStyles:xe.defaultStyles},ht)),Ve.node);Ve.portalRef(_e)},G),pe(Ve,Rt)}return x(xe,[{key:"componentDidMount",value:function(){if(N.canUseDOM){qe||(this.node=je("div")),this.node.className=this.props.portalClassName;var G=ot(this.props.parentSelector);G.appendChild(this.node),!qe&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(G){var Ve=ot(G.parentSelector),Rt=ot(this.props.parentSelector);return{prevParent:Ve,nextParent:Rt}}},{key:"componentDidUpdate",value:function(G,Ve,Rt){if(N.canUseDOM){var Ae=this.props,et=Ae.isOpen,Ze=Ae.portalClassName;G.portalClassName!==Ze&&(this.node.className=Ze);var ht=Rt.prevParent,oe=Rt.nextParent;oe!==ht&&(ht.removeChild(this.node),oe.appendChild(this.node)),!(!G.isOpen&&!et)&&!qe&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!N.canUseDOM||!this.node||!this.portal)){var G=this.portal.state,Ve=Date.now(),Rt=G.isOpen&&this.props.closeTimeoutMS&&(G.closesAt||Ve+this.props.closeTimeoutMS);Rt?(G.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,Rt-Ve)):this.removePortal()}}},{key:"render",value:function(){if(!N.canUseDOM||!qe)return null;!this.node&&qe&&(this.node=je("div"));var G=St();return G(C.default.createElement(U.default,d({ref:this.portalRef,defaultStyles:xe.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(G){j.setElement(G)}}]),xe}(v.Component);return At.propTypes={isOpen:u.default.bool.isRequired,style:u.default.shape({content:u.default.object,overlay:u.default.object}),portalClassName:u.default.string,bodyOpenClassName:u.default.string,htmlOpenClassName:u.default.string,className:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),overlayClassName:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),appElement:u.default.oneOfType([u.default.instanceOf(q.default),u.default.instanceOf(N.SafeHTMLCollection),u.default.instanceOf(N.SafeNodeList),u.default.arrayOf(u.default.instanceOf(q.default))]),onAfterOpen:u.default.func,onRequestClose:u.default.func,closeTimeoutMS:u.default.number,ariaHideApp:u.default.bool,shouldFocusAfterRender:u.default.bool,shouldCloseOnOverlayClick:u.default.bool,shouldReturnFocusAfterClose:u.default.bool,preventScroll:u.default.bool,parentSelector:u.default.func,aria:u.default.object,data:u.default.object,role:u.default.string,contentLabel:u.default.string,shouldCloseOnEsc:u.default.bool,overlayRef:u.default.func,contentRef:u.default.func,id:u.default.string,overlayElement:u.default.func,contentElement:u.default.func},At.defaultProps={isOpen:!1,portalClassName:Fe,bodyOpenClassName:ve,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(xe,Je){return C.default.createElement("div",xe,Je)},contentElement:function(xe,Je){return C.default.createElement("div",xe,Je)}},At.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,se.polyfill)(At),nc.default=At,nc}var ey;function Ex(){return ey||(ey=1,function(d,x){Object.defineProperty(x,"__esModule",{value:!0});var v=Sx(),C=I(v);function I(z){return z&&z.__esModule?z:{default:z}}x.default=C.default,d.exports=x.default}(Wf,Wf.exports)),Wf.exports}var Tx=Ex();const c_=ld(Tx);c_.setAppElement("#root");function kx({isOpen:d,afterOpen:x,onClose:v,content:C}){const I={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",minWidth:"60vw",minHeight:"60vh",textAlign:"center"}};return yt.jsx(c_,{isOpen:d,onAfterOpen:x,onRequestClose:v,style:I,contentLabel:"Example Modal",children:C})}function um({img:d,title:x,children:v,selected:C,onClick:I,name:z}){return yt.jsxs("div",{onClick:()=>I(z),className:["cardOption",C?"cardOptionSelected":""].join(" "),children:[yt.jsx("img",{className:"cardOptionImage",src:d,alt:x}),yt.jsx("h3",{children:x}),v]})}function Cx({settings:d,onChange:x}){const v=C=>{x({...d,msgPosition:C})};return yt.jsx("div",{className:"",children:yt.jsxs("div",{className:"cardOptions",children:[yt.jsxs(um,{selected:d.msgPosition==="closest",img:"img/config-closest.png",name:"closest",title:yt.jsx(Yi,{id:"app.config.closestMsg",defaultMessage:"closest"}),onClick:v,children:[yt.jsx(Yi,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",yt.jsxs("strong",{children:[" ",yt.jsx(Yi,{id:"app.config.closestMsg",defaultMessage:"closest"})," "]})," ",yt.jsx(Yi,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]}),yt.jsxs(um,{selected:d.msgPosition==="after",img:"img/config-after.png",name:"after",title:yt.jsx(Yi,{id:"app.config.closestNextMsg",defaultMessage:"next"}),onClick:v,children:[yt.jsx(Yi,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",yt.jsx("strong",{children:yt.jsx(Yi,{id:"app.config.closestNextMsg",defaultMessage:"next"})})," ",yt.jsx(Yi,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]}),yt.jsxs(um,{selected:d.msgPosition==="before",img:"img/config-before.png",name:"before",title:yt.jsx(Yi,{id:"app.config.closestPreviousMsg",defaultMessage:"previous"}),onClick:v,children:[yt.jsx(Yi,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",yt.jsx("strong",{children:yt.jsx(Yi,{id:"app.config.previousNextMsg",defaultMessage:"next"})})," ",yt.jsx(Yi,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]})]})})}function Ix({dataAvailable:d,dataFiles:x,mapData:v,handleNewUploadClick:C,settings:I,handleSettingsChange:z}){const[E,u]=qr.useState(null),B=()=>{u(null)};return qr.useEffect(()=>{u(null)},[I.msgPosition]),yt.jsx(yt.Fragment,{children:yt.jsxs("header",{className:"header",children:[yt.jsxs("div",{className:"top",children:[!d&&yt.jsx(cx,{onOptionClick:U=>{U==="options"&&u(yt.jsx(Cx,{settings:I,onChange:z}))}}),yt.jsx(kx,{isOpen:E!==null,onClose:B,content:E})]}),yt.jsxs("h1",{className:d?"titleSmall":"title",children:[yt.jsx("img",{src:ky,className:"logo",alt:"logo"}),yt.jsx("span",{children:"ChatMap"})]}),d?yt.jsxs("div",{className:"fileOptions",children:[yt.jsx(ux,{data:v,dataFiles:x}),yt.jsx("button",{onClick:C,className:"secondaryButton",children:yt.jsx(Yi,{id:"app.uploadNewFile",defaultMessage:"Upload new file"})})]}):yt.jsxs(yt.Fragment,{children:[yt.jsx("p",{className:"subtitle",children:yt.jsx(Yi,{id:"app.subtitle",defaultMessage:"Export and upload a chat to visualize locations, messages and media"})}),yt.jsx("p",{className:"highlighted",children:yt.jsx(Yi,{id:"app.supportedApps",defaultMessage:"Now it works with WhatsApp, Telegram or Signal!"})})]})]})})}function Px(){return yt.jsxs(yt.Fragment,{children:[yt.jsxs("p",{className:"info",children:[yt.jsx("strong",{children:"From chat to map"})," check this quick ",yt.jsx("strong",{children:yt.jsx("a",{href:"https://www.youtube.com/watch?v=ScHgVhyj1aw",children:"video tutorial"})})]}),yt.jsxs("div",{className:"infoLinks",children:[yt.jsxs("div",{className:"copy",children:[yt.jsx("a",{className:"github",href:"https://github.com/hotosm/chatmap"}),yt.jsx("span",{children:"Free and Open Source Software"})]}),yt.jsx("a",{href:"https://www.hotosm.org/privacy",children:"We collect zero data. https://www.hotosm.org/privacy"})]})]})}var Go=function(){return Go=Object.assign||function(x){for(var v,C=1,I=arguments.length;C<I;C++){v=arguments[C];for(var z in v)Object.prototype.hasOwnProperty.call(v,z)&&(x[z]=v[z])}return x},Go.apply(this,arguments)};function lp(d,x,v){if(v||arguments.length===2)for(var C=0,I=x.length,z;C<I;C++)(z||!(C in x))&&(z||(z=Array.prototype.slice.call(x,0,C)),z[C]=x[C]);return d.concat(z||Array.prototype.slice.call(x))}var ai="-ms-",Gd="-moz-",Vn="-webkit-",h_="comm",pp="rule",Bm="decl",Ax="@import",d_="@keyframes",Mx="@layer",f_=Math.abs,Nm=String.fromCharCode,Cm=Object.assign;function zx(d,x){return Ts(d,0)^45?(((x<<2^Ts(d,0))<<2^Ts(d,1))<<2^Ts(d,2))<<2^Ts(d,3):0}function p_(d){return d.trim()}function Au(d,x){return(d=x.exec(d))?d[0]:d}function ln(d,x,v){return d.replace(x,v)}function np(d,x,v){return d.indexOf(x,v)}function Ts(d,x){return d.charCodeAt(x)|0}function nd(d,x,v){return d.slice(x,v)}function Yl(d){return d.length}function m_(d){return d.length}function $d(d,x){return x.push(d),d}function Rx(d,x){return d.map(x).join("")}function ty(d,x){return d.filter(function(v){return!Au(v,x)})}var mp=1,id=1,g_=0,Ua=0,Ji=0,ud="";function gp(d,x,v,C,I,z,E,u){return{value:d,root:x,parent:v,type:C,props:I,children:z,line:mp,column:id,length:E,return:"",siblings:u}}function ic(d,x){return Cm(gp("",null,null,"",null,null,0,d.siblings),d,{length:-d.length},x)}function Qh(d){for(;d.root;)d=ic(d.root,{children:[d]});$d(d,d.siblings)}function Dx(){return Ji}function Lx(){return Ji=Ua>0?Ts(ud,--Ua):0,id--,Ji===10&&(id=1,mp--),Ji}function fl(){return Ji=Ua<g_?Ts(ud,Ua++):0,id++,Ji===10&&(id=1,mp++),Ji}function sh(){return Ts(ud,Ua)}function ip(){return Ua}function yp(d,x){return nd(ud,d,x)}function Im(d){switch(d){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Fx(d){return mp=id=1,g_=Yl(ud=d),Ua=0,[]}function Ox(d){return ud="",d}function cm(d){return p_(yp(Ua-1,Pm(d===91?d+2:d===40?d+1:d)))}function Bx(d){for(;(Ji=sh())&&Ji<33;)fl();return Im(d)>2||Im(Ji)>3?"":" "}function Nx(d,x){for(;--x&&fl()&&!(Ji<48||Ji>102||Ji>57&&Ji<65||Ji>70&&Ji<97););return yp(d,ip()+(x<6&&sh()==32&&fl()==32))}function Pm(d){for(;fl();)switch(Ji){case d:return Ua;case 34:case 39:d!==34&&d!==39&&Pm(Ji);break;case 40:d===41&&Pm(d);break;case 92:fl();break}return Ua}function jx(d,x){for(;fl()&&d+Ji!==57;)if(d+Ji===84&&sh()===47)break;return"/*"+yp(x,Ua-1)+"*"+Nm(d===47?d:fl())}function Ux(d){for(;!Im(sh());)fl();return yp(d,Ua)}function Vx(d){return Ox(sp("",null,null,null,[""],d=Fx(d),0,[0],d))}function sp(d,x,v,C,I,z,E,u,B){for(var U=0,K=0,j=E,N=0,q=0,se=0,J=1,ae=1,re=1,pe=0,ge="",Fe=I,ve=z,qe=C,je=ge;ae;)switch(se=pe,pe=fl()){case 40:if(se!=108&&Ts(je,j-1)==58){np(je+=ln(cm(pe),"&","&\f"),"&\f",f_(U?u[U-1]:0))!=-1&&(re=-1);break}case 34:case 39:case 91:je+=cm(pe);break;case 9:case 10:case 13:case 32:je+=Bx(se);break;case 92:je+=Nx(ip()-1,7);continue;case 47:switch(sh()){case 42:case 47:$d(Hx(jx(fl(),ip()),x,v,B),B);break;default:je+="/"}break;case 123*J:u[U++]=Yl(je)*re;case 125*J:case 59:case 0:switch(pe){case 0:case 125:ae=0;case 59+K:re==-1&&(je=ln(je,/\f/g,"")),q>0&&Yl(je)-j&&$d(q>32?ny(je+";",C,v,j-1,B):ny(ln(je," ","")+";",C,v,j-2,B),B);break;case 59:je+=";";default:if($d(qe=ry(je,x,v,U,K,I,u,ge,Fe=[],ve=[],j,z),z),pe===123)if(K===0)sp(je,x,qe,qe,Fe,z,j,u,ve);else switch(N===99&&Ts(je,3)===110?100:N){case 100:case 108:case 109:case 115:sp(d,qe,qe,C&&$d(ry(d,qe,qe,0,0,I,u,ge,I,Fe=[],j,ve),ve),I,ve,j,u,C?Fe:ve);break;default:sp(je,qe,qe,qe,[""],ve,0,u,ve)}}U=K=q=0,J=re=1,ge=je="",j=E;break;case 58:j=1+Yl(je),q=se;default:if(J<1){if(pe==123)--J;else if(pe==125&&J++==0&&Lx()==125)continue}switch(je+=Nm(pe),pe*J){case 38:re=K>0?1:(je+="\f",-1);break;case 44:u[U++]=(Yl(je)-1)*re,re=1;break;case 64:sh()===45&&(je+=cm(fl())),N=sh(),K=j=Yl(ge=je+=Ux(ip())),pe++;break;case 45:se===45&&Yl(je)==2&&(J=0)}}return z}function ry(d,x,v,C,I,z,E,u,B,U,K,j){for(var N=I-1,q=I===0?z:[""],se=m_(q),J=0,ae=0,re=0;J<C;++J)for(var pe=0,ge=nd(d,N+1,N=f_(ae=E[J])),Fe=d;pe<se;++pe)(Fe=p_(ae>0?q[pe]+" "+ge:ln(ge,/&\f/g,q[pe])))&&(B[re++]=Fe);return gp(d,x,v,I===0?pp:u,B,U,K,j)}function Hx(d,x,v,C){return gp(d,x,v,h_,Nm(Dx()),nd(d,2,-2),0,C)}function ny(d,x,v,C,I){return gp(d,x,v,Bm,nd(d,0,C),nd(d,C+1,-1),C,I)}function y_(d,x,v){switch(zx(d,x)){case 5103:return Vn+"print-"+d+d;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Vn+d+d;case 4789:return Gd+d+d;case 5349:case 4246:case 4810:case 6968:case 2756:return Vn+d+Gd+d+ai+d+d;case 5936:switch(Ts(d,x+11)){case 114:return Vn+d+ai+ln(d,/[svh]\w+-[tblr]{2}/,"tb")+d;case 108:return Vn+d+ai+ln(d,/[svh]\w+-[tblr]{2}/,"tb-rl")+d;case 45:return Vn+d+ai+ln(d,/[svh]\w+-[tblr]{2}/,"lr")+d}case 6828:case 4268:case 2903:return Vn+d+ai+d+d;case 6165:return Vn+d+ai+"flex-"+d+d;case 5187:return Vn+d+ln(d,/(\w+).+(:[^]+)/,Vn+"box-$1$2"+ai+"flex-$1$2")+d;case 5443:return Vn+d+ai+"flex-item-"+ln(d,/flex-|-self/g,"")+(Au(d,/flex-|baseline/)?"":ai+"grid-row-"+ln(d,/flex-|-self/g,""))+d;case 4675:return Vn+d+ai+"flex-line-pack"+ln(d,/align-content|flex-|-self/g,"")+d;case 5548:return Vn+d+ai+ln(d,"shrink","negative")+d;case 5292:return Vn+d+ai+ln(d,"basis","preferred-size")+d;case 6060:return Vn+"box-"+ln(d,"-grow","")+Vn+d+ai+ln(d,"grow","positive")+d;case 4554:return Vn+ln(d,/([^-])(transform)/g,"$1"+Vn+"$2")+d;case 6187:return ln(ln(ln(d,/(zoom-|grab)/,Vn+"$1"),/(image-set)/,Vn+"$1"),d,"")+d;case 5495:case 3959:return ln(d,/(image-set\([^]*)/,Vn+"$1$`$1");case 4968:return ln(ln(d,/(.+:)(flex-)?(.*)/,Vn+"box-pack:$3"+ai+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Vn+d+d;case 4200:if(!Au(d,/flex-|baseline/))return ai+"grid-column-align"+nd(d,x)+d;break;case 2592:case 3360:return ai+ln(d,"template-","")+d;case 4384:case 3616:return v&&v.some(function(C,I){return x=I,Au(C.props,/grid-\w+-end/)})?~np(d+(v=v[x].value),"span",0)?d:ai+ln(d,"-start","")+d+ai+"grid-row-span:"+(~np(v,"span",0)?Au(v,/\d+/):+Au(v,/\d+/)-+Au(d,/\d+/))+";":ai+ln(d,"-start","")+d;case 4896:case 4128:return v&&v.some(function(C){return Au(C.props,/grid-\w+-start/)})?d:ai+ln(ln(d,"-end","-span"),"span ","")+d;case 4095:case 3583:case 4068:case 2532:return ln(d,/(.+)-inline(.+)/,Vn+"$1$2")+d;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yl(d)-1-x>6)switch(Ts(d,x+1)){case 109:if(Ts(d,x+4)!==45)break;case 102:return ln(d,/(.+:)(.+)-([^]+)/,"$1"+Vn+"$2-$3$1"+Gd+(Ts(d,x+3)==108?"$3":"$2-$3"))+d;case 115:return~np(d,"stretch",0)?y_(ln(d,"stretch","fill-available"),x,v)+d:d}break;case 5152:case 5920:return ln(d,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(C,I,z,E,u,B,U){return ai+I+":"+z+U+(E?ai+I+"-span:"+(u?B:+B-+z)+U:"")+d});case 4949:if(Ts(d,x+6)===121)return ln(d,":",":"+Vn)+d;break;case 6444:switch(Ts(d,Ts(d,14)===45?18:11)){case 120:return ln(d,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Vn+(Ts(d,14)===45?"inline-":"")+"box$3$1"+Vn+"$2$3$1"+ai+"$2box$3")+d;case 100:return ln(d,":",":"+ai)+d}break;case 5719:case 2647:case 2135:case 3927:case 2391:return ln(d,"scroll-","scroll-snap-")+d}return d}function up(d,x){for(var v="",C=0;C<d.length;C++)v+=x(d[C],C,d,x)||"";return v}function $x(d,x,v,C){switch(d.type){case Mx:if(d.children.length)break;case Ax:case Bm:return d.return=d.return||d.value;case h_:return"";case d_:return d.return=d.value+"{"+up(d.children,C)+"}";case pp:if(!Yl(d.value=d.props.join(",")))return""}return Yl(v=up(d.children,C))?d.return=d.value+"{"+v+"}":""}function Gx(d){var x=m_(d);return function(v,C,I,z){for(var E="",u=0;u<x;u++)E+=d[u](v,C,I,z)||"";return E}}function qx(d){return function(x){x.root||(x=x.return)&&d(x)}}function Zx(d,x,v,C){if(d.length>-1&&!d.return)switch(d.type){case Bm:d.return=y_(d.value,d.length,v);return;case d_:return up([ic(d,{value:ln(d.value,"@","@"+Vn)})],C);case pp:if(d.length)return Rx(v=d.props,function(I){switch(Au(I,C=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Qh(ic(d,{props:[ln(I,/:(read-\w+)/,":"+Gd+"$1")]})),Qh(ic(d,{props:[I]})),Cm(d,{props:ty(v,C)});break;case"::placeholder":Qh(ic(d,{props:[ln(I,/:(plac\w+)/,":"+Vn+"input-$1")]})),Qh(ic(d,{props:[ln(I,/:(plac\w+)/,":"+Gd+"$1")]})),Qh(ic(d,{props:[ln(I,/:(plac\w+)/,ai+"input-$1")]})),Qh(ic(d,{props:[I]})),Cm(d,{props:ty(v,C)});break}return""})}}var Wx={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},xa={},sd=typeof process<"u"&&xa!==void 0&&(xa.REACT_APP_SC_ATTR||xa.SC_ATTR)||"data-styled",__="active",v_="data-styled-version",_p="6.1.13",jm=`/*!sc*/
`,cp=typeof window<"u"&&"HTMLElement"in window,Xx=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&xa!==void 0&&xa.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&xa.REACT_APP_SC_DISABLE_SPEEDY!==""?xa.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&xa.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&xa!==void 0&&xa.SC_DISABLE_SPEEDY!==void 0&&xa.SC_DISABLE_SPEEDY!==""&&xa.SC_DISABLE_SPEEDY!=="false"&&xa.SC_DISABLE_SPEEDY),vp=Object.freeze([]),od=Object.freeze({});function Kx(d,x,v){return v===void 0&&(v=od),d.theme!==v.theme&&d.theme||x||v.theme}var x_=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),Yx=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Jx=/(^-|-$)/g;function iy(d){return d.replace(Yx,"-").replace(Jx,"")}var Qx=/(a)(d)/gi,Jf=52,sy=function(d){return String.fromCharCode(d+(d>25?39:97))};function Am(d){var x,v="";for(x=Math.abs(d);x>Jf;x=x/Jf|0)v=sy(x%Jf)+v;return(sy(x%Jf)+v).replace(Qx,"$1-$2")}var hm,w_=5381,ed=function(d,x){for(var v=x.length;v;)d=33*d^x.charCodeAt(--v);return d},b_=function(d){return ed(w_,d)};function e1(d){return Am(b_(d)>>>0)}function t1(d){return d.displayName||d.name||"Component"}function dm(d){return typeof d=="string"&&!0}var S_=typeof Symbol=="function"&&Symbol.for,E_=S_?Symbol.for("react.memo"):60115,r1=S_?Symbol.for("react.forward_ref"):60112,n1={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i1={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},T_={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s1=((hm={})[r1]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hm[E_]=T_,hm);function oy(d){return("type"in(x=d)&&x.type.$$typeof)===E_?T_:"$$typeof"in d?s1[d.$$typeof]:n1;var x}var o1=Object.defineProperty,a1=Object.getOwnPropertyNames,ay=Object.getOwnPropertySymbols,l1=Object.getOwnPropertyDescriptor,u1=Object.getPrototypeOf,ly=Object.prototype;function k_(d,x,v){if(typeof x!="string"){if(ly){var C=u1(x);C&&C!==ly&&k_(d,C,v)}var I=a1(x);ay&&(I=I.concat(ay(x)));for(var z=oy(d),E=oy(x),u=0;u<I.length;++u){var B=I[u];if(!(B in i1||v&&v[B]||E&&B in E||z&&B in z)){var U=l1(x,B);try{o1(d,B,U)}catch{}}}}return d}function ad(d){return typeof d=="function"}function Um(d){return typeof d=="object"&&"styledComponentId"in d}function ih(d,x){return d&&x?"".concat(d," ").concat(x):d||x||""}function uy(d,x){if(d.length===0)return"";for(var v=d[0],C=1;C<d.length;C++)v+=d[C];return v}function qd(d){return d!==null&&typeof d=="object"&&d.constructor.name===Object.name&&!("props"in d&&d.$$typeof)}function Mm(d,x,v){if(v===void 0&&(v=!1),!v&&!qd(d)&&!Array.isArray(d))return x;if(Array.isArray(x))for(var C=0;C<x.length;C++)d[C]=Mm(d[C],x[C]);else if(qd(x))for(var C in x)d[C]=Mm(d[C],x[C]);return d}function Vm(d,x){Object.defineProperty(d,"toString",{value:x})}function Xd(d){for(var x=[],v=1;v<arguments.length;v++)x[v-1]=arguments[v];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(d," for more information.").concat(x.length>0?" Args: ".concat(x.join(", ")):""))}var c1=function(){function d(x){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=x}return d.prototype.indexOfGroup=function(x){for(var v=0,C=0;C<x;C++)v+=this.groupSizes[C];return v},d.prototype.insertRules=function(x,v){if(x>=this.groupSizes.length){for(var C=this.groupSizes,I=C.length,z=I;x>=z;)if((z<<=1)<0)throw Xd(16,"".concat(x));this.groupSizes=new Uint32Array(z),this.groupSizes.set(C),this.length=z;for(var E=I;E<z;E++)this.groupSizes[E]=0}for(var u=this.indexOfGroup(x+1),B=(E=0,v.length);E<B;E++)this.tag.insertRule(u,v[E])&&(this.groupSizes[x]++,u++)},d.prototype.clearGroup=function(x){if(x<this.length){var v=this.groupSizes[x],C=this.indexOfGroup(x),I=C+v;this.groupSizes[x]=0;for(var z=C;z<I;z++)this.tag.deleteRule(C)}},d.prototype.getGroup=function(x){var v="";if(x>=this.length||this.groupSizes[x]===0)return v;for(var C=this.groupSizes[x],I=this.indexOfGroup(x),z=I+C,E=I;E<z;E++)v+="".concat(this.tag.getRule(E)).concat(jm);return v},d}(),op=new Map,hp=new Map,ap=1,Qf=function(d){if(op.has(d))return op.get(d);for(;hp.has(ap);)ap++;var x=ap++;return op.set(d,x),hp.set(x,d),x},h1=function(d,x){ap=x+1,op.set(d,x),hp.set(x,d)},d1="style[".concat(sd,"][").concat(v_,'="').concat(_p,'"]'),f1=new RegExp("^".concat(sd,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),p1=function(d,x,v){for(var C,I=v.split(","),z=0,E=I.length;z<E;z++)(C=I[z])&&d.registerName(x,C)},m1=function(d,x){for(var v,C=((v=x.textContent)!==null&&v!==void 0?v:"").split(jm),I=[],z=0,E=C.length;z<E;z++){var u=C[z].trim();if(u){var B=u.match(f1);if(B){var U=0|parseInt(B[1],10),K=B[2];U!==0&&(h1(K,U),p1(d,K,B[3]),d.getTag().insertRules(U,I)),I.length=0}else I.push(u)}}},cy=function(d){for(var x=document.querySelectorAll(d1),v=0,C=x.length;v<C;v++){var I=x[v];I&&I.getAttribute(sd)!==__&&(m1(d,I),I.parentNode&&I.parentNode.removeChild(I))}};function g1(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var C_=function(d){var x=document.head,v=d||x,C=document.createElement("style"),I=function(u){var B=Array.from(u.querySelectorAll("style[".concat(sd,"]")));return B[B.length-1]}(v),z=I!==void 0?I.nextSibling:null;C.setAttribute(sd,__),C.setAttribute(v_,_p);var E=g1();return E&&C.setAttribute("nonce",E),v.insertBefore(C,z),C},y1=function(){function d(x){this.element=C_(x),this.element.appendChild(document.createTextNode("")),this.sheet=function(v){if(v.sheet)return v.sheet;for(var C=document.styleSheets,I=0,z=C.length;I<z;I++){var E=C[I];if(E.ownerNode===v)return E}throw Xd(17)}(this.element),this.length=0}return d.prototype.insertRule=function(x,v){try{return this.sheet.insertRule(v,x),this.length++,!0}catch{return!1}},d.prototype.deleteRule=function(x){this.sheet.deleteRule(x),this.length--},d.prototype.getRule=function(x){var v=this.sheet.cssRules[x];return v&&v.cssText?v.cssText:""},d}(),_1=function(){function d(x){this.element=C_(x),this.nodes=this.element.childNodes,this.length=0}return d.prototype.insertRule=function(x,v){if(x<=this.length&&x>=0){var C=document.createTextNode(v);return this.element.insertBefore(C,this.nodes[x]||null),this.length++,!0}return!1},d.prototype.deleteRule=function(x){this.element.removeChild(this.nodes[x]),this.length--},d.prototype.getRule=function(x){return x<this.length?this.nodes[x].textContent:""},d}(),v1=function(){function d(x){this.rules=[],this.length=0}return d.prototype.insertRule=function(x,v){return x<=this.length&&(this.rules.splice(x,0,v),this.length++,!0)},d.prototype.deleteRule=function(x){this.rules.splice(x,1),this.length--},d.prototype.getRule=function(x){return x<this.length?this.rules[x]:""},d}(),hy=cp,x1={isServer:!cp,useCSSOMInjection:!Xx},I_=function(){function d(x,v,C){x===void 0&&(x=od),v===void 0&&(v={});var I=this;this.options=Go(Go({},x1),x),this.gs=v,this.names=new Map(C),this.server=!!x.isServer,!this.server&&cp&&hy&&(hy=!1,cy(this)),Vm(this,function(){return function(z){for(var E=z.getTag(),u=E.length,B="",U=function(j){var N=function(re){return hp.get(re)}(j);if(N===void 0)return"continue";var q=z.names.get(N),se=E.getGroup(j);if(q===void 0||!q.size||se.length===0)return"continue";var J="".concat(sd,".g").concat(j,'[id="').concat(N,'"]'),ae="";q!==void 0&&q.forEach(function(re){re.length>0&&(ae+="".concat(re,","))}),B+="".concat(se).concat(J,'{content:"').concat(ae,'"}').concat(jm)},K=0;K<u;K++)U(K);return B}(I)})}return d.registerId=function(x){return Qf(x)},d.prototype.rehydrate=function(){!this.server&&cp&&cy(this)},d.prototype.reconstructWithOptions=function(x,v){return v===void 0&&(v=!0),new d(Go(Go({},this.options),x),this.gs,v&&this.names||void 0)},d.prototype.allocateGSInstance=function(x){return this.gs[x]=(this.gs[x]||0)+1},d.prototype.getTag=function(){return this.tag||(this.tag=(x=function(v){var C=v.useCSSOMInjection,I=v.target;return v.isServer?new v1(I):C?new y1(I):new _1(I)}(this.options),new c1(x)));var x},d.prototype.hasNameForId=function(x,v){return this.names.has(x)&&this.names.get(x).has(v)},d.prototype.registerName=function(x,v){if(Qf(x),this.names.has(x))this.names.get(x).add(v);else{var C=new Set;C.add(v),this.names.set(x,C)}},d.prototype.insertRules=function(x,v,C){this.registerName(x,v),this.getTag().insertRules(Qf(x),C)},d.prototype.clearNames=function(x){this.names.has(x)&&this.names.get(x).clear()},d.prototype.clearRules=function(x){this.getTag().clearGroup(Qf(x)),this.clearNames(x)},d.prototype.clearTag=function(){this.tag=void 0},d}(),w1=/&/g,b1=/^\s*\/\/.*$/gm;function P_(d,x){return d.map(function(v){return v.type==="rule"&&(v.value="".concat(x," ").concat(v.value),v.value=v.value.replaceAll(",",",".concat(x," ")),v.props=v.props.map(function(C){return"".concat(x," ").concat(C)})),Array.isArray(v.children)&&v.type!=="@keyframes"&&(v.children=P_(v.children,x)),v})}function S1(d){var x,v,C,I=od,z=I.options,E=z===void 0?od:z,u=I.plugins,B=u===void 0?vp:u,U=function(N,q,se){return se.startsWith(v)&&se.endsWith(v)&&se.replaceAll(v,"").length>0?".".concat(x):N},K=B.slice();K.push(function(N){N.type===pp&&N.value.includes("&")&&(N.props[0]=N.props[0].replace(w1,v).replace(C,U))}),E.prefix&&K.push(Zx),K.push($x);var j=function(N,q,se,J){q===void 0&&(q=""),se===void 0&&(se=""),J===void 0&&(J="&"),x=J,v=q,C=new RegExp("\\".concat(v,"\\b"),"g");var ae=N.replace(b1,""),re=Vx(se||q?"".concat(se," ").concat(q," { ").concat(ae," }"):ae);E.namespace&&(re=P_(re,E.namespace));var pe=[];return up(re,Gx(K.concat(qx(function(ge){return pe.push(ge)})))),pe};return j.hash=B.length?B.reduce(function(N,q){return q.name||Xd(15),ed(N,q.name)},w_).toString():"",j}var E1=new I_,zm=S1(),A_=lh.createContext({shouldForwardProp:void 0,styleSheet:E1,stylis:zm});A_.Consumer;lh.createContext(void 0);function dy(){return qr.useContext(A_)}var T1=function(){function d(x,v){var C=this;this.inject=function(I,z){z===void 0&&(z=zm);var E=C.name+z.hash;I.hasNameForId(C.id,E)||I.insertRules(C.id,E,z(C.rules,E,"@keyframes"))},this.name=x,this.id="sc-keyframes-".concat(x),this.rules=v,Vm(this,function(){throw Xd(12,String(C.name))})}return d.prototype.getName=function(x){return x===void 0&&(x=zm),this.name+x.hash},d}(),k1=function(d){return d>="A"&&d<="Z"};function fy(d){for(var x="",v=0;v<d.length;v++){var C=d[v];if(v===1&&C==="-"&&d[0]==="-")return d;k1(C)?x+="-"+C.toLowerCase():x+=C}return x.startsWith("ms-")?"-"+x:x}var M_=function(d){return d==null||d===!1||d===""},z_=function(d){var x,v,C=[];for(var I in d){var z=d[I];d.hasOwnProperty(I)&&!M_(z)&&(Array.isArray(z)&&z.isCss||ad(z)?C.push("".concat(fy(I),":"),z,";"):qd(z)?C.push.apply(C,lp(lp(["".concat(I," {")],z_(z),!1),["}"],!1)):C.push("".concat(fy(I),": ").concat((x=I,(v=z)==null||typeof v=="boolean"||v===""?"":typeof v!="number"||v===0||x in Wx||x.startsWith("--")?String(v).trim():"".concat(v,"px")),";")))}return C};function oh(d,x,v,C){if(M_(d))return[];if(Um(d))return[".".concat(d.styledComponentId)];if(ad(d)){if(!ad(z=d)||z.prototype&&z.prototype.isReactComponent||!x)return[d];var I=d(x);return oh(I,x,v,C)}var z;return d instanceof T1?v?(d.inject(v,C),[d.getName(C)]):[d]:qd(d)?z_(d):Array.isArray(d)?Array.prototype.concat.apply(vp,d.map(function(E){return oh(E,x,v,C)})):[d.toString()]}function C1(d){for(var x=0;x<d.length;x+=1){var v=d[x];if(ad(v)&&!Um(v))return!1}return!0}var I1=b_(_p),P1=function(){function d(x,v,C){this.rules=x,this.staticRulesId="",this.isStatic=(C===void 0||C.isStatic)&&C1(x),this.componentId=v,this.baseHash=ed(I1,v),this.baseStyle=C,I_.registerId(v)}return d.prototype.generateAndInjectStyles=function(x,v,C){var I=this.baseStyle?this.baseStyle.generateAndInjectStyles(x,v,C):"";if(this.isStatic&&!C.hash)if(this.staticRulesId&&v.hasNameForId(this.componentId,this.staticRulesId))I=ih(I,this.staticRulesId);else{var z=uy(oh(this.rules,x,v,C)),E=Am(ed(this.baseHash,z)>>>0);if(!v.hasNameForId(this.componentId,E)){var u=C(z,".".concat(E),void 0,this.componentId);v.insertRules(this.componentId,E,u)}I=ih(I,E),this.staticRulesId=E}else{for(var B=ed(this.baseHash,C.hash),U="",K=0;K<this.rules.length;K++){var j=this.rules[K];if(typeof j=="string")U+=j;else if(j){var N=uy(oh(j,x,v,C));B=ed(B,N+K),U+=N}}if(U){var q=Am(B>>>0);v.hasNameForId(this.componentId,q)||v.insertRules(this.componentId,q,C(U,".".concat(q),void 0,this.componentId)),I=ih(I,q)}}return I},d}(),R_=lh.createContext(void 0);R_.Consumer;var fm={};function A1(d,x,v){var C=Um(d),I=d,z=!dm(d),E=x.attrs,u=E===void 0?vp:E,B=x.componentId,U=B===void 0?function(Fe,ve){var qe=typeof Fe!="string"?"sc":iy(Fe);fm[qe]=(fm[qe]||0)+1;var je="".concat(qe,"-").concat(e1(_p+qe+fm[qe]));return ve?"".concat(ve,"-").concat(je):je}(x.displayName,x.parentComponentId):B,K=x.displayName,j=K===void 0?function(Fe){return dm(Fe)?"styled.".concat(Fe):"Styled(".concat(t1(Fe),")")}(d):K,N=x.displayName&&x.componentId?"".concat(iy(x.displayName),"-").concat(x.componentId):x.componentId||U,q=C&&I.attrs?I.attrs.concat(u).filter(Boolean):u,se=x.shouldForwardProp;if(C&&I.shouldForwardProp){var J=I.shouldForwardProp;if(x.shouldForwardProp){var ae=x.shouldForwardProp;se=function(Fe,ve){return J(Fe,ve)&&ae(Fe,ve)}}else se=J}var re=new P1(v,N,C?I.componentStyle:void 0);function pe(Fe,ve){return function(qe,je,St){var ot=qe.attrs,At=qe.componentStyle,xt=qe.defaultProps,xe=qe.foldedComponentIds,Je=qe.styledComponentId,G=qe.target,Ve=lh.useContext(R_),Rt=dy(),Ae=qe.shouldForwardProp||Rt.shouldForwardProp,et=Kx(je,Ve,xt)||od,Ze=function(wt,ar,fr){for(var qt,Kt=Go(Go({},ar),{className:void 0,theme:fr}),Cr=0;Cr<wt.length;Cr+=1){var Br=ad(qt=wt[Cr])?qt(Kt):qt;for(var Yr in Br)Kt[Yr]=Yr==="className"?ih(Kt[Yr],Br[Yr]):Yr==="style"?Go(Go({},Kt[Yr]),Br[Yr]):Br[Yr]}return ar.className&&(Kt.className=ih(Kt.className,ar.className)),Kt}(ot,je,et),ht=Ze.as||G,oe={};for(var _e in Ze)Ze[_e]===void 0||_e[0]==="$"||_e==="as"||_e==="theme"&&Ze.theme===et||(_e==="forwardedAs"?oe.as=Ze.forwardedAs:Ae&&!Ae(_e,ht)||(oe[_e]=Ze[_e]));var Ct=function(wt,ar){var fr=dy(),qt=wt.generateAndInjectStyles(ar,fr.styleSheet,fr.stylis);return qt}(At,Ze),bt=ih(xe,Je);return Ct&&(bt+=" "+Ct),Ze.className&&(bt+=" "+Ze.className),oe[dm(ht)&&!x_.has(ht)?"class":"className"]=bt,oe.ref=St,qr.createElement(ht,oe)}(ge,Fe,ve)}pe.displayName=j;var ge=lh.forwardRef(pe);return ge.attrs=q,ge.componentStyle=re,ge.displayName=j,ge.shouldForwardProp=se,ge.foldedComponentIds=C?ih(I.foldedComponentIds,I.styledComponentId):"",ge.styledComponentId=N,ge.target=C?I.target:d,Object.defineProperty(ge,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(Fe){this._foldedDefaultProps=C?function(ve){for(var qe=[],je=1;je<arguments.length;je++)qe[je-1]=arguments[je];for(var St=0,ot=qe;St<ot.length;St++)Mm(ve,ot[St],!0);return ve}({},I.defaultProps,Fe):Fe}}),Vm(ge,function(){return".".concat(ge.styledComponentId)}),z&&k_(ge,d,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),ge}function py(d,x){for(var v=[d[0]],C=0,I=x.length;C<I;C+=1)v.push(x[C],d[C+1]);return v}var my=function(d){return Object.assign(d,{isCss:!0})};function D_(d){for(var x=[],v=1;v<arguments.length;v++)x[v-1]=arguments[v];if(ad(d)||qd(d))return my(oh(py(vp,lp([d],x,!0))));var C=d;return x.length===0&&C.length===1&&typeof C[0]=="string"?oh(C):my(oh(py(C,x)))}function Rm(d,x,v){if(v===void 0&&(v=od),!x)throw Xd(1,x);var C=function(I){for(var z=[],E=1;E<arguments.length;E++)z[E-1]=arguments[E];return d(x,v,D_.apply(void 0,lp([I],z,!1)))};return C.attrs=function(I){return Rm(d,x,Go(Go({},v),{attrs:Array.prototype.concat(v.attrs,I).filter(Boolean)}))},C.withConfig=function(I){return Rm(d,x,Go(Go({},v),I))},C}var L_=function(d){return Rm(A1,d)},Kd=L_;x_.forEach(function(d){Kd[d]=L_(d)});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ah=function(){return ah=Object.assign||function(d){for(var x,v=1,C=arguments.length;v<C;v++)for(var I in x=arguments[v])Object.prototype.hasOwnProperty.call(x,I)&&(d[I]=x[I]);return d},ah.apply(this,arguments)};function Yd(d,x){return Object.defineProperty?Object.defineProperty(d,"raw",{value:x}):d.raw=x,d}var gy,yy,_y,vy,xy,M1=D_(gy||(gy=Yd([`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`],[`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`])),"#0658c2","#666","#666","#666","#666","#666"),z1=Kd.label(yy||(yy=Yd([`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`],[`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`])),function(d){return d.override?"":M1}),R1=Kd.div(_y||(_y=Yd([`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`],[`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`])),"#666","#999"),D1=Kd.div(vy||(vy=Yd([`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`],[`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`])),function(d){return d.$error?"red":"#666"}),L1=Kd.span(xy||(xy=Yd([`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`],[`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`])),"#666"),wy=function(d){return d/1024/1024},F1=function(d){return d===void 0?"":d.map(function(x){return".".concat(x.toLowerCase())}).join(",")};function O1(d){var x=d.types,v=d.minSize,C=d.maxSize;if(x){var I=x.toString(),z="";return C&&(z+="size >= ".concat(C,", ")),v&&(z+="size <= ".concat(v,", ")),yt.jsx("span",ah({title:"".concat(z,"types: ").concat(I),className:"file-types"},{children:I}),void 0)}return null}function B1(){return yt.jsxs("svg",ah({width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[yt.jsx("path",{d:"M5.33317 6.66667H22.6665V16H25.3332V6.66667C25.3332 5.196 24.1372 4 22.6665 4H5.33317C3.8625 4 2.6665 5.196 2.6665 6.66667V22.6667C2.6665 24.1373 3.8625 25.3333 5.33317 25.3333H15.9998V22.6667H5.33317V6.66667Z",fill:"#0658C2"},void 0),yt.jsx("path",{d:"M10.6665 14.6667L6.6665 20H21.3332L15.9998 12L11.9998 17.3333L10.6665 14.6667Z",fill:"#0658C2"},void 0),yt.jsx("path",{d:"M25.3332 18.6667H22.6665V22.6667H18.6665V25.3333H22.6665V29.3333H25.3332V25.3333H29.3332V22.6667H25.3332V18.6667Z",fill:"#0658C2"},void 0)]}),void 0)}var pm=0,N1=function(d,x,v,C,I,z){return v?yt.jsx("span",{children:"File type/size error, Hovered on types!"},void 0):yt.jsx(L1,{children:C?yt.jsx("span",{children:"Upload disabled"},void 0):yt.jsx(yt.Fragment,d||x?{children:z?yt.jsx(yt.Fragment,{children:yt.jsx("span",{children:z},void 0)},void 0):yt.jsxs(yt.Fragment,{children:[yt.jsx("span",{children:"Uploaded Successfully!"},void 0)," Upload another?"]},void 0)}:{children:yt.jsxs(yt.Fragment,I?{children:[yt.jsx("span",{children:I.split(" ")[0]},void 0)," ",I.substr(I.indexOf(" ")+1)]}:{children:[yt.jsx("span",{children:"Upload"},void 0)," or drop a file right here"]},void 0)},void 0)},void 0)},j1=function(d){var x=d.name,v=d.hoverTitle,C=d.types,I=d.handleChange,z=d.classes,E=d.children,u=d.maxSize,B=d.minSize,U=d.fileOrFiles,K=d.onSizeError,j=d.onTypeError,N=d.onSelect,q=d.onDrop,se=d.disabled,J=d.label,ae=d.uploadedLabel,re=d.multiple,pe=d.required,ge=d.onDraggingStateChange,Fe=d.dropMessageStyle,ve=d.ariaLabel,qe=d.ariaDescribedby,je=qr.useRef(null),St=qr.useRef(null),ot=qr.useState(!1),At=ot[0],xt=ot[1],xe=qr.useState(null),Je=xe[0],G=xe[1],Ve=qr.useState(!1),Rt=Ve[0],Ae=Ve[1],et=function(oe){return C&&!function(_e,Ct){var bt=_e.name.split(".").pop();return Ct.map(function(wt){return wt.toLowerCase()}).includes(bt.toLowerCase())}(oe,C)?(Ae(!0),j&&j("File type is not supported"),!1):u&&wy(oe.size)>u?(Ae(!0),K&&K("File size is too big"),!1):!(B&&wy(oe.size)<B)||(Ae(!0),K&&K("File size is too small"),!1)},Ze=function(oe){var _e=!1;if(oe){if(oe instanceof File)_e=!et(oe);else for(var Ct=0;Ct<oe.length;Ct++){var bt=oe[Ct];_e=!et(bt)||_e}return!_e&&(I&&I(oe),G(oe),xt(!0),Ae(!1),!0)}return!1},ht=function(oe){var _e=oe.labelRef,Ct=oe.inputRef,bt=oe.multiple,wt=oe.handleChanges,ar=oe.onDrop,fr=qr.useState(!1),qt=fr[0],Kt=fr[1],Cr=qr.useCallback(function(){Ct.current.click()},[Ct]),Br=qr.useCallback(function(ft){ft.preventDefault(),ft.stopPropagation(),pm++,ft.dataTransfer.items&&ft.dataTransfer.items.length!==0&&Kt(!0)},[]),Yr=qr.useCallback(function(ft){ft.preventDefault(),ft.stopPropagation(),--pm>0||Kt(!1)},[]),Zr=qr.useCallback(function(ft){ft.preventDefault(),ft.stopPropagation()},[]),W=qr.useCallback(function(ft){ft.preventDefault(),ft.stopPropagation(),Kt(!1),pm=0;var ye=ft.dataTransfer.files;if(ye&&ye.length>0){var Me=bt?ye:ye[0],we=wt(Me);ar&&we&&ar(Me)}},[wt]);return qr.useEffect(function(){var ft=_e.current;return ft.addEventListener("click",Cr),ft.addEventListener("dragenter",Br),ft.addEventListener("dragleave",Yr),ft.addEventListener("dragover",Zr),ft.addEventListener("drop",W),function(){ft.removeEventListener("click",Cr),ft.removeEventListener("dragenter",Br),ft.removeEventListener("dragleave",Yr),ft.removeEventListener("dragover",Zr),ft.removeEventListener("drop",W)}},[Cr,Br,Yr,Zr,W,_e]),qt}({labelRef:je,inputRef:St,multiple:re,handleChanges:Ze,onDrop:q});return qr.useEffect(function(){ge==null||ge(ht)},[ht]),qr.useEffect(function(){U?(xt(!0),G(U)):(St.current&&(St.current.value=""),xt(!1),G(null))},[U]),yt.jsxs(z1,ah({override:E,className:"".concat(z||""," ").concat(se?"is-disabled":""),ref:je,htmlFor:x,onClick:function(oe){oe.preventDefault(),oe.stopPropagation()},"aria-describedby":qe,role:"button","aria-label":ve},{children:[yt.jsx("input",{onClick:function(oe){oe.stopPropagation(),St&&St.current&&(St.current.value="",St.current.click())},onChange:function(oe){var _e=oe.target.files,Ct=re?_e:_e[0],bt=Ze(Ct);N&&bt&&N(Ct)},accept:F1(C),ref:St,type:"file",id:x,name:x,disabled:se,multiple:re,required:pe},void 0),ht&&yt.jsx(R1,ah({style:Fe},{children:yt.jsx("span",{children:v||"Drop Here"},void 0)}),void 0),!E&&yt.jsxs(yt.Fragment,{children:[yt.jsx(B1,{},void 0),yt.jsxs(D1,ah({$error:Rt},{children:[N1(Je,At,Rt,se,J,ae),yt.jsx(O1,{types:C,minSize:B,maxSize:u},void 0)]}),void 0)]},void 0),E]}),void 0)};const U1=["txt","zip","json"],by=d=>{if(d.substring(0,8)==="__MACOSX")return;const x=d.toLowerCase();if(x.endsWith(".txt")||x.endsWith(".json"))return"chat";if(x.endsWith(".zip"))return"zip";if(x.endsWith(".jpg")||x.endsWith(".jpeg")||x.endsWith(".mp4"))return"media"},V1=({onFilesLoad:d,onDataFileLoad:x,onError:v})=>{const[C,I]=qr.useState(),[z,E]=qr.useState(),u=fp(),B=K=>{E(K.length);for(let N=0;N<K.length;N++){const q=K[N],se=by(q.name);if(se==="chat"){var j=new FileReader;j.readAsText(q,"UTF-8"),j.onload=function(J){I(ae=>({...ae,[q.name]:J.target.result}))},j.onerror=function(J){v(q.name)}}else se==="zip"&&new r_().loadAsync(q).then(function(J){Object.keys(J.files).forEach(ae=>{const re=by(ae);re==="chat"?J.files[ae].async("string").then(function(pe){I(ge=>({...ge,[q.name]:pe}))}):re==="media"&&J.files[ae].async("arraybuffer").then(function(pe){const ge=new Uint8Array(pe),Fe=new Blob([ge.buffer]);x(ae,Fe)})})})}};qr.useEffect(()=>{C&&Object.keys(C).length===z&&d(C)},[C,d]);const U=C&&Object.keys(C).length!==z;return yt.jsxs(yt.Fragment,{children:[U?yt.jsxs("p",{style:{textAlign:"center"},children:[u.formatMessage({id:"app.loading",defaultMessage:"Loading"})," ..."]}):"",yt.jsx("div",{style:U?{display:"none"}:null,children:yt.jsx(j1,{classes:"fileUploadDropArea",handleChange:B,multiple:!0,name:"file",types:U1,label:u.formatMessage({id:"app.uploadLabel",defaultMessage:"Upload or drag a file right here"})})})]})};function H1({handleDataFile:d,handleFiles:x}){return yt.jsx(yt.Fragment,{children:yt.jsx("div",{className:"fileUpload",children:yt.jsx(V1,{onDataFileLoad:d,onFilesLoad:x})})})}function $1({handleNewUploadClick:d}){return yt.jsxs(yt.Fragment,{children:[yt.jsx("h2",{children:yt.jsx(Yi,{id:"app.nolocations",defaultMessage:"No locations found in this file"})}),yt.jsx("button",{onClick:d,className:"secondaryButton",children:yt.jsx(Yi,{id:"app.uploadNewFile",defaultMessage:"Upload new file"})})]})}function G1(){const[d,x]=kv({msgPosition:"closest"}),[v,C,I,z,E]=Iv(),[u,B]=zv({files:E,msgPosition:d.msgPosition}),U=()=>{I(),B()},K=E&&u&&u.features.length>0,j=E&&u&&u.features.length===0;return yt.jsxs("div",{className:"app",children:[yt.jsx(Ix,{dataAvailable:K,dataFiles:z,mapData:u,handleNewUploadClick:U,settings:d,handleSettingsChange:x}),!E&&yt.jsxs(yt.Fragment,{children:[yt.jsx(H1,{handleFiles:v,handleDataFile:C}),yt.jsx(Px,{})]}),K&&yt.jsx(Tv,{data:u,dataFiles:z}),j&&yt.jsx($1,{handleNewUploadClick:U})]})}class q1 extends lh.Component{constructor(x){super(x),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(x){return{hasError:!0,error:x}}render(){if(this.state.hasError){const x=`${this.state.error.fileName}(${this.state.error.lineNumber}): 
 ${this.state.error.toString()} 
 ${this.state.error.stack}`,v=`mailto:emilio.mariscal@hotosm.org?subject=ChatMap Error&body=Hi, something went wrong with chatmap: ${x}`;return yt.jsxs("div",{className:"errorMessage",children:[yt.jsx("header",{className:"header",children:yt.jsxs("h1",{className:"title",children:[yt.jsx("img",{src:ky,className:"logo",alt:"logo"})," ChatMap"]})}),yt.jsxs("div",{children:[yt.jsx("h2",{children:"Oops! something went wrong 🫢"}),yt.jsx("h3",{children:"Let us know of this error so we can fix it as soon as possible."}),yt.jsxs("p",{children:[yt.jsxs("strong",{className:"highlighted",children:["Please, send the detail below to ",yt.jsx("a",{href:v,children:"emilio.mariscal@hotosm.org"})]}),yt.jsx("br",{}),"or create an issue in ",yt.jsx("a",{href:"https://github.com/hotosm/chatmap/issues",children:"github.com/hotosm/chatmap/issues"})]}),yt.jsxs("div",{className:"buttons",children:[yt.jsx("a",{className:"primaryButton",href:"/",children:"Go back"}),yt.jsx("a",{className:"secondaryButton",href:v,children:"Send error report"})]}),yt.jsxs("pre",{children:[yt.jsx("strong",{children:"Error:"})," ",x]})]})]})}return this.props.children}}const Z1={"app.subtitle":"Export and upload a chat to visualize locations, messages and media","app.config.msgPositionTextStart":"It will search for locations and the","app.config.msgPositionTextEnd":"message from the same user.","app.config.closestPreviousMsg":"previous","app.config.closestNextMsg":"next","app.config.closestMsg":"closest","app.uploadNewFile":"Upload new file","app.download":"Download","app.options":"Options","app.uploadLabel":"Upload or drag a file right here","app.nolocations":"No locations found in this file","app.supportedApps":"Now it works with WhatsApp, Telegram or Signal!"},W1={"app.subtitle":"Exporte e carregue um bate-papo para visualizar locais, mensagens e mídia","app.config.msgPositionTextStart":"Buscará localizaciones y el","app.config.msgPositionTextEnd":"mensaje del mismo usuario.","app.config.closestPreviousMsg":"anterior","app.config.closestNextMsg":"siguiente","app.config.closestMsg":"más cercano","app.uploadNewFile":"Subir un nuevo archivo","app.download":"Descargar","app.options":"Opciones","app.uploadLabel":"Sube o arrastra un archivo aquí mismo","app.nolocations":"No se han encontrado ubicaciones en este archivo","app.loading":"Cargando","app.supportedApps":"Ahora funciona con WhatsApp, Telegram o Signal!"},X1={"app.subtitle":"Exportar uma chat da aplicação e visualizar localizações partilhadas na conversa","app.config.msgPositionTextStart":"Procurará locais e o","app.config.msgPositionTextEnd":"mensagem do mesmo utilizador.","app.config.closestPreviousMsg":"anterior","app.config.closestNextMsg":"seguinte","app.config.closestMsg":"mais próximo","app.uploadNewFile":"Carregar um novo ficheiro","app.download":"Descarregar","app.options":"Opções","app.uploadLabel":"Carregue ou arraste um ficheiro aqui mesmo","app.nolocations":"Não foram encontrados locais neste arquivo.","app.loading":"Carregando","app.supportedApps":"Agora funciona com WhatsApp, Telegram e Signal!"},mm={en:Z1,es:W1,pt:X1},K1=()=>{const d=navigator.language.slice(0,2);return d in mm?mm[d]:mm.en},Y1=uv.createRoot(document.getElementById("root"));Y1.render(yt.jsx(lh.StrictMode,{children:yt.jsx(tx,{locale:navigator.language,messages:K1(),children:yt.jsx(q1,{children:yt.jsx(G1,{})})})}));
//# sourceMappingURL=index-CmzH1Pb_.js.map

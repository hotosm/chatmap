import{g as e}from"./chatmap-ChGbHgkD.js";const t=["Se eliminó este mensaje","Los mensajes y las llamadas están cifrados de extremo a extremo. Solo las personas en este chat pueden leerlos, escucharlos o compartirlos. Obtén más información.","You deleted this message.","You changed this group's icon","You changed the group description","You created group ","Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them.","This message was deleted.","joined using your invite","Tap to change who can add other members.","<Multimedia omitido>"],s=/[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?).*$/,a={IOS:/\[(.*)\] ([^:]*): (.*)/,ANDROID:/(.*) - ([^:]*): (.*)/},r=e=>{const t=e.match(a.IOS),s=e.match(a.ANDROID);return t?"IOS":s?"ANDROID":"UNKNOWN"},n=e=>{const t=e.message.toLowerCase();let s=t.indexOf(".jpg");if(s<0&&(s=t.indexOf(".mp4")),s>0){let a=e.message.substring(t.lastIndexOf(":")+1,s+4);return" "==a.substring(0,1)?a.substring(1,a.length):a}return""},o=e=>{const t=e.match(s);return t?t[0].split(",").map((e=>parseFloat(e))):null},i=(e,s)=>{const r=e.match(a[s]);if(r&&-1===t.indexOf(r[3])){let e=r[2];const t=e.indexOf(":");t>-1&&(e=e.substring(0,t));let s={time:l(r[1]),username:e,message:r[3]};return s.file=n(s),s.file&&(s.message=""),s}},l=e=>{let t=e.replace("a. m.","AM").replace("p. m.","PM");t=t.replace("a.m.","AM").replace("p.m.","PM");let s=t.split(" ");const a=new Date;let r=[[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/"),s[1]].join(" ");return new Date(r)},p=(e,t)=>{let s=0;const a={};return e.forEach((e=>{e=e.replaceAll(/[\u200E\u200F\u202A-\u202E\u200B]/g,"");const r=i(e,t);r?(a[s]=r,a[s].id=s,s++):(a[s-1]&&"ANDROID"==t&&"/"!==e.substring(2,1)&&-1==e.indexOf("a. m.")&&-1==e.indexOf("p. m.")||"IOS"==t&&-1==e.indexOf("["))&&(a[s-1].message+=" "+e)})),a};function m({text:t}){if(!t)return;const s=t.split("\n"),a={type:"FeatureCollection",features:[]};let n,i={};for(let e=0;e<s.length&&(n=r(s[e]),"UNKNOWN"===n);e++);const l=p(s,n);return Object.values(l).forEach(((t,s)=>{if(t.message){const r=o(t.message);if(r){const n=[parseFloat(r[1]),parseFloat(r[0])];if(n[0]/Math.round(n[0])!=1&&n[1]/Math.round(n[1])!=0){i={type:"Feature",properties:{},geometry:{type:"Point",coordinates:n}};const r=e(l,s,o);r?(i.properties={...r},i.properties.related=r.id,l[r.id].mapped=!0):i.properties={username:t.username,time:t.time},i.properties.id=s,a.features.push(i),l[s].mapped=!0}}}})),{geoJSON:a,messages:l}}export{m as default,r as detectSystem,n as lookForMediaFile,p as parseAndIndex,i as parseMessage,l as parseTimeString,o as searchLocation};

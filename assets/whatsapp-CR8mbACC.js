import{g as e,a as t,b as s}from"./chatmap-CJOVdwUa.js";const a=/[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?).*$/,r={IOS:/\[(.*)\] ([^:]*): (.*)/,ANDROID:/(.*) - ([^:]*): (.*)/},n=e=>{const t=e.match(r.IOS),s=e.match(r.ANDROID);return t?"IOS":s?"ANDROID":"UNKNOWN"},l=e=>{const t=e.message.toLowerCase();let s=t.indexOf(".jpg");if(s<0&&(s=t.indexOf(".mp4")),s>0){let a=e.message.substring(t.lastIndexOf(":")+1,s+4);return" "==a.substring(0,1)?a.substring(1,a.length):a}return""},o=e=>{const t=e.match(a);return t?t[0].split(",").map((e=>parseFloat(e))):null},c=(e,t)=>{const s=e.match(r[t]);if(s){let e=s[2];const t=e.indexOf(":");t>-1&&(e=e.substring(0,t));let a={time:i(s[1]),username:e,message:s[3]};return a.file=l(a),a.file&&(a.message=""),a}},i=e=>{let t=e.replace("a. m.","AM").replace("p. m.","PM");t=t.replace("a.m.","AM").replace("p.m.","PM");let s=t.split(" ");const a=new Date;let r=[[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/"),s[1]].join(" ");return new Date(r)};function u({text:a,msgPosition:r}){if(!a)return;const l=a.split("\n"),i={type:"FeatureCollection",features:[]};let u,p={};for(let e=0;e<l.length&&(u=n(l[e]),"UNKNOWN"===u);e++);const m=((e,t)=>{let s=0;const a={};return e.forEach((e=>{e=e.replaceAll(/[\u200E\u200F\u202A-\u202E\u200B]/g,"");const r=c(e,t);r&&(a[s]=r,s++)})),a})(l,u);return Object.values(m).forEach(((a,n)=>{if(a.message){const l=o(a.message);if(l){let a;switch(p={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[parseFloat(l[1]),parseFloat(l[0])]}},r){case"before":a=s(m,n);break;case"after":a=t(m,n);break;default:a=e(m,n)}p.properties={...a},i.features.push(p)}}})),i}export{u as default,n as detectSystem,l as lookForMediaFile,c as parseMessage,i as parseTimeString,o as searchLocation};

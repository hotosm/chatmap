import{g as f,a as g,b as p}from"./chatmap--UvUJPGO.js";const d=/[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?).*$/,u={IOS:/\[(.*)\] ([^:]*): (.*)/,ANDROID:/(.*) - ([^:]*): (.*)/},O=a=>{const s=a.match(u.IOS),e=a.match(u.ANDROID);return s?"IOS":e?"ANDROID":"UNKNOWN"},h=a=>{const s=a.message.toLowerCase();let e=s.indexOf(".jpg");if(e<0&&(e=s.indexOf(".mp4")),e>0){let t=a.message.substring(s.lastIndexOf(":")+1,e+4);return t.substring(0,1)==" "?t.substring(1,t.length):t}return""},N=a=>{const s=a.match(d);return s?s[0].split(",").map(e=>parseFloat(e)):null},b=(a,s)=>{const e=a.match(u[s]);if(e){let t=e[2];const r=t.indexOf(":");r>-1&&(t=t.substring(0,r));let n={time:A(e[1]),username:t,message:e[3]};return n.file=h(n),n.file&&(n.message=""),n}},A=a=>{let s=a.replace("a. m.","AM").replace("p. m.","PM");s=s.replace("a.m.","AM").replace("p.m.","PM");let e=s.split(" ");const t=new Date;let r=[[t.getFullYear(),t.getMonth()+1,t.getDate()].join("/"),e[1]].join(" ");return new Date(r)},I=(a,s)=>{let e=0;const t={};return a.forEach(r=>{r=r.replaceAll(/[\u200E\u200F\u202A-\u202E\u200B]/g,"");const n=b(r,s);n&&(t[e]=n,e++)}),t};function F({text:a,msgPosition:s}){if(!a)return;const e=a.split(`
`),t={type:"FeatureCollection",features:[]};let r={},n;for(let o=0;o<e.length&&(n=O(e[o]),n==="UNKNOWN");o++);const c=I(e,n);return Object.values(c).forEach((o,l)=>{if(o.message){const m=N(o.message);if(m){r={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[parseFloat(m[1]),parseFloat(m[0])]}};let i;switch(s){case"before":i=p(c,l);break;case"after":i=g(c,l);break;default:i=f(c,l);break}r.properties={...i},t.features.push(r)}}}),t}export{F as default,O as detectSystem,h as lookForMediaFile,b as parseMessage,A as parseTimeString,N as searchLocation};
//# sourceMappingURL=whatsapp-C86084Ia.js.map
